!function(t) {
    function i() {
        for (var t = 0; t < x.length; t++) x[t][0](x[t][1]);
        m = !(x = []);
    }
    function n(t, e) {
        x.push([ t, e ]), m || (m = !0, S(i, 0));
    }
    function s(e) {
        var t = (i = e.owner).state_, i = i.data_, n = e[t];
        if (e = e.then, "function" == typeof n) {
            t = v;
            try {
                i = n(i);
            } catch (t) {
                h(e, t);
            }
        }
        o(e, i) || (t === v && a(e, i), t === b && h(e, i));
    }
    function o(e, i) {
        var n;
        try {
            if (e === i) throw new TypeError("A promises callback cannot return that same promise.");
            if (i && ("function" == typeof i || "object" == typeof i)) {
                var t = i.then;
                if ("function" == typeof t) return t.call(i, function(t) {
                    n || (n = !0, i !== t ? a(e, t) : r(e, t));
                }, function(t) {
                    n || (n = !0, h(e, t));
                }), !0;
            }
        } catch (t) {
            return n || h(e, t), !0;
        }
        return !1;
    }
    function a(t, e) {
        t !== e && o(t, e) || r(t, e);
    }
    function r(t, e) {
        t.state_ === f && (t.state_ = y, t.data_ = e, n(l, t));
    }
    function h(t, e) {
        t.state_ === f && (t.state_ = y, t.data_ = e, n(c, t));
    }
    function e(t) {
        var e = t.then_;
        for (t.then_ = void 0, t = 0; t < e.length; t++) s(e[t]);
    }
    function l(t) {
        t.state_ = v, e(t);
    }
    function c(t) {
        t.state_ = b, e(t);
    }
    function u(t) {
        if ("function" != typeof t) throw new TypeError("Promise constructor takes a function argument");
        if (!1 == this instanceof u) throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
        this.then_ = [], function(t, e) {
            function i(t) {
                h(e, t);
            }
            try {
                t(function(t) {
                    a(e, t);
                }, i);
            } catch (t) {
                i(t);
            }
        }(t, this);
    }
    var d, p = t.Promise, g = p && "resolve" in p && "reject" in p && "all" in p && "race" in p && (new p(function(t) {
        d = t;
    }), "function" == typeof d);
    "undefined" != typeof exports && exports ? (exports.Promise = g ? p : u, exports.Polyfill = u) : "function" == typeof define && define.amd ? define(function() {
        return g ? p : u;
    }) : g || (t.Promise = u);
    var m, f = "pending", y = "sealed", v = "fulfilled", b = "rejected", _ = function() {}, S = "undefined" != typeof setImmediate ? setImmediate : setTimeout, x = [];
    u.prototype = {
        constructor: u,
        state_: f,
        then_: null,
        data_: void 0,
        then: function(t, e) {
            var i = {
                owner: this,
                then: new this.constructor(_),
                fulfilled: t,
                rejected: e
            };
            return this.state_ === v || this.state_ === b ? n(s, i) : this.then_.push(i), i.then;
        },
        catch: function(t) {
            return this.then(null, t);
        }
    }, u.all = function(r) {
        if ("[object Array]" !== Object.prototype.toString.call(r)) throw new TypeError("You must pass an array to Promise.all().");
        return new this(function(i, t) {
            function e(e) {
                return o++, function(t) {
                    s[e] = t, --o || i(s);
                };
            }
            for (var n, s = [], o = 0, a = 0; a < r.length; a++) (n = r[a]) && "function" == typeof n.then ? n.then(e(a), t) : s[a] = n;
            o || i(s);
        });
    }, u.race = function(s) {
        if ("[object Array]" !== Object.prototype.toString.call(s)) throw new TypeError("You must pass an array to Promise.race().");
        return new this(function(t, e) {
            for (var i, n = 0; n < s.length; n++) (i = s[n]) && "function" == typeof i.then ? i.then(t, e) : t(i);
        });
    }, u.resolve = function(e) {
        return e && "object" == typeof e && e.constructor === this ? e : new this(function(t) {
            t(e);
        });
    }, u.reject = function(i) {
        return new this(function(t, e) {
            e(i);
        });
    };
}("undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : this), 
function(t) {
    var e;
    "object" == typeof exports ? module.exports = t() : ("undefined" != typeof window ? e = window : "undefined" != typeof global ? e = global : "undefined" != typeof self && (e = self), 
    e.p2 = t());
}(function() {
    return function s(o, a, r) {
        function h(i, t) {
            if (!a[i]) {
                if (!o[i]) {
                    var e = "function" == typeof require && require;
                    if (!t && e) return e(i, !0);
                    if (l) return l(i, !0);
                    throw new Error("Cannot find module '" + i + "'");
                }
                var n = a[i] = {
                    exports: {}
                };
                o[i][0].call(n.exports, function(t) {
                    var e = o[i][1][t];
                    return h(e || t);
                }, n, n.exports, s, o, a, r);
            }
            return a[i].exports;
        }
        for (var l = "function" == typeof require && require, t = 0; t < r.length; t++) h(r[t]);
        return h;
    }({
        1: [ function(t, e, i) {
            var u = t("./Scalar");
            function n() {}
            (e.exports = n).lineInt = function(t, e, i) {
                i = i || 0;
                var n, s, o, a, r, h, l, c = [ 0, 0 ];
                return n = t[1][1] - t[0][1], s = t[0][0] - t[1][0], o = n * t[0][0] + s * t[0][1], 
                a = e[1][1] - e[0][1], r = e[0][0] - e[1][0], h = a * e[0][0] + r * e[0][1], l = n * r - a * s, 
                u.eq(l, 0, i) || (c[0] = (r * o - s * h) / l, c[1] = (n * h - a * o) / l), c;
            }, n.segmentsIntersect = function(t, e, i, n) {
                var s = e[0] - t[0], o = e[1] - t[1], a = n[0] - i[0], r = n[1] - i[1];
                if (a * o - r * s == 0) return !1;
                var h = (s * (i[1] - t[1]) + o * (t[0] - i[0])) / (a * o - r * s), l = (a * (t[1] - i[1]) + r * (i[0] - t[0])) / (r * s - a * o);
                return 0 <= h && h <= 1 && 0 <= l && l <= 1;
            };
        }, {
            "./Scalar": 4
        } ],
        2: [ function(t, e, i) {
            function l() {}
            (e.exports = l).area = function(t, e, i) {
                return (e[0] - t[0]) * (i[1] - t[1]) - (i[0] - t[0]) * (e[1] - t[1]);
            }, l.left = function(t, e, i) {
                return 0 < l.area(t, e, i);
            }, l.leftOn = function(t, e, i) {
                return 0 <= l.area(t, e, i);
            }, l.right = function(t, e, i) {
                return l.area(t, e, i) < 0;
            }, l.rightOn = function(t, e, i) {
                return l.area(t, e, i) <= 0;
            };
            var c = [], u = [];
            l.collinear = function(t, e, i, n) {
                if (n) {
                    var s = c, o = u;
                    s[0] = e[0] - t[0], s[1] = e[1] - t[1], o[0] = i[0] - e[0], o[1] = i[1] - e[1];
                    var a = s[0] * o[0] + s[1] * o[1], r = Math.sqrt(s[0] * s[0] + s[1] * s[1]), h = Math.sqrt(o[0] * o[0] + o[1] * o[1]);
                    return Math.acos(a / (r * h)) < n;
                }
                return 0 == l.area(t, e, i);
            }, l.sqdist = function(t, e) {
                var i = e[0] - t[0], n = e[1] - t[1];
                return i * i + n * n;
            };
        }, {} ],
        3: [ function(t, e, i) {
            var r = t("./Line"), x = t("./Point"), d = t("./Scalar");
            function w() {
                this.vertices = [];
            }
            (e.exports = w).prototype.at = function(t) {
                var e = this.vertices, i = e.length;
                return e[t < 0 ? t % i + i : t % i];
            }, w.prototype.first = function() {
                return this.vertices[0];
            }, w.prototype.last = function() {
                return this.vertices[this.vertices.length - 1];
            }, w.prototype.clear = function() {
                this.vertices.length = 0;
            }, w.prototype.append = function(t, e, i) {
                if (void 0 === e) throw new Error("From is not given!");
                if (void 0 === i) throw new Error("To is not given!");
                if (i - 1 < e) throw new Error("lol1");
                if (i > t.vertices.length) throw new Error("lol2");
                if (e < 0) throw new Error("lol3");
                for (var n = e; n < i; n++) this.vertices.push(t.vertices[n]);
            }, w.prototype.makeCCW = function() {
                for (var t = 0, e = this.vertices, i = 1; i < this.vertices.length; ++i) (e[i][1] < e[t][1] || e[i][1] == e[t][1] && e[i][0] > e[t][0]) && (t = i);
                x.left(this.at(t - 1), this.at(t), this.at(t + 1)) || this.reverse();
            }, w.prototype.reverse = function() {
                for (var t = [], e = 0, i = this.vertices.length; e !== i; e++) t.push(this.vertices.pop());
                this.vertices = t;
            }, w.prototype.isReflex = function(t) {
                return x.right(this.at(t - 1), this.at(t), this.at(t + 1));
            };
            var h = [], l = [];
            function A(t, e, i, n, s) {
                s = s || 0;
                var o = e[1] - t[1], a = t[0] - e[0], r = o * t[0] + a * t[1], h = n[1] - i[1], l = i[0] - n[0], c = h * i[0] + l * i[1], u = o * l - h * a;
                return d.eq(u, 0, s) ? [ 0, 0 ] : [ (l * r - a * c) / u, (o * c - h * r) / u ];
            }
            w.prototype.canSee = function(t, e) {
                var i, n, s = h, o = l;
                if (x.leftOn(this.at(t + 1), this.at(t), this.at(e)) && x.rightOn(this.at(t - 1), this.at(t), this.at(e))) return !1;
                n = x.sqdist(this.at(t), this.at(e));
                for (var a = 0; a !== this.vertices.length; ++a) if ((a + 1) % this.vertices.length !== t && a !== t && x.leftOn(this.at(t), this.at(e), this.at(a + 1)) && x.rightOn(this.at(t), this.at(e), this.at(a)) && (s[0] = this.at(t), 
                s[1] = this.at(e), o[0] = this.at(a), o[1] = this.at(a + 1), i = r.lineInt(s, o), 
                x.sqdist(this.at(t), i) < n)) return !1;
                return !0;
            }, w.prototype.copy = function(t, e, i) {
                var n = i || new w();
                if (n.clear(), t < e) for (var s = t; s <= e; s++) n.vertices.push(this.vertices[s]); else {
                    for (s = 0; s <= e; s++) n.vertices.push(this.vertices[s]);
                    for (s = t; s < this.vertices.length; s++) n.vertices.push(this.vertices[s]);
                }
                return n;
            }, w.prototype.getCutEdges = function() {
                for (var t = [], e = [], i = [], n = new w(), s = Number.MAX_VALUE, o = 0; o < this.vertices.length; ++o) if (this.isReflex(o)) for (var a = 0; a < this.vertices.length; ++a) if (this.canSee(o, a)) {
                    e = this.copy(o, a, n).getCutEdges(), i = this.copy(a, o, n).getCutEdges();
                    for (var r = 0; r < i.length; r++) e.push(i[r]);
                    e.length < s && (s = (t = e).length, t.push([ this.at(o), this.at(a) ]));
                }
                return t;
            }, w.prototype.decomp = function() {
                var t = this.getCutEdges();
                return 0 < t.length ? this.slice(t) : [ this ];
            }, w.prototype.slice = function(t) {
                if (0 == t.length) return [ this ];
                if (t instanceof Array && t.length && t[0] instanceof Array && 2 == t[0].length && t[0][0] instanceof Array) {
                    for (var e = [ this ], i = 0; i < t.length; i++) for (var n = t[i], s = 0; s < e.length; s++) {
                        var o = e[s].slice(n);
                        if (o) {
                            e.splice(s, 1), e.push(o[0], o[1]);
                            break;
                        }
                    }
                    return e;
                }
                n = t, i = this.vertices.indexOf(n[0]), s = this.vertices.indexOf(n[1]);
                return -1 != i && -1 != s && [ this.copy(i, s), this.copy(s, i) ];
            }, w.prototype.isSimple = function() {
                for (var t = this.vertices, e = 0; e < t.length - 1; e++) for (var i = 0; i < e - 1; i++) if (r.segmentsIntersect(t[e], t[e + 1], t[i], t[i + 1])) return !1;
                for (e = 1; e < t.length - 2; e++) if (r.segmentsIntersect(t[0], t[t.length - 1], t[e], t[e + 1])) return !1;
                return !0;
            }, w.prototype.quickDecomp = function(t, e, i, n, s, o) {
                s = s || 100, o = o || 0, n = n || 25, t = void 0 !== t ? t : [], e = e || [], i = i || [];
                var a = [ 0, 0 ], r = [ 0, 0 ], h = [ 0, 0 ], l = 0, c = 0, u = 0, d = 0, p = 0, g = 0, m = 0, f = new w(), y = new w(), v = this, b = this.vertices;
                if (b.length < 3) return t;
                if (s < ++o) return t;
                for (var _ = 0; _ < this.vertices.length; ++_) if (v.isReflex(_)) {
                    e.push(v.vertices[_]), l = c = Number.MAX_VALUE;
                    for (var S = 0; S < this.vertices.length; ++S) x.left(v.at(_ - 1), v.at(_), v.at(S)) && x.rightOn(v.at(_ - 1), v.at(_), v.at(S - 1)) && (h = A(v.at(_ - 1), v.at(_), v.at(S), v.at(S - 1)), 
                    x.right(v.at(_ + 1), v.at(_), h) && (u = x.sqdist(v.vertices[_], h)) < c && (c = u, 
                    r = h, g = S)), x.left(v.at(_ + 1), v.at(_), v.at(S + 1)) && x.rightOn(v.at(_ + 1), v.at(_), v.at(S)) && (h = A(v.at(_ + 1), v.at(_), v.at(S), v.at(S + 1)), 
                    x.left(v.at(_ - 1), v.at(_), h) && (u = x.sqdist(v.vertices[_], h)) < l && (l = u, 
                    a = h, p = S));
                    if (g == (p + 1) % this.vertices.length) h[0] = (r[0] + a[0]) / 2, h[1] = (r[1] + a[1]) / 2, 
                    i.push(h), _ < p ? (f.append(v, _, p + 1), f.vertices.push(h), y.vertices.push(h), 
                    0 != g && y.append(v, g, v.vertices.length), y.append(v, 0, _ + 1)) : (0 != _ && f.append(v, _, v.vertices.length), 
                    f.append(v, 0, p + 1), f.vertices.push(h), y.vertices.push(h), y.append(v, g, _ + 1)); else {
                        if (p < g && (p += this.vertices.length), d = Number.MAX_VALUE, p < g) return t;
                        for (S = g; S <= p; ++S) x.leftOn(v.at(_ - 1), v.at(_), v.at(S)) && x.rightOn(v.at(_ + 1), v.at(_), v.at(S)) && (u = x.sqdist(v.at(_), v.at(S))) < d && (d = u, 
                        m = S % this.vertices.length);
                        _ < m ? (f.append(v, _, m + 1), 0 != m && y.append(v, m, b.length), y.append(v, 0, _ + 1)) : (0 != _ && f.append(v, _, b.length), 
                        f.append(v, 0, m + 1), y.append(v, m, _ + 1));
                    }
                    return f.vertices.length < y.vertices.length ? (f.quickDecomp(t, e, i, n, s, o), 
                    y.quickDecomp(t, e, i, n, s, o)) : (y.quickDecomp(t, e, i, n, s, o), f.quickDecomp(t, e, i, n, s, o)), 
                    t;
                }
                return t.push(this), t;
            }, w.prototype.removeCollinearPoints = function(t) {
                for (var e = 0, i = this.vertices.length - 1; 3 < this.vertices.length && 0 <= i; --i) x.collinear(this.at(i - 1), this.at(i), this.at(i + 1), t) && (this.vertices.splice(i % this.vertices.length, 1), 
                i--, e++);
                return e;
            };
        }, {
            "./Line": 1,
            "./Point": 2,
            "./Scalar": 4
        } ],
        4: [ function(t, e, i) {
            function n() {}
            (e.exports = n).eq = function(t, e, i) {
                return i = i || 0, Math.abs(t - e) < i;
            };
        }, {} ],
        5: [ function(t, e, i) {
            e.exports = {
                Polygon: t("./Polygon"),
                Point: t("./Point")
            };
        }, {
            "./Point": 2,
            "./Polygon": 3
        } ],
        6: [ function(t, e, i) {
            e.exports = {
                name: "p2",
                version: "0.7.1",
                description: "A JavaScript 2D physics engine.",
                author: "Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",
                keywords: [ "p2.js", "p2", "physics", "engine", "2d" ],
                main: "./src/p2.js",
                engines: {
                    node: "*"
                },
                repository: {
                    type: "git",
                    url: "https://github.com/schteppe/p2.js.git"
                },
                bugs: {
                    url: "https://github.com/schteppe/p2.js/issues"
                },
                licenses: [ {
                    type: "MIT"
                } ],
                devDependencies: {
                    grunt: "^0.4.5",
                    "grunt-contrib-jshint": "^0.11.2",
                    "grunt-contrib-nodeunit": "^0.4.1",
                    "grunt-contrib-uglify": "~0.4.0",
                    "grunt-contrib-watch": "~0.5.0",
                    "grunt-browserify": "~2.0.1",
                    "grunt-contrib-concat": "^0.4.0"
                },
                dependencies: {
                    "poly-decomp": "0.1.1"
                }
            };
        }, {} ],
        7: [ function(t, e, i) {
            var p = t("../math/vec2");
            t("../utils/Utils");
            function n(t) {
                this.lowerBound = p.create(), t && t.lowerBound && p.copy(this.lowerBound, t.lowerBound), 
                this.upperBound = p.create(), t && t.upperBound && p.copy(this.upperBound, t.upperBound);
            }
            e.exports = n;
            var g = p.create();
            n.prototype.setFromPoints = function(t, e, i, n) {
                var s = this.lowerBound, o = this.upperBound;
                "number" != typeof i && (i = 0), 0 !== i ? p.rotate(s, t[0], i) : p.copy(s, t[0]), 
                p.copy(o, s);
                for (var a = Math.cos(i), r = Math.sin(i), h = 1; h < t.length; h++) {
                    var l = t[h];
                    if (0 !== i) {
                        var c = l[0], u = l[1];
                        g[0] = a * c - r * u, g[1] = r * c + a * u, l = g;
                    }
                    for (var d = 0; d < 2; d++) l[d] > o[d] && (o[d] = l[d]), l[d] < s[d] && (s[d] = l[d]);
                }
                e && (p.add(this.lowerBound, this.lowerBound, e), p.add(this.upperBound, this.upperBound, e)), 
                n && (this.lowerBound[0] -= n, this.lowerBound[1] -= n, this.upperBound[0] += n, 
                this.upperBound[1] += n);
            }, n.prototype.copy = function(t) {
                p.copy(this.lowerBound, t.lowerBound), p.copy(this.upperBound, t.upperBound);
            }, n.prototype.extend = function(t) {
                for (var e = 2; e--; ) {
                    var i = t.lowerBound[e];
                    this.lowerBound[e] > i && (this.lowerBound[e] = i);
                    var n = t.upperBound[e];
                    this.upperBound[e] < n && (this.upperBound[e] = n);
                }
            }, n.prototype.overlaps = function(t) {
                var e = this.lowerBound, i = this.upperBound, n = t.lowerBound, s = t.upperBound;
                return (n[0] <= i[0] && i[0] <= s[0] || e[0] <= s[0] && s[0] <= i[0]) && (n[1] <= i[1] && i[1] <= s[1] || e[1] <= s[1] && s[1] <= i[1]);
            }, n.prototype.containsPoint = function(t) {
                var e = this.lowerBound, i = this.upperBound;
                return e[0] <= t[0] && t[0] <= i[0] && e[1] <= t[1] && t[1] <= i[1];
            }, n.prototype.overlapsRay = function(t) {
                var e = 1 / t.direction[0], i = 1 / t.direction[1], n = (this.lowerBound[0] - t.from[0]) * e, s = (this.upperBound[0] - t.from[0]) * e, o = (this.lowerBound[1] - t.from[1]) * i, a = (this.upperBound[1] - t.from[1]) * i, r = Math.max(Math.max(Math.min(n, s), Math.min(o, a))), h = Math.min(Math.min(Math.max(n, s), Math.max(o, a)));
                return h < 0 ? -1 : h < r ? -1 : r;
            };
        }, {
            "../math/vec2": 30,
            "../utils/Utils": 57
        } ],
        8: [ function(t, e, i) {
            var s = t("../math/vec2"), o = t("../objects/Body");
            function n(t) {
                this.type = t, this.result = [], this.world = null, this.boundingVolumeType = n.AABB;
            }
            (e.exports = n).AABB = 1, n.BOUNDING_CIRCLE = 2, n.prototype.setWorld = function(t) {
                this.world = t;
            }, n.prototype.getCollisionPairs = function(t) {};
            var a = s.create();
            n.boundingRadiusCheck = function(t, e) {
                s.sub(a, t.position, e.position);
                var i = s.squaredLength(a), n = t.boundingRadius + e.boundingRadius;
                return i <= n * n;
            }, n.aabbCheck = function(t, e) {
                return t.getAABB().overlaps(e.getAABB());
            }, n.prototype.boundingVolumeCheck = function(t, e) {
                var i;
                switch (this.boundingVolumeType) {
                  case n.BOUNDING_CIRCLE:
                    i = n.boundingRadiusCheck(t, e);
                    break;

                  case n.AABB:
                    i = n.aabbCheck(t, e);
                    break;

                  default:
                    throw new Error("Bounding volume type not recognized: " + this.boundingVolumeType);
                }
                return i;
            }, n.canCollide = function(t, e) {
                var i = o.KINEMATIC, n = o.STATIC;
                return (t.type !== n || e.type !== n) && (!(t.type === i && e.type === n || t.type === n && e.type === i) && ((t.type !== i || e.type !== i) && ((t.sleepState !== o.SLEEPING || e.sleepState !== o.SLEEPING) && !(t.sleepState === o.SLEEPING && e.type === n || e.sleepState === o.SLEEPING && t.type === n))));
            }, n.NAIVE = 1, n.SAP = 2;
        }, {
            "../math/vec2": 30,
            "../objects/Body": 31
        } ],
        9: [ function(t, e, i) {
            t("../shapes/Circle"), t("../shapes/Plane"), t("../shapes/Shape"), t("../shapes/Particle");
            var h = t("../collision/Broadphase");
            t("../math/vec2");
            function n() {
                h.call(this, h.NAIVE);
            }
            (((e.exports = n).prototype = new h()).constructor = n).prototype.getCollisionPairs = function(t) {
                for (var e = t.bodies, i = this.result, n = i.length = 0, s = e.length; n !== s; n++) for (var o = e[n], a = 0; a < n; a++) {
                    var r = e[a];
                    h.canCollide(o, r) && this.boundingVolumeCheck(o, r) && i.push(o, r);
                }
                return i;
            }, n.prototype.aabbQuery = function(t, e, i) {
                i = i || [];
                for (var n = t.bodies, s = 0; s < n.length; s++) {
                    var o = n[s];
                    o.aabbNeedsUpdate && o.updateAABB(), o.aabb.overlaps(e) && i.push(o);
                }
                return i;
            };
        }, {
            "../collision/Broadphase": 8,
            "../math/vec2": 30,
            "../shapes/Circle": 39,
            "../shapes/Particle": 43,
            "../shapes/Plane": 44,
            "../shapes/Shape": 45
        } ],
        10: [ function(t, e, i) {
            var z = t("../math/vec2"), W = z.sub, V = z.add, H = z.dot, n = (t("../utils/Utils"), 
            t("../utils/ContactEquationPool")), s = t("../utils/FrictionEquationPool"), o = t("../utils/TupleDictionary"), a = t("../equations/Equation"), r = (t("../equations/ContactEquation"), 
            t("../equations/FrictionEquation"), t("../shapes/Circle")), h = t("../shapes/Convex"), l = t("../shapes/Shape"), w = (t("../objects/Body"), 
            t("../shapes/Box"));
            e.exports = $;
            var A = z.fromValues(0, 1), X = z.fromValues(0, 0), j = z.fromValues(0, 0), Y = z.fromValues(0, 0), q = z.fromValues(0, 0), K = z.fromValues(0, 0), M = z.fromValues(0, 0), Z = z.fromValues(0, 0), J = z.fromValues(0, 0), Q = z.fromValues(0, 0), k = z.fromValues(0, 0), D = z.fromValues(0, 0), G = z.fromValues(0, 0), U = z.fromValues(0, 0), F = z.fromValues(0, 0), B = z.fromValues(0, 0), L = z.fromValues(0, 0), E = z.fromValues(0, 0), I = z.fromValues(0, 0), N = [];
            function $() {
                this.contactEquations = [], this.frictionEquations = [], this.enableFriction = !0, 
                this.enabledEquations = !0, this.slipForce = 10, this.frictionCoefficient = .3, 
                this.surfaceVelocity = 0, this.contactEquationPool = new n({
                    size: 32
                }), this.frictionEquationPool = new s({
                    size: 64
                }), this.restitution = 0, this.stiffness = a.DEFAULT_STIFFNESS, this.relaxation = a.DEFAULT_RELAXATION, 
                this.frictionStiffness = a.DEFAULT_STIFFNESS, this.frictionRelaxation = a.DEFAULT_RELAXATION, 
                this.enableFrictionReduction = !0, this.collidingBodiesLastStep = new o(), this.contactSkinSize = .01;
            }
            var c = z.create(), u = z.create();
            function b(t, e) {
                z.set(t.vertices[0], .5 * -e.length, -e.radius), z.set(t.vertices[1], .5 * e.length, -e.radius), 
                z.set(t.vertices[2], .5 * e.length, e.radius), z.set(t.vertices[3], .5 * -e.length, e.radius);
            }
            $.prototype.bodiesOverlap = function(t, e) {
                for (var i = c, n = u, s = 0, o = t.shapes.length; s !== o; s++) {
                    var a = t.shapes[s];
                    t.toWorldFrame(i, a.position);
                    for (var r = 0, h = e.shapes.length; r !== h; r++) {
                        var l = e.shapes[r];
                        if (e.toWorldFrame(n, l.position), this[a.type | l.type](t, a, i, a.angle + t.angle, e, l, n, l.angle + e.angle, !0)) return !0;
                    }
                }
                return !1;
            }, $.prototype.collidedLastStep = function(t, e) {
                var i = 0 | t.id, n = 0 | e.id;
                return !!this.collidingBodiesLastStep.get(i, n);
            }, $.prototype.reset = function() {
                this.collidingBodiesLastStep.reset();
                for (var t = this.contactEquations, e = t.length; e--; ) {
                    var i = t[e], n = i.bodyA.id, s = i.bodyB.id;
                    this.collidingBodiesLastStep.set(n, s, !0);
                }
                for (var o = this.contactEquations, a = this.frictionEquations, r = 0; r < o.length; r++) this.contactEquationPool.release(o[r]);
                for (r = 0; r < a.length; r++) this.frictionEquationPool.release(a[r]);
                this.contactEquations.length = this.frictionEquations.length = 0;
            }, $.prototype.createContactEquation = function(t, e, i, n) {
                var s = this.contactEquationPool.get();
                return s.bodyA = t, s.bodyB = e, s.shapeA = i, s.shapeB = n, s.restitution = this.restitution, 
                s.firstImpact = !this.collidedLastStep(t, e), s.stiffness = this.stiffness, s.relaxation = this.relaxation, 
                s.needsUpdate = !0, s.enabled = this.enabledEquations, s.offset = this.contactSkinSize, 
                s;
            }, $.prototype.createFrictionEquation = function(t, e, i, n) {
                var s = this.frictionEquationPool.get();
                return s.bodyA = t, s.bodyB = e, s.shapeA = i, s.shapeB = n, s.setSlipForce(this.slipForce), 
                s.frictionCoefficient = this.frictionCoefficient, s.relativeVelocity = this.surfaceVelocity, 
                s.enabled = this.enabledEquations, s.needsUpdate = !0, s.stiffness = this.frictionStiffness, 
                s.relaxation = this.frictionRelaxation, s.contactEquations.length = 0, s;
            }, $.prototype.createFrictionFromContact = function(t) {
                var e = this.createFrictionEquation(t.bodyA, t.bodyB, t.shapeA, t.shapeB);
                return z.copy(e.contactPointA, t.contactPointA), z.copy(e.contactPointB, t.contactPointB), 
                z.rotate90cw(e.t, t.normalA), e.contactEquations.push(t), e;
            }, $.prototype.createFrictionFromAverage = function(t) {
                var e = this.contactEquations[this.contactEquations.length - 1], i = this.createFrictionEquation(e.bodyA, e.bodyB, e.shapeA, e.shapeB), n = e.bodyA;
                e.bodyB;
                z.set(i.contactPointA, 0, 0), z.set(i.contactPointB, 0, 0), z.set(i.t, 0, 0);
                for (var s = 0; s !== t; s++) (e = this.contactEquations[this.contactEquations.length - 1 - s]).bodyA === n ? (z.add(i.t, i.t, e.normalA), 
                z.add(i.contactPointA, i.contactPointA, e.contactPointA), z.add(i.contactPointB, i.contactPointB, e.contactPointB)) : (z.sub(i.t, i.t, e.normalA), 
                z.add(i.contactPointA, i.contactPointA, e.contactPointB), z.add(i.contactPointB, i.contactPointB, e.contactPointA)), 
                i.contactEquations.push(e);
                var o = 1 / t;
                return z.scale(i.contactPointA, i.contactPointA, o), z.scale(i.contactPointB, i.contactPointB, o), 
                z.normalize(i.t, i.t), z.rotate90cw(i.t, i.t), i;
            }, $.prototype[l.LINE | l.CONVEX] = $.prototype.convexLine = function(t, e, i, n, s, o, a, r, h) {
                return !h && 0;
            }, $.prototype[l.LINE | l.BOX] = $.prototype.lineBox = function(t, e, i, n, s, o, a, r, h) {
                return !h && 0;
            };
            var p = new w({
                width: 1,
                height: 1
            }), g = z.create();
            $.prototype[l.CAPSULE | l.CONVEX] = $.prototype[l.CAPSULE | l.BOX] = $.prototype.convexCapsule = function(t, e, i, n, s, o, a, r, h) {
                var l = g;
                z.set(l, o.length / 2, 0), z.rotate(l, l, r), z.add(l, l, a);
                var c = this.circleConvex(s, o, l, r, t, e, i, n, h, o.radius);
                z.set(l, -o.length / 2, 0), z.rotate(l, l, r), z.add(l, l, a);
                var u = this.circleConvex(s, o, l, r, t, e, i, n, h, o.radius);
                if (h && (c || u)) return !0;
                var d = p;
                return b(d, o), this.convexConvex(t, e, i, n, s, d, a, r, h) + c + u;
            }, $.prototype[l.CAPSULE | l.LINE] = $.prototype.lineCapsule = function(t, e, i, n, s, o, a, r, h) {
                return !h && 0;
            };
            var _ = z.create(), S = z.create(), x = new w({
                width: 1,
                height: 1
            });
            $.prototype[l.CAPSULE | l.CAPSULE] = $.prototype.capsuleCapsule = function(t, e, i, n, s, o, a, r, h) {
                for (var l = _, c = S, u = 0, d = 0; d < 2; d++) {
                    z.set(l, (0 === d ? -1 : 1) * e.length / 2, 0), z.rotate(l, l, n), z.add(l, l, i);
                    for (var p = 0; p < 2; p++) {
                        z.set(c, (0 === p ? -1 : 1) * o.length / 2, 0), z.rotate(c, c, r), z.add(c, c, a), 
                        this.enableFrictionReduction && (y = this.enableFriction, this.enableFriction = !1);
                        var g = this.circleCircle(t, e, l, n, s, o, c, r, h, e.radius, o.radius);
                        if (this.enableFrictionReduction && (this.enableFriction = y), h && g) return !0;
                        u += g;
                    }
                }
                this.enableFrictionReduction && (y = this.enableFriction, this.enableFriction = !1);
                var m = x;
                b(m, e);
                var f = this.convexCapsule(t, m, i, n, s, o, a, r, h);
                if (this.enableFrictionReduction && (this.enableFriction = y), h && f) return !0;
                if (u += f, this.enableFrictionReduction) {
                    var y = this.enableFriction;
                    this.enableFriction = !1;
                }
                b(m, o);
                var v = this.convexCapsule(s, m, a, r, t, e, i, n, h);
                return this.enableFrictionReduction && (this.enableFriction = y), !(!h || !v) || (u += v, 
                this.enableFrictionReduction && u && this.enableFriction && this.frictionEquations.push(this.createFrictionFromAverage(u)), 
                u);
            }, $.prototype[l.LINE | l.LINE] = $.prototype.lineLine = function(t, e, i, n, s, o, a, r, h) {
                return !h && 0;
            }, $.prototype[l.PLANE | l.LINE] = $.prototype.planeLine = function(t, e, i, n, s, o, a, r, h) {
                var l = X, c = j, u = Y, d = q, p = K, g = M, m = Z, f = J, y = Q, v = N, b = 0;
                z.set(l, -o.length / 2, 0), z.set(c, o.length / 2, 0), z.rotate(u, l, r), z.rotate(d, c, r), 
                V(u, u, a), V(d, d, a), z.copy(l, u), z.copy(c, d), W(p, c, l), z.normalize(g, p), 
                z.rotate90cw(y, g), z.rotate(f, A, n), v[0] = l, v[1] = c;
                for (var _ = 0; _ < v.length; _++) {
                    var S = v[_];
                    W(m, S, i);
                    var x = H(m, f);
                    if (x < 0) {
                        if (h) return !0;
                        var w = this.createContactEquation(t, s, e, o);
                        b++, z.copy(w.normalA, f), z.normalize(w.normalA, w.normalA), z.scale(m, f, x), 
                        W(w.contactPointA, S, m), W(w.contactPointA, w.contactPointA, t.position), W(w.contactPointB, S, a), 
                        V(w.contactPointB, w.contactPointB, a), W(w.contactPointB, w.contactPointB, s.position), 
                        this.contactEquations.push(w), this.enableFrictionReduction || this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(w));
                    }
                }
                return !h && (this.enableFrictionReduction || b && this.enableFriction && this.frictionEquations.push(this.createFrictionFromAverage(b)), 
                b);
            }, $.prototype[l.PARTICLE | l.CAPSULE] = $.prototype.particleCapsule = function(t, e, i, n, s, o, a, r, h) {
                return this.circleLine(t, e, i, n, s, o, a, r, h, o.radius, 0);
            }, $.prototype[l.CIRCLE | l.LINE] = $.prototype.circleLine = function(t, e, i, n, s, o, a, r, h, l, c) {
                l = l || 0, c = void 0 !== c ? c : e.radius;
                var u = X, d = j, p = Y, g = q, m = K, f = M, y = Z, v = J, b = Q, _ = k, S = D, x = G, w = U, A = F, P = N;
                z.set(v, -o.length / 2, 0), z.set(b, o.length / 2, 0), z.rotate(_, v, r), z.rotate(S, b, r), 
                V(_, _, a), V(S, S, a), z.copy(v, _), z.copy(b, S), W(f, b, v), z.normalize(y, f), 
                z.rotate90cw(m, y), W(x, i, v);
                var C = H(x, m);
                W(g, v, a), W(w, i, a);
                var T = c + l;
                if (Math.abs(C) < T) {
                    z.scale(u, m, C), W(p, i, u), z.scale(d, m, H(m, w)), z.normalize(d, d), z.scale(d, d, l), 
                    V(p, p, d);
                    var E = H(y, p), I = H(y, v), B = H(y, b);
                    if (I < E && E < B) {
                        if (h) return !0;
                        var L = this.createContactEquation(t, s, e, o);
                        return z.scale(L.normalA, u, -1), z.normalize(L.normalA, L.normalA), z.scale(L.contactPointA, L.normalA, c), 
                        V(L.contactPointA, L.contactPointA, i), W(L.contactPointA, L.contactPointA, t.position), 
                        W(L.contactPointB, p, a), V(L.contactPointB, L.contactPointB, a), W(L.contactPointB, L.contactPointB, s.position), 
                        this.contactEquations.push(L), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(L)), 
                        1;
                    }
                }
                P[0] = v, P[1] = b;
                for (var R = 0; R < P.length; R++) {
                    var O = P[R];
                    if (W(x, O, i), z.squaredLength(x) < Math.pow(T, 2)) {
                        if (h) return !0;
                        L = this.createContactEquation(t, s, e, o);
                        return z.copy(L.normalA, x), z.normalize(L.normalA, L.normalA), z.scale(L.contactPointA, L.normalA, c), 
                        V(L.contactPointA, L.contactPointA, i), W(L.contactPointA, L.contactPointA, t.position), 
                        W(L.contactPointB, O, a), z.scale(A, L.normalA, -l), V(L.contactPointB, L.contactPointB, A), 
                        V(L.contactPointB, L.contactPointB, a), W(L.contactPointB, L.contactPointB, s.position), 
                        this.contactEquations.push(L), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(L)), 
                        1;
                    }
                }
                return 0;
            }, $.prototype[l.CIRCLE | l.CAPSULE] = $.prototype.circleCapsule = function(t, e, i, n, s, o, a, r, h) {
                return this.circleLine(t, e, i, n, s, o, a, r, h, o.radius);
            }, $.prototype[l.CIRCLE | l.CONVEX] = $.prototype[l.CIRCLE | l.BOX] = $.prototype.circleConvex = function(t, e, i, n, s, o, a, r, h, l) {
                l = "number" == typeof l ? l : e.radius;
                for (var c = X, u = j, d = Y, p = q, g = K, m = k, f = D, y = U, v = F, b = B, _ = L, S = !1, x = Number.MAX_VALUE, w = o.vertices, A = 0; A !== w.length + 1; A++) {
                    var P = w[A % w.length], C = w[(A + 1) % w.length];
                    if (z.rotate(c, P, r), z.rotate(u, C, r), V(c, c, a), V(u, u, a), W(d, u, c), z.normalize(p, d), 
                    z.rotate90cw(g, p), z.scale(v, g, -e.radius), V(v, v, i), R(v, o, a, r)) {
                        z.sub(b, c, v);
                        var T = Math.abs(z.dot(b, g));
                        T < x && (z.copy(_, v), x = T, z.scale(y, g, T), z.add(y, y, v), S = !0);
                    }
                }
                if (S) {
                    if (h) return !0;
                    var E = this.createContactEquation(t, s, e, o);
                    return z.sub(E.normalA, _, i), z.normalize(E.normalA, E.normalA), z.scale(E.contactPointA, E.normalA, l), 
                    V(E.contactPointA, E.contactPointA, i), W(E.contactPointA, E.contactPointA, t.position), 
                    W(E.contactPointB, y, a), V(E.contactPointB, E.contactPointB, a), W(E.contactPointB, E.contactPointB, s.position), 
                    this.contactEquations.push(E), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(E)), 
                    1;
                }
                if (0 < l) for (A = 0; A < w.length; A++) {
                    var I = w[A];
                    if (z.rotate(f, I, r), V(f, f, a), W(m, f, i), z.squaredLength(m) < Math.pow(l, 2)) {
                        if (h) return !0;
                        E = this.createContactEquation(t, s, e, o);
                        return z.copy(E.normalA, m), z.normalize(E.normalA, E.normalA), z.scale(E.contactPointA, E.normalA, l), 
                        V(E.contactPointA, E.contactPointA, i), W(E.contactPointA, E.contactPointA, t.position), 
                        W(E.contactPointB, f, a), V(E.contactPointB, E.contactPointB, a), W(E.contactPointB, E.contactPointB, s.position), 
                        this.contactEquations.push(E), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(E)), 
                        1;
                    }
                }
                return 0;
            };
            var m = z.create(), f = z.create(), y = z.create(), v = z.create();
            function R(t, e, i, n) {
                for (var s = m, o = f, a = y, r = v, h = t, l = e.vertices, c = null, u = 0; u !== l.length + 1; u++) {
                    var d = l[u % l.length], p = l[(u + 1) % l.length];
                    z.rotate(s, d, n), z.rotate(o, p, n), V(s, s, i), V(o, o, i), W(a, s, h), W(r, o, h);
                    var g = z.crossLength(a, r);
                    if (null === c && (c = g), g * c <= 0) return !1;
                    c = g;
                }
                return !0;
            }
            $.prototype[l.PARTICLE | l.CONVEX] = $.prototype[l.PARTICLE | l.BOX] = $.prototype.particleConvex = function(t, e, i, n, s, o, a, r, h) {
                var l = X, c = j, u = Y, d = q, p = K, g = M, m = Z, f = k, y = U, v = E, b = I, _ = Number.MAX_VALUE, S = !1, x = o.vertices;
                if (!R(i, o, a, r)) return 0;
                if (h) return !0;
                for (var w = 0; w !== x.length + 1; w++) {
                    var A = x[w % x.length], P = x[(w + 1) % x.length];
                    z.rotate(l, A, r), z.rotate(c, P, r), V(l, l, a), V(c, c, a), W(u, c, l), z.normalize(d, u), 
                    z.rotate90cw(p, d), W(f, i, l);
                    H(f, p);
                    W(g, l, a), W(m, i, a), z.sub(v, l, i);
                    var C = Math.abs(z.dot(v, p));
                    C < _ && (_ = C, z.scale(y, p, C), z.add(y, y, i), z.copy(b, p), S = !0);
                }
                if (S) {
                    var T = this.createContactEquation(t, s, e, o);
                    return z.scale(T.normalA, b, -1), z.normalize(T.normalA, T.normalA), z.set(T.contactPointA, 0, 0), 
                    V(T.contactPointA, T.contactPointA, i), W(T.contactPointA, T.contactPointA, t.position), 
                    W(T.contactPointB, y, a), V(T.contactPointB, T.contactPointB, a), W(T.contactPointB, T.contactPointB, s.position), 
                    this.contactEquations.push(T), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(T)), 
                    1;
                }
                return 0;
            }, $.prototype[l.CIRCLE] = $.prototype.circleCircle = function(t, e, i, n, s, o, a, r, h, l, c) {
                var u = X;
                l = l || e.radius, c = c || o.radius;
                W(u, i, a);
                var d = l + c;
                if (z.squaredLength(u) > Math.pow(d, 2)) return 0;
                if (h) return !0;
                var p = this.createContactEquation(t, s, e, o);
                return W(p.normalA, a, i), z.normalize(p.normalA, p.normalA), z.scale(p.contactPointA, p.normalA, l), 
                z.scale(p.contactPointB, p.normalA, -c), V(p.contactPointA, p.contactPointA, i), 
                W(p.contactPointA, p.contactPointA, t.position), V(p.contactPointB, p.contactPointB, a), 
                W(p.contactPointB, p.contactPointB, s.position), this.contactEquations.push(p), 
                this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(p)), 
                1;
            }, $.prototype[l.PLANE | l.CONVEX] = $.prototype[l.PLANE | l.BOX] = $.prototype.planeConvex = function(t, e, i, n, s, o, a, r, h) {
                var l = X, c = j, u = Y, d = 0;
                z.rotate(c, A, n);
                for (var p = 0; p !== o.vertices.length; p++) {
                    var g = o.vertices[p];
                    if (z.rotate(l, g, r), V(l, l, a), W(u, l, i), H(u, c) <= 0) {
                        if (h) return !0;
                        d++;
                        var m = this.createContactEquation(t, s, e, o);
                        W(u, l, i), z.copy(m.normalA, c);
                        var f = H(u, m.normalA);
                        z.scale(u, m.normalA, f), W(m.contactPointB, l, s.position), W(m.contactPointA, l, u), 
                        W(m.contactPointA, m.contactPointA, t.position), this.contactEquations.push(m), 
                        this.enableFrictionReduction || this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(m));
                    }
                }
                return this.enableFrictionReduction && this.enableFriction && d && this.frictionEquations.push(this.createFrictionFromAverage(d)), 
                d;
            }, $.prototype[l.PARTICLE | l.PLANE] = $.prototype.particlePlane = function(t, e, i, n, s, o, a, r, h) {
                var l = X, c = j;
                r = r || 0, W(l, i, a), z.rotate(c, A, r);
                var u = H(l, c);
                if (0 < u) return 0;
                if (h) return !0;
                var d = this.createContactEquation(s, t, o, e);
                return z.copy(d.normalA, c), z.scale(l, d.normalA, u), W(d.contactPointA, i, l), 
                W(d.contactPointA, d.contactPointA, s.position), W(d.contactPointB, i, t.position), 
                this.contactEquations.push(d), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(d)), 
                1;
            }, $.prototype[l.CIRCLE | l.PARTICLE] = $.prototype.circleParticle = function(t, e, i, n, s, o, a, r, h) {
                var l = X;
                if (W(l, a, i), z.squaredLength(l) > Math.pow(e.radius, 2)) return 0;
                if (h) return !0;
                var c = this.createContactEquation(t, s, e, o);
                return z.copy(c.normalA, l), z.normalize(c.normalA, c.normalA), z.scale(c.contactPointA, c.normalA, e.radius), 
                V(c.contactPointA, c.contactPointA, i), W(c.contactPointA, c.contactPointA, t.position), 
                W(c.contactPointB, a, s.position), this.contactEquations.push(c), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(c)), 
                1;
            };
            var P = new r({
                radius: 1
            }), C = z.create(), T = z.create();
            z.create();
            $.prototype[l.PLANE | l.CAPSULE] = $.prototype.planeCapsule = function(t, e, i, n, s, o, a, r, h) {
                var l, c = C, u = T, d = P;
                z.set(c, -o.length / 2, 0), z.rotate(c, c, r), V(c, c, a), z.set(u, o.length / 2, 0), 
                z.rotate(u, u, r), V(u, u, a), d.radius = o.radius, this.enableFrictionReduction && (l = this.enableFriction, 
                this.enableFriction = !1);
                var p = this.circlePlane(s, d, c, 0, t, e, i, n, h), g = this.circlePlane(s, d, u, 0, t, e, i, n, h);
                if (this.enableFrictionReduction && (this.enableFriction = l), h) return p || g;
                var m = p + g;
                return this.enableFrictionReduction && m && this.frictionEquations.push(this.createFrictionFromAverage(m)), 
                m;
            }, $.prototype[l.CIRCLE | l.PLANE] = $.prototype.circlePlane = function(t, e, i, n, s, o, a, r, h) {
                var l = t, c = e, u = i, d = s, p = a, g = r;
                g = g || 0;
                var m = X, f = j, y = Y;
                W(m, u, p), z.rotate(f, A, g);
                var v = H(f, m);
                if (v > c.radius) return 0;
                if (h) return !0;
                var b = this.createContactEquation(d, l, o, e);
                return z.copy(b.normalA, f), z.scale(b.contactPointB, b.normalA, -c.radius), V(b.contactPointB, b.contactPointB, u), 
                W(b.contactPointB, b.contactPointB, l.position), z.scale(y, b.normalA, v), W(b.contactPointA, m, y), 
                V(b.contactPointA, b.contactPointA, p), W(b.contactPointA, b.contactPointA, d.position), 
                this.contactEquations.push(b), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(b)), 
                1;
            }, $.prototype[l.CONVEX] = $.prototype[l.CONVEX | l.BOX] = $.prototype[l.BOX] = $.prototype.convexConvex = function(t, e, i, n, s, o, a, r, h, l) {
                var c = X, u = j, d = Y, p = q, g = K, m = Z, f = J, y = Q, v = 0;
                l = "number" == typeof l ? l : 0;
                if (!$.findSeparatingAxis(e, i, n, o, a, r, c)) return 0;
                W(f, a, i), 0 < H(c, f) && z.scale(c, c, -1);
                var b = $.getClosestEdge(e, n, c, !0), _ = $.getClosestEdge(o, r, c);
                if (-1 === b || -1 === _) return 0;
                for (var S = 0; S < 2; S++) {
                    var x, w = b, A = _, P = e, C = o, T = i, E = a, I = n, B = r, L = t, R = s;
                    if (0 === S) x = w, w = A, A = x, x = P, P = C, C = x, x = T, T = E, E = x, x = I, 
                    I = B, B = x, x = L, L = R, R = x;
                    for (var O = A; O < A + 2; O++) {
                        var M = C.vertices[(O + C.vertices.length) % C.vertices.length];
                        z.rotate(u, M, B), V(u, u, E);
                        for (var k = 0, D = w - 1; D < w + 2; D++) {
                            var G = P.vertices[(D + P.vertices.length) % P.vertices.length], U = P.vertices[(D + 1 + P.vertices.length) % P.vertices.length];
                            z.rotate(d, G, I), z.rotate(p, U, I), V(d, d, T), V(p, p, T), W(g, p, d), z.rotate90cw(y, g), 
                            z.normalize(y, y), W(f, u, d);
                            var F = H(y, f);
                            (D === w && F <= l || D !== w && F <= 0) && k++;
                        }
                        if (3 <= k) {
                            if (h) return !0;
                            var N = this.createContactEquation(L, R, P, C);
                            v++;
                            G = P.vertices[w % P.vertices.length], U = P.vertices[(w + 1) % P.vertices.length];
                            z.rotate(d, G, I), z.rotate(p, U, I), V(d, d, T), V(p, p, T), W(g, p, d), z.rotate90cw(N.normalA, g), 
                            z.normalize(N.normalA, N.normalA), W(f, u, d);
                            F = H(N.normalA, f);
                            z.scale(m, N.normalA, F), W(N.contactPointA, u, T), W(N.contactPointA, N.contactPointA, m), 
                            V(N.contactPointA, N.contactPointA, T), W(N.contactPointA, N.contactPointA, L.position), 
                            W(N.contactPointB, u, E), V(N.contactPointB, N.contactPointB, E), W(N.contactPointB, N.contactPointB, R.position), 
                            this.contactEquations.push(N), this.enableFrictionReduction || this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(N));
                        }
                    }
                }
                return this.enableFrictionReduction && this.enableFriction && v && this.frictionEquations.push(this.createFrictionFromAverage(v)), 
                v;
            };
            var O = z.fromValues(0, 0);
            $.projectConvexOntoAxis = function(t, e, i, n, s) {
                var o, a, r = null, h = null, l = O;
                z.rotate(l, n, -i);
                for (var c = 0; c < t.vertices.length; c++) o = t.vertices[c], a = H(o, l), (null === r || r < a) && (r = a), 
                (null === h || a < h) && (h = a);
                if (r < h) {
                    var u = h;
                    h = r, r = u;
                }
                var d = H(e, n);
                z.set(s, h + d, r + d);
            };
            var tt = z.fromValues(0, 0), et = z.fromValues(0, 0), it = z.fromValues(0, 0), nt = z.fromValues(0, 0), st = z.fromValues(0, 0), ot = z.fromValues(0, 0);
            $.findSeparatingAxis = function(t, e, i, n, s, o, a) {
                var r = null, h = !1, l = !1, c = tt, u = et, d = it, p = nt, g = st, m = ot;
                if (t instanceof w && n instanceof w) for (var f = 0; 2 !== f; f++) {
                    var y = t, v = i;
                    1 === f && (y = n, v = o);
                    for (var b = 0; 2 !== b; b++) {
                        0 === b ? z.set(p, 0, 1) : 1 === b && z.set(p, 1, 0), 0 !== v && z.rotate(p, p, v), 
                        $.projectConvexOntoAxis(t, e, i, p, g), $.projectConvexOntoAxis(n, s, o, p, m);
                        var _ = g, S = m;
                        g[0] > m[0] && (S = g, _ = m, !0), h = (x = S[0] - _[1]) <= 0, (null === r || r < x) && (z.copy(a, p), 
                        r = x, l = h);
                    }
                } else for (f = 0; 2 !== f; f++) {
                    y = t, v = i;
                    1 === f && (y = n, v = o);
                    for (b = 0; b !== y.vertices.length; b++) {
                        z.rotate(u, y.vertices[b], v), z.rotate(d, y.vertices[(b + 1) % y.vertices.length], v), 
                        W(c, d, u), z.rotate90cw(p, c), z.normalize(p, p), $.projectConvexOntoAxis(t, e, i, p, g), 
                        $.projectConvexOntoAxis(n, s, o, p, m);
                        var x;
                        _ = g, S = m;
                        g[0] > m[0] && (S = g, _ = m, !0), h = (x = S[0] - _[1]) <= 0, (null === r || r < x) && (z.copy(a, p), 
                        r = x, l = h);
                    }
                }
                return l;
            };
            var d = z.fromValues(0, 0), at = z.fromValues(0, 0), rt = z.fromValues(0, 0);
            $.getClosestEdge = function(t, e, i, n) {
                var s = d, o = at, a = rt;
                z.rotate(s, i, -e), n && z.scale(s, s, -1);
                for (var r = -1, h = t.vertices.length, l = -1, c = 0; c !== h; c++) {
                    W(o, t.vertices[(c + 1) % h], t.vertices[c % h]), z.rotate90cw(a, o), z.normalize(a, a);
                    var u = H(a, s);
                    (-1 === r || l < u) && (r = c % h, l = u);
                }
                return r;
            };
            var ht = z.create(), lt = z.create(), ct = z.create(), ut = z.create(), dt = z.create(), pt = z.create(), gt = z.create();
            $.prototype[l.CIRCLE | l.HEIGHTFIELD] = $.prototype.circleHeightfield = function(t, e, i, n, s, o, a, r, h, l) {
                var c = o.heights, u = (l = l || e.radius, o.elementWidth), d = lt, p = ht, g = dt, m = gt, f = pt, y = ct, v = ut, b = Math.floor((i[0] - l - a[0]) / u), _ = Math.ceil((i[0] + l - a[0]) / u);
                b < 0 && (b = 0), _ >= c.length && (_ = c.length - 1);
                for (var S = c[b], x = c[_], w = b; w < _; w++) c[w] < x && (x = c[w]), c[w] > S && (S = c[w]);
                if (i[1] - l > S) return !h && 0;
                var A = !1;
                for (w = b; w < _; w++) {
                    z.set(y, w * u, c[w]), z.set(v, (w + 1) * u, c[w + 1]), z.add(y, y, a), z.add(v, v, a), 
                    z.sub(f, v, y), z.rotate(f, f, Math.PI / 2), z.normalize(f, f), z.scale(p, f, -l), 
                    z.add(p, p, i), z.sub(d, p, y);
                    var P = z.dot(d, f);
                    if (p[0] >= y[0] && p[0] < v[0] && P <= 0) {
                        if (h) return !0;
                        A = !0, z.scale(d, f, -P), z.add(g, p, d), z.copy(m, f);
                        var C = this.createContactEquation(s, t, o, e);
                        z.copy(C.normalA, m), z.scale(C.contactPointB, C.normalA, -l), V(C.contactPointB, C.contactPointB, i), 
                        W(C.contactPointB, C.contactPointB, t.position), z.copy(C.contactPointA, g), z.sub(C.contactPointA, C.contactPointA, s.position), 
                        this.contactEquations.push(C), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(C));
                    }
                }
                if (A = !1, 0 < l) for (w = b; w <= _; w++) if (z.set(y, w * u, c[w]), z.add(y, y, a), 
                z.sub(d, i, y), z.squaredLength(d) < Math.pow(l, 2)) {
                    if (h) return !0;
                    A = !0;
                    C = this.createContactEquation(s, t, o, e);
                    z.copy(C.normalA, d), z.normalize(C.normalA, C.normalA), z.scale(C.contactPointB, C.normalA, -l), 
                    V(C.contactPointB, C.contactPointB, i), W(C.contactPointB, C.contactPointB, t.position), 
                    W(C.contactPointA, y, a), V(C.contactPointA, C.contactPointA, a), W(C.contactPointA, C.contactPointA, s.position), 
                    this.contactEquations.push(C), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(C));
                }
                return A ? 1 : 0;
            };
            var mt = z.create(), ft = z.create(), yt = z.create(), vt = new h({
                vertices: [ z.create(), z.create(), z.create(), z.create() ]
            });
            $.prototype[l.BOX | l.HEIGHTFIELD] = $.prototype[l.CONVEX | l.HEIGHTFIELD] = $.prototype.convexHeightfield = function(t, e, i, n, s, o, a, r, h) {
                var l = o.heights, c = o.elementWidth, u = mt, d = ft, p = yt, g = vt, m = Math.floor((t.aabb.lowerBound[0] - a[0]) / c), f = Math.ceil((t.aabb.upperBound[0] - a[0]) / c);
                m < 0 && (m = 0), f >= l.length && (f = l.length - 1);
                for (var y = l[m], v = l[f], b = m; b < f; b++) l[b] < v && (v = l[b]), l[b] > y && (y = l[b]);
                if (t.aabb.lowerBound[1] > y) return !h && 0;
                var _ = 0;
                for (b = m; b < f; b++) {
                    z.set(u, b * c, l[b]), z.set(d, (b + 1) * c, l[b + 1]), z.add(u, u, a), z.add(d, d, a);
                    z.set(p, .5 * (d[0] + u[0]), .5 * (d[1] + u[1] - 100)), z.sub(g.vertices[0], d, p), 
                    z.sub(g.vertices[1], u, p), z.copy(g.vertices[2], g.vertices[1]), z.copy(g.vertices[3], g.vertices[0]), 
                    g.vertices[2][1] -= 100, g.vertices[3][1] -= 100, _ += this.convexConvex(t, e, i, n, s, g, p, 0, h);
                }
                return _;
            };
        }, {
            "../equations/ContactEquation": 21,
            "../equations/Equation": 22,
            "../equations/FrictionEquation": 23,
            "../math/vec2": 30,
            "../objects/Body": 31,
            "../shapes/Box": 37,
            "../shapes/Circle": 39,
            "../shapes/Convex": 40,
            "../shapes/Shape": 45,
            "../utils/ContactEquationPool": 48,
            "../utils/FrictionEquationPool": 49,
            "../utils/TupleDictionary": 56,
            "../utils/Utils": 57
        } ],
        11: [ function(t, e, i) {
            e.exports = a;
            var h = t("../math/vec2");
            t("../collision/RaycastResult"), t("../shapes/Shape"), t("../collision/AABB");
            function a(t) {
                t = t || {}, this.from = t.from ? h.fromValues(t.from[0], t.from[1]) : h.create(), 
                this.to = t.to ? h.fromValues(t.to[0], t.to[1]) : h.create(), this.checkCollisionResponse = void 0 === t.checkCollisionResponse || t.checkCollisionResponse, 
                this.skipBackfaces = !!t.skipBackfaces, this.collisionMask = void 0 !== t.collisionMask ? t.collisionMask : -1, 
                this.collisionGroup = void 0 !== t.collisionGroup ? t.collisionGroup : -1, this.mode = void 0 !== t.mode ? t.mode : a.ANY, 
                this.callback = t.callback || function(t) {}, this.direction = h.create(), this.length = 1, 
                this.update();
            }
            (a.prototype.constructor = a).CLOSEST = 1, a.ANY = 2, a.ALL = 4, a.prototype.update = function() {
                var t = this.direction;
                h.sub(t, this.to, this.from), this.length = h.length(t), h.normalize(t, t);
            }, a.prototype.intersectBodies = function(t, e) {
                for (var i = 0, n = e.length; !t.shouldStop(this) && i < n; i++) {
                    var s = e[i], o = s.getAABB();
                    (0 <= o.overlapsRay(this) || o.containsPoint(this.from)) && this.intersectBody(t, s);
                }
            };
            var l = h.create();
            a.prototype.intersectBody = function(t, e) {
                var i = this.checkCollisionResponse;
                if (!i || e.collisionResponse) for (var n = l, s = 0, o = e.shapes.length; s < o; s++) {
                    var a = e.shapes[s];
                    if ((!i || a.collisionResponse) && (0 != (this.collisionGroup & a.collisionMask) && 0 != (a.collisionGroup & this.collisionMask))) {
                        h.rotate(n, a.position, e.angle), h.add(n, n, e.position);
                        var r = a.angle + e.angle;
                        if (this.intersectShape(t, a, r, n, e), t.shouldStop(this)) break;
                    }
                }
            }, a.prototype.intersectShape = function(t, e, i, n, s) {
                (function(t, e, i) {
                    h.sub(o, i, t);
                    var n = h.dot(o, e);
                    return h.scale(r, e, n), h.add(r, r, t), h.squaredDistance(i, r);
                })(this.from, this.direction, n) > e.boundingRadius * e.boundingRadius || (this._currentBody = s, 
                (this._currentShape = e).raycast(t, this, n, i), this._currentBody = this._currentShape = null);
            }, a.prototype.getAABB = function(t) {
                var e = this.to, i = this.from;
                h.set(t.lowerBound, Math.min(e[0], i[0]), Math.min(e[1], i[1])), h.set(t.upperBound, Math.max(e[0], i[0]), Math.max(e[1], i[1]));
            };
            h.create();
            a.prototype.reportIntersection = function(t, e, i, n) {
                this.from, this.to;
                var s = this._currentShape, o = this._currentBody;
                if (!(this.skipBackfaces && 0 < h.dot(i, this.direction))) switch (this.mode) {
                  case a.ALL:
                    t.set(i, s, o, e, n), this.callback(t);
                    break;

                  case a.CLOSEST:
                    (e < t.fraction || !t.hasHit()) && t.set(i, s, o, e, n);
                    break;

                  case a.ANY:
                    t.set(i, s, o, e, n);
                }
            };
            var o = h.create(), r = h.create();
        }, {
            "../collision/AABB": 7,
            "../collision/RaycastResult": 12,
            "../math/vec2": 30,
            "../shapes/Shape": 45
        } ],
        12: [ function(t, e, i) {
            var o = t("../math/vec2"), n = t("../collision/Ray");
            function s() {
                this.normal = o.create(), this.shape = null, this.body = null, this.faceIndex = -1, 
                this.fraction = -1, this.isStopped = !1;
            }
            (e.exports = s).prototype.reset = function() {
                o.set(this.normal, 0, 0), this.shape = null, this.body = null, this.faceIndex = -1, 
                this.fraction = -1, this.isStopped = !1;
            }, s.prototype.getHitDistance = function(t) {
                return o.distance(t.from, t.to) * this.fraction;
            }, s.prototype.hasHit = function() {
                return -1 !== this.fraction;
            }, s.prototype.getHitPoint = function(t, e) {
                o.lerp(t, e.from, e.to, this.fraction);
            }, s.prototype.stop = function() {
                this.isStopped = !0;
            }, s.prototype.shouldStop = function(t) {
                return this.isStopped || -1 !== this.fraction && t.mode === n.ANY;
            }, s.prototype.set = function(t, e, i, n, s) {
                o.copy(this.normal, t), this.shape = e, this.body = i, this.fraction = n, this.faceIndex = s;
            };
        }, {
            "../collision/Ray": 11,
            "../math/vec2": 30
        } ],
        13: [ function(t, e, i) {
            var n = t("../utils/Utils"), u = t("../collision/Broadphase");
            function s() {
                u.call(this, u.SAP), this.axisList = [], this.axisIndex = 0;
                var i = this;
                this._addBodyHandler = function(t) {
                    i.axisList.push(t.body);
                }, this._removeBodyHandler = function(t) {
                    var e = i.axisList.indexOf(t.body);
                    -1 !== e && i.axisList.splice(e, 1);
                };
            }
            (((e.exports = s).prototype = new u()).constructor = s).prototype.setWorld = function(t) {
                this.axisList.length = 0, n.appendArray(this.axisList, t.bodies), t.off("addBody", this._addBodyHandler).off("removeBody", this._removeBodyHandler), 
                t.on("addBody", this._addBodyHandler).on("removeBody", this._removeBodyHandler), 
                this.world = t;
            }, s.sortAxisList = function(t, e) {
                e |= 0;
                for (var i = 1, n = t.length; i < n; i++) {
                    for (var s = t[i], o = i - 1; 0 <= o && !(t[o].aabb.lowerBound[e] <= s.aabb.lowerBound[e]); o--) t[o + 1] = t[o];
                    t[o + 1] = s;
                }
                return t;
            }, s.prototype.sortList = function() {
                var t = this.axisList, e = this.axisIndex;
                s.sortAxisList(t, e);
            }, s.prototype.getCollisionPairs = function(t) {
                var e = this.axisList, i = this.result, n = this.axisIndex;
                i.length = 0;
                for (var s = e.length; s--; ) {
                    var o = e[s];
                    o.aabbNeedsUpdate && o.updateAABB();
                }
                this.sortList();
                for (var a = 0, r = 0 | e.length; a !== r; a++) for (var h = e[a], l = a + 1; l < r; l++) {
                    var c = e[l];
                    if (!(c.aabb.lowerBound[n] <= h.aabb.upperBound[n])) break;
                    u.canCollide(h, c) && this.boundingVolumeCheck(h, c) && i.push(h, c);
                }
                return i;
            }, s.prototype.aabbQuery = function(t, e, i) {
                i = i || [], this.sortList();
                var n = this.axisIndex, s = "x";
                1 === n && (s = "y"), 2 === n && (s = "z");
                for (var o = this.axisList, a = (e.lowerBound[s], e.upperBound[s], 0); a < o.length; a++) {
                    var r = o[a];
                    r.aabbNeedsUpdate && r.updateAABB(), r.aabb.overlaps(e) && i.push(r);
                }
                return i;
            };
        }, {
            "../collision/Broadphase": 8,
            "../utils/Utils": 57
        } ],
        14: [ function(t, e, i) {
            e.exports = n;
            var s = t("../utils/Utils");
            function n(t, e, i, n) {
                this.type = i, n = s.defaults(n, {
                    collideConnected: !0,
                    wakeUpBodies: !0
                }), this.equations = [], this.bodyA = t, this.bodyB = e, this.collideConnected = n.collideConnected, 
                n.wakeUpBodies && (t && t.wakeUp(), e && e.wakeUp());
            }
            n.prototype.update = function() {
                throw new Error("method update() not implmemented in this Constraint subclass!");
            }, n.DISTANCE = 1, n.GEAR = 2, n.LOCK = 3, n.PRISMATIC = 4, n.REVOLUTE = 5, n.prototype.setStiffness = function(t) {
                for (var e = this.equations, i = 0; i !== e.length; i++) {
                    var n = e[i];
                    n.stiffness = t, n.needsUpdate = !0;
                }
            }, n.prototype.setRelaxation = function(t) {
                for (var e = this.equations, i = 0; i !== e.length; i++) {
                    var n = e[i];
                    n.relaxation = t, n.needsUpdate = !0;
                }
            };
        }, {
            "../utils/Utils": 57
        } ],
        15: [ function(t, e, i) {
            var p = t("./Constraint"), g = t("../equations/Equation"), m = t("../math/vec2"), f = t("../utils/Utils");
            function n(t, e, i) {
                i = f.defaults(i, {
                    localAnchorA: [ 0, 0 ],
                    localAnchorB: [ 0, 0 ]
                }), p.call(this, t, e, p.DISTANCE, i), this.localAnchorA = m.fromValues(i.localAnchorA[0], i.localAnchorA[1]), 
                this.localAnchorB = m.fromValues(i.localAnchorB[0], i.localAnchorB[1]);
                var n, s = this.localAnchorA, o = this.localAnchorB;
                if (this.distance = 0, "number" == typeof i.distance) this.distance = i.distance; else {
                    var a = m.create(), r = m.create(), h = m.create();
                    m.rotate(a, s, t.angle), m.rotate(r, o, e.angle), m.add(h, e.position, r), m.sub(h, h, a), 
                    m.sub(h, h, t.position), this.distance = m.length(h);
                }
                n = void 0 === i.maxForce ? Number.MAX_VALUE : i.maxForce;
                var l = new g(t, e, -n, n);
                this.equations = [ l ], this.maxForce = n;
                h = m.create();
                var c = m.create(), u = m.create(), d = this;
                l.computeGq = function() {
                    var t = this.bodyA, e = this.bodyB, i = t.position, n = e.position;
                    return m.rotate(c, s, t.angle), m.rotate(u, o, e.angle), m.add(h, n, u), m.sub(h, h, c), 
                    m.sub(h, h, i), m.length(h) - d.distance;
                }, this.setMaxForce(n), this.upperLimitEnabled = !1, this.upperLimit = 1, this.lowerLimitEnabled = !1, 
                this.lowerLimit = 0, this.position = 0;
            }
            ((e.exports = n).prototype = new p()).constructor = n;
            var c = m.create(), u = m.create(), d = m.create();
            n.prototype.update = function() {
                var t = this.equations[0], e = this.bodyA, i = this.bodyB, n = (this.distance, e.position), s = i.position, o = this.equations[0], a = t.G;
                m.rotate(u, this.localAnchorA, e.angle), m.rotate(d, this.localAnchorB, i.angle), 
                m.add(c, s, d), m.sub(c, c, u), m.sub(c, c, n), this.position = m.length(c);
                var r = !1;
                if (this.upperLimitEnabled && this.position > this.upperLimit && (o.maxForce = 0, 
                o.minForce = -this.maxForce, this.distance = this.upperLimit, r = !0), this.lowerLimitEnabled && this.position < this.lowerLimit && (o.maxForce = this.maxForce, 
                o.minForce = 0, this.distance = this.lowerLimit, r = !0), !this.lowerLimitEnabled && !this.upperLimitEnabled || r) {
                    o.enabled = !0, m.normalize(c, c);
                    var h = m.crossLength(u, c), l = m.crossLength(d, c);
                    a[0] = -c[0], a[1] = -c[1], a[2] = -h, a[3] = c[0], a[4] = c[1], a[5] = l;
                } else o.enabled = !1;
            }, n.prototype.setMaxForce = function(t) {
                var e = this.equations[0];
                e.minForce = -t, e.maxForce = t;
            }, n.prototype.getMaxForce = function() {
                return this.equations[0].maxForce;
            };
        }, {
            "../equations/Equation": 22,
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Constraint": 14
        } ],
        16: [ function(t, e, i) {
            var n = t("./Constraint"), s = (t("../equations/Equation"), t("../equations/AngleLockEquation"));
            t("../math/vec2");
            function o(t, e, i) {
                i = i || {}, n.call(this, t, e, n.GEAR, i), this.ratio = void 0 !== i.ratio ? i.ratio : 1, 
                this.angle = void 0 !== i.angle ? i.angle : e.angle - this.ratio * t.angle, i.angle = this.angle, 
                i.ratio = this.ratio, this.equations = [ new s(t, e, i) ], void 0 !== i.maxTorque && this.setMaxTorque(i.maxTorque);
            }
            (((e.exports = o).prototype = new n()).constructor = o).prototype.update = function() {
                var t = this.equations[0];
                t.ratio !== this.ratio && t.setRatio(this.ratio), t.angle = this.angle;
            }, o.prototype.setMaxTorque = function(t) {
                this.equations[0].setMaxTorque(t);
            }, o.prototype.getMaxTorque = function(t) {
                return this.equations[0].maxForce;
            };
        }, {
            "../equations/AngleLockEquation": 20,
            "../equations/Equation": 22,
            "../math/vec2": 30,
            "./Constraint": 14
        } ],
        17: [ function(t, e, i) {
            var d = t("./Constraint"), p = t("../math/vec2"), g = t("../equations/Equation");
            function n(t, e, i) {
                i = i || {}, d.call(this, t, e, d.LOCK, i);
                var n = void 0 === i.maxForce ? Number.MAX_VALUE : i.maxForce, s = (i.localAngleB, 
                new g(t, e, -n, n)), o = new g(t, e, -n, n), a = new g(t, e, -n, n), r = p.create(), h = p.create(), l = this;
                s.computeGq = function() {
                    return p.rotate(r, l.localOffsetB, t.angle), p.sub(h, e.position, t.position), p.sub(h, h, r), 
                    h[0];
                }, o.computeGq = function() {
                    return p.rotate(r, l.localOffsetB, t.angle), p.sub(h, e.position, t.position), p.sub(h, h, r), 
                    h[1];
                };
                var c = p.create(), u = p.create();
                a.computeGq = function() {
                    return p.rotate(c, l.localOffsetB, e.angle - l.localAngleB), p.scale(c, c, -1), 
                    p.sub(h, t.position, e.position), p.add(h, h, c), p.rotate(u, c, -Math.PI / 2), 
                    p.normalize(u, u), p.dot(h, u);
                }, this.localOffsetB = p.create(), i.localOffsetB ? p.copy(this.localOffsetB, i.localOffsetB) : (p.sub(this.localOffsetB, e.position, t.position), 
                p.rotate(this.localOffsetB, this.localOffsetB, -t.angle)), this.localAngleB = 0, 
                "number" == typeof i.localAngleB ? this.localAngleB = i.localAngleB : this.localAngleB = e.angle - t.angle, 
                this.equations.push(s, o, a), this.setMaxForce(n);
            }
            (((e.exports = n).prototype = new d()).constructor = n).prototype.setMaxForce = function(t) {
                for (var e = this.equations, i = 0; i < this.equations.length; i++) e[i].maxForce = t, 
                e[i].minForce = -t;
            }, n.prototype.getMaxForce = function() {
                return this.equations[0].maxForce;
            };
            var o = p.create(), a = p.create(), r = p.create(), h = p.fromValues(1, 0), l = p.fromValues(0, 1);
            n.prototype.update = function() {
                var t = this.equations[0], e = this.equations[1], i = this.equations[2], n = this.bodyA, s = this.bodyB;
                p.rotate(o, this.localOffsetB, n.angle), p.rotate(a, this.localOffsetB, s.angle - this.localAngleB), 
                p.scale(a, a, -1), p.rotate(r, a, Math.PI / 2), p.normalize(r, r), t.G[0] = -1, 
                t.G[1] = 0, t.G[2] = -p.crossLength(o, h), t.G[3] = 1, e.G[0] = 0, e.G[1] = -1, 
                e.G[2] = -p.crossLength(o, l), e.G[4] = 1, i.G[0] = -r[0], i.G[1] = -r[1], i.G[3] = r[0], 
                i.G[4] = r[1], i.G[5] = p.crossLength(a, r);
            };
        }, {
            "../equations/Equation": 22,
            "../math/vec2": 30,
            "./Constraint": 14
        } ],
        18: [ function(t, e, i) {
            var m = t("./Constraint"), f = t("../equations/ContactEquation"), y = t("../equations/Equation"), v = t("../math/vec2"), b = t("../equations/RotationalLockEquation");
            function n(n, s, t) {
                t = t || {}, m.call(this, n, s, m.PRISMATIC, t);
                var o = v.fromValues(0, 0), a = v.fromValues(1, 0), r = v.fromValues(0, 0);
                t.localAnchorA && v.copy(o, t.localAnchorA), t.localAxisA && v.copy(a, t.localAxisA), 
                t.localAnchorB && v.copy(r, t.localAnchorB), this.localAnchorA = o, this.localAnchorB = r, 
                this.localAxisA = a;
                var e = this.maxForce = void 0 !== t.maxForce ? t.maxForce : Number.MAX_VALUE, i = new y(n, s, -e, e), h = new v.create(), l = new v.create(), c = new v.create(), u = new v.create();
                if (i.computeGq = function() {
                    return v.dot(c, u);
                }, i.updateJacobian = function() {
                    var t = this.G, e = n.position, i = s.position;
                    v.rotate(h, o, n.angle), v.rotate(l, r, s.angle), v.add(c, i, l), v.sub(c, c, e), 
                    v.sub(c, c, h), v.rotate(u, a, n.angle + Math.PI / 2), t[0] = -u[0], t[1] = -u[1], 
                    t[2] = -v.crossLength(h, u) + v.crossLength(u, c), t[3] = u[0], t[4] = u[1], t[5] = v.crossLength(l, u);
                }, this.equations.push(i), !t.disableRotationalLock) {
                    var d = new b(n, s, -e, e);
                    this.equations.push(d);
                }
                this.position = 0, this.velocity = 0, this.lowerLimitEnabled = void 0 !== t.lowerLimit, 
                this.upperLimitEnabled = void 0 !== t.upperLimit, this.lowerLimit = void 0 !== t.lowerLimit ? t.lowerLimit : 0, 
                this.upperLimit = void 0 !== t.upperLimit ? t.upperLimit : 1, this.upperLimitEquation = new f(n, s), 
                this.lowerLimitEquation = new f(n, s), this.upperLimitEquation.minForce = this.lowerLimitEquation.minForce = 0, 
                this.upperLimitEquation.maxForce = this.lowerLimitEquation.maxForce = e, this.motorEquation = new y(n, s), 
                this.motorEnabled = !1, this.motorSpeed = 0;
                var p = this, g = this.motorEquation;
                g.computeGW;
                g.computeGq = function() {
                    return 0;
                }, g.computeGW = function() {
                    var t = this.G, e = this.bodyA, i = this.bodyB, n = e.velocity, s = i.velocity, o = e.angularVelocity, a = i.angularVelocity;
                    return this.gmult(t, n, o, s, a) + p.motorSpeed;
                };
            }
            ((e.exports = n).prototype = new m()).constructor = n;
            var g = v.create(), _ = v.create(), S = v.create(), x = v.create(), w = v.create(), A = v.create();
            n.prototype.update = function() {
                var t = this.equations, e = t[0], i = this.upperLimit, n = this.lowerLimit, s = this.upperLimitEquation, o = this.lowerLimitEquation, a = this.bodyA, r = this.bodyB, h = this.localAxisA, l = this.localAnchorA, c = this.localAnchorB;
                e.updateJacobian(), v.rotate(g, h, a.angle), v.rotate(x, l, a.angle), v.add(_, x, a.position), 
                v.rotate(w, c, r.angle), v.add(S, w, r.position);
                var u, d = this.position = v.dot(S, g) - v.dot(_, g);
                if (this.motorEnabled) {
                    var p = this.motorEquation.G;
                    p[0] = g[0], p[1] = g[1], p[2] = v.crossLength(g, w), p[3] = -g[0], p[4] = -g[1], 
                    p[5] = -v.crossLength(g, x);
                }
                this.upperLimitEnabled && i < d ? (v.scale(s.normalA, g, -1), v.sub(s.contactPointA, _, a.position), 
                v.sub(s.contactPointB, S, r.position), v.scale(A, g, i), v.add(s.contactPointA, s.contactPointA, A), 
                -1 === t.indexOf(s) && t.push(s)) : -1 !== (u = t.indexOf(s)) && t.splice(u, 1);
                this.lowerLimitEnabled && d < n ? (v.scale(o.normalA, g, 1), v.sub(o.contactPointA, _, a.position), 
                v.sub(o.contactPointB, S, r.position), v.scale(A, g, n), v.sub(o.contactPointB, o.contactPointB, A), 
                -1 === t.indexOf(o) && t.push(o)) : -1 !== (u = t.indexOf(o)) && t.splice(u, 1);
            }, n.prototype.enableMotor = function() {
                this.motorEnabled || (this.equations.push(this.motorEquation), this.motorEnabled = !0);
            }, n.prototype.disableMotor = function() {
                if (this.motorEnabled) {
                    var t = this.equations.indexOf(this.motorEquation);
                    this.equations.splice(t, 1), this.motorEnabled = !1;
                }
            }, n.prototype.setLimits = function(t, e) {
                "number" == typeof t ? (this.lowerLimit = t, this.lowerLimitEnabled = !0) : (this.lowerLimit = t, 
                this.lowerLimitEnabled = !1), "number" == typeof e ? (this.upperLimit = e, this.upperLimitEnabled = !0) : (this.upperLimit = e, 
                this.upperLimitEnabled = !1);
            };
        }, {
            "../equations/ContactEquation": 21,
            "../equations/Equation": 22,
            "../equations/RotationalLockEquation": 24,
            "../math/vec2": 30,
            "./Constraint": 14
        } ],
        19: [ function(t, e, i) {
            var h = t("./Constraint"), l = t("../equations/Equation"), c = t("../equations/RotationalVelocityEquation"), u = t("../equations/RotationalLockEquation"), p = t("../math/vec2");
            e.exports = n;
            var g = p.create(), m = p.create(), f = p.fromValues(1, 0), y = p.fromValues(0, 1), d = p.create();
            function n(t, e, i) {
                i = i || {}, h.call(this, t, e, h.REVOLUTE, i);
                var n = this.maxForce = void 0 !== i.maxForce ? i.maxForce : Number.MAX_VALUE;
                this.pivotA = p.create(), this.pivotB = p.create(), i.worldPivot ? (p.sub(this.pivotA, i.worldPivot, t.position), 
                p.sub(this.pivotB, i.worldPivot, e.position), p.rotate(this.pivotA, this.pivotA, -t.angle), 
                p.rotate(this.pivotB, this.pivotB, -e.angle)) : (p.copy(this.pivotA, i.localPivotA), 
                p.copy(this.pivotB, i.localPivotB));
                var s = this.equations = [ new l(t, e, -n, n), new l(t, e, -n, n) ], o = s[0], a = s[1], r = this;
                o.computeGq = function() {
                    return p.rotate(g, r.pivotA, t.angle), p.rotate(m, r.pivotB, e.angle), p.add(d, e.position, m), 
                    p.sub(d, d, t.position), p.sub(d, d, g), p.dot(d, f);
                }, a.computeGq = function() {
                    return p.rotate(g, r.pivotA, t.angle), p.rotate(m, r.pivotB, e.angle), p.add(d, e.position, m), 
                    p.sub(d, d, t.position), p.sub(d, d, g), p.dot(d, y);
                }, a.minForce = o.minForce = -n, a.maxForce = o.maxForce = n, this.motorEquation = new c(t, e), 
                this.motorEnabled = !1, this.angle = 0, this.lowerLimitEnabled = !1, this.upperLimitEnabled = !1, 
                this.lowerLimit = 0, this.upperLimit = 0, this.upperLimitEquation = new u(t, e), 
                this.lowerLimitEquation = new u(t, e), this.upperLimitEquation.minForce = 0, this.lowerLimitEquation.maxForce = 0;
            }
            ((n.prototype = new h()).constructor = n).prototype.setLimits = function(t, e) {
                "number" == typeof t ? (this.lowerLimit = t, this.lowerLimitEnabled = !0) : (this.lowerLimit = t, 
                this.lowerLimitEnabled = !1), "number" == typeof e ? (this.upperLimit = e, this.upperLimitEnabled = !0) : (this.upperLimit = e, 
                this.upperLimitEnabled = !1);
            }, n.prototype.update = function() {
                var t, e = this.bodyA, i = this.bodyB, n = this.pivotA, s = this.pivotB, o = this.equations, a = (o[0], 
                o[1], o[0]), r = o[1], h = this.upperLimit, l = this.lowerLimit, c = this.upperLimitEquation, u = this.lowerLimitEquation, d = this.angle = i.angle - e.angle;
                this.upperLimitEnabled && h < d ? (c.angle = h, -1 === o.indexOf(c) && o.push(c)) : -1 !== (t = o.indexOf(c)) && o.splice(t, 1);
                this.lowerLimitEnabled && d < l ? (u.angle = l, -1 === o.indexOf(u) && o.push(u)) : -1 !== (t = o.indexOf(u)) && o.splice(t, 1);
                p.rotate(g, n, e.angle), p.rotate(m, s, i.angle), a.G[0] = -1, a.G[1] = 0, a.G[2] = -p.crossLength(g, f), 
                a.G[3] = 1, a.G[4] = 0, a.G[5] = p.crossLength(m, f), r.G[0] = 0, r.G[1] = -1, r.G[2] = -p.crossLength(g, y), 
                r.G[3] = 0, r.G[4] = 1, r.G[5] = p.crossLength(m, y);
            }, n.prototype.enableMotor = function() {
                this.motorEnabled || (this.equations.push(this.motorEquation), this.motorEnabled = !0);
            }, n.prototype.disableMotor = function() {
                if (this.motorEnabled) {
                    var t = this.equations.indexOf(this.motorEquation);
                    this.equations.splice(t, 1), this.motorEnabled = !1;
                }
            }, n.prototype.setMotorSpeed = function(t) {
                if (this.motorEnabled) {
                    var e = this.equations.indexOf(this.motorEquation);
                    this.equations[e].relativeVelocity = t;
                }
            }, n.prototype.getMotorSpeed = function() {
                return !!this.motorEnabled && this.motorEquation.relativeVelocity;
            };
        }, {
            "../equations/Equation": 22,
            "../equations/RotationalLockEquation": 24,
            "../equations/RotationalVelocityEquation": 25,
            "../math/vec2": 30,
            "./Constraint": 14
        } ],
        20: [ function(t, e, i) {
            var n = t("./Equation");
            t("../math/vec2");
            function s(t, e, i) {
                i = i || {}, n.call(this, t, e, -Number.MAX_VALUE, Number.MAX_VALUE), this.angle = i.angle || 0, 
                this.ratio = "number" == typeof i.ratio ? i.ratio : 1, this.setRatio(this.ratio);
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.computeGq = function() {
                return this.ratio * this.bodyA.angle - this.bodyB.angle + this.angle;
            }, s.prototype.setRatio = function(t) {
                var e = this.G;
                e[2] = t, e[5] = -1, this.ratio = t;
            }, s.prototype.setMaxTorque = function(t) {
                this.maxForce = t, this.minForce = -t;
            };
        }, {
            "../math/vec2": 30,
            "./Equation": 22
        } ],
        21: [ function(t, e, i) {
            var n = t("./Equation"), f = t("../math/vec2");
            function s(t, e) {
                n.call(this, t, e, 0, Number.MAX_VALUE), this.contactPointA = f.create(), this.penetrationVec = f.create(), 
                this.contactPointB = f.create(), this.normalA = f.create(), this.restitution = 0, 
                this.firstImpact = !1, this.shapeA = null, this.shapeB = null;
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.computeB = function(t, e, i) {
                var n, s, o = this.bodyA, a = this.bodyB, r = this.contactPointA, h = this.contactPointB, l = o.position, c = a.position, u = this.penetrationVec, d = this.normalA, p = this.G, g = f.crossLength(r, d), m = f.crossLength(h, d);
                return p[0] = -d[0], p[1] = -d[1], p[2] = -g, p[3] = d[0], p[4] = d[1], p[5] = m, 
                f.add(u, c, h), f.sub(u, u, l), f.sub(u, u, r), this.firstImpact && 0 !== this.restitution ? (s = 0, 
                n = 1 / e * (1 + this.restitution) * this.computeGW()) : (s = f.dot(d, u) + this.offset, 
                n = this.computeGW()), -s * t - n * e - i * this.computeGiMf();
            };
            var o = f.create(), a = f.create(), r = f.create();
            s.prototype.getVelocityAlongNormal = function() {
                return this.bodyA.getVelocityAtPoint(o, this.contactPointA), this.bodyB.getVelocityAtPoint(a, this.contactPointB), 
                f.subtract(r, o, a), f.dot(this.normalA, r);
            };
        }, {
            "../math/vec2": 30,
            "./Equation": 22
        } ],
        22: [ function(t, e, i) {
            e.exports = a;
            var u = t("../math/vec2"), o = t("../utils/Utils");
            t("../objects/Body");
            function a(t, e, i, n) {
                this.minForce = void 0 === i ? -Number.MAX_VALUE : i, this.maxForce = void 0 === n ? Number.MAX_VALUE : n, 
                this.bodyA = t, this.bodyB = e, this.stiffness = a.DEFAULT_STIFFNESS, this.relaxation = a.DEFAULT_RELAXATION, 
                this.G = new o.ARRAY_TYPE(6);
                for (var s = 0; s < 6; s++) this.G[s] = 0;
                this.offset = 0, this.a = 0, this.b = 0, this.epsilon = 0, this.timeStep = 1 / 60, 
                this.needsUpdate = !0, this.multiplier = 0, this.relativeVelocity = 0, this.enabled = !0;
            }
            (a.prototype.constructor = a).DEFAULT_STIFFNESS = 1e6, a.DEFAULT_RELAXATION = 4, 
            a.prototype.update = function() {
                var t = this.stiffness, e = this.relaxation, i = this.timeStep;
                this.a = 4 / (i * (1 + 4 * e)), this.b = 4 * e / (1 + 4 * e), this.epsilon = 4 / (i * i * t * (1 + 4 * e)), 
                this.needsUpdate = !1;
            }, a.prototype.gmult = function(t, e, i, n, s) {
                return t[0] * e[0] + t[1] * e[1] + t[2] * i + t[3] * n[0] + t[4] * n[1] + t[5] * s;
            }, a.prototype.computeB = function(t, e, i) {
                var n = this.computeGW();
                return -this.computeGq() * t - n * e - this.computeGiMf() * i;
            };
            var r = u.create(), h = u.create();
            a.prototype.computeGq = function() {
                var t = this.G, e = this.bodyA, i = this.bodyB, n = (e.position, i.position, e.angle), s = i.angle;
                return this.gmult(t, r, n, h, s) + this.offset;
            }, a.prototype.computeGW = function() {
                var t = this.G, e = this.bodyA, i = this.bodyB, n = e.velocity, s = i.velocity, o = e.angularVelocity, a = i.angularVelocity;
                return this.gmult(t, n, o, s, a) + this.relativeVelocity;
            }, a.prototype.computeGWlambda = function() {
                var t = this.G, e = this.bodyA, i = this.bodyB, n = e.vlambda, s = i.vlambda, o = e.wlambda, a = i.wlambda;
                return this.gmult(t, n, o, s, a);
            };
            var d = u.create(), p = u.create();
            a.prototype.computeGiMf = function() {
                var t = this.bodyA, e = this.bodyB, i = t.force, n = t.angularForce, s = e.force, o = e.angularForce, a = t.invMassSolve, r = e.invMassSolve, h = t.invInertiaSolve, l = e.invInertiaSolve, c = this.G;
                return u.scale(d, i, a), u.multiply(d, t.massMultiplier, d), u.scale(p, s, r), u.multiply(p, e.massMultiplier, p), 
                this.gmult(c, d, n * h, p, o * l);
            }, a.prototype.computeGiMGt = function() {
                var t = this.bodyA, e = this.bodyB, i = t.invMassSolve, n = e.invMassSolve, s = t.invInertiaSolve, o = e.invInertiaSolve, a = this.G;
                return a[0] * a[0] * i * t.massMultiplier[0] + a[1] * a[1] * i * t.massMultiplier[1] + a[2] * a[2] * s + a[3] * a[3] * n * e.massMultiplier[0] + a[4] * a[4] * n * e.massMultiplier[1] + a[5] * a[5] * o;
            };
            var g = u.create(), m = u.create(), f = u.create();
            u.create(), u.create(), u.create();
            a.prototype.addToWlambda = function(t) {
                var e = this.bodyA, i = this.bodyB, n = g, s = m, o = f, a = e.invMassSolve, r = i.invMassSolve, h = e.invInertiaSolve, l = i.invInertiaSolve, c = this.G;
                s[0] = c[0], s[1] = c[1], o[0] = c[3], o[1] = c[4], u.scale(n, s, a * t), u.multiply(n, n, e.massMultiplier), 
                u.add(e.vlambda, e.vlambda, n), e.wlambda += h * c[2] * t, u.scale(n, o, r * t), 
                u.multiply(n, n, i.massMultiplier), u.add(i.vlambda, i.vlambda, n), i.wlambda += l * c[5] * t;
            }, a.prototype.computeInvC = function(t) {
                return 1 / (this.computeGiMGt() + t);
            };
        }, {
            "../math/vec2": 30,
            "../objects/Body": 31,
            "../utils/Utils": 57
        } ],
        23: [ function(t, e, i) {
            var r = t("../math/vec2"), n = t("./Equation");
            t("../utils/Utils");
            function s(t, e, i) {
                n.call(this, t, e, -i, i), this.contactPointA = r.create(), this.contactPointB = r.create(), 
                this.t = r.create(), this.contactEquations = [], this.shapeA = null, this.shapeB = null, 
                this.frictionCoefficient = .3;
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.setSlipForce = function(t) {
                this.maxForce = t, this.minForce = -t;
            }, s.prototype.getSlipForce = function() {
                return this.maxForce;
            }, s.prototype.computeB = function(t, e, i) {
                this.bodyA, this.bodyB;
                var n = this.contactPointA, s = this.contactPointB, o = this.t, a = this.G;
                return a[0] = -o[0], a[1] = -o[1], a[2] = -r.crossLength(n, o), a[3] = o[0], a[4] = o[1], 
                a[5] = r.crossLength(s, o), -this.computeGW() * e - i * this.computeGiMf();
            };
        }, {
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Equation": 22
        } ],
        24: [ function(t, e, i) {
            var s = t("./Equation"), n = t("../math/vec2");
            function o(t, e, i) {
                i = i || {}, s.call(this, t, e, -Number.MAX_VALUE, Number.MAX_VALUE), this.angle = i.angle || 0;
                var n = this.G;
                n[2] = 1, n[5] = -1;
            }
            ((e.exports = o).prototype = new s()).constructor = o;
            var a = n.create(), r = n.create(), h = n.fromValues(1, 0), l = n.fromValues(0, 1);
            o.prototype.computeGq = function() {
                return n.rotate(a, h, this.bodyA.angle + this.angle), n.rotate(r, l, this.bodyB.angle), 
                n.dot(a, r);
            };
        }, {
            "../math/vec2": 30,
            "./Equation": 22
        } ],
        25: [ function(t, e, i) {
            var n = t("./Equation");
            t("../math/vec2");
            function s(t, e) {
                n.call(this, t, e, -Number.MAX_VALUE, Number.MAX_VALUE), this.relativeVelocity = 1, 
                this.ratio = 1;
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.computeB = function(t, e, i) {
                var n = this.G;
                n[2] = -1, n[5] = this.ratio;
                var s = this.computeGiMf();
                return -this.computeGW() * e - i * s;
            };
        }, {
            "../math/vec2": 30,
            "./Equation": 22
        } ],
        26: [ function(t, e, i) {
            var n = function() {};
            (e.exports = n).prototype = {
                constructor: n,
                on: function(t, e, i) {
                    e.context = i || this, void 0 === this._listeners && (this._listeners = {});
                    var n = this._listeners;
                    return void 0 === n[t] && (n[t] = []), -1 === n[t].indexOf(e) && n[t].push(e), this;
                },
                has: function(t, e) {
                    if (void 0 === this._listeners) return !1;
                    var i = this._listeners;
                    if (e) {
                        if (void 0 !== i[t] && -1 !== i[t].indexOf(e)) return !0;
                    } else if (void 0 !== i[t]) return !0;
                    return !1;
                },
                off: function(t, e) {
                    if (void 0 === this._listeners) return this;
                    var i = this._listeners, n = i[t].indexOf(e);
                    return -1 !== n && i[t].splice(n, 1), this;
                },
                emit: function(t) {
                    if (void 0 === this._listeners) return this;
                    var e = this._listeners[t.type];
                    if (void 0 !== e) {
                        t.target = this;
                        for (var i = 0, n = e.length; i < n; i++) {
                            var s = e[i];
                            s.call(s.context, t);
                        }
                    }
                    return this;
                }
            };
        }, {} ],
        27: [ function(t, e, i) {
            var n = t("./Material"), s = t("../equations/Equation");
            function o(t, e, i) {
                if (i = i || {}, !(t instanceof n && e instanceof n)) throw new Error("First two arguments must be Material instances.");
                this.id = o.idCounter++, this.materialA = t, this.materialB = e, this.friction = void 0 !== i.friction ? Number(i.friction) : .3, 
                this.restitution = void 0 !== i.restitution ? Number(i.restitution) : 0, this.stiffness = void 0 !== i.stiffness ? Number(i.stiffness) : s.DEFAULT_STIFFNESS, 
                this.relaxation = void 0 !== i.relaxation ? Number(i.relaxation) : s.DEFAULT_RELAXATION, 
                this.frictionStiffness = void 0 !== i.frictionStiffness ? Number(i.frictionStiffness) : s.DEFAULT_STIFFNESS, 
                this.frictionRelaxation = void 0 !== i.frictionRelaxation ? Number(i.frictionRelaxation) : s.DEFAULT_RELAXATION, 
                this.surfaceVelocity = void 0 !== i.surfaceVelocity ? Number(i.surfaceVelocity) : 0, 
                this.contactSkinSize = .005;
            }
            (e.exports = o).idCounter = 0;
        }, {
            "../equations/Equation": 22,
            "./Material": 28
        } ],
        28: [ function(t, e, i) {
            function n(t) {
                this.id = t || n.idCounter++;
            }
            (e.exports = n).idCounter = 0;
        }, {} ],
        29: [ function(t, e, i) {
            var v = {
                GetArea: function(t) {
                    if (t.length < 6) return 0;
                    for (var e = t.length - 2, i = 0, n = 0; n < e; n += 2) i += (t[n + 2] - t[n]) * (t[n + 1] + t[n + 3]);
                    return .5 * -(i += (t[0] - t[e]) * (t[e + 1] + t[1]));
                },
                Triangulate: function(t) {
                    var e = t.length >> 1;
                    if (e < 3) return [];
                    for (var i = [], n = [], s = 0; s < e; s++) n.push(s);
                    s = 0;
                    for (var o = e; 3 < o; ) {
                        var a = n[(s + 0) % o], r = n[(s + 1) % o], h = n[(s + 2) % o], l = t[2 * a], c = t[2 * a + 1], u = t[2 * r], d = t[2 * r + 1], p = t[2 * h], g = t[2 * h + 1], m = !1;
                        if (v._convex(l, c, u, d, p, g)) {
                            m = !0;
                            for (var f = 0; f < o; f++) {
                                var y = n[f];
                                if (y != a && y != r && y != h && v._PointInTriangle(t[2 * y], t[2 * y + 1], l, c, u, d, p, g)) {
                                    m = !1;
                                    break;
                                }
                            }
                        }
                        if (m) i.push(a, r, h), n.splice((s + 1) % o, 1), o--, s = 0; else if (s++ > 3 * o) break;
                    }
                    return i.push(n[0], n[1], n[2]), i;
                },
                _PointInTriangle: function(t, e, i, n, s, o, a, r) {
                    var h = a - i, l = r - n, c = s - i, u = o - n, d = t - i, p = e - n, g = h * h + l * l, m = h * c + l * u, f = h * d + l * p, y = c * c + u * u, v = c * d + u * p, b = 1 / (g * y - m * m), _ = (y * f - m * v) * b, S = (g * v - m * f) * b;
                    return 0 <= _ && 0 <= S && _ + S < 1;
                },
                _convex: function(t, e, i, n, s, o) {
                    return 0 <= (e - n) * (s - i) + (i - t) * (o - n);
                }
            };
            e.exports = v;
        }, {} ],
        30: [ function(t, e, i) {
            var a = e.exports = {}, n = t("../utils/Utils");
            a.crossLength = function(t, e) {
                return t[0] * e[1] - t[1] * e[0];
            }, a.crossVZ = function(t, e, i) {
                return a.rotate(t, e, -Math.PI / 2), a.scale(t, t, i), t;
            }, a.crossZV = function(t, e, i) {
                return a.rotate(t, i, Math.PI / 2), a.scale(t, t, e), t;
            }, a.rotate = function(t, e, i) {
                if (0 !== i) {
                    var n = Math.cos(i), s = Math.sin(i), o = e[0], a = e[1];
                    t[0] = n * o - s * a, t[1] = s * o + n * a;
                } else t[0] = e[0], t[1] = e[1];
            }, a.rotate90cw = function(t, e) {
                var i = e[0], n = e[1];
                t[0] = n, t[1] = -i;
            }, a.toLocalFrame = function(t, e, i, n) {
                a.copy(t, e), a.sub(t, t, i), a.rotate(t, t, -n);
            }, a.toGlobalFrame = function(t, e, i, n) {
                a.copy(t, e), a.rotate(t, t, n), a.add(t, t, i);
            }, a.vectorToLocalFrame = function(t, e, i) {
                a.rotate(t, e, -i);
            }, a.vectorToGlobalFrame = function(t, e, i) {
                a.rotate(t, e, i);
            }, a.centroid = function(t, e, i, n) {
                return a.add(t, e, i), a.add(t, t, n), a.scale(t, t, 1 / 3), t;
            }, a.create = function() {
                var t = new n.ARRAY_TYPE(2);
                return t[0] = 0, t[1] = 0, t;
            }, a.clone = function(t) {
                var e = new n.ARRAY_TYPE(2);
                return e[0] = t[0], e[1] = t[1], e;
            }, a.fromValues = function(t, e) {
                var i = new n.ARRAY_TYPE(2);
                return i[0] = t, i[1] = e, i;
            }, a.copy = function(t, e) {
                return t[0] = e[0], t[1] = e[1], t;
            }, a.set = function(t, e, i) {
                return t[0] = e, t[1] = i, t;
            }, a.add = function(t, e, i) {
                return t[0] = e[0] + i[0], t[1] = e[1] + i[1], t;
            }, a.subtract = function(t, e, i) {
                return t[0] = e[0] - i[0], t[1] = e[1] - i[1], t;
            }, a.sub = a.subtract, a.multiply = function(t, e, i) {
                return t[0] = e[0] * i[0], t[1] = e[1] * i[1], t;
            }, a.mul = a.multiply, a.divide = function(t, e, i) {
                return t[0] = e[0] / i[0], t[1] = e[1] / i[1], t;
            }, a.div = a.divide, a.scale = function(t, e, i) {
                return t[0] = e[0] * i, t[1] = e[1] * i, t;
            }, a.distance = function(t, e) {
                var i = e[0] - t[0], n = e[1] - t[1];
                return Math.sqrt(i * i + n * n);
            }, a.dist = a.distance, a.squaredDistance = function(t, e) {
                var i = e[0] - t[0], n = e[1] - t[1];
                return i * i + n * n;
            }, a.sqrDist = a.squaredDistance, a.length = function(t) {
                var e = t[0], i = t[1];
                return Math.sqrt(e * e + i * i);
            }, a.len = a.length, a.squaredLength = function(t) {
                var e = t[0], i = t[1];
                return e * e + i * i;
            }, a.sqrLen = a.squaredLength, a.negate = function(t, e) {
                return t[0] = -e[0], t[1] = -e[1], t;
            }, a.normalize = function(t, e) {
                var i = e[0], n = e[1], s = i * i + n * n;
                return 0 < s && (s = 1 / Math.sqrt(s), t[0] = e[0] * s, t[1] = e[1] * s), t;
            }, a.dot = function(t, e) {
                return t[0] * e[0] + t[1] * e[1];
            }, a.str = function(t) {
                return "vec2(" + t[0] + ", " + t[1] + ")";
            }, a.lerp = function(t, e, i, n) {
                var s = e[0], o = e[1];
                return t[0] = s + n * (i[0] - s), t[1] = o + n * (i[1] - o), t;
            }, a.reflect = function(t, e, i) {
                var n = e[0] * i[0] + e[1] * i[1];
                t[0] = e[0] - 2 * i[0] * n, t[1] = e[1] - 2 * i[1] * n;
            }, a.getLineSegmentsIntersection = function(t, e, i, n, s) {
                var o = a.getLineSegmentsIntersectionFraction(e, i, n, s);
                return !(o < 0) && (t[0] = e[0] + o * (i[0] - e[0]), t[1] = e[1] + o * (i[1] - e[1]), 
                !0);
            }, a.getLineSegmentsIntersectionFraction = function(t, e, i, n) {
                var s, o, a = e[0] - t[0], r = e[1] - t[1], h = n[0] - i[0], l = n[1] - i[1];
                return s = (-r * (t[0] - i[0]) + a * (t[1] - i[1])) / (-h * r + a * l), o = (h * (t[1] - i[1]) - l * (t[0] - i[0])) / (-h * r + a * l), 
                0 <= s && s <= 1 && 0 <= o && o <= 1 ? o : -1;
            };
        }, {
            "../utils/Utils": 57
        } ],
        31: [ function(t, e, i) {
            var u = t("../math/vec2"), l = t("poly-decomp"), c = t("../shapes/Convex"), n = t("../collision/RaycastResult"), s = t("../collision/Ray"), o = t("../collision/AABB"), a = t("../events/EventEmitter");
            function r(t) {
                t = t || {}, a.call(this), this.id = t.id || ++r._idCounter, this.world = null, 
                this.shapes = [], this.mass = t.mass || 0, this.invMass = 0, this.inertia = 0, this.invInertia = 0, 
                this.invMassSolve = 0, this.invInertiaSolve = 0, this.fixedRotation = !!t.fixedRotation, 
                this.fixedX = !!t.fixedX, this.fixedY = !!t.fixedY, this.massMultiplier = u.create(), 
                this.position = u.fromValues(0, 0), t.position && u.copy(this.position, t.position), 
                this.interpolatedPosition = u.fromValues(0, 0), this.interpolatedAngle = 0, this.previousPosition = u.fromValues(0, 0), 
                this.previousAngle = 0, this.velocity = u.fromValues(0, 0), t.velocity && u.copy(this.velocity, t.velocity), 
                this.vlambda = u.fromValues(0, 0), this.wlambda = 0, this.angle = t.angle || 0, 
                this.angularVelocity = t.angularVelocity || 0, this.force = u.create(), t.force && u.copy(this.force, t.force), 
                this.angularForce = t.angularForce || 0, this.damping = "number" == typeof t.damping ? t.damping : .1, 
                this.angularDamping = "number" == typeof t.angularDamping ? t.angularDamping : .1, 
                this.type = r.STATIC, void 0 !== t.type ? this.type = t.type : t.mass ? this.type = r.DYNAMIC : this.type = r.STATIC, 
                this.boundingRadius = 0, this.aabb = new o(), this.aabbNeedsUpdate = !0, this.allowSleep = void 0 === t.allowSleep || t.allowSleep, 
                this.wantsToSleep = !1, this.sleepState = r.AWAKE, this.sleepSpeedLimit = void 0 !== t.sleepSpeedLimit ? t.sleepSpeedLimit : .2, 
                this.sleepTimeLimit = void 0 !== t.sleepTimeLimit ? t.sleepTimeLimit : 1, this.gravityScale = void 0 !== t.gravityScale ? t.gravityScale : 1, 
                this.collisionResponse = void 0 === t.collisionResponse || t.collisionResponse, 
                this.idleTime = 0, this.timeLastSleepy = 0, this.ccdSpeedThreshold = void 0 !== t.ccdSpeedThreshold ? t.ccdSpeedThreshold : -1, 
                this.ccdIterations = void 0 !== t.ccdIterations ? t.ccdIterations : 10, this.concavePath = null, 
                this._wakeUpAfterNarrowphase = !1, this.updateMassProperties();
            }
            (((e.exports = r).prototype = new a()).constructor = r)._idCounter = 0, r.prototype.updateSolveMassProperties = function() {
                this.sleepState === r.SLEEPING || this.type === r.KINEMATIC ? (this.invMassSolve = 0, 
                this.invInertiaSolve = 0) : (this.invMassSolve = this.invMass, this.invInertiaSolve = this.invInertia);
            }, r.prototype.setDensity = function(t) {
                var e = this.getArea();
                this.mass = e * t, this.updateMassProperties();
            }, r.prototype.getArea = function() {
                for (var t = 0, e = 0; e < this.shapes.length; e++) t += this.shapes[e].area;
                return t;
            }, r.prototype.getAABB = function() {
                return this.aabbNeedsUpdate && this.updateAABB(), this.aabb;
            };
            var h = new o(), d = u.create();
            r.prototype.updateAABB = function() {
                for (var t = this.shapes, e = t.length, i = d, n = this.angle, s = 0; s !== e; s++) {
                    var o = t[s], a = o.angle + n;
                    u.rotate(i, o.position, n), u.add(i, i, this.position), o.computeAABB(h, i, a), 
                    0 === s ? this.aabb.copy(h) : this.aabb.extend(h);
                }
                this.aabbNeedsUpdate = !1;
            }, r.prototype.updateBoundingRadius = function() {
                for (var t = this.shapes, e = t.length, i = 0, n = 0; n !== e; n++) {
                    var s = t[n], o = u.length(s.position), a = s.boundingRadius;
                    i < o + a && (i = o + a);
                }
                this.boundingRadius = i;
            }, r.prototype.addShape = function(t, e, i) {
                if (t.body) throw new Error("A shape can only be added to one body.");
                t.body = this, e ? u.copy(t.position, e) : u.set(t.position, 0, 0), t.angle = i || 0, 
                this.shapes.push(t), this.updateMassProperties(), this.updateBoundingRadius(), this.aabbNeedsUpdate = !0;
            }, r.prototype.removeShape = function(t) {
                var e = this.shapes.indexOf(t);
                return -1 !== e && (this.shapes.splice(e, 1), this.aabbNeedsUpdate = !0, !(t.body = null));
            }, r.prototype.updateMassProperties = function() {
                if (this.type === r.STATIC || this.type === r.KINEMATIC) this.mass = Number.MAX_VALUE, 
                this.invMass = 0, this.inertia = Number.MAX_VALUE, this.invInertia = 0; else {
                    var t = this.shapes, e = t.length, i = this.mass / e, n = 0;
                    if (this.fixedRotation) this.inertia = Number.MAX_VALUE, this.invInertia = 0; else {
                        for (var s = 0; s < e; s++) {
                            var o = t[s], a = u.squaredLength(o.position);
                            n += o.computeMomentOfInertia(i) + i * a;
                        }
                        this.inertia = n, this.invInertia = 0 < n ? 1 / n : 0;
                    }
                    this.invMass = 1 / this.mass, u.set(this.massMultiplier, this.fixedX ? 0 : 1, this.fixedY ? 0 : 1);
                }
            };
            u.create();
            r.prototype.applyForce = function(t, e) {
                if (u.add(this.force, this.force, t), e) {
                    var i = u.crossLength(e, t);
                    this.angularForce += i;
                }
            };
            var p = u.create(), g = u.create(), m = u.create();
            r.prototype.applyForceLocal = function(t, e) {
                e = e || m;
                var i = p, n = g;
                this.vectorToWorldFrame(i, t), this.vectorToWorldFrame(n, e), this.applyForce(i, n);
            };
            var f = u.create();
            r.prototype.applyImpulse = function(t, e) {
                if (this.type === r.DYNAMIC) {
                    var i = f;
                    if (u.scale(i, t, this.invMass), u.multiply(i, this.massMultiplier, i), u.add(this.velocity, i, this.velocity), 
                    e) {
                        var n = u.crossLength(e, t);
                        n *= this.invInertia, this.angularVelocity += n;
                    }
                }
            };
            var y = u.create(), v = u.create(), b = u.create();
            r.prototype.applyImpulseLocal = function(t, e) {
                e = e || b;
                var i = y, n = v;
                this.vectorToWorldFrame(i, t), this.vectorToWorldFrame(n, e), this.applyImpulse(i, n);
            }, r.prototype.toLocalFrame = function(t, e) {
                u.toLocalFrame(t, e, this.position, this.angle);
            }, r.prototype.toWorldFrame = function(t, e) {
                u.toGlobalFrame(t, e, this.position, this.angle);
            }, r.prototype.vectorToLocalFrame = function(t, e) {
                u.vectorToLocalFrame(t, e, this.angle);
            }, r.prototype.vectorToWorldFrame = function(t, e) {
                u.vectorToGlobalFrame(t, e, this.angle);
            }, r.prototype.fromPolygon = function(t, e) {
                e = e || {};
                for (var i = this.shapes.length; 0 <= i; --i) this.removeShape(this.shapes[i]);
                var n, s = new l.Polygon();
                if (s.vertices = t, s.makeCCW(), "number" == typeof e.removeCollinearPoints && s.removeCollinearPoints(e.removeCollinearPoints), 
                void 0 === e.skipSimpleCheck && !s.isSimple()) return !1;
                this.concavePath = s.vertices.slice(0);
                for (i = 0; i < this.concavePath.length; i++) {
                    var o = [ 0, 0 ];
                    u.copy(o, this.concavePath[i]), this.concavePath[i] = o;
                }
                n = e.optimalDecomp ? s.decomp() : s.quickDecomp();
                var a = u.create();
                for (i = 0; i !== n.length; i++) {
                    for (var r = new c({
                        vertices: n[i].vertices
                    }), h = 0; h !== r.vertices.length; h++) {
                        o = r.vertices[h];
                        u.sub(o, o, r.centerOfMass);
                    }
                    u.scale(a, r.centerOfMass, 1), r.updateTriangles(), r.updateCenterOfMass(), r.updateBoundingRadius(), 
                    this.addShape(r, a);
                }
                return this.adjustCenterOfMass(), this.aabbNeedsUpdate = !0;
            };
            u.fromValues(0, 0);
            var _ = u.fromValues(0, 0), S = u.fromValues(0, 0), x = u.fromValues(0, 0);
            r.prototype.adjustCenterOfMass = function() {
                var t = _, e = S, i = x, n = 0;
                u.set(e, 0, 0);
                for (var s = 0; s !== this.shapes.length; s++) {
                    var o = this.shapes[s];
                    u.scale(t, o.position, o.area), u.add(e, e, t), n += o.area;
                }
                u.scale(i, e, 1 / n);
                for (s = 0; s !== this.shapes.length; s++) {
                    o = this.shapes[s];
                    u.sub(o.position, o.position, i);
                }
                u.add(this.position, this.position, i);
                for (s = 0; this.concavePath && s < this.concavePath.length; s++) u.sub(this.concavePath[s], this.concavePath[s], i);
                this.updateMassProperties(), this.updateBoundingRadius();
            }, r.prototype.setZeroForce = function() {
                u.set(this.force, 0, 0), this.angularForce = 0;
            }, r.prototype.resetConstraintVelocity = function() {
                var t = this.vlambda;
                u.set(t, 0, 0), this.wlambda = 0;
            }, r.prototype.addConstraintVelocity = function() {
                var t = this.velocity;
                u.add(t, t, this.vlambda), this.angularVelocity += this.wlambda;
            }, r.prototype.applyDamping = function(t) {
                if (this.type === r.DYNAMIC) {
                    var e = this.velocity;
                    u.scale(e, e, Math.pow(1 - this.damping, t)), this.angularVelocity *= Math.pow(1 - this.angularDamping, t);
                }
            }, r.prototype.wakeUp = function() {
                var t = this.sleepState;
                this.sleepState = r.AWAKE, this.idleTime = 0, t !== r.AWAKE && this.emit(r.wakeUpEvent);
            }, r.prototype.sleep = function() {
                this.sleepState = r.SLEEPING, this.angularVelocity = 0, this.angularForce = 0, u.set(this.velocity, 0, 0), 
                u.set(this.force, 0, 0), this.emit(r.sleepEvent);
            }, r.prototype.sleepTick = function(t, e, i) {
                if (this.allowSleep && this.type !== r.SLEEPING) {
                    this.wantsToSleep = !1;
                    this.sleepState;
                    var n = u.squaredLength(this.velocity) + Math.pow(this.angularVelocity, 2);
                    Math.pow(this.sleepSpeedLimit, 2) <= n ? (this.idleTime = 0, this.sleepState = r.AWAKE) : (this.idleTime += i, 
                    this.sleepState = r.SLEEPY), this.idleTime > this.sleepTimeLimit && (e ? this.wantsToSleep = !0 : this.sleep());
                }
            }, r.prototype.overlaps = function(t) {
                return this.world.overlapKeeper.bodiesAreOverlapping(this, t);
            };
            var w = u.create(), A = u.create();
            r.prototype.integrate = function(t) {
                var e = this.invMass, i = this.force, n = this.position, s = this.velocity;
                u.copy(this.previousPosition, this.position), this.previousAngle = this.angle, this.fixedRotation || (this.angularVelocity += this.angularForce * this.invInertia * t), 
                u.scale(w, i, t * e), u.multiply(w, this.massMultiplier, w), u.add(s, w, s), this.integrateToTimeOfImpact(t) || (u.scale(A, s, t), 
                u.add(n, n, A), this.fixedRotation || (this.angle += this.angularVelocity * t)), 
                this.aabbNeedsUpdate = !0;
            };
            var P = new n(), C = new s({
                mode: s.ALL
            }), T = u.create(), E = u.create(), I = u.create(), B = u.create();
            r.prototype.integrateToTimeOfImpact = function(t) {
                if (this.ccdSpeedThreshold < 0 || u.squaredLength(this.velocity) < Math.pow(this.ccdSpeedThreshold, 2)) return !1;
                u.normalize(T, this.velocity), u.scale(E, this.velocity, t), u.add(E, E, this.position), 
                u.sub(I, E, this.position);
                var e, i = this.angularVelocity * t, n = u.length(I), s = 1, o = this;
                if (P.reset(), C.callback = function(t) {
                    t.body !== o && (e = t.body, t.getHitPoint(E, C), u.sub(I, E, o.position), s = u.length(I) / n, 
                    t.stop());
                }, u.copy(C.from, this.position), u.copy(C.to, E), C.update(), this.world.raycast(P, C), 
                !e) return !1;
                var a = this.angle;
                u.copy(B, this.position);
                for (var r = 0, h = 0, l = 0, c = s; h <= c && r < this.ccdIterations; ) {
                    r++, l = (c - h) / 2, u.scale(A, I, s), u.add(this.position, B, A), this.angle = a + i * s, 
                    this.updateAABB(), this.aabb.overlaps(e.aabb) && this.world.narrowphase.bodiesOverlap(this, e) ? h = l : c = l;
                }
                return s = l, u.copy(this.position, B), this.angle = a, u.scale(A, I, s), u.add(this.position, this.position, A), 
                this.fixedRotation || (this.angle += i * s), !0;
            }, r.prototype.getVelocityAtPoint = function(t, e) {
                return u.crossVZ(t, e, this.angularVelocity), u.subtract(t, this.velocity, t), t;
            }, r.sleepyEvent = {
                type: "sleepy"
            }, r.sleepEvent = {
                type: "sleep"
            }, r.wakeUpEvent = {
                type: "wakeup"
            }, r.DYNAMIC = 1, r.STATIC = 2, r.KINEMATIC = 4, r.AWAKE = 0, r.SLEEPY = 1, r.SLEEPING = 2;
        }, {
            "../collision/AABB": 7,
            "../collision/Ray": 11,
            "../collision/RaycastResult": 12,
            "../events/EventEmitter": 26,
            "../math/vec2": 30,
            "../shapes/Convex": 40,
            "poly-decomp": 5
        } ],
        32: [ function(t, e, i) {
            var y = t("../math/vec2"), a = t("./Spring");
            t("../utils/Utils");
            function n(t, e, i) {
                i = i || {}, a.call(this, t, e, i), this.localAnchorA = y.fromValues(0, 0), this.localAnchorB = y.fromValues(0, 0), 
                i.localAnchorA && y.copy(this.localAnchorA, i.localAnchorA), i.localAnchorB && y.copy(this.localAnchorB, i.localAnchorB), 
                i.worldAnchorA && this.setWorldAnchorA(i.worldAnchorA), i.worldAnchorB && this.setWorldAnchorB(i.worldAnchorB);
                var n = y.create(), s = y.create();
                this.getWorldAnchorA(n), this.getWorldAnchorB(s);
                var o = y.distance(n, s);
                this.restLength = "number" == typeof i.restLength ? i.restLength : o;
            }
            (((e.exports = n).prototype = new a()).constructor = n).prototype.setWorldAnchorA = function(t) {
                this.bodyA.toLocalFrame(this.localAnchorA, t);
            }, n.prototype.setWorldAnchorB = function(t) {
                this.bodyB.toLocalFrame(this.localAnchorB, t);
            }, n.prototype.getWorldAnchorA = function(t) {
                this.bodyA.toWorldFrame(t, this.localAnchorA);
            }, n.prototype.getWorldAnchorB = function(t) {
                this.bodyB.toWorldFrame(t, this.localAnchorB);
            };
            var v = y.create(), b = y.create(), _ = y.create(), S = y.create(), x = y.create(), w = y.create(), A = y.create(), P = y.create(), C = y.create();
            n.prototype.applyForce = function() {
                var t = this.stiffness, e = this.damping, i = this.restLength, n = this.bodyA, s = this.bodyB, o = v, a = b, r = _, h = S, l = C, c = x, u = w, d = A, p = P;
                this.getWorldAnchorA(c), this.getWorldAnchorB(u), y.sub(d, c, n.position), y.sub(p, u, s.position), 
                y.sub(o, u, c);
                var g = y.len(o);
                y.normalize(a, o), y.sub(r, s.velocity, n.velocity), y.crossZV(l, s.angularVelocity, p), 
                y.add(r, r, l), y.crossZV(l, n.angularVelocity, d), y.sub(r, r, l), y.scale(h, a, -t * (g - i) - e * y.dot(r, a)), 
                y.sub(n.force, n.force, h), y.add(s.force, s.force, h);
                var m = y.crossLength(d, h), f = y.crossLength(p, h);
                n.angularForce -= m, s.angularForce += f;
            };
        }, {
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Spring": 34
        } ],
        33: [ function(t, e, i) {
            t("../math/vec2");
            var n = t("./Spring");
            function s(t, e, i) {
                i = i || {}, n.call(this, t, e, i), this.restAngle = "number" == typeof i.restAngle ? i.restAngle : e.angle - t.angle;
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.applyForce = function() {
                var t = this.stiffness, e = this.damping, i = this.restAngle, n = this.bodyA, s = this.bodyB, o = -t * (s.angle - n.angle - i) - e * (s.angularVelocity - n.angularVelocity) * 0;
                n.angularForce -= o, s.angularForce += o;
            };
        }, {
            "../math/vec2": 30,
            "./Spring": 34
        } ],
        34: [ function(t, e, i) {
            t("../math/vec2");
            var n = t("../utils/Utils");
            function s(t, e, i) {
                i = n.defaults(i, {
                    stiffness: 100,
                    damping: 1
                }), this.stiffness = i.stiffness, this.damping = i.damping, this.bodyA = t, this.bodyB = e;
            }
            (e.exports = s).prototype.applyForce = function() {};
        }, {
            "../math/vec2": 30,
            "../utils/Utils": 57
        } ],
        35: [ function(t, e, i) {
            var n = t("../math/vec2"), s = (t("../utils/Utils"), t("../constraints/Constraint")), o = t("../equations/FrictionEquation"), a = t("../objects/Body");
            function r(t, e) {
                e = e || {}, this.chassisBody = t, this.wheels = [], this.groundBody = new a({
                    mass: 0
                }), this.world = null;
                var i = this;
                this.preStepCallback = function() {
                    i.update();
                };
            }
            function h(t, e) {
                e = e || {}, this.vehicle = t, this.forwardEquation = new o(t.chassisBody, t.groundBody), 
                this.sideEquation = new o(t.chassisBody, t.groundBody), this.steerValue = 0, this.engineForce = 0, 
                this.setSideFriction(void 0 !== e.sideFriction ? e.sideFriction : 5), this.localForwardVector = n.fromValues(0, 1), 
                e.localForwardVector && n.copy(this.localForwardVector, e.localForwardVector), this.localPosition = n.fromValues(0, 0), 
                e.localPosition && n.copy(this.localPosition, e.localPosition), s.apply(this, t.chassisBody, t.groundBody), 
                this.equations.push(this.forwardEquation, this.sideEquation), this.setBrakeForce(0);
            }
            (e.exports = r).prototype.addToWorld = function(t) {
                (this.world = t).addBody(this.groundBody), t.on("preStep", this.preStepCallback);
                for (var e = 0; e < this.wheels.length; e++) {
                    var i = this.wheels[e];
                    t.addConstraint(i);
                }
            }, r.prototype.removeFromWorld = function() {
                var t = this.world;
                t.removeBody(this.groundBody), t.off("preStep", this.preStepCallback);
                for (var e = 0; e < this.wheels.length; e++) {
                    var i = this.wheels[e];
                    t.removeConstraint(i);
                }
                this.world = null;
            }, r.prototype.addWheel = function(t) {
                var e = new h(this, t);
                return this.wheels.push(e), e;
            }, r.prototype.update = function() {
                for (var t = 0; t < this.wheels.length; t++) this.wheels[t].update();
            }, (h.prototype = new s()).setBrakeForce = function(t) {
                this.forwardEquation.setSlipForce(t);
            }, h.prototype.setSideFriction = function(t) {
                this.sideEquation.setSlipForce(t);
            };
            var l = n.create(), c = n.create();
            h.prototype.getSpeed = function() {
                return this.vehicle.chassisBody.vectorToWorldFrame(c, this.localForwardVector), 
                this.vehicle.chassisBody.getVelocityAtPoint(l, c), n.dot(l, c);
            };
            var u = n.create();
            h.prototype.update = function() {
                this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t, this.localForwardVector), 
                n.rotate(this.sideEquation.t, this.localForwardVector, Math.PI / 2), this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t, this.sideEquation.t), 
                n.rotate(this.forwardEquation.t, this.forwardEquation.t, this.steerValue), n.rotate(this.sideEquation.t, this.sideEquation.t, this.steerValue), 
                this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB, this.localPosition), 
                n.copy(this.sideEquation.contactPointB, this.forwardEquation.contactPointB), this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA, this.localPosition), 
                n.copy(this.sideEquation.contactPointA, this.forwardEquation.contactPointA), n.normalize(u, this.forwardEquation.t), 
                n.scale(u, u, this.engineForce), this.vehicle.chassisBody.applyForce(u, this.forwardEquation.contactPointA);
            };
        }, {
            "../constraints/Constraint": 14,
            "../equations/FrictionEquation": 23,
            "../math/vec2": 30,
            "../objects/Body": 31,
            "../utils/Utils": 57
        } ],
        36: [ function(t, e, i) {
            var n = e.exports = {
                AABB: t("./collision/AABB"),
                AngleLockEquation: t("./equations/AngleLockEquation"),
                Body: t("./objects/Body"),
                Broadphase: t("./collision/Broadphase"),
                Capsule: t("./shapes/Capsule"),
                Circle: t("./shapes/Circle"),
                Constraint: t("./constraints/Constraint"),
                ContactEquation: t("./equations/ContactEquation"),
                ContactEquationPool: t("./utils/ContactEquationPool"),
                ContactMaterial: t("./material/ContactMaterial"),
                Convex: t("./shapes/Convex"),
                DistanceConstraint: t("./constraints/DistanceConstraint"),
                Equation: t("./equations/Equation"),
                EventEmitter: t("./events/EventEmitter"),
                FrictionEquation: t("./equations/FrictionEquation"),
                FrictionEquationPool: t("./utils/FrictionEquationPool"),
                GearConstraint: t("./constraints/GearConstraint"),
                GSSolver: t("./solver/GSSolver"),
                Heightfield: t("./shapes/Heightfield"),
                Line: t("./shapes/Line"),
                LockConstraint: t("./constraints/LockConstraint"),
                Material: t("./material/Material"),
                Narrowphase: t("./collision/Narrowphase"),
                NaiveBroadphase: t("./collision/NaiveBroadphase"),
                Particle: t("./shapes/Particle"),
                Plane: t("./shapes/Plane"),
                Pool: t("./utils/Pool"),
                RevoluteConstraint: t("./constraints/RevoluteConstraint"),
                PrismaticConstraint: t("./constraints/PrismaticConstraint"),
                Ray: t("./collision/Ray"),
                RaycastResult: t("./collision/RaycastResult"),
                Box: t("./shapes/Box"),
                RotationalVelocityEquation: t("./equations/RotationalVelocityEquation"),
                SAPBroadphase: t("./collision/SAPBroadphase"),
                Shape: t("./shapes/Shape"),
                Solver: t("./solver/Solver"),
                Spring: t("./objects/Spring"),
                TopDownVehicle: t("./objects/TopDownVehicle"),
                LinearSpring: t("./objects/LinearSpring"),
                RotationalSpring: t("./objects/RotationalSpring"),
                Utils: t("./utils/Utils"),
                World: t("./world/World"),
                vec2: t("./math/vec2"),
                version: t("../package.json").version
            };
            Object.defineProperty(n, "Rectangle", {
                get: function() {
                    return this.Box;
                }
            });
        }, {
            "../package.json": 6,
            "./collision/AABB": 7,
            "./collision/Broadphase": 8,
            "./collision/NaiveBroadphase": 9,
            "./collision/Narrowphase": 10,
            "./collision/Ray": 11,
            "./collision/RaycastResult": 12,
            "./collision/SAPBroadphase": 13,
            "./constraints/Constraint": 14,
            "./constraints/DistanceConstraint": 15,
            "./constraints/GearConstraint": 16,
            "./constraints/LockConstraint": 17,
            "./constraints/PrismaticConstraint": 18,
            "./constraints/RevoluteConstraint": 19,
            "./equations/AngleLockEquation": 20,
            "./equations/ContactEquation": 21,
            "./equations/Equation": 22,
            "./equations/FrictionEquation": 23,
            "./equations/RotationalVelocityEquation": 25,
            "./events/EventEmitter": 26,
            "./material/ContactMaterial": 27,
            "./material/Material": 28,
            "./math/vec2": 30,
            "./objects/Body": 31,
            "./objects/LinearSpring": 32,
            "./objects/RotationalSpring": 33,
            "./objects/Spring": 34,
            "./objects/TopDownVehicle": 35,
            "./shapes/Box": 37,
            "./shapes/Capsule": 38,
            "./shapes/Circle": 39,
            "./shapes/Convex": 40,
            "./shapes/Heightfield": 41,
            "./shapes/Line": 42,
            "./shapes/Particle": 43,
            "./shapes/Plane": 44,
            "./shapes/Shape": 45,
            "./solver/GSSolver": 46,
            "./solver/Solver": 47,
            "./utils/ContactEquationPool": 48,
            "./utils/FrictionEquationPool": 49,
            "./utils/Pool": 55,
            "./utils/Utils": 57,
            "./world/World": 61
        } ],
        37: [ function(t, e, i) {
            var o = t("../math/vec2"), a = t("./Shape"), r = t("./Convex");
            function n(t) {
                "number" == typeof t && "number" == typeof arguments[1] && (t = {
                    width: t,
                    height: arguments[1]
                }), t = t || {};
                var e = this.width = t.width || 1, i = this.height = t.height || 1, n = [ o.fromValues(-e / 2, -i / 2), o.fromValues(e / 2, -i / 2), o.fromValues(e / 2, i / 2), o.fromValues(-e / 2, i / 2) ], s = [ o.fromValues(1, 0), o.fromValues(0, 1) ];
                t.vertices = n, t.axes = s, t.type = a.BOX, r.call(this, t);
            }
            (((e.exports = n).prototype = new r()).constructor = n).prototype.computeMomentOfInertia = function(t) {
                var e = this.width, i = this.height;
                return t * (i * i + e * e) / 12;
            }, n.prototype.updateBoundingRadius = function() {
                var t = this.width, e = this.height;
                this.boundingRadius = Math.sqrt(t * t + e * e) / 2;
            };
            o.create(), o.create(), o.create(), o.create();
            n.prototype.computeAABB = function(t, e, i) {
                t.setFromPoints(this.vertices, e, i, 0);
            }, n.prototype.updateArea = function() {
                this.area = this.width * this.height;
            };
        }, {
            "../math/vec2": 30,
            "./Convex": 40,
            "./Shape": 45
        } ],
        38: [ function(t, e, i) {
            var n = t("./Shape"), x = t("../math/vec2");
            function s(t) {
                "number" == typeof t && "number" == typeof arguments[1] && (t = {
                    length: t,
                    radius: arguments[1]
                }), t = t || {}, this.length = t.length || 1, this.radius = t.radius || 1, t.type = n.CAPSULE, 
                n.call(this, t);
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.computeMomentOfInertia = function(t) {
                var e = this.radius, i = this.length + e, n = 2 * e;
                return t * (n * n + i * i) / 12;
            }, s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = this.radius + this.length / 2;
            }, s.prototype.updateArea = function() {
                this.area = Math.PI * this.radius * this.radius + 2 * this.radius * this.length;
            };
            var o = x.create();
            s.prototype.computeAABB = function(t, e, i) {
                var n = this.radius;
                x.set(o, this.length / 2, 0), 0 !== i && x.rotate(o, o, i), x.set(t.upperBound, Math.max(o[0] + n, -o[0] + n), Math.max(o[1] + n, -o[1] + n)), 
                x.set(t.lowerBound, Math.min(o[0] - n, -o[0] - n), Math.min(o[1] - n, -o[1] - n)), 
                x.add(t.lowerBound, t.lowerBound, e), x.add(t.upperBound, t.upperBound, e);
            };
            var w = x.create(), A = x.create(), P = x.create(), C = x.create(), T = x.fromValues(0, 1);
            s.prototype.raycast = function(t, e, i, n) {
                for (var s = e.from, o = e.to, a = (e.direction, w), r = A, h = P, l = C, c = this.length / 2, u = 0; u < 2; u++) {
                    var d = this.radius * (2 * u - 1);
                    if (x.set(h, -c, d), x.set(l, c, d), x.toGlobalFrame(h, h, i, n), x.toGlobalFrame(l, l, i, n), 
                    0 <= (g = x.getLineSegmentsIntersectionFraction(s, o, h, l)) && (x.rotate(r, T, n), 
                    x.scale(r, r, 2 * u - 1), e.reportIntersection(t, g, r, -1), t.shouldStop(e))) return;
                }
                var p = Math.pow(this.radius, 2) + Math.pow(c, 2);
                for (u = 0; u < 2; u++) {
                    x.set(h, c * (2 * u - 1), 0), x.toGlobalFrame(h, h, i, n);
                    var g, m = Math.pow(o[0] - s[0], 2) + Math.pow(o[1] - s[1], 2), f = 2 * ((o[0] - s[0]) * (s[0] - h[0]) + (o[1] - s[1]) * (s[1] - h[1])), y = Math.pow(s[0] - h[0], 2) + Math.pow(s[1] - h[1], 2) - Math.pow(this.radius, 2);
                    if (!((g = Math.pow(f, 2) - 4 * m * y) < 0)) if (0 === g) {
                        if (x.lerp(a, s, o, g), x.squaredDistance(a, i) > p && (x.sub(r, a, h), x.normalize(r, r), 
                        e.reportIntersection(t, g, r, -1), t.shouldStop(e))) return;
                    } else {
                        var v = Math.sqrt(g), b = 1 / (2 * m), _ = (-f - v) * b, S = (-f + v) * b;
                        if (0 <= _ && _ <= 1 && (x.lerp(a, s, o, _), x.squaredDistance(a, i) > p && (x.sub(r, a, h), 
                        x.normalize(r, r), e.reportIntersection(t, _, r, -1), t.shouldStop(e)))) return;
                        if (0 <= S && S <= 1 && (x.lerp(a, s, o, S), x.squaredDistance(a, i) > p && (x.sub(r, a, h), 
                        x.normalize(r, r), e.reportIntersection(t, S, r, -1), t.shouldStop(e)))) return;
                    }
                }
            };
        }, {
            "../math/vec2": 30,
            "./Shape": 45
        } ],
        39: [ function(t, e, i) {
            var n = t("./Shape"), y = t("../math/vec2");
            function s(t) {
                "number" == typeof t && (t = {
                    radius: t
                }), t = t || {}, this.radius = t.radius || 1, t.type = n.CIRCLE, n.call(this, t);
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.computeMomentOfInertia = function(t) {
                var e = this.radius;
                return t * e * e / 2;
            }, s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = this.radius;
            }, s.prototype.updateArea = function() {
                this.area = Math.PI * this.radius * this.radius;
            }, s.prototype.computeAABB = function(t, e, i) {
                var n = this.radius;
                y.set(t.upperBound, n, n), y.set(t.lowerBound, -n, -n), e && (y.add(t.lowerBound, t.lowerBound, e), 
                y.add(t.upperBound, t.upperBound, e));
            };
            var v = y.create(), b = y.create();
            s.prototype.raycast = function(t, e, i, n) {
                var s = e.from, o = e.to, a = this.radius, r = Math.pow(o[0] - s[0], 2) + Math.pow(o[1] - s[1], 2), h = 2 * ((o[0] - s[0]) * (s[0] - i[0]) + (o[1] - s[1]) * (s[1] - i[1])), l = Math.pow(s[0] - i[0], 2) + Math.pow(s[1] - i[1], 2) - Math.pow(a, 2), c = Math.pow(h, 2) - 4 * r * l, u = v, d = b;
                if (!(c < 0)) if (0 === c) y.lerp(u, s, o, c), y.sub(d, u, i), y.normalize(d, d), 
                e.reportIntersection(t, c, d, -1); else {
                    var p = Math.sqrt(c), g = 1 / (2 * r), m = (-h - p) * g, f = (-h + p) * g;
                    if (0 <= m && m <= 1 && (y.lerp(u, s, o, m), y.sub(d, u, i), y.normalize(d, d), 
                    e.reportIntersection(t, m, d, -1), t.shouldStop(e))) return;
                    0 <= f && f <= 1 && (y.lerp(u, s, o, f), y.sub(d, u, i), y.normalize(d, d), e.reportIntersection(t, f, d, -1));
                }
            };
        }, {
            "../math/vec2": 30,
            "./Shape": 45
        } ],
        40: [ function(t, e, i) {
            var h = t("./Shape"), p = t("../math/vec2"), r = t("../math/polyk");
            t("poly-decomp");
            function d(t) {
                Array.isArray(t) && (t = {
                    vertices: t,
                    axes: arguments[1]
                }), t = t || {}, this.vertices = [];
                for (var e = void 0 !== t.vertices ? t.vertices : [], i = 0; i < e.length; i++) {
                    var n = p.create();
                    p.copy(n, e[i]), this.vertices.push(n);
                }
                if (this.axes = [], t.axes) for (i = 0; i < t.axes.length; i++) {
                    var s = p.create();
                    p.copy(s, t.axes[i]), this.axes.push(s);
                } else for (i = 0; i < this.vertices.length; i++) {
                    var o = this.vertices[i], a = this.vertices[(i + 1) % this.vertices.length], r = p.create();
                    p.sub(r, a, o), p.rotate90cw(r, r), p.normalize(r, r), this.axes.push(r);
                }
                if (this.centerOfMass = p.fromValues(0, 0), this.triangles = [], this.vertices.length && (this.updateTriangles(), 
                this.updateCenterOfMass()), this.boundingRadius = 0, t.type = h.CONVEX, h.call(this, t), 
                this.updateBoundingRadius(), this.updateArea(), this.area < 0) throw new Error("Convex vertices must be given in conter-clockwise winding.");
            }
            ((e.exports = d).prototype = new h()).constructor = d;
            var l = p.create(), a = p.create();
            d.prototype.projectOntoLocalAxis = function(t, e) {
                for (var i, n, s = null, o = null, a = (t = l, 0); a < this.vertices.length; a++) i = this.vertices[a], 
                n = p.dot(i, t), (null === s || s < n) && (s = n), (null === o || n < o) && (o = n);
                if (s < o) {
                    var r = o;
                    o = s, s = r;
                }
                p.set(e, o, s);
            }, d.prototype.projectOntoWorldAxis = function(t, e, i, n) {
                var s = a;
                this.projectOntoLocalAxis(t, n), 0 !== i ? p.rotate(s, t, i) : s = t;
                var o = p.dot(e, s);
                p.set(n, n[0] + o, n[1] + o);
            }, d.prototype.updateTriangles = function() {
                for (var t = [], e = this.triangles.length = 0; e < this.vertices.length; e++) {
                    var i = this.vertices[e];
                    t.push(i[0], i[1]);
                }
                var n = r.Triangulate(t);
                for (e = 0; e < n.length; e += 3) {
                    var s = n[e], o = n[e + 1], a = n[e + 2];
                    this.triangles.push([ s, o, a ]);
                }
            };
            var g = p.create(), m = p.create(), f = p.create(), y = p.create(), v = p.create();
            p.create(), p.create(), p.create(), p.create();
            d.prototype.updateCenterOfMass = function() {
                var t = this.triangles, e = this.vertices, i = this.centerOfMass, n = g, s = f, o = y, a = v, r = m;
                p.set(i, 0, 0);
                for (var h = 0, l = 0; l !== t.length; l++) {
                    var c = t[l];
                    s = e[c[0]], o = e[c[1]], a = e[c[2]];
                    p.centroid(n, s, o, a);
                    var u = d.triangleArea(s, o, a);
                    h += u, p.scale(r, n, u), p.add(i, i, r);
                }
                p.scale(i, i, 1 / h);
            }, d.prototype.computeMomentOfInertia = function(t) {
                for (var e = 0, i = 0, n = this.vertices.length, s = n - 1, o = 0; o < n; s = o, 
                o++) {
                    var a = this.vertices[s], r = this.vertices[o], h = Math.abs(p.crossLength(a, r));
                    e += h * (p.dot(r, r) + p.dot(r, a) + p.dot(a, a)), i += h;
                }
                return t / 6 * (e / i);
            }, d.prototype.updateBoundingRadius = function() {
                for (var t = this.vertices, e = 0, i = 0; i !== t.length; i++) {
                    var n = p.squaredLength(t[i]);
                    e < n && (e = n);
                }
                this.boundingRadius = Math.sqrt(e);
            }, d.triangleArea = function(t, e, i) {
                return .5 * ((e[0] - t[0]) * (i[1] - t[1]) - (i[0] - t[0]) * (e[1] - t[1]));
            }, d.prototype.updateArea = function() {
                this.updateTriangles(), this.area = 0;
                for (var t = this.triangles, e = this.vertices, i = 0; i !== t.length; i++) {
                    var n = t[i], s = e[n[0]], o = e[n[1]], a = e[n[2]], r = d.triangleArea(s, o, a);
                    this.area += r;
                }
            }, d.prototype.computeAABB = function(t, e, i) {
                t.setFromPoints(this.vertices, e, i, 0);
            };
            var b = p.create(), _ = p.create(), S = p.create();
            d.prototype.raycast = function(t, e, i, n) {
                var s = b, o = _, a = S, r = this.vertices;
                p.toLocalFrame(s, e.from, i, n), p.toLocalFrame(o, e.to, i, n);
                for (var h = r.length, l = 0; l < h && !t.shouldStop(e); l++) {
                    var c = r[l], u = r[(l + 1) % h], d = p.getLineSegmentsIntersectionFraction(s, o, c, u);
                    0 <= d && (p.sub(a, u, c), p.rotate(a, a, -Math.PI / 2 + n), p.normalize(a, a), 
                    e.reportIntersection(t, d, a, l));
                }
            };
        }, {
            "../math/polyk": 29,
            "../math/vec2": 30,
            "./Shape": 45,
            "poly-decomp": 5
        } ],
        41: [ function(t, e, i) {
            var n = t("./Shape"), f = t("../math/vec2");
            t("../utils/Utils");
            function s(t) {
                if (Array.isArray(t) && (t = {
                    heights: t
                }, "object" == typeof arguments[1])) for (var e in arguments[1]) t[e] = arguments[1][e];
                t = t || {}, this.heights = t.heights ? t.heights.slice(0) : [], this.maxValue = t.maxValue || null, 
                this.minValue = t.minValue || null, this.elementWidth = t.elementWidth || .1, void 0 !== t.maxValue && void 0 !== t.minValue || this.updateMaxMinValues(), 
                t.type = n.HEIGHTFIELD, n.call(this, t);
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.updateMaxMinValues = function() {
                for (var t = this.heights, e = t[0], i = t[0], n = 0; n !== t.length; n++) {
                    var s = t[n];
                    e < s && (e = s), s < i && (i = s);
                }
                this.maxValue = e, this.minValue = i;
            }, s.prototype.computeMomentOfInertia = function(t) {
                return Number.MAX_VALUE;
            }, s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = Number.MAX_VALUE;
            }, s.prototype.updateArea = function() {
                for (var t = this.heights, e = 0, i = 0; i < t.length - 1; i++) e += (t[i] + t[i + 1]) / 2 * this.elementWidth;
                this.area = e;
            };
            var o = [ f.create(), f.create(), f.create(), f.create() ];
            s.prototype.computeAABB = function(t, e, i) {
                f.set(o[0], 0, this.maxValue), f.set(o[1], this.elementWidth * this.heights.length, this.maxValue), 
                f.set(o[2], this.elementWidth * this.heights.length, this.minValue), f.set(o[3], 0, this.minValue), 
                t.setFromPoints(o, e, i);
            }, s.prototype.getLineSegment = function(t, e, i) {
                var n = this.heights, s = this.elementWidth;
                f.set(t, i * s, n[i]), f.set(e, (i + 1) * s, n[i + 1]);
            }, s.prototype.getSegmentIndex = function(t) {
                return Math.floor(t[0] / this.elementWidth);
            }, s.prototype.getClampedSegmentIndex = function(t) {
                var e = this.getSegmentIndex(t);
                return e = Math.min(this.heights.length, Math.max(e, 0));
            };
            f.create();
            var y = f.create(), v = f.create(), b = f.create(), _ = f.create(), S = f.create();
            f.fromValues(0, 1);
            s.prototype.raycast = function(t, e, i, n) {
                var s = e.from, o = e.to, a = (e.direction, y), r = v, h = b, l = _, c = S;
                f.toLocalFrame(l, s, i, n), f.toLocalFrame(c, o, i, n);
                var u = this.getClampedSegmentIndex(l), d = this.getClampedSegmentIndex(c);
                if (d < u) {
                    var p = u;
                    u = d, d = p;
                }
                for (var g = 0; g < this.heights.length - 1; g++) {
                    this.getLineSegment(r, h, g);
                    var m = f.getLineSegmentsIntersectionFraction(l, c, r, h);
                    if (0 <= m && (f.sub(a, h, r), f.rotate(a, a, n + Math.PI / 2), f.normalize(a, a), 
                    e.reportIntersection(t, m, a, -1), t.shouldStop(e))) return;
                }
            };
        }, {
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Shape": 45
        } ],
        42: [ function(t, e, i) {
            var n = t("./Shape"), u = t("../math/vec2");
            function s(t) {
                "number" == typeof t && (t = {
                    length: t
                }), t = t || {}, this.length = t.length || 1, t.type = n.LINE, n.call(this, t);
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.computeMomentOfInertia = function(t) {
                return t * Math.pow(this.length, 2) / 12;
            }, s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = this.length / 2;
            };
            var o = [ u.create(), u.create() ];
            s.prototype.computeAABB = function(t, e, i) {
                var n = this.length / 2;
                u.set(o[0], -n, 0), u.set(o[1], n, 0), t.setFromPoints(o, e, i, 0);
            };
            u.create();
            var d = u.create(), p = u.create(), g = u.create(), m = u.fromValues(0, 1);
            s.prototype.raycast = function(t, e, i, n) {
                var s = e.from, o = e.to, a = p, r = g, h = this.length / 2;
                u.set(a, -h, 0), u.set(r, h, 0), u.toGlobalFrame(a, a, i, n), u.toGlobalFrame(r, r, i, n);
                var l = u.getLineSegmentsIntersectionFraction(a, r, s, o);
                if (0 <= l) {
                    var c = d;
                    u.rotate(c, m, n), e.reportIntersection(t, l, c, -1);
                }
            };
        }, {
            "../math/vec2": 30,
            "./Shape": 45
        } ],
        43: [ function(t, e, i) {
            var n = t("./Shape"), s = t("../math/vec2");
            function o(t) {
                (t = t || {}).type = n.PARTICLE, n.call(this, t);
            }
            (((e.exports = o).prototype = new n()).constructor = o).prototype.computeMomentOfInertia = function(t) {
                return 0;
            }, o.prototype.updateBoundingRadius = function() {
                this.boundingRadius = 0;
            }, o.prototype.computeAABB = function(t, e, i) {
                s.copy(t.lowerBound, e), s.copy(t.upperBound, e);
            };
        }, {
            "../math/vec2": 30,
            "./Shape": 45
        } ],
        44: [ function(t, e, i) {
            var n = t("./Shape"), p = t("../math/vec2");
            t("../utils/Utils");
            function s(t) {
                (t = t || {}).type = n.PLANE, n.call(this, t);
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.computeMomentOfInertia = function(t) {
                return 0;
            }, s.prototype.updateBoundingRadius = function() {
                this.boundingRadius = Number.MAX_VALUE;
            }, s.prototype.computeAABB = function(t, e, i) {
                var n = i % (2 * Math.PI), s = p.set, o = t.lowerBound, a = t.upperBound;
                s(o, -1e7, -1e7), s(a, 1e7, 1e7), 0 === n ? a[1] = 0 : n === Math.PI / 2 ? o[0] = 0 : n === Math.PI ? o[1] = 0 : n === 3 * Math.PI / 2 && (a[0] = 0);
            }, s.prototype.updateArea = function() {
                this.area = Number.MAX_VALUE;
            };
            var g = p.create(), m = (p.create(), p.create(), p.create()), f = p.create();
            s.prototype.raycast = function(t, e, i, n) {
                var s = e.from, o = e.to, a = e.direction, r = g, h = m, l = f;
                p.set(h, 0, 1), p.rotate(h, h, n), p.sub(l, s, i);
                var c = p.dot(l, h);
                if (p.sub(l, o, i), !(0 < c * p.dot(l, h) || p.squaredDistance(s, o) < c * c)) {
                    var u = p.dot(h, a);
                    p.sub(r, s, i);
                    var d = -p.dot(h, r) / u / e.length;
                    e.reportIntersection(t, d, h, -1);
                }
            };
        }, {
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Shape": 45
        } ],
        45: [ function(t, e, i) {
            e.exports = s;
            var n = t("../math/vec2");
            function s(t) {
                t = t || {}, this.body = null, this.position = n.fromValues(0, 0), t.position && n.copy(this.position, t.position), 
                this.angle = t.angle || 0, this.type = t.type || 0, this.id = s.idCounter++, this.boundingRadius = 0, 
                this.collisionGroup = void 0 !== t.collisionGroup ? t.collisionGroup : 1, this.collisionResponse = void 0 === t.collisionResponse || t.collisionResponse, 
                this.collisionMask = void 0 !== t.collisionMask ? t.collisionMask : 1, this.material = t.material || null, 
                this.area = 0, this.sensor = void 0 !== t.sensor && t.sensor, this.type && this.updateBoundingRadius(), 
                this.updateArea();
            }
            s.idCounter = 0, s.CIRCLE = 1, s.PARTICLE = 2, s.PLANE = 4, s.CONVEX = 8, s.LINE = 16, 
            s.BOX = 32, s.CAPSULE = 64, s.HEIGHTFIELD = 128, s.prototype.computeMomentOfInertia = function(t) {}, 
            s.prototype.updateBoundingRadius = function() {}, s.prototype.updateArea = function() {}, 
            s.prototype.computeAABB = function(t, e, i) {}, s.prototype.raycast = function(t, e, i, n) {};
        }, {
            "../math/vec2": 30
        } ],
        46: [ function(t, e, i) {
            var x = t("../math/vec2"), n = t("./Solver"), w = t("../utils/Utils"), A = t("../equations/FrictionEquation");
            function P(t) {
                n.call(this, t, n.GS), t = t || {}, this.iterations = t.iterations || 10, this.tolerance = t.tolerance || 1e-7, 
                this.arrayStep = 30, this.lambda = new w.ARRAY_TYPE(this.arrayStep), this.Bs = new w.ARRAY_TYPE(this.arrayStep), 
                this.invCs = new w.ARRAY_TYPE(this.arrayStep), this.useZeroRHS = !1, this.frictionIterations = void 0 !== t.frictionIterations ? 0 : t.frictionIterations, 
                this.usedIterations = 0;
            }
            (((e.exports = P).prototype = new n()).constructor = P).prototype.solve = function(t, e) {
                this.sortEquations();
                var i = 0, n = this.iterations, s = this.frictionIterations, o = this.equations, a = o.length, r = Math.pow(this.tolerance * a, 2), h = e.bodies, l = e.bodies.length, c = (x.add, 
                x.set, this.useZeroRHS), u = this.lambda;
                if (this.usedIterations = 0, a) for (var d = 0; d !== l; d++) {
                    h[d].updateSolveMassProperties();
                }
                u.length < a && (u = this.lambda = new w.ARRAY_TYPE(a + this.arrayStep), this.Bs = new w.ARRAY_TYPE(a + this.arrayStep), 
                this.invCs = new w.ARRAY_TYPE(a + this.arrayStep)), function(t) {
                    for (var e = t.length; e--; ) t[e] = 0;
                }(u);
                var p, g, m = this.invCs, f = this.Bs;
                for (u = this.lambda, d = 0; d !== o.length; d++) {
                    var y;
                    ((y = o[d]).timeStep !== t || y.needsUpdate) && (y.timeStep = t, y.update()), f[d] = y.computeB(y.a, y.b, t), 
                    m[d] = y.computeInvC(y.epsilon);
                }
                if (0 !== a) {
                    for (d = 0; d !== l; d++) {
                        h[d].resetConstraintVelocity();
                    }
                    if (s) {
                        for (i = 0; i !== s; i++) {
                            for (g = p = 0; g !== a; g++) {
                                y = o[g];
                                var v = P.iterateEquation(g, y, y.epsilon, f, m, u, c, t, i);
                                p += Math.abs(v);
                            }
                            if (this.usedIterations++, p * p <= r) break;
                        }
                        for (P.updateMultipliers(o, u, 1 / t), g = 0; g !== a; g++) {
                            var b = o[g];
                            if (b instanceof A) {
                                for (var _ = 0, S = 0; S !== b.contactEquations.length; S++) _ += b.contactEquations[S].multiplier;
                                _ *= b.frictionCoefficient / b.contactEquations.length, b.maxForce = _, b.minForce = -_;
                            }
                        }
                    }
                    for (i = 0; i !== n; i++) {
                        for (g = p = 0; g !== a; g++) {
                            y = o[g];
                            v = P.iterateEquation(g, y, y.epsilon, f, m, u, c, t, i);
                            p += Math.abs(v);
                        }
                        if (this.usedIterations++, p * p <= r) break;
                    }
                    for (d = 0; d !== l; d++) h[d].addConstraintVelocity();
                    P.updateMultipliers(o, u, 1 / t);
                }
            }, P.updateMultipliers = function(t, e, i) {
                for (var n = t.length; n--; ) t[n].multiplier = e[n] * i;
            }, P.iterateEquation = function(t, e, i, n, s, o, a, r, h) {
                var l = n[t], c = s[t], u = o[t], d = e.computeGWlambda(), p = e.maxForce, g = e.minForce;
                a && (l = 0);
                var m = c * (l - d - i * u), f = u + m;
                return f < g * r ? m = g * r - u : p * r < f && (m = p * r - u), o[t] += m, e.addToWlambda(m), 
                m;
            };
        }, {
            "../equations/FrictionEquation": 23,
            "../math/vec2": 30,
            "../utils/Utils": 57,
            "./Solver": 47
        } ],
        47: [ function(t, e, i) {
            t("../utils/Utils");
            var n = t("../events/EventEmitter");
            function s(t, e) {
                t = t || {}, n.call(this), this.type = e, this.equations = [], this.equationSortFunction = t.equationSortFunction || !1;
            }
            (((e.exports = s).prototype = new n()).constructor = s).prototype.solve = function(t, e) {
                throw new Error("Solver.solve should be implemented by subclasses!");
            };
            var o = {
                bodies: []
            };
            s.prototype.solveIsland = function(t, e) {
                this.removeAllEquations(), e.equations.length && (this.addEquations(e.equations), 
                o.bodies.length = 0, e.getBodies(o.bodies), o.bodies.length && this.solve(t, o));
            }, s.prototype.sortEquations = function() {
                this.equationSortFunction && this.equations.sort(this.equationSortFunction);
            }, s.prototype.addEquation = function(t) {
                t.enabled && this.equations.push(t);
            }, s.prototype.addEquations = function(t) {
                for (var e = 0, i = t.length; e !== i; e++) {
                    var n = t[e];
                    n.enabled && this.equations.push(n);
                }
            }, s.prototype.removeEquation = function(t) {
                var e = this.equations.indexOf(t);
                -1 !== e && this.equations.splice(e, 1);
            }, s.prototype.removeAllEquations = function() {
                this.equations.length = 0;
            }, s.GS = 1, s.ISLAND = 2;
        }, {
            "../events/EventEmitter": 26,
            "../utils/Utils": 57
        } ],
        48: [ function(t, e, i) {
            var n = t("../equations/ContactEquation"), s = t("./Pool");
            function o() {
                s.apply(this, arguments);
            }
            (((e.exports = o).prototype = new s()).constructor = o).prototype.create = function() {
                return new n();
            }, o.prototype.destroy = function(t) {
                return t.bodyA = t.bodyB = null, this;
            };
        }, {
            "../equations/ContactEquation": 21,
            "./Pool": 55
        } ],
        49: [ function(t, e, i) {
            var n = t("../equations/FrictionEquation"), s = t("./Pool");
            function o() {
                s.apply(this, arguments);
            }
            (((e.exports = o).prototype = new s()).constructor = o).prototype.create = function() {
                return new n();
            }, o.prototype.destroy = function(t) {
                return t.bodyA = t.bodyB = null, this;
            };
        }, {
            "../equations/FrictionEquation": 23,
            "./Pool": 55
        } ],
        50: [ function(t, e, i) {
            var n = t("../world/IslandNode"), s = t("./Pool");
            function o() {
                s.apply(this, arguments);
            }
            (((e.exports = o).prototype = new s()).constructor = o).prototype.create = function() {
                return new n();
            }, o.prototype.destroy = function(t) {
                return t.reset(), this;
            };
        }, {
            "../world/IslandNode": 60,
            "./Pool": 55
        } ],
        51: [ function(t, e, i) {
            var n = t("../world/Island"), s = t("./Pool");
            function o() {
                s.apply(this, arguments);
            }
            (((e.exports = o).prototype = new s()).constructor = o).prototype.create = function() {
                return new n();
            }, o.prototype.destroy = function(t) {
                return t.reset(), this;
            };
        }, {
            "../world/Island": 58,
            "./Pool": 55
        } ],
        52: [ function(t, e, i) {
            var n = t("./TupleDictionary"), s = (t("./OverlapKeeperRecord"), t("./OverlapKeeperRecordPool"));
            t("./Utils");
            function o() {
                this.overlappingShapesLastState = new n(), this.overlappingShapesCurrentState = new n(), 
                this.recordPool = new s({
                    size: 16
                }), this.tmpDict = new n(), this.tmpArray1 = [];
            }
            (e.exports = o).prototype.tick = function() {
                for (var t = this.overlappingShapesLastState, e = this.overlappingShapesCurrentState, i = t.keys.length; i--; ) {
                    var n = t.keys[i], s = t.getByKey(n);
                    e.getByKey(n);
                    s && this.recordPool.release(s);
                }
                t.reset(), t.copy(e), e.reset();
            }, o.prototype.setOverlapping = function(t, e, i, n) {
                this.overlappingShapesLastState;
                var s = this.overlappingShapesCurrentState;
                if (!s.get(e.id, n.id)) {
                    var o = this.recordPool.get();
                    o.set(t, e, i, n), s.set(e.id, n.id, o);
                }
            }, o.prototype.getNewOverlaps = function(t) {
                return this.getDiff(this.overlappingShapesLastState, this.overlappingShapesCurrentState, t);
            }, o.prototype.getEndOverlaps = function(t) {
                return this.getDiff(this.overlappingShapesCurrentState, this.overlappingShapesLastState, t);
            }, o.prototype.bodiesAreOverlapping = function(t, e) {
                for (var i = this.overlappingShapesCurrentState, n = i.keys.length; n--; ) {
                    var s = i.keys[n], o = i.data[s];
                    if (o.bodyA === t && o.bodyB === e || o.bodyA === e && o.bodyB === t) return !0;
                }
                return !1;
            }, o.prototype.getDiff = function(t, e, i) {
                var n = t, s = e;
                (i = i || []).length = 0;
                for (var o = s.keys.length; o--; ) {
                    var a = s.keys[o], r = s.data[a];
                    if (!r) throw new Error("Key " + a + " had no data!");
                    n.data[a] || i.push(r);
                }
                return i;
            }, o.prototype.isNewOverlap = function(t, e) {
                var i = 0 | t.id, n = 0 | e.id, s = this.overlappingShapesLastState, o = this.overlappingShapesCurrentState;
                return !s.get(i, n) && !!o.get(i, n);
            }, o.prototype.getNewBodyOverlaps = function(t) {
                this.tmpArray1.length = 0;
                var e = this.getNewOverlaps(this.tmpArray1);
                return this.getBodyDiff(e, t);
            }, o.prototype.getEndBodyOverlaps = function(t) {
                this.tmpArray1.length = 0;
                var e = this.getEndOverlaps(this.tmpArray1);
                return this.getBodyDiff(e, t);
            }, o.prototype.getBodyDiff = function(t, e) {
                e = e || [];
                for (var i = this.tmpDict, n = t.length; n--; ) {
                    var s = t[n];
                    i.set(0 | s.bodyA.id, 0 | s.bodyB.id, s);
                }
                for (n = i.keys.length; n--; ) {
                    (s = i.getByKey(i.keys[n])) && e.push(s.bodyA, s.bodyB);
                }
                return i.reset(), e;
            };
        }, {
            "./OverlapKeeperRecord": 53,
            "./OverlapKeeperRecordPool": 54,
            "./TupleDictionary": 56,
            "./Utils": 57
        } ],
        53: [ function(t, e, i) {
            function s(t, e, i, n) {
                this.shapeA = e, this.shapeB = n, this.bodyA = t, this.bodyB = i;
            }
            (e.exports = s).prototype.set = function(t, e, i, n) {
                s.call(this, t, e, i, n);
            };
        }, {} ],
        54: [ function(t, e, i) {
            var n = t("./OverlapKeeperRecord"), s = t("./Pool");
            function o() {
                s.apply(this, arguments);
            }
            (((e.exports = o).prototype = new s()).constructor = o).prototype.create = function() {
                return new n();
            }, o.prototype.destroy = function(t) {
                return t.bodyA = t.bodyB = t.shapeA = t.shapeB = null, this;
            };
        }, {
            "./OverlapKeeperRecord": 53,
            "./Pool": 55
        } ],
        55: [ function(t, e, i) {
            function n(t) {
                t = t || {}, this.objects = [], void 0 !== t.size && this.resize(t.size);
            }
            (e.exports = n).prototype.resize = function(t) {
                for (var e = this.objects; e.length > t; ) e.pop();
                for (;e.length < t; ) e.push(this.create());
                return this;
            }, n.prototype.get = function() {
                var t = this.objects;
                return t.length ? t.pop() : this.create();
            }, n.prototype.release = function(t) {
                return this.destroy(t), this.objects.push(t), this;
            };
        }, {} ],
        56: [ function(t, e, i) {
            var n = t("./Utils");
            function s() {
                this.data = {}, this.keys = [];
            }
            (e.exports = s).prototype.getKey = function(t, e) {
                return (0 | (t |= 0)) == (0 | (e |= 0)) ? -1 : 0 | ((0 | e) < (0 | t) ? t << 16 | 65535 & e : e << 16 | 65535 & t);
            }, s.prototype.getByKey = function(t) {
                return t |= 0, this.data[t];
            }, s.prototype.get = function(t, e) {
                return this.data[this.getKey(t, e)];
            }, s.prototype.set = function(t, e, i) {
                if (!i) throw new Error("No data!");
                var n = this.getKey(t, e);
                return this.data[n] || this.keys.push(n), this.data[n] = i, n;
            }, s.prototype.reset = function() {
                for (var t = this.data, e = this.keys, i = e.length; i--; ) delete t[e[i]];
                e.length = 0;
            }, s.prototype.copy = function(t) {
                this.reset(), n.appendArray(this.keys, t.keys);
                for (var e = t.keys.length; e--; ) {
                    var i = t.keys[e];
                    this.data[i] = t.data[i];
                }
            };
        }, {
            "./Utils": 57
        } ],
        57: [ function(t, e, i) {
            function n() {}
            (e.exports = n).appendArray = function(t, e) {
                if (e.length < 15e4) t.push.apply(t, e); else for (var i = 0, n = e.length; i !== n; ++i) t.push(e[i]);
            }, n.splice = function(t, e, i) {
                i = i || 1;
                for (var n = e, s = t.length - i; n < s; n++) t[n] = t[n + i];
                t.length = s;
            }, n.ARRAY_TYPE = "undefined" != typeof P2_ARRAY_TYPE ? P2_ARRAY_TYPE : "undefined" != typeof Float32Array ? Float32Array : Array, 
            n.extend = function(t, e) {
                for (var i in e) t[i] = e[i];
            }, n.defaults = function(t, e) {
                for (var i in t = t || {}, e) i in t || (t[i] = e[i]);
                return t;
            };
        }, {} ],
        58: [ function(t, e, i) {
            var n = t("../objects/Body");
            function s() {
                this.equations = [], this.bodies = [];
            }
            (e.exports = s).prototype.reset = function() {
                this.equations.length = this.bodies.length = 0;
            };
            var o = [];
            s.prototype.getBodies = function(t) {
                for (var e = t || [], i = this.equations, n = o.length = 0; n !== i.length; n++) {
                    var s = i[n];
                    -1 === o.indexOf(s.bodyA.id) && (e.push(s.bodyA), o.push(s.bodyA.id)), -1 === o.indexOf(s.bodyB.id) && (e.push(s.bodyB), 
                    o.push(s.bodyB.id));
                }
                return e;
            }, s.prototype.wantsToSleep = function() {
                for (var t = 0; t < this.bodies.length; t++) {
                    var e = this.bodies[t];
                    if (e.type === n.DYNAMIC && !e.wantsToSleep) return !1;
                }
                return !0;
            }, s.prototype.sleep = function() {
                for (var t = 0; t < this.bodies.length; t++) {
                    this.bodies[t].sleep();
                }
                return !0;
            };
        }, {
            "../objects/Body": 31
        } ],
        59: [ function(t, e, i) {
            t("../math/vec2"), t("./Island"), t("./IslandNode");
            var n = t("./../utils/IslandNodePool"), s = t("./../utils/IslandPool"), a = t("../objects/Body");
            function g(t) {
                this.nodePool = new n({
                    size: 16
                }), this.islandPool = new s({
                    size: 8
                }), this.equations = [], this.islands = [], this.nodes = [], this.queue = [];
            }
            (e.exports = g).getUnvisitedNode = function(t) {
                for (var e = t.length, i = 0; i !== e; i++) {
                    var n = t[i];
                    if (!n.visited && n.body.type === a.DYNAMIC) return n;
                }
                return !1;
            }, g.prototype.visit = function(t, e, i) {
                e.push(t.body);
                for (var n = t.equations.length, s = 0; s !== n; s++) {
                    var o = t.equations[s];
                    -1 === i.indexOf(o) && i.push(o);
                }
            }, g.prototype.bfs = function(t, e, i) {
                var n = this.queue;
                for (n.length = 0, n.push(t), t.visited = !0, this.visit(t, e, i); n.length; ) for (var s, o = n.pop(); s = g.getUnvisitedNode(o.neighbors); ) s.visited = !0, 
                this.visit(s, e, i), s.body.type === a.DYNAMIC && n.push(s);
            }, g.prototype.split = function(t) {
                for (var e = t.bodies, i = this.nodes, n = this.equations; i.length; ) this.nodePool.release(i.pop());
                for (var s = 0; s !== e.length; s++) {
                    var o = this.nodePool.get();
                    o.body = e[s], i.push(o);
                }
                for (var a = 0; a !== n.length; a++) {
                    var r = n[a], h = (s = e.indexOf(r.bodyA), e.indexOf(r.bodyB)), l = i[s], c = i[h];
                    l.neighbors.push(c), c.neighbors.push(l), l.equations.push(r), c.equations.push(r);
                }
                var u, d = this.islands;
                for (s = 0; s < d.length; s++) this.islandPool.release(d[s]);
                for (d.length = 0; u = g.getUnvisitedNode(i); ) {
                    var p = this.islandPool.get();
                    this.bfs(u, p.bodies, p.equations), d.push(p);
                }
                return d;
            };
        }, {
            "../math/vec2": 30,
            "../objects/Body": 31,
            "./../utils/IslandNodePool": 50,
            "./../utils/IslandPool": 51,
            "./Island": 58,
            "./IslandNode": 60
        } ],
        60: [ function(t, e, i) {
            function n(t) {
                this.body = t, this.neighbors = [], this.equations = [], this.visited = !1;
            }
            (e.exports = n).prototype.reset = function() {
                this.equations.length = 0, this.neighbors.length = 0, this.visited = !1, this.body = null;
            };
        }, {} ],
        61: [ function(t, e, i) {
            var n = t("../solver/GSSolver"), X = (t("../solver/Solver"), t("../collision/Ray"), 
            t("../math/vec2")), y = t("../shapes/Circle"), v = t("../shapes/Convex"), b = (t("../shapes/Line"), 
            t("../shapes/Plane")), _ = t("../shapes/Capsule"), S = t("../shapes/Particle"), s = t("../events/EventEmitter"), j = t("../objects/Body"), o = (t("../shapes/Shape"), 
            t("../objects/LinearSpring"), t("../material/Material")), a = t("../material/ContactMaterial"), r = (t("../constraints/DistanceConstraint"), 
            t("../constraints/Constraint"), t("../constraints/LockConstraint"), t("../constraints/RevoluteConstraint"), 
            t("../constraints/PrismaticConstraint"), t("../constraints/GearConstraint"), t("../../package.json"), 
            t("../collision/Broadphase"), t("../collision/AABB")), h = t("../collision/SAPBroadphase"), l = t("../collision/Narrowphase"), Y = t("../utils/Utils"), c = t("../utils/OverlapKeeper"), u = t("./IslandManager");
            t("../objects/RotationalSpring");
            function q(t) {
                s.apply(this), t = t || {}, this.springs = [], this.bodies = [], this.disabledBodyCollisionPairs = [], 
                this.solver = t.solver || new n(), this.narrowphase = new l(this), this.islandManager = new u(), 
                this.gravity = X.fromValues(0, -9.78), t.gravity && X.copy(this.gravity, t.gravity), 
                this.frictionGravity = X.length(this.gravity) || 10, this.useWorldGravityAsFrictionGravity = !0, 
                this.useFrictionGravityOnZeroGravity = !0, this.broadphase = t.broadphase || new h(), 
                this.broadphase.setWorld(this), this.constraints = [], this.defaultMaterial = new o(), 
                this.defaultContactMaterial = new a(this.defaultMaterial, this.defaultMaterial), 
                this.lastTimeStep = 1 / 60, this.applySpringForces = !0, this.applyDamping = !0, 
                this.applyGravity = !0, this.solveConstraints = !0, this.contactMaterials = [], 
                this.time = 0, this.accumulator = 0, this.stepping = !1, this.bodiesToBeRemoved = [], 
                this.islandSplit = void 0 === t.islandSplit || !!t.islandSplit, this.emitImpactEvent = !0, 
                this._constraintIdCounter = 0, this._bodyIdCounter = 0, this.postStepEvent = {
                    type: "postStep"
                }, this.addBodyEvent = {
                    type: "addBody",
                    body: null
                }, this.removeBodyEvent = {
                    type: "removeBody",
                    body: null
                }, this.addSpringEvent = {
                    type: "addSpring",
                    spring: null
                }, this.impactEvent = {
                    type: "impact",
                    bodyA: null,
                    bodyB: null,
                    shapeA: null,
                    shapeB: null,
                    contactEquation: null
                }, this.postBroadphaseEvent = {
                    type: "postBroadphase",
                    pairs: null
                }, this.sleepMode = q.NO_SLEEPING, this.beginContactEvent = {
                    type: "beginContact",
                    shapeA: null,
                    shapeB: null,
                    bodyA: null,
                    bodyB: null,
                    contactEquations: []
                }, this.endContactEvent = {
                    type: "endContact",
                    shapeA: null,
                    shapeB: null,
                    bodyA: null,
                    bodyB: null
                }, this.preSolveEvent = {
                    type: "preSolve",
                    contactEquations: null,
                    frictionEquations: null
                }, this.overlappingShapesLastState = {
                    keys: []
                }, this.overlappingShapesCurrentState = {
                    keys: []
                }, this.overlapKeeper = new c();
            }
            (((e.exports = q).prototype = new Object(s.prototype)).constructor = q).NO_SLEEPING = 1, 
            q.BODY_SLEEPING = 2, q.ISLAND_SLEEPING = 4, q.prototype.addConstraint = function(t) {
                this.constraints.push(t);
            }, q.prototype.addContactMaterial = function(t) {
                this.contactMaterials.push(t);
            }, q.prototype.removeContactMaterial = function(t) {
                var e = this.contactMaterials.indexOf(t);
                -1 !== e && Y.splice(this.contactMaterials, e, 1);
            }, q.prototype.getContactMaterial = function(t, e) {
                for (var i = this.contactMaterials, n = 0, s = i.length; n !== s; n++) {
                    var o = i[n];
                    if (o.materialA.id === t.id && o.materialB.id === e.id || o.materialA.id === e.id && o.materialB.id === t.id) return o;
                }
                return !1;
            }, q.prototype.removeConstraint = function(t) {
                var e = this.constraints.indexOf(t);
                -1 !== e && Y.splice(this.constraints, e, 1);
            };
            X.create(), X.create(), X.create(), X.create(), X.create(), X.create();
            var K = X.create(), A = X.fromValues(0, 0), P = X.fromValues(0, 0);
            X.fromValues(0, 0), X.fromValues(0, 0);
            q.prototype.step = function(t, e, i) {
                if (i = i || 10, 0 === (e = e || 0)) this.internalStep(t), this.time += t; else {
                    this.accumulator += e;
                    for (var n = 0; this.accumulator >= t && n < i; ) this.internalStep(t), this.time += t, 
                    this.accumulator -= t, n++;
                    for (var s = this.accumulator % t / t, o = 0; o !== this.bodies.length; o++) {
                        var a = this.bodies[o];
                        X.lerp(a.interpolatedPosition, a.previousPosition, a.position, s), a.interpolatedAngle = a.previousAngle + s * (a.angle - a.previousAngle);
                    }
                }
            };
            var Z = [];
            q.prototype.internalStep = function(t) {
                this.stepping = !0;
                var e = this.springs.length, i = this.springs, n = this.bodies, s = this.gravity, o = this.solver, a = this.bodies.length, r = this.broadphase, h = this.narrowphase, l = this.constraints, c = K, u = (X.scale, 
                X.add), d = (X.rotate, this.islandManager);
                if (this.overlapKeeper.tick(), this.lastTimeStep = t, this.useWorldGravityAsFrictionGravity) {
                    var p = X.length(this.gravity);
                    0 === p && this.useFrictionGravityOnZeroGravity || (this.frictionGravity = p);
                }
                if (this.applyGravity) for (var g = 0; g !== a; g++) {
                    var m = (f = n[g]).force;
                    f.type === j.DYNAMIC && f.sleepState !== j.SLEEPING && (X.scale(c, s, f.mass * f.gravityScale), 
                    u(m, m, c));
                }
                if (this.applySpringForces) for (g = 0; g !== e; g++) {
                    i[g].applyForce();
                }
                if (this.applyDamping) for (g = 0; g !== a; g++) {
                    var f;
                    (f = n[g]).type === j.DYNAMIC && f.applyDamping(t);
                }
                var y = r.getCollisionPairs(this), v = this.disabledBodyCollisionPairs;
                for (g = v.length - 2; 0 <= g; g -= 2) for (var b = y.length - 2; 0 <= b; b -= 2) (v[g] === y[b] && v[g + 1] === y[b + 1] || v[g + 1] === y[b] && v[g] === y[b + 1]) && y.splice(b, 2);
                var _ = l.length;
                for (g = 0; g !== _; g++) {
                    var S = l[g];
                    if (!S.collideConnected) for (b = y.length - 2; 0 <= b; b -= 2) (S.bodyA === y[b] && S.bodyB === y[b + 1] || S.bodyB === y[b] && S.bodyA === y[b + 1]) && y.splice(b, 2);
                }
                this.postBroadphaseEvent.pairs = y, this.emit(this.postBroadphaseEvent), this.postBroadphaseEvent.pairs = null, 
                h.reset(this);
                g = 0;
                for (var x = y.length; g !== x; g += 2) for (var w = y[g], A = y[g + 1], P = 0, C = w.shapes.length; P !== C; P++) for (var T = w.shapes[P], E = T.position, I = T.angle, B = 0, L = A.shapes.length; B !== L; B++) {
                    var R = A.shapes[B], O = R.position, M = R.angle, k = this.defaultContactMaterial;
                    if (T.material && R.material) {
                        var D = this.getContactMaterial(T.material, R.material);
                        D && (k = D);
                    }
                    this.runNarrowphase(h, w, T, E, I, A, R, O, M, k, this.frictionGravity);
                }
                for (g = 0; g !== a; g++) {
                    (N = n[g])._wakeUpAfterNarrowphase && (N.wakeUp(), N._wakeUpAfterNarrowphase = !1);
                }
                if (this.has("endContact")) {
                    this.overlapKeeper.getEndOverlaps(Z);
                    var G = this.endContactEvent;
                    for (B = Z.length; B--; ) {
                        var U = Z[B];
                        G.shapeA = U.shapeA, G.shapeB = U.shapeB, G.bodyA = U.bodyA, G.bodyB = U.bodyB, 
                        this.emit(G);
                    }
                    Z.length = 0;
                }
                var F = this.preSolveEvent;
                F.contactEquations = h.contactEquations, F.frictionEquations = h.frictionEquations, 
                this.emit(F), F.contactEquations = F.frictionEquations = null;
                _ = l.length;
                for (g = 0; g !== _; g++) l[g].update();
                if (h.contactEquations.length || h.frictionEquations.length || _) if (this.islandSplit) {
                    for (d.equations.length = 0, Y.appendArray(d.equations, h.contactEquations), Y.appendArray(d.equations, h.frictionEquations), 
                    g = 0; g !== _; g++) Y.appendArray(d.equations, l[g].equations);
                    d.split(this);
                    for (g = 0; g !== d.islands.length; g++) {
                        (V = d.islands[g]).equations.length && o.solveIsland(t, V);
                    }
                } else {
                    for (o.addEquations(h.contactEquations), o.addEquations(h.frictionEquations), g = 0; g !== _; g++) o.addEquations(l[g].equations);
                    this.solveConstraints && o.solve(t, this), o.removeAllEquations();
                }
                for (g = 0; g !== a; g++) {
                    var N;
                    (N = n[g]).integrate(t);
                }
                for (g = 0; g !== a; g++) n[g].setZeroForce();
                if (this.emitImpactEvent && this.has("impact")) {
                    var z = this.impactEvent;
                    for (g = 0; g !== h.contactEquations.length; g++) {
                        var W = h.contactEquations[g];
                        W.firstImpact && (z.bodyA = W.bodyA, z.bodyB = W.bodyB, z.shapeA = W.shapeA, z.shapeB = W.shapeB, 
                        z.contactEquation = W, this.emit(z));
                    }
                }
                if (this.sleepMode === q.BODY_SLEEPING) for (g = 0; g !== a; g++) n[g].sleepTick(this.time, !1, t); else if (this.sleepMode === q.ISLAND_SLEEPING && this.islandSplit) {
                    for (g = 0; g !== a; g++) n[g].sleepTick(this.time, !0, t);
                    for (g = 0; g < this.islandManager.islands.length; g++) {
                        var V;
                        (V = this.islandManager.islands[g]).wantsToSleep() && V.sleep();
                    }
                }
                this.stepping = !1;
                var H = this.bodiesToBeRemoved;
                for (g = 0; g !== H.length; g++) this.removeBody(H[g]);
                H.length = 0, this.emit(this.postStepEvent);
            }, q.prototype.runNarrowphase = function(t, e, i, n, s, o, a, r, h, l, c) {
                if (0 != (i.collisionGroup & a.collisionMask) && 0 != (a.collisionGroup & i.collisionMask)) {
                    X.rotate(A, n, e.angle), X.rotate(P, r, o.angle), X.add(A, A, e.position), X.add(P, P, o.position);
                    var u, d = s + e.angle, p = h + o.angle;
                    t.enableFriction = 0 < l.friction, t.frictionCoefficient = l.friction, u = e.type === j.STATIC || e.type === j.KINEMATIC ? o.mass : o.type === j.STATIC || o.type === j.KINEMATIC ? e.mass : e.mass * o.mass / (e.mass + o.mass), 
                    t.slipForce = l.friction * c * u, t.restitution = l.restitution, t.surfaceVelocity = l.surfaceVelocity, 
                    t.frictionStiffness = l.frictionStiffness, t.frictionRelaxation = l.frictionRelaxation, 
                    t.stiffness = l.stiffness, t.relaxation = l.relaxation, t.contactSkinSize = l.contactSkinSize, 
                    t.enabledEquations = e.collisionResponse && o.collisionResponse && i.collisionResponse && a.collisionResponse;
                    var g = t[i.type | a.type], m = 0;
                    if (g) {
                        var f = i.sensor || a.sensor, y = t.frictionEquations.length;
                        m = i.type < a.type ? g.call(t, e, i, A, d, o, a, P, p, f) : g.call(t, o, a, P, p, e, i, A, d, f);
                        var v = t.frictionEquations.length - y;
                        if (m) {
                            if (e.allowSleep && e.type === j.DYNAMIC && e.sleepState === j.SLEEPING && o.sleepState === j.AWAKE && o.type !== j.STATIC) {
                                var b = X.squaredLength(o.velocity) + Math.pow(o.angularVelocity, 2);
                                2 * Math.pow(o.sleepSpeedLimit, 2) <= b && (e._wakeUpAfterNarrowphase = !0);
                            }
                            if (o.allowSleep && o.type === j.DYNAMIC && o.sleepState === j.SLEEPING && e.sleepState === j.AWAKE && e.type !== j.STATIC) {
                                var _ = X.squaredLength(e.velocity) + Math.pow(e.angularVelocity, 2);
                                2 * Math.pow(e.sleepSpeedLimit, 2) <= _ && (o._wakeUpAfterNarrowphase = !0);
                            }
                            if (this.overlapKeeper.setOverlapping(e, i, o, a), this.has("beginContact") && this.overlapKeeper.isNewOverlap(i, a)) {
                                var S = this.beginContactEvent;
                                if (S.shapeA = i, S.shapeB = a, S.bodyA = e, S.bodyB = o, S.contactEquations.length = 0, 
                                "number" == typeof m) for (var x = t.contactEquations.length - m; x < t.contactEquations.length; x++) S.contactEquations.push(t.contactEquations[x]);
                                this.emit(S);
                            }
                            if ("number" == typeof m && 1 < v) for (x = t.frictionEquations.length - v; x < t.frictionEquations.length; x++) {
                                var w = t.frictionEquations[x];
                                w.setSlipForce(w.getSlipForce() / v);
                            }
                        }
                    }
                }
            }, q.prototype.addSpring = function(t) {
                this.springs.push(t);
                var e = this.addSpringEvent;
                e.spring = t, this.emit(e), e.spring = null;
            }, q.prototype.removeSpring = function(t) {
                var e = this.springs.indexOf(t);
                -1 !== e && Y.splice(this.springs, e, 1);
            }, q.prototype.addBody = function(t) {
                if (-1 === this.bodies.indexOf(t)) {
                    this.bodies.push(t);
                    var e = (t.world = this).addBodyEvent;
                    e.body = t, this.emit(e), e.body = null;
                }
            }, q.prototype.removeBody = function(t) {
                if (this.stepping) this.bodiesToBeRemoved.push(t); else {
                    t.world = null;
                    var e = this.bodies.indexOf(t);
                    -1 !== e && (Y.splice(this.bodies, e, 1), (this.removeBodyEvent.body = t).resetConstraintVelocity(), 
                    this.emit(this.removeBodyEvent), this.removeBodyEvent.body = null);
                }
            }, q.prototype.getBodyById = function(t) {
                for (var e = this.bodies, i = 0; i < e.length; i++) {
                    var n = e[i];
                    if (n.id === t) return n;
                }
                return !1;
            }, q.prototype.disableBodyCollision = function(t, e) {
                this.disabledBodyCollisionPairs.push(t, e);
            }, q.prototype.enableBodyCollision = function(t, e) {
                for (var i = this.disabledBodyCollisionPairs, n = 0; n < i.length; n += 2) if (i[n] === t && i[n + 1] === e || i[n + 1] === t && i[n] === e) return void i.splice(n, 2);
            }, q.prototype.clear = function() {
                this.time = 0, this.solver && this.solver.equations.length && this.solver.removeAllEquations();
                for (var t = this.constraints, e = t.length - 1; 0 <= e; e--) this.removeConstraint(t[e]);
                var i = this.bodies;
                for (e = i.length - 1; 0 <= e; e--) this.removeBody(i[e]);
                var n = this.springs;
                for (e = n.length - 1; 0 <= e; e--) this.removeSpring(n[e]);
                var s = this.contactMaterials;
                for (e = s.length - 1; 0 <= e; e--) this.removeContactMaterial(s[e]);
                q.apply(this);
            };
            var x = X.create(), w = (X.fromValues(0, 0), X.fromValues(0, 0));
            q.prototype.hitTest = function(t, e, i) {
                i = i || 0;
                var n = new j({
                    position: t
                }), s = new S(), o = t, a = x, r = w;
                n.addShape(s);
                for (var h = this.narrowphase, l = [], c = 0, u = e.length; c !== u; c++) for (var d = e[c], p = 0, g = d.shapes.length; p !== g; p++) {
                    var m = d.shapes[p];
                    X.rotate(a, m.position, d.angle), X.add(a, a, d.position);
                    var f = m.angle + d.angle;
                    (m instanceof y && h.circleParticle(d, m, a, f, n, s, o, 0, !0) || m instanceof v && h.particleConvex(n, s, o, 0, d, m, a, f, !0) || m instanceof b && h.particlePlane(n, s, o, 0, d, m, a, f, !0) || m instanceof _ && h.particleCapsule(n, s, o, 0, d, m, a, f, !0) || m instanceof S && X.squaredLength(X.sub(r, a, t)) < i * i) && l.push(d);
                }
                return l;
            }, q.prototype.setGlobalStiffness = function(t) {
                for (var e = this.constraints, i = 0; i !== e.length; i++) for (var n = e[i], s = 0; s !== n.equations.length; s++) {
                    var o = n.equations[s];
                    o.stiffness = t, o.needsUpdate = !0;
                }
                var a = this.contactMaterials;
                for (i = 0; i !== a.length; i++) {
                    (n = a[i]).stiffness = n.frictionStiffness = t;
                }
                (n = this.defaultContactMaterial).stiffness = n.frictionStiffness = t;
            }, q.prototype.setGlobalRelaxation = function(t) {
                for (var e = 0; e !== this.constraints.length; e++) for (var i = this.constraints[e], n = 0; n !== i.equations.length; n++) {
                    var s = i.equations[n];
                    s.relaxation = t, s.needsUpdate = !0;
                }
                for (e = 0; e !== this.contactMaterials.length; e++) {
                    (i = this.contactMaterials[e]).relaxation = i.frictionRelaxation = t;
                }
                (i = this.defaultContactMaterial).relaxation = i.frictionRelaxation = t;
            };
            var d = new r(), p = [];
            q.prototype.raycast = function(t, e) {
                return e.getAABB(d), this.broadphase.aabbQuery(this, d, p), e.intersectBodies(t, p), 
                p.length = 0, t.hasHit();
            };
        }, {
            "../../package.json": 6,
            "../collision/AABB": 7,
            "../collision/Broadphase": 8,
            "../collision/Narrowphase": 10,
            "../collision/Ray": 11,
            "../collision/SAPBroadphase": 13,
            "../constraints/Constraint": 14,
            "../constraints/DistanceConstraint": 15,
            "../constraints/GearConstraint": 16,
            "../constraints/LockConstraint": 17,
            "../constraints/PrismaticConstraint": 18,
            "../constraints/RevoluteConstraint": 19,
            "../events/EventEmitter": 26,
            "../material/ContactMaterial": 27,
            "../material/Material": 28,
            "../math/vec2": 30,
            "../objects/Body": 31,
            "../objects/LinearSpring": 32,
            "../objects/RotationalSpring": 33,
            "../shapes/Capsule": 38,
            "../shapes/Circle": 39,
            "../shapes/Convex": 40,
            "../shapes/Line": 42,
            "../shapes/Particle": 43,
            "../shapes/Plane": 44,
            "../shapes/Shape": 45,
            "../solver/GSSolver": 46,
            "../solver/Solver": 47,
            "../utils/OverlapKeeper": 52,
            "../utils/Utils": 57,
            "./IslandManager": 59
        } ]
    }, {}, [ 36 ])(36);
}), function() {
    var t = this, M = M || {};
    M.DisplayObject = function() {
        this.position = new M.Point(0, 0), this.scale = new M.Point(1, 1), this.pivot = new M.Point(0, 0), 
        this.rotation = 0, this.alpha = 1, this.visible = !0, this.hitArea = null, this.renderable = !1, 
        this.parent = null, this.worldAlpha = 1, this.worldTransform = new Phaser.Matrix(), 
        this.worldPosition = new M.Point(0, 0), this.worldScale = new M.Point(1, 1), this.worldRotation = 0, 
        this.filterArea = null, this._sr = 0, this._cr = 1, this._bounds = new M.Rectangle(0, 0, 0, 0), 
        this._currentBounds = null, this._mask = null, this._cacheAsBitmap = !1, this._cacheIsDirty = !1;
    }, M.DisplayObject.prototype = {
        constructor: M.DisplayObject,
        destroy: function() {
            if (this.children) {
                for (var t = this.children.length; t--; ) this.children[t].destroy();
                this.children = [];
            }
            this.hitArea = null, this.parent = null, this.worldTransform = null, this.filterArea = null, 
            this.renderable = !1, this._bounds = null, this._currentBounds = null, this._mask = null, 
            this._destroyCachedSprite();
        },
        updateTransform: function(t) {
            if (!t && !this.parent && !this.game) return this;
            var e = this.parent;
            t ? e = t : this.parent || (e = this.game.world);
            var i, n, s, o, a, r, h = e.worldTransform, l = this.worldTransform;
            this.rotation % Phaser.Math.PI2 ? (this.rotation !== this.rotationCache && (this.rotationCache = this.rotation, 
            this._sr = Math.sin(this.rotation), this._cr = Math.cos(this.rotation)), i = this._cr * this.scale.x, 
            n = this._sr * this.scale.x, s = -this._sr * this.scale.y, o = this._cr * this.scale.y, 
            a = this.position.x, r = this.position.y, (this.pivot.x || this.pivot.y) && (a -= this.pivot.x * i + this.pivot.y * s, 
            r -= this.pivot.x * n + this.pivot.y * o), l.a = i * h.a + n * h.c, l.b = i * h.b + n * h.d, 
            l.c = s * h.a + o * h.c, l.d = s * h.b + o * h.d) : (i = this.scale.x, s = n = 0, 
            o = this.scale.y, a = this.position.x - this.pivot.x * i, r = this.position.y - this.pivot.y * o, 
            l.a = i * h.a, l.b = i * h.b, l.c = o * h.c, l.d = o * h.d), l.tx = a * h.a + r * h.c + h.tx, 
            l.ty = a * h.b + r * h.d + h.ty, i = l.a, n = l.b, s = l.c;
            var c = i * (o = l.d) - n * s;
            if (i || n) {
                var u = Math.sqrt(i * i + n * n);
                this.worldRotation = 0 < n ? Math.acos(i / u) : -Math.acos(i / u), this.worldScale.x = u, 
                this.worldScale.y = c / u;
            } else if (s || o) {
                var d = Math.sqrt(s * s + o * o);
                this.worldRotation = Phaser.Math.HALF_PI - (0 < o ? Math.acos(-s / d) : -Math.acos(s / d)), 
                this.worldScale.x = c / d, this.worldScale.y = d;
            } else this.worldScale.x = 0, this.worldScale.y = 0;
            return this.worldAlpha = this.alpha * e.worldAlpha, this.worldPosition.x = l.tx, 
            this.worldPosition.y = l.ty, this._currentBounds = null, this.transformCallback && this.transformCallback.call(this.transformCallbackContext, l, h), 
            this;
        },
        preUpdate: function() {},
        generateTexture: function(t, e, i) {
            var n = this.getLocalBounds(), s = new Phaser.RenderTexture(this.game, 0 | n.width, 0 | n.height, i, e, t);
            return M.DisplayObject._tempMatrix.tx = -n.x, M.DisplayObject._tempMatrix.ty = -n.y, 
            s.render(this, M.DisplayObject._tempMatrix), s;
        },
        updateCache: function() {
            return this._generateCachedSprite(), this;
        },
        toGlobal: function(t) {
            return this.updateTransform(), this.worldTransform.apply(t);
        },
        toLocal: function(t, e) {
            return e && (t = e.toGlobal(t)), this.updateTransform(), this.worldTransform.applyInverse(t);
        },
        _renderCachedSprite: function(t) {
            this._cachedSprite.worldAlpha = this.worldAlpha, t.gl ? M.Sprite.prototype._renderWebGL.call(this._cachedSprite, t) : M.Sprite.prototype._renderCanvas.call(this._cachedSprite, t);
        },
        _generateCachedSprite: function() {
            this._cacheAsBitmap = !1;
            var t = this.getLocalBounds();
            if (t.width = Math.max(1, Math.ceil(t.width)), t.height = Math.max(1, Math.ceil(t.height)), 
            this.updateTransform(), this._cachedSprite) this._cachedSprite.texture.resize(t.width, t.height); else {
                var e = 0;
                this.texture && this.texture.baseTexture && M._enableMultiTextureToggle && (e = this.texture.baseTexture.textureIndex);
                var i = new Phaser.RenderTexture(this.game, t.width, t.height, void 0, void 0, void 0, void 0, e);
                this._cachedSprite = new M.Sprite(i), this._cachedSprite.worldTransform = this.worldTransform;
            }
            var n = this._filters;
            this._filters = null, this._cachedSprite.filters = n, M.DisplayObject._tempMatrix.tx = -t.x, 
            M.DisplayObject._tempMatrix.ty = -t.y, this._cachedSprite.texture.render(this, M.DisplayObject._tempMatrix, !0), 
            this._cachedSprite.anchor.x = -t.x / t.width, this._cachedSprite.anchor.y = -t.y / t.height, 
            this._filters = n, this._cacheAsBitmap = !0;
        },
        _destroyCachedSprite: function() {
            this._cachedSprite && (this._cachedSprite.texture.destroy(!0), this._cachedSprite = null);
        }
    }, M.DisplayObject.prototype.displayObjectUpdateTransform = M.DisplayObject.prototype.updateTransform, 
    Object.defineProperties(M.DisplayObject.prototype, {
        x: {
            get: function() {
                return this.position.x;
            },
            set: function(t) {
                this.position.x = t;
            }
        },
        y: {
            get: function() {
                return this.position.y;
            },
            set: function(t) {
                this.position.y = t;
            }
        },
        worldVisible: {
            get: function() {
                if (this.visible) {
                    var t = this.parent;
                    if (!t) return this.visible;
                    do {
                        if (!t.visible) return !1;
                        t = t.parent;
                    } while (t);
                    return !0;
                }
                return !1;
            }
        },
        mask: {
            get: function() {
                return this._mask;
            },
            set: function(t) {
                this._mask && (this._mask.isMask = !1), (this._mask = t) && (this._mask.isMask = !0);
            }
        },
        filters: {
            get: function() {
                return this._filters;
            },
            set: function(t) {
                if (Array.isArray(t)) {
                    for (var e = [], i = 0; i < t.length; i++) for (var n = t[i].passes, s = 0; s < n.length; s++) e.push(n[s]);
                    this._filterBlock = {
                        target: this,
                        filterPasses: e
                    };
                }
                this._filters = t, this.blendMode && this.blendMode === M.blendModes.MULTIPLY && (this.blendMode = M.blendModes.NORMAL);
            }
        },
        cacheAsBitmap: {
            get: function() {
                return this._cacheAsBitmap;
            },
            set: function(t) {
                this._cacheAsBitmap !== t && (t ? this._generateCachedSprite() : this._destroyCachedSprite(), 
                this._cacheAsBitmap = t);
            }
        }
    }), M.DisplayObjectContainer = function() {
        M.DisplayObject.call(this), this.children = [], this.ignoreChildInput = !1;
    }, M.DisplayObjectContainer.prototype = Object.create(M.DisplayObject.prototype), 
    M.DisplayObjectContainer.prototype.constructor = M.DisplayObjectContainer, M.DisplayObjectContainer.prototype.addChild = function(t) {
        return this.addChildAt(t, this.children.length);
    }, M.DisplayObjectContainer.prototype.addChildAt = function(t, e) {
        if (0 <= e && e <= this.children.length) return t.parent && t.parent.removeChild(t), 
        (t.parent = this).children.splice(e, 0, t), t;
        throw new Error(t + "addChildAt: The index " + e + " supplied is out of bounds " + this.children.length);
    }, M.DisplayObjectContainer.prototype.swapChildren = function(t, e) {
        if (t !== e) {
            var i = this.getChildIndex(t), n = this.getChildIndex(e);
            if (i < 0 || n < 0) throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");
            this.children[i] = e, this.children[n] = t;
        }
    }, M.DisplayObjectContainer.prototype.getChildIndex = function(t) {
        var e = this.children.indexOf(t);
        if (-1 === e) throw new Error("The supplied DisplayObject must be a child of the caller");
        return e;
    }, M.DisplayObjectContainer.prototype.setChildIndex = function(t, e) {
        if (e < 0 || e >= this.children.length) throw new Error("The supplied index is out of bounds");
        var i = this.getChildIndex(t);
        this.children.splice(i, 1), this.children.splice(e, 0, t);
    }, M.DisplayObjectContainer.prototype.getChildAt = function(t) {
        if (t < 0 || t >= this.children.length) throw new Error("getChildAt: Supplied index " + t + " does not exist in the child list, or the supplied DisplayObject must be a child of the caller");
        return this.children[t];
    }, M.DisplayObjectContainer.prototype.removeChild = function(t) {
        var e = this.children.indexOf(t);
        if (-1 !== e) return this.removeChildAt(e);
    }, M.DisplayObjectContainer.prototype.removeChildAt = function(t) {
        var e = this.getChildAt(t);
        return e && (e.parent = void 0, this.children.splice(t, 1)), e;
    }, M.DisplayObjectContainer.prototype.bringChildToTop = function(t) {
        if (t.parent === this) return this.setChildIndex(t, this.children.length - 1);
    }, M.DisplayObjectContainer.prototype.sendChildToBack = function(t) {
        if (t.parent === this) return this.setChildIndex(t, 0);
    }, M.DisplayObjectContainer.prototype.removeChildren = function(t, e) {
        void 0 === t && (t = 0), void 0 === e && (e = this.children.length);
        var i = e - t;
        if (0 < i && i <= e) {
            for (var n = this.children.splice(t, i), s = 0; s < n.length; s++) {
                n[s].parent = void 0;
            }
            return n;
        }
        if (0 === i && 0 === this.children.length) return [];
        throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range");
    }, M.DisplayObjectContainer.prototype.updateTransform = function() {
        if (this.visible && (this.displayObjectUpdateTransform(), !this._cacheAsBitmap)) for (var t = 0; t < this.children.length; t++) this.children[t].updateTransform();
    }, M.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform = M.DisplayObjectContainer.prototype.updateTransform, 
    M.DisplayObjectContainer.prototype.getBounds = function(t) {
        var e, i = t && t instanceof M.DisplayObject, n = !0;
        if (i ? n = t instanceof M.DisplayObjectContainer && t.contains(this) : t = this, 
        i) {
            var s = t.worldTransform;
            for (t.worldTransform = Phaser.identityMatrix, e = 0; e < t.children.length; e++) t.children[e].updateTransform();
        }
        var o, a, r, h = 1 / 0, l = 1 / 0, c = -1 / 0, u = -1 / 0, d = !1;
        for (e = 0; e < this.children.length; e++) {
            this.children[e].visible && (d = !0, h = h < (o = this.children[e].getBounds()).x ? h : o.x, 
            l = l < o.y ? l : o.y, c = (a = o.width + o.x) < c ? c : a, u = (r = o.height + o.y) < u ? u : r);
        }
        var p = this._bounds;
        if (!d) {
            var g = (p = new M.Rectangle()).x, m = p.width + p.x, f = p.y, y = p.height + p.y, v = this.worldTransform, b = v.a, _ = v.b, S = v.c, x = v.d, w = v.tx, A = v.ty, P = b * m + S * y + w, C = x * y + _ * m + A, T = b * g + S * y + w, E = x * y + _ * g + A, I = b * g + S * f + w, B = x * f + _ * g + A, L = b * m + S * f + w, R = x * f + _ * m + A;
            h = L < (h = I < (h = T < (h = c = P) ? T : h) ? I : h) ? L : h, l = R < (l = B < (l = E < (l = u = C) ? E : l) ? B : l) ? R : l, 
            c = (c = (c = c < T ? T : c) < I ? I : c) < L ? L : c, u = (u = (u = u < E ? E : u) < B ? B : u) < R ? R : u;
        }
        if (p.x = h, p.y = l, p.width = c - h, p.height = u - l, i) for (t.worldTransform = s, 
        e = 0; e < t.children.length; e++) t.children[e].updateTransform();
        if (!n) {
            var O = t.getBounds();
            p.x -= O.x, p.y -= O.y;
        }
        return p;
    }, M.DisplayObjectContainer.prototype.getLocalBounds = function() {
        return this.getBounds(this);
    }, M.DisplayObjectContainer.prototype.contains = function(t) {
        return !!t && (t === this || this.contains(t.parent));
    }, M.DisplayObjectContainer.prototype._renderWebGL = function(t) {
        var e;
        if (this.visible && !(this.alpha <= 0)) if (this._cacheAsBitmap) this._renderCachedSprite(t); else if (this._mask || this._filters) {
            for (this._filters && (t.spriteBatch.flush(), t.filterManager.pushFilter(this._filterBlock)), 
            this._mask && (t.spriteBatch.stop(), t.maskManager.pushMask(this.mask, t), t.spriteBatch.start()), 
            e = 0; e < this.children.length; e++) this.children[e]._renderWebGL(t);
            t.spriteBatch.stop(), this._mask && t.maskManager.popMask(this._mask, t), this._filters && t.filterManager.popFilter(), 
            t.spriteBatch.start();
        } else for (e = 0; e < this.children.length; e++) this.children[e]._renderWebGL(t);
    }, M.DisplayObjectContainer.prototype._renderCanvas = function(t) {
        if (!1 !== this.visible && 0 !== this.alpha) if (this._cacheAsBitmap) this._renderCachedSprite(t); else {
            this._mask && t.maskManager.pushMask(this._mask, t);
            for (var e = 0; e < this.children.length; e++) this.children[e]._renderCanvas(t);
            this._mask && t.maskManager.popMask(t);
        }
    }, Object.defineProperty(M.DisplayObjectContainer.prototype, "width", {
        get: function() {
            return this.getLocalBounds().width * this.scale.x;
        },
        set: function(t) {
            var e = this.getLocalBounds().width;
            this.scale.x = 0 !== e ? t / e : 1, this._width = t;
        }
    }), Object.defineProperty(M.DisplayObjectContainer.prototype, "height", {
        get: function() {
            return this.getLocalBounds().height * this.scale.y;
        },
        set: function(t) {
            var e = this.getLocalBounds().height;
            this.scale.y = 0 !== e ? t / e : 1, this._height = t;
        }
    }), M.Sprite = function(t) {
        M.DisplayObjectContainer.call(this), this.anchor = new M.Point(M.Sprite.defaultAnchor.x, M.Sprite.defaultAnchor.y), 
        this.texture = t || M.Texture.emptyTexture, this._width = 0, this._height = 0, this.tint = 16777215, 
        this.cachedTint = -1, this.tintedTexture = null, this.blendMode = M.blendModes.NORMAL, 
        this.shader = null, this.exists = !0, this.texture.baseTexture.hasLoaded && this.onTextureUpdate(), 
        this.renderable = !0;
    }, M.Sprite.defaultAnchor = {
        x: 0,
        y: 0
    }, M.Sprite.prototype = Object.create(M.DisplayObjectContainer.prototype), M.Sprite.prototype.constructor = M.Sprite, 
    Object.defineProperty(M.Sprite.prototype, "width", {
        get: function() {
            return this.scale.x * this.texture.frame.width;
        },
        set: function(t) {
            this.scale.x = t / this.texture.frame.width, this._width = t;
        }
    }), Object.defineProperty(M.Sprite.prototype, "height", {
        get: function() {
            return this.scale.y * this.texture.frame.height;
        },
        set: function(t) {
            this.scale.y = t / this.texture.frame.height, this._height = t;
        }
    }), M.Sprite.prototype.setTexture = function(t, e) {
        e && this.texture.baseTexture.destroy(), this.texture.baseTexture.skipRender = !1, 
        this.texture = t, this.texture.valid = !0, this.cachedTint = -1;
    }, M.Sprite.prototype.onTextureUpdate = function() {
        this._width && (this.scale.x = this._width / this.texture.frame.width), this._height && (this.scale.y = this._height / this.texture.frame.height);
    }, M.Sprite.prototype.getBounds = function(t) {
        var e = this.texture.frame.width, i = this.texture.frame.height, n = e * (1 - this.anchor.x), s = e * -this.anchor.x, o = i * (1 - this.anchor.y), a = i * -this.anchor.y, r = t || this.worldTransform, h = r.a, l = r.b, c = r.c, u = r.d, d = r.tx, p = r.ty, g = -1 / 0, m = -1 / 0, f = 1 / 0, y = 1 / 0;
        if (0 === l && 0 === c) {
            if (h < 0) {
                h *= -1;
                var v = n;
                n = -s, s = -v;
            }
            if (u < 0) {
                u *= -1;
                v = o;
                o = -a, a = -v;
            }
            f = h * s + d, g = h * n + d, y = u * a + p, m = u * o + p;
        } else {
            var b = h * s + c * a + d, _ = u * a + l * s + p, S = h * n + c * a + d, x = u * a + l * n + p, w = h * n + c * o + d, A = u * o + l * n + p, P = h * s + c * o + d, C = u * o + l * s + p;
            f = P < (f = w < (f = S < (f = b < f ? b : f) ? S : f) ? w : f) ? P : f, y = C < (y = A < (y = x < (y = _ < y ? _ : y) ? x : y) ? A : y) ? C : y, 
            g = (g = (g = (g = g < b ? b : g) < S ? S : g) < w ? w : g) < P ? P : g, m = (m = (m = (m = m < _ ? _ : m) < x ? x : m) < A ? A : m) < C ? C : m;
        }
        var T = this._bounds;
        return T.x = f, T.width = g - f, T.y = y, T.height = m - y, this._currentBounds = T;
    }, M.Sprite.prototype.getLocalBounds = function() {
        var t = this.worldTransform;
        this.worldTransform = Phaser.identityMatrix;
        for (var e = 0; e < this.children.length; e++) this.children[e].updateTransform();
        var i = this.getBounds();
        for (this.worldTransform = t, e = 0; e < this.children.length; e++) this.children[e].updateTransform();
        return i;
    }, M.Sprite.prototype._renderWebGL = function(t, e) {
        if (this.visible && !(this.alpha <= 0) && this.renderable) {
            var i = this.worldTransform;
            if (e && (i = e), this._mask || this._filters) {
                var n = t.spriteBatch;
                this._filters && (n.flush(), t.filterManager.pushFilter(this._filterBlock)), this._mask && (n.stop(), 
                t.maskManager.pushMask(this.mask, t), n.start()), n.render(this);
                for (var s = 0; s < this.children.length; s++) this.children[s]._renderWebGL(t);
                n.stop(), this._mask && t.maskManager.popMask(this._mask, t), this._filters && t.filterManager.popFilter(), 
                n.start();
            } else {
                t.spriteBatch.render(this);
                for (s = 0; s < this.children.length; s++) this.children[s]._renderWebGL(t, i);
            }
        }
    }, M.Sprite.prototype._renderCanvas = function(t, e) {
        if (!(!this.visible || 0 === this.alpha || !this.renderable || this.texture.crop.width < 1 || this.texture.crop.height < 1)) {
            var i = this.worldTransform;
            if (e && (i = e), this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode, 
            t.context.globalCompositeOperation = M.blendModesCanvas[t.currentBlendMode]), this._mask && t.maskManager.pushMask(this._mask, t), 
            this.texture.valid) {
                var n = this.texture.baseTexture.resolution / t.resolution;
                t.context.globalAlpha = this.worldAlpha, t.smoothProperty && t.scaleMode !== this.texture.baseTexture.scaleMode && (t.scaleMode = this.texture.baseTexture.scaleMode, 
                t.context[t.smoothProperty] = t.scaleMode === M.scaleModes.LINEAR);
                var s = this.texture.trim ? this.texture.trim.x - this.anchor.x * this.texture.trim.width : this.anchor.x * -this.texture.frame.width, o = this.texture.trim ? this.texture.trim.y - this.anchor.y * this.texture.trim.height : this.anchor.y * -this.texture.frame.height, a = i.tx * t.resolution + t.shakeX, r = i.ty * t.resolution + t.shakeY, h = this.texture.crop.width, l = this.texture.crop.height;
                if (this.texture.rotated) {
                    var c = i.a, u = i.b, d = i.c, p = i.d, g = h;
                    a = i.c * l + a, r = i.d * l + r, i.a = 6123233995736766e-32 * c - d, i.b = 6123233995736766e-32 * u - p, 
                    i.c = c + 6123233995736766e-32 * d, i.d = u + 6123233995736766e-32 * p, h = l, l = g;
                }
                if (t.roundPixels ? (t.context.setTransform(i.a, i.b, i.c, i.d, 0 | a, 0 | r), s |= 0, 
                o |= 0) : t.context.setTransform(i.a, i.b, i.c, i.d, a, r), s /= n, o /= n, l |= 0, 
                (h |= 0) && l) {
                    if (16777215 !== this.tint) (this.texture.requiresReTint || this.cachedTint !== this.tint) && (this.tintedTexture = M.CanvasTinter.getTintedTexture(this, this.tint), 
                    this.cachedTint = this.tint, this.texture.requiresReTint = !1), t.context.drawImage(this.tintedTexture, 0, 0, h, l, s, o, h / n, l / n); else {
                        var m = this.texture.crop.x, f = this.texture.crop.y;
                        t.context.drawImage(this.texture.baseTexture.source, m, f, h, l, s, o, h / n, l / n);
                    }
                    for (y = 0; y < this.children.length; y++) this.children[y]._renderCanvas(t);
                    this._mask && t.maskManager.popMask(t);
                }
            } else {
                for (var y = 0; y < this.children.length; y++) this.children[y]._renderCanvas(t);
                this._mask && t.maskManager.popMask(t);
            }
        }
    }, M.initDefaultShaders = function() {}, M.CompileVertexShader = function(t, e) {
        return M._CompileShader(t, e, t.VERTEX_SHADER);
    }, M.CompileFragmentShader = function(t, e) {
        return M._CompileShader(t, e, t.FRAGMENT_SHADER);
    }, M._CompileShader = function(t, e, i) {
        var n = e;
        Array.isArray(e) && (n = e.join("\n"));
        var s = t.createShader(i);
        return t.shaderSource(s, n), t.compileShader(s), t.getShaderParameter(s, t.COMPILE_STATUS) ? s : (window.console.log(t.getShaderInfoLog(s)), 
        null);
    }, M.compileProgram = function(t, e, i) {
        var n = M.CompileFragmentShader(t, i), s = M.CompileVertexShader(t, e), o = t.createProgram();
        return t.attachShader(o, s), t.attachShader(o, n), t.linkProgram(o), t.getProgramParameter(o, t.LINK_STATUS) || (window.console.log(t.getProgramInfoLog(o)), 
        window.console.log("Could not initialise shaders")), o;
    }, M.PixiShader = function(t) {
        this._UID = Phaser._UID++, this.gl = t, this.program = null, this.fragmentSrc = null, 
        this.textureCount = 0, this.firstRun = !0, this.dirty = !0, this.attributes = [], 
        this.init();
    }, M.PixiShader.prototype.constructor = M.PixiShader, M.PixiShader.prototype.initMultitexShader = function() {
        var t = this.gl;
        this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);
        for (var e = "\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n", i = 1; i < this.MAX_TEXTURES; ++i) e += "\tif (vTextureIndex == " + i + ".0) {gl_FragColor = texture2D(uSamplerArray[" + i + "], vTextureCoord) * vColor;return;}\n";
        this.fragmentSrc = [ "// PixiShader Fragment Shader.", "precision lowp float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) { gl_FragColor = BLUE;return;}", "   if(isnan(vTextureIndex)) { gl_FragColor = RED;return;}", "}" ];
        var n = M.compileProgram(t, this.vertexSrc || M.PixiShader.defaultVertexSrc, this.fragmentSrc);
        t.useProgram(n), this.uSamplerArray = t.getUniformLocation(n, "uSamplerArray[0]"), 
        this.projectionVector = t.getUniformLocation(n, "projectionVector"), this.offsetVector = t.getUniformLocation(n, "offsetVector"), 
        this.dimensions = t.getUniformLocation(n, "dimensions"), this.aVertexPosition = t.getAttribLocation(n, "aVertexPosition"), 
        this.aTextureCoord = t.getAttribLocation(n, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(n, "aColor"), 
        this.aTextureIndex = t.getAttribLocation(n, "aTextureIndex");
        var s = [], o = t.createTexture();
        t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, o), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null);
        for (var a = 0; a < this.MAX_TEXTURES; ++a) t.activeTexture(t.TEXTURE0 + a), t.bindTexture(t.TEXTURE_2D, o), 
        s.push(a);
        for (var r in t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSamplerArray, s), 
        -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [ this.aVertexPosition, this.aTextureCoord, this.colorAttribute, this.aTextureIndex ], 
        this.uniforms) this.uniforms[r].uniformLocation = t.getUniformLocation(n, r);
        this.initUniforms(), this.program = n;
    }, M.PixiShader.prototype.initDefaultShader = function() {
        null === this.fragmentSrc && (this.fragmentSrc = [ "precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}" ]);
        var t = this.gl, e = M.compileProgram(t, this.vertexSrc || M.PixiShader.defaultVertexSrc, this.fragmentSrc);
        for (var i in t.useProgram(e), this.uSampler = t.getUniformLocation(e, "uSampler"), 
        this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), 
        this.dimensions = t.getUniformLocation(e, "dimensions"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), 
        this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(e, "aColor"), 
        this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), -1 === this.colorAttribute && (this.colorAttribute = 2), 
        this.attributes = [ this.aVertexPosition, this.aTextureCoord, this.colorAttribute, this.aTextureIndex ], 
        this.uniforms) this.uniforms[i].uniformLocation = t.getUniformLocation(e, i);
        this.initUniforms(), this.program = e;
    }, M.PixiShader.prototype.init = function(t) {
        M._enableMultiTextureToggle && !t ? this.initMultitexShader() : this.initDefaultShader();
    }, M.PixiShader.prototype.initUniforms = function() {
        this.textureCount = 1;
        var t, e = this.gl;
        for (var i in this.uniforms) {
            var n = (t = this.uniforms[i]).type;
            "sampler2D" === n ? (t._init = !1, null !== t.value && this.initSampler2D(t)) : "mat2" === n || "mat3" === n || "mat4" === n ? (t.glMatrix = !0, 
            t.glValueLength = 1, "mat2" === n ? t.glFunc = e.uniformMatrix2fv : "mat3" === n ? t.glFunc = e.uniformMatrix3fv : "mat4" === n && (t.glFunc = e.uniformMatrix4fv)) : (t.glFunc = e["uniform" + n], 
            t.glValueLength = "2f" === n || "2i" === n ? 2 : "3f" === n || "3i" === n ? 3 : "4f" === n || "4i" === n ? 4 : 1);
        }
    }, M.PixiShader.prototype.initSampler2D = function(t) {
        if (t.value && t.value.baseTexture && t.value.baseTexture.hasLoaded) {
            var e = this.gl;
            if (e.activeTexture(e.TEXTURE0 + this.textureCount), e.bindTexture(e.TEXTURE_2D, t.value.baseTexture._glTextures[e.id]), 
            t.textureData) {
                var i = t.textureData, n = i.magFilter ? i.magFilter : e.LINEAR, s = i.minFilter ? i.minFilter : e.LINEAR, o = i.wrapS ? i.wrapS : e.CLAMP_TO_EDGE, a = i.wrapT ? i.wrapT : e.CLAMP_TO_EDGE, r = i.luminance ? e.LUMINANCE : e.RGBA;
                if (i.repeat && (o = e.REPEAT, a = e.REPEAT), e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, !!i.flipY), 
                i.width) {
                    var h = i.width ? i.width : 512, l = i.height ? i.height : 2, c = i.border ? i.border : 0;
                    e.texImage2D(e.TEXTURE_2D, 0, r, h, l, c, r, e.UNSIGNED_BYTE, null);
                } else e.texImage2D(e.TEXTURE_2D, 0, r, e.RGBA, e.UNSIGNED_BYTE, t.value.baseTexture.source);
                e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, n), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, s), 
                e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, o), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, a);
            }
            e.uniform1i(t.uniformLocation, this.textureCount), t._init = !0, this.textureCount++;
        }
    }, M.PixiShader.prototype.syncUniforms = function() {
        var t;
        this.textureCount = 1;
        var e = this.gl;
        for (var i in this.uniforms) 1 === (t = this.uniforms[i]).glValueLength ? !0 === t.glMatrix ? t.glFunc.call(e, t.uniformLocation, t.transpose, t.value) : t.glFunc.call(e, t.uniformLocation, t.value) : 2 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y) : 3 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y, t.value.z) : 4 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y, t.value.z, t.value.w) : "sampler2D" === t.type && (t._init ? (e.activeTexture(e["TEXTURE" + this.textureCount]), 
        t.value.baseTexture._dirty[e.id] ? M.instances[e.id].updateTexture(t.value.baseTexture) : e.bindTexture(e.TEXTURE_2D, t.value.baseTexture._glTextures[e.id]), 
        e.uniform1i(t.uniformLocation, this.textureCount), this.textureCount++) : this.initSampler2D(t));
    }, M.PixiShader.prototype.destroy = function() {
        this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null;
    }, M.PixiShader.defaultVertexSrc = [ "// PixiShader Vertex Shader", "// With multi-texture rendering", "attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute vec4 aColor;", "attribute float aTextureIndex;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   if (aTextureIndex > 0.0) gl_Position = vec4(0.0);", "   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vColor = vec4(aColor.rgb * aColor.a, aColor.a);", "   vTextureIndex = aTextureIndex;", "}" ], 
    M.PixiFastShader = function(t) {
        if (this._UID = Phaser._UID++, this.gl = t, this.program = null, M._enableMultiTextureToggle) {
            t = this.gl;
            this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);
            for (var e = "\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n", i = 1; i < this.MAX_TEXTURES; ++i) e += "\tif (vTextureIndex == " + i + ".0) { gl_FragColor = texture2D(uSamplerArray[" + i + "], vTextureCoord) * vColor;return;}\n";
            this.fragmentSrc = [ "// PixiFastShader Fragment Shader.", "precision lowp float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) { gl_FragColor = BLUE;return;}", "   if(isnan(vTextureIndex)) {gl_FragColor = RED;return;}", "}" ];
        } else this.fragmentSrc = [ "// PixiFastShader Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;", "}" ];
        this.vertexSrc = [ "// PixiFastShader Vertex Shader.", "attribute vec2 aVertexPosition;", "attribute vec2 aPositionCoord;", "attribute vec2 aScale;", "attribute float aRotation;", "attribute vec2 aTextureCoord;", "attribute float aColor;", "attribute float aTextureIndex;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform mat3 uMatrix;", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   vec2 v;", "   vec2 sv = aVertexPosition * aScale;", "   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);", "   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);", "   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;", "   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vTextureIndex = aTextureIndex;", "   vColor = aColor;", "}" ], 
        this.textureCount = 0, this.init();
    }, M.PixiFastShader.prototype.constructor = M.PixiFastShader, M.PixiFastShader.prototype.init = function() {
        var t = this.gl, e = M.compileProgram(t, this.vertexSrc, this.fragmentSrc);
        if (t.useProgram(e), this.uSampler = M._enableMultiTextureToggle ? t.getUniformLocation(e, "uSamplerArray[0]") : t.getUniformLocation(e, "uSampler"), 
        M._enableMultiTextureToggle) {
            var i = [], n = t.createTexture();
            t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, n), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null);
            for (var s = 0; s < this.MAX_TEXTURES; ++s) t.activeTexture(t.TEXTURE0 + s), t.bindTexture(t.TEXTURE_2D, n), 
            i.push(s);
            t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSampler, i);
        }
        this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), 
        this.dimensions = t.getUniformLocation(e, "dimensions"), this.uMatrix = t.getUniformLocation(e, "uMatrix"), 
        this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aPositionCoord = t.getAttribLocation(e, "aPositionCoord"), 
        this.aScale = t.getAttribLocation(e, "aScale"), this.aRotation = t.getAttribLocation(e, "aRotation"), 
        this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(e, "aColor"), 
        this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), -1 === this.colorAttribute && (this.colorAttribute = 2), 
        this.attributes = [ this.aVertexPosition, this.aPositionCoord, this.aScale, this.aRotation, this.aTextureCoord, this.colorAttribute, this.aTextureIndex ], 
        this.program = e;
    }, M.PixiFastShader.prototype.destroy = function() {
        this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null;
    }, M.StripShader = function(t) {
        if (this._UID = Phaser._UID++, this.gl = t, this.program = null, M._enableMultiTextureToggle) {
            t = this.gl;
            this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);
            for (var e = "\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord);return;}\n", i = 1; i < this.MAX_TEXTURES; ++i) e += "\tif (vTextureIndex == " + i + ".0) { gl_FragColor = texture2D(uSamplerArray[" + i + "], vTextureCoord) ;return;}\n";
            this.fragmentSrc = [ "//StripShader Fragment Shader.", "precision mediump float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "uniform float alpha;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) { gl_FragColor = BLUE;return;}", "   if(isnan(vTextureIndex)) {gl_FragColor = RED;return;}", "}" ];
        } else this.fragmentSrc = [ "//StripShader Fragment Shader.", "precision mediump float;", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "uniform float alpha;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord);", "}" ];
        this.vertexSrc = [ "//StripShader Vertex Shader.", "attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute float aTextureIndex;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vTextureIndex = aTextureIndex;", "}" ], 
        this.init();
    }, M.StripShader.prototype.constructor = M.StripShader, M.StripShader.prototype.init = function() {
        var t = this.gl, e = M.compileProgram(t, this.vertexSrc, this.fragmentSrc);
        if (t.useProgram(e), this.uSampler = M._enableMultiTextureToggle ? t.getUniformLocation(e, "uSamplerArray[0]") : t.getUniformLocation(e, "uSampler"), 
        M._enableMultiTextureToggle) {
            var i = [], n = t.createTexture();
            t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, n), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null);
            for (var s = 0; s < this.MAX_TEXTURES; ++s) t.activeTexture(t.TEXTURE0 + s), t.bindTexture(t.TEXTURE_2D, n), 
            i.push(s);
            t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSampler, i);
        }
        this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), 
        this.colorAttribute = t.getAttribLocation(e, "aColor"), this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), 
        this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), 
        this.attributes = [ this.aVertexPosition, this.aTextureCoord, this.aTextureIndex ], 
        this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), 
        this.program = e;
    }, M.StripShader.prototype.destroy = function() {
        this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null;
    }, M.PrimitiveShader = function(t) {
        this._UID = Phaser._UID++, this.gl = t, this.program = null, this.fragmentSrc = [ "precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}" ], 
        this.vertexSrc = [ "attribute vec2 aVertexPosition;", "attribute vec4 aColor;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform float alpha;", "uniform float flipY;", "uniform vec3 tint;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = aColor * vec4(tint * alpha, alpha);", "}" ], 
        this.init();
    }, M.PrimitiveShader.prototype.constructor = M.PrimitiveShader, M.PrimitiveShader.prototype.init = function() {
        var t = this.gl, e = M.compileProgram(t, this.vertexSrc, this.fragmentSrc);
        t.useProgram(e), this.projectionVector = t.getUniformLocation(e, "projectionVector"), 
        this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.tintColor = t.getUniformLocation(e, "tint"), 
        this.flipY = t.getUniformLocation(e, "flipY"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), 
        this.colorAttribute = t.getAttribLocation(e, "aColor"), this.attributes = [ this.aVertexPosition, this.colorAttribute ], 
        this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), 
        this.program = e;
    }, M.PrimitiveShader.prototype.destroy = function() {
        this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null;
    }, M.ComplexPrimitiveShader = function(t) {
        this._UID = Phaser._UID++, this.gl = t, this.program = null, this.fragmentSrc = [ "precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}" ], 
        this.vertexSrc = [ "attribute vec2 aVertexPosition;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform vec3 tint;", "uniform float alpha;", "uniform vec3 color;", "uniform float flipY;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = vec4(color * alpha * tint, alpha);", "}" ], 
        this.init();
    }, M.ComplexPrimitiveShader.prototype.constructor = M.ComplexPrimitiveShader, M.ComplexPrimitiveShader.prototype.init = function() {
        var t = this.gl, e = M.compileProgram(t, this.vertexSrc, this.fragmentSrc);
        t.useProgram(e), this.projectionVector = t.getUniformLocation(e, "projectionVector"), 
        this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.tintColor = t.getUniformLocation(e, "tint"), 
        this.color = t.getUniformLocation(e, "color"), this.flipY = t.getUniformLocation(e, "flipY"), 
        this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.attributes = [ this.aVertexPosition, this.colorAttribute ], 
        this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), 
        this.program = e;
    }, M.ComplexPrimitiveShader.prototype.destroy = function() {
        this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null;
    }, M.glContexts = [], M.instances = [], M._enableMultiTextureToggle = !1, M.WebGLRenderer = function(t, e) {
        this.game = t, M.defaultRenderer || (M.defaultRenderer = this), this.extensions = {}, 
        this.type = Phaser.WEBGL, this.resolution = t.resolution, this.transparent = t.transparent, 
        this.autoResize = !1, this.preserveDrawingBuffer = t.preserveDrawingBuffer, this.clearBeforeRender = t.clearBeforeRender, 
        this.width = t.width, this.height = t.height, this.view = t.canvas, this._contextOptions = {
            alpha: this.transparent,
            antialias: t.antialias,
            failIfMajorPerformanceCaveat: e.failIfMajorPerformanceCaveat,
            premultipliedAlpha: this.transparent && "notMultiplied" !== this.transparent,
            stencil: !0,
            preserveDrawingBuffer: this.preserveDrawingBuffer
        }, this.projection = new M.Point(), this.offset = new M.Point(), this.shaderManager = new M.WebGLShaderManager(), 
        this.spriteBatch = new M.WebGLSpriteBatch(t), this.maskManager = new M.WebGLMaskManager(), 
        this.filterManager = new M.WebGLFilterManager(), this.stencilManager = new M.WebGLStencilManager(), 
        this.blendModeManager = new M.WebGLBlendModeManager(), this.renderSession = {}, 
        this.currentBatchedTextures = [], this.renderSession.game = this.game, this.renderSession.gl = this.gl, 
        this.renderSession.drawCount = 0, this.renderSession.shaderManager = this.shaderManager, 
        this.renderSession.maskManager = this.maskManager, this.renderSession.filterManager = this.filterManager, 
        this.renderSession.blendModeManager = this.blendModeManager, this.renderSession.spriteBatch = this.spriteBatch, 
        this.renderSession.stencilManager = this.stencilManager, (this.renderSession.renderer = this).renderSession.resolution = this.resolution, 
        this.renderSession.roundPixels = e.roundPixels || !1, this.renderSession.maxTextureAvailableSpace = null, 
        this.initContext(), this.mapBlendModes();
    }, M.WebGLRenderer.prototype.constructor = M.WebGLRenderer, M.WebGLRenderer.prototype.initContext = function() {
        var t = this.view.getContext("webgl", this._contextOptions) || this.view.getContext("experimental-webgl", this._contextOptions);
        if (!(this.gl = t)) throw new Error("This browser does not support webGL. Try using the canvas renderer");
        this.maxTextures = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS), this.maxTextureSize = this.gl.getParameter(t.MAX_TEXTURE_SIZE), 
        this.glContextId = t.id = M.WebGLRenderer.glContextId++, M.glContexts[this.glContextId] = t, 
        M.instances[this.glContextId] = this, t.disable(t.DEPTH_TEST), t.disable(t.CULL_FACE), 
        t.enable(t.BLEND), this.shaderManager.setContext(t), this.spriteBatch.setContext(t), 
        this.maskManager.setContext(t), this.filterManager.setContext(t), this.blendModeManager.setContext(t), 
        this.stencilManager.setContext(t), this.renderSession.gl = this.gl, this.resize(this.width, this.height), 
        this.extensions.compression = {};
        var e = t.getExtension("WEBGL_compressed_texture_etc1") || t.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"), i = t.getExtension("WEBGL_compressed_texture_pvrtc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"), n = t.getExtension("WEBGL_compressed_texture_s3tc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
        e && (this.extensions.compression.ETC1 = e), i && (this.extensions.compression.PVRTC = i), 
        n && (this.extensions.compression.S3TC = n);
    }, M.WebGLRenderer.prototype.setTexturePriority = function(t) {
        if (M._enableMultiTextureToggle) {
            for (var e = function(t) {
                return --t, t |= t >> 1, t |= t >> 2, t |= t >> 4, t |= t >> 8, t |= t >> 16, ++t;
            }, i = this.gl, n = i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS), s = i.getParameter(i.MAX_TEXTURE_SIZE), o = this.game.cache._cache.image, a = null, r = 0; r < this.currentBatchedTextures.length; r++) (a = this.currentBatchedTextures[r]) in o && (o[a].base.textureIndex = 0);
            for (var h = s - e(Math.max(this.width, this.height)), l = this.currentBatchedTextures.length = 0; l < t.length; ++l) if ((a = t[l]) in o) {
                var c = o[a].base;
                h -= e(Math.max(c.width, c.height)), c.textureIndex = h <= 0 ? 0 : 1 + l % (n - 1), 
                this.currentBatchedTextures.push(a);
            }
            return this.renderSession.maxTextureAvailableSpace = h, this.currentBatchedTextures;
        }
    }, M.WebGLRenderer.prototype.render = function(t) {
        if (!this.contextLost) {
            var e = this.gl;
            e.viewport(0, 0, this.width, this.height), e.bindFramebuffer(e.FRAMEBUFFER, null), 
            this.game.clearBeforeRender && (e.clearColor(t._bgColor.r, t._bgColor.g, t._bgColor.b, t._bgColor.a), 
            e.clear(e.COLOR_BUFFER_BIT)), this.offset.x = this.game.camera._shake.x, this.offset.y = this.game.camera._shake.y, 
            this.renderDisplayObject(t, this.projection);
        }
    }, M.WebGLRenderer.prototype.renderDisplayObject = function(t, e, i, n) {
        this.renderSession.blendModeManager.setBlendMode(M.blendModes.NORMAL), this.renderSession.drawCount = 0, 
        this.renderSession.flipY = i ? -1 : 1, this.renderSession.projection = e, this.renderSession.offset = this.offset, 
        this.spriteBatch.begin(this.renderSession), this.filterManager.begin(this.renderSession, i), 
        t._renderWebGL(this.renderSession, n), this.spriteBatch.end();
    }, M.WebGLRenderer.prototype.resize = function(t, e) {
        this.width = t * this.resolution, this.height = e * this.resolution, this.view.width = this.width, 
        this.view.height = this.height, this.autoResize && (this.view.style.width = this.width / this.resolution + "px", 
        this.view.style.height = this.height / this.resolution + "px"), this.gl.viewport(0, 0, this.width, this.height), 
        this.projection.x = this.width / 2 / this.resolution, this.projection.y = -this.height / 2 / this.resolution;
    }, M.WebGLRenderer.prototype.updateCompressedTexture = function(t) {
        if (!t.hasLoaded) return !1;
        var e = this.gl, i = t.source;
        return t._glTextures[e.id] || (t._glTextures[e.id] = e.createTexture()), e.activeTexture(e.TEXTURE0 + t.textureIndex), 
        e.bindTexture(e.TEXTURE_2D, t._glTextures[e.id]), e.compressedTexImage2D(e.TEXTURE_2D, 0, i.glExtensionFormat, i.width, i.height, 0, i.textureData), 
        e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, t.scaleMode === M.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), 
        t.mipmap && Phaser.Math.isPowerOfTwo(t.width, t.height) ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === M.scaleModes.LINEAR ? e.LINEAR_MIPMAP_LINEAR : e.NEAREST_MIPMAP_NEAREST), 
        e.generateMipmap(e.TEXTURE_2D)) : e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === M.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), 
        t._powerOf2 ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT)) : (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), 
        e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE)), !(t._dirty[e.id] = !1);
    }, M.WebGLRenderer.prototype.updateTexture = function(t) {
        if (!t.hasLoaded || !t.source) return !1;
        if (t.source.compressionAlgorithm) return this.updateCompressedTexture(t);
        var e = this.gl;
        return t._glTextures[e.id] || (t._glTextures[e.id] = e.createTexture()), e.activeTexture(e.TEXTURE0 + t.textureIndex), 
        e.bindTexture(e.TEXTURE_2D, t._glTextures[e.id]), e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t.premultipliedAlpha), 
        e.texImage2D(e.TEXTURE_2D, 0, e.RGBA, e.RGBA, e.UNSIGNED_BYTE, t.source), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, t.scaleMode === M.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), 
        t.mipmap && Phaser.Math.isPowerOfTwo(t.width, t.height) ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === M.scaleModes.LINEAR ? e.LINEAR_MIPMAP_LINEAR : e.NEAREST_MIPMAP_NEAREST), 
        e.generateMipmap(e.TEXTURE_2D)) : e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === M.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), 
        t._powerOf2 ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT)) : (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), 
        e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE)), !(t._dirty[e.id] = !1);
    }, M.WebGLRenderer.prototype.destroy = function() {
        M.glContexts[this.glContextId] = null, this.projection = null, this.offset = null, 
        this.shaderManager.destroy(), this.spriteBatch.destroy(), this.maskManager.destroy(), 
        this.filterManager.destroy(), this.shaderManager = null, this.spriteBatch = null, 
        this.maskManager = null, this.filterManager = null, this.gl = null, this.renderSession = null, 
        Phaser.CanvasPool.remove(this), M.instances[this.glContextId] = null, M.WebGLRenderer.glContextId--;
    }, M.WebGLRenderer.prototype.mapBlendModes = function() {
        var t = this.gl;
        if (!M.blendModesWebGL) {
            var e = [], i = M.blendModes;
            e[i.NORMAL] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], e[i.ADD] = [ t.SRC_ALPHA, t.DST_ALPHA ], 
            e[i.MULTIPLY] = [ t.DST_COLOR, t.ONE_MINUS_SRC_ALPHA ], e[i.SCREEN] = [ t.SRC_ALPHA, t.ONE ], 
            e[i.OVERLAY] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], e[i.DARKEN] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], 
            e[i.LIGHTEN] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], e[i.COLOR_DODGE] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], 
            e[i.COLOR_BURN] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], e[i.HARD_LIGHT] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], 
            e[i.SOFT_LIGHT] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], e[i.DIFFERENCE] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], 
            e[i.EXCLUSION] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], e[i.HUE] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], 
            e[i.SATURATION] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], e[i.COLOR] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], 
            e[i.LUMINOSITY] = [ t.ONE, t.ONE_MINUS_SRC_ALPHA ], M.blendModesWebGL = e;
        }
    }, M.WebGLRenderer.prototype.getMaxTextureUnit = function() {
        var t = this.gl;
        return t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);
    }, M.enableMultiTexture = function() {
        M._enableMultiTextureToggle = !0;
    }, M.WebGLRenderer.glContextId = 0, M.WebGLRenderer.textureArray = [], M.WebGLBlendModeManager = function() {
        this.currentBlendMode = 99999;
    }, M.WebGLBlendModeManager.prototype.constructor = M.WebGLBlendModeManager, M.WebGLBlendModeManager.prototype.setContext = function(t) {
        this.gl = t;
    }, M.WebGLBlendModeManager.prototype.setBlendMode = function(t) {
        if (this.currentBlendMode === t) return !1;
        this.currentBlendMode = t;
        var e = M.blendModesWebGL[this.currentBlendMode];
        return e && this.gl.blendFunc(e[0], e[1]), !0;
    }, M.WebGLBlendModeManager.prototype.destroy = function() {
        this.gl = null;
    }, M.WebGLMaskManager = function() {}, M.WebGLMaskManager.prototype.constructor = M.WebGLMaskManager, 
    M.WebGLMaskManager.prototype.setContext = function(t) {
        this.gl = t;
    }, M.WebGLMaskManager.prototype.pushMask = function(t, e) {
        var i = e.gl;
        t.dirty && M.WebGLGraphics.updateGraphics(t, i), void 0 !== t._webGL[i.id] && void 0 !== t._webGL[i.id].data && 0 !== t._webGL[i.id].data.length && e.stencilManager.pushStencil(t, t._webGL[i.id].data[0], e);
    }, M.WebGLMaskManager.prototype.popMask = function(t, e) {
        var i = this.gl;
        void 0 !== t._webGL[i.id] && void 0 !== t._webGL[i.id].data && 0 !== t._webGL[i.id].data.length && e.stencilManager.popStencil(t, t._webGL[i.id].data[0], e);
    }, M.WebGLMaskManager.prototype.destroy = function() {
        this.gl = null;
    }, M.WebGLStencilManager = function() {
        this.stencilStack = [], this.reverse = !0, this.count = 0;
    }, M.WebGLStencilManager.prototype.setContext = function(t) {
        this.gl = t;
    }, M.WebGLStencilManager.prototype.pushStencil = function(t, e, i) {
        var n = this.gl;
        this.bindGraphics(t, e, i), 0 === this.stencilStack.length && (n.enable(n.STENCIL_TEST), 
        n.clear(n.STENCIL_BUFFER_BIT), this.reverse = !0, this.count = 0), this.stencilStack.push(e);
        var s = this.count;
        n.colorMask(!1, !1, !1, !1), n.stencilFunc(n.ALWAYS, 0, 255), n.stencilOp(n.KEEP, n.KEEP, n.INVERT), 
        1 === e.mode ? (n.drawElements(n.TRIANGLE_FAN, e.indices.length - 4, n.UNSIGNED_SHORT, 0), 
        this.reverse ? (n.stencilFunc(n.EQUAL, 255 - s, 255), n.stencilOp(n.KEEP, n.KEEP, n.DECR)) : (n.stencilFunc(n.EQUAL, s, 255), 
        n.stencilOp(n.KEEP, n.KEEP, n.INCR)), n.drawElements(n.TRIANGLE_FAN, 4, n.UNSIGNED_SHORT, 2 * (e.indices.length - 4)), 
        this.reverse ? n.stencilFunc(n.EQUAL, 255 - (s + 1), 255) : n.stencilFunc(n.EQUAL, s + 1, 255), 
        this.reverse = !this.reverse) : (this.reverse ? (n.stencilFunc(n.EQUAL, s, 255), 
        n.stencilOp(n.KEEP, n.KEEP, n.INCR)) : (n.stencilFunc(n.EQUAL, 255 - s, 255), n.stencilOp(n.KEEP, n.KEEP, n.DECR)), 
        n.drawElements(n.TRIANGLE_STRIP, e.indices.length, n.UNSIGNED_SHORT, 0), this.reverse ? n.stencilFunc(n.EQUAL, s + 1, 255) : n.stencilFunc(n.EQUAL, 255 - (s + 1), 255)), 
        n.colorMask(!0, !0, !0, !0), n.stencilOp(n.KEEP, n.KEEP, n.KEEP), this.count++;
    }, M.WebGLStencilManager.prototype.bindGraphics = function(t, e, i) {
        this._currentGraphics = t;
        var n, s = this.gl, o = i.projection, a = i.offset;
        1 === e.mode ? (n = i.shaderManager.complexPrimitiveShader, i.shaderManager.setShader(n), 
        s.uniform1f(n.flipY, i.flipY), s.uniformMatrix3fv(n.translationMatrix, !1, t.worldTransform.toArray(!0)), 
        s.uniform2f(n.projectionVector, o.x, -o.y), s.uniform2f(n.offsetVector, -a.x, -a.y), 
        s.uniform3fv(n.tintColor, Phaser.Color.hexToRGBArray(t.tint)), s.uniform3fv(n.color, e.color), 
        s.uniform1f(n.alpha, t.worldAlpha * e.alpha), s.bindBuffer(s.ARRAY_BUFFER, e.buffer), 
        s.vertexAttribPointer(n.aVertexPosition, 2, s.FLOAT, !1, 8, 0)) : (n = i.shaderManager.primitiveShader, 
        i.shaderManager.setShader(n), s.uniformMatrix3fv(n.translationMatrix, !1, t.worldTransform.toArray(!0)), 
        s.uniform1f(n.flipY, i.flipY), s.uniform2f(n.projectionVector, o.x, -o.y), s.uniform2f(n.offsetVector, -a.x, -a.y), 
        s.uniform3fv(n.tintColor, Phaser.Color.hexToRGBArray(t.tint)), s.uniform1f(n.alpha, t.worldAlpha), 
        s.bindBuffer(s.ARRAY_BUFFER, e.buffer), s.vertexAttribPointer(n.aVertexPosition, 2, s.FLOAT, !1, 24, 0), 
        s.vertexAttribPointer(n.colorAttribute, 4, s.FLOAT, !1, 24, 8)), s.bindBuffer(s.ELEMENT_ARRAY_BUFFER, e.indexBuffer);
    }, M.WebGLStencilManager.prototype.popStencil = function(t, e, i) {
        var n = this.gl;
        if (this.stencilStack.pop(), this.count--, 0 === this.stencilStack.length) n.disable(n.STENCIL_TEST); else {
            var s = this.count;
            this.bindGraphics(t, e, i), n.colorMask(!1, !1, !1, !1), 1 === e.mode ? (this.reverse = !this.reverse, 
            this.reverse ? (n.stencilFunc(n.EQUAL, 255 - (s + 1), 255), n.stencilOp(n.KEEP, n.KEEP, n.INCR)) : (n.stencilFunc(n.EQUAL, s + 1, 255), 
            n.stencilOp(n.KEEP, n.KEEP, n.DECR)), n.drawElements(n.TRIANGLE_FAN, 4, n.UNSIGNED_SHORT, 2 * (e.indices.length - 4)), 
            n.stencilFunc(n.ALWAYS, 0, 255), n.stencilOp(n.KEEP, n.KEEP, n.INVERT), n.drawElements(n.TRIANGLE_FAN, e.indices.length - 4, n.UNSIGNED_SHORT, 0)) : (this.reverse ? (n.stencilFunc(n.EQUAL, s + 1, 255), 
            n.stencilOp(n.KEEP, n.KEEP, n.DECR)) : (n.stencilFunc(n.EQUAL, 255 - (s + 1), 255), 
            n.stencilOp(n.KEEP, n.KEEP, n.INCR)), n.drawElements(n.TRIANGLE_STRIP, e.indices.length, n.UNSIGNED_SHORT, 0)), 
            this.reverse ? n.stencilFunc(n.EQUAL, s, 255) : n.stencilFunc(n.EQUAL, 255 - s, 255), 
            n.colorMask(!0, !0, !0, !0), n.stencilOp(n.KEEP, n.KEEP, n.KEEP);
        }
    }, M.WebGLStencilManager.prototype.destroy = function() {
        this.stencilStack = null, this.gl = null;
    }, M.WebGLShaderManager = function() {
        this.maxAttibs = 10, this.attribState = [], this.tempAttribState = [];
        for (var t = 0; t < this.maxAttibs; t++) this.attribState[t] = !1;
        this.stack = [];
    }, M.WebGLShaderManager.prototype.constructor = M.WebGLShaderManager, M.WebGLShaderManager.prototype.setContext = function(t) {
        this.gl = t, this.primitiveShader = new M.PrimitiveShader(t), this.complexPrimitiveShader = new M.ComplexPrimitiveShader(t), 
        this.defaultShader = new M.PixiShader(t), this.fastShader = new M.PixiFastShader(t), 
        this.stripShader = new M.StripShader(t), this.creatureShader = M.CreatureShader ? new M.CreatureShader(t) : null, 
        this.setShader(this.defaultShader);
    }, M.WebGLShaderManager.prototype.setAttribs = function(t) {
        var e;
        for (e = 0; e < this.tempAttribState.length; e++) this.tempAttribState[e] = !1;
        for (e = 0; e < t.length; e++) {
            var i = t[e];
            this.tempAttribState[i] = !0;
        }
        var n = this.gl;
        for (e = 0; e < this.attribState.length; e++) this.attribState[e] !== this.tempAttribState[e] && (this.attribState[e] = this.tempAttribState[e], 
        this.tempAttribState[e] ? n.enableVertexAttribArray(e) : n.disableVertexAttribArray(e));
    }, M.WebGLShaderManager.prototype.setShader = function(t) {
        return this._currentId !== t._UID && (this._currentId = t._UID, this.currentShader = t, 
        this.gl.useProgram(t.program), this.setAttribs(t.attributes), !0);
    }, M.WebGLShaderManager.prototype.destroy = function() {
        this.attribState = null, this.tempAttribState = null, this.primitiveShader.destroy(), 
        this.complexPrimitiveShader.destroy(), this.defaultShader.destroy(), this.fastShader.destroy(), 
        this.stripShader.destroy(), this.creatureShader && this.creatureShader.destroy(), 
        this.gl = null;
    }, M.WebGLSpriteBatch = function(t) {
        this.game = t, this.vertSize = 5, this.size = 2e3, this.vertexSize = 24;
        var e = this.vertexSize * this.size * 4, i = 6 * this.size;
        this.vertices = new ArrayBuffer(e), this.positions = new Float32Array(this.vertices), 
        this.colors = new Uint32Array(this.vertices), this.indices = new Uint16Array(i);
        for (var n = this.lastIndexCount = 0, s = 0; n < i; n += 6, s += 4) this.indices[n + 0] = s + 0, 
        this.indices[n + 1] = s + 1, this.indices[n + 2] = s + 2, this.indices[n + 3] = s + 0, 
        this.indices[n + 4] = s + 2, this.indices[n + 5] = s + 3;
        this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.dirty = !0, 
        this.textures = [], this.blendModes = [], this.shaders = [], this.sprites = [], 
        this.defaultShader = null;
    }, M.WebGLSpriteBatch.prototype.setContext = function(t) {
        if (this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS), this.gl = t, 
        M._enableMultiTextureToggle) {
            for (var e = "\tif (vTextureIndex == 0.0) {gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n", i = 1; i < this.MAX_TEXTURES; ++i) e += "\tif (vTextureIndex == " + i + ".0) {gl_FragColor = texture2D(uSamplerArray[" + i + "], vTextureCoord) * vColor;return;}\n";
            this.defaultShader = new Phaser.Filter(this.game, void 0, [ "//WebGLSpriteBatch Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "void main(void) {", e, "\tgl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;", "}" ]);
        } else this.defaultShader = new Phaser.Filter(this.game, void 0, [ "//WebGLSpriteBatch Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;", "}" ]);
        this.vertexBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), 
        t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.indices, t.STATIC_DRAW), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), 
        t.bufferData(t.ARRAY_BUFFER, this.vertices, t.DYNAMIC_DRAW), this.currentBlendMode = 99999;
        var n = new M.PixiShader(t);
        n.fragmentSrc = this.defaultShader.fragmentSrc, n.uniforms = {}, n.init(), this.defaultShader.shaders[t.id] = n;
    }, M.WebGLSpriteBatch.prototype.begin = function(t) {
        this.renderSession = t, this.shader = this.renderSession.shaderManager.defaultShader, 
        this.start();
    }, M.WebGLSpriteBatch.prototype.end = function() {
        this.flush();
    }, M.WebGLSpriteBatch.prototype.render = function(t, e) {
        var i = t.texture, n = t.worldTransform;
        e && (n = e), this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = i.baseTexture);
        var s = i._uvs;
        if (s) {
            var o, a, r, h, l = t.anchor.x, c = t.anchor.y;
            if (i.trim) {
                var u = i.trim;
                o = (a = u.x - l * u.width) + i.crop.width, r = (h = u.y - c * u.height) + i.crop.height;
            } else o = i.frame.width * (1 - l), a = i.frame.width * -l, r = i.frame.height * (1 - c), 
            h = i.frame.height * -c;
            var d = this.currentBatchSize * this.vertexSize, p = i.baseTexture.resolution, g = i.baseTexture.textureIndex, m = n.a / p, f = n.b / p, y = n.c / p, v = n.d / p, b = n.tx, _ = n.ty, S = i.crop.height;
            if (i.rotated) {
                var x = n.a, w = n.b, A = n.c, P = n.d, C = a, T = o;
                b = n.c * S + b, _ = n.d * S + _, m = 6123233995736766e-32 * x - A, f = 6123233995736766e-32 * w - P, 
                y = x + 6123233995736766e-32 * A, v = w + 6123233995736766e-32 * P, i._updateUvsInverted(), 
                o = r, a = h, r = T, h = C;
            }
            var E = this.colors, I = this.positions, B = t.tint, L = (B >> 16) + (65280 & B) + ((255 & B) << 16) + (255 * t.worldAlpha << 24);
            this.renderSession.roundPixels ? (I[d++] = m * a + y * h + b | 0, I[d++] = v * h + f * a + _ | 0, 
            I[d++] = s.x0, I[d++] = s.y0, E[d++] = L, I[d++] = g, I[d++] = m * o + y * h + b | 0, 
            I[d++] = v * h + f * o + _ | 0, I[d++] = s.x1, I[d++] = s.y1, E[d++] = L, I[d++] = g, 
            I[d++] = m * o + y * r + b | 0, I[d++] = v * r + f * o + _ | 0, I[d++] = s.x2, I[d++] = s.y2, 
            E[d++] = L, I[d++] = g, I[d++] = m * a + y * r + b | 0, I[d++] = v * r + f * a + _ | 0) : (I[d++] = m * a + y * h + b, 
            I[d++] = v * h + f * a + _, I[d++] = s.x0, I[d++] = s.y0, E[d++] = L, I[d++] = g, 
            I[d++] = m * o + y * h + b, I[d++] = v * h + f * o + _, I[d++] = s.x1, I[d++] = s.y1, 
            E[d++] = L, I[d++] = g, I[d++] = m * o + y * r + b, I[d++] = v * r + f * o + _, 
            I[d++] = s.x2, I[d++] = s.y2, E[d++] = L, I[d++] = g, I[d++] = m * a + y * r + b, 
            I[d++] = v * r + f * a + _), I[d++] = s.x3, I[d++] = s.y3, E[d++] = L, I[d++] = g, 
            this.sprites[this.currentBatchSize++] = t;
        }
    }, M.WebGLSpriteBatch.prototype.renderTilingSprite = function(t) {
        var e = t.tilingTexture, i = t.texture.baseTexture.textureIndex;
        this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = e.baseTexture), 
        t._uvs || (t._uvs = new M.TextureUvs());
        var n = t._uvs, s = e.baseTexture.width, o = e.baseTexture.height;
        t.tilePosition.x %= s * t.tileScaleOffset.x, t.tilePosition.y %= o * t.tileScaleOffset.y;
        var a = t.tilePosition.x / (s * t.tileScaleOffset.x), r = t.tilePosition.y / (o * t.tileScaleOffset.y), h = t.width / s / (t.tileScale.x * t.tileScaleOffset.x), l = t.height / o / (t.tileScale.y * t.tileScaleOffset.y);
        n.x0 = 0 - a, n.y0 = 0 - r, n.x1 = 1 * h - a, n.y1 = 0 - r, n.x2 = 1 * h - a, n.y2 = 1 * l - r, 
        n.x3 = 0 - a, n.y3 = 1 * l - r;
        var c = t.tint, u = (c >> 16) + (65280 & c) + ((255 & c) << 16) + (255 * t.worldAlpha << 24), d = this.positions, p = this.colors, g = t.width, m = t.height, f = t.anchor.x, y = t.anchor.y, v = g * (1 - f), b = g * -f, _ = m * (1 - y), S = m * -y, x = this.currentBatchSize * this.vertexSize, w = e.baseTexture.resolution, A = t.worldTransform, P = A.a / w, C = A.b / w, T = A.c / w, E = A.d / w, I = A.tx, B = A.ty;
        d[x++] = P * b + T * S + I, d[x++] = E * S + C * b + B, d[x++] = n.x0, d[x++] = n.y0, 
        p[x++] = u, d[x++] = i, d[x++] = P * v + T * S + I, d[x++] = E * S + C * v + B, 
        d[x++] = n.x1, d[x++] = n.y1, p[x++] = u, d[x++] = i, d[x++] = P * v + T * _ + I, 
        d[x++] = E * _ + C * v + B, d[x++] = n.x2, d[x++] = n.y2, p[x++] = u, d[x++] = i, 
        d[x++] = P * b + T * _ + I, d[x++] = E * _ + C * b + B, d[x++] = n.x3, d[x++] = n.y3, 
        p[x++] = u, d[x++] = i, this.sprites[this.currentBatchSize++] = t;
    }, M.WebGLSpriteBatch.prototype.flush = function() {
        if (0 !== this.currentBatchSize) {
            var t, e, i, n, s = this.gl;
            if (this.dirty) {
                this.dirty = !1, t = this.defaultShader.shaders[s.id], s.activeTexture(s.TEXTURE0), 
                s.bindBuffer(s.ARRAY_BUFFER, this.vertexBuffer), s.bindBuffer(s.ELEMENT_ARRAY_BUFFER, this.indexBuffer);
                var o = this.vertexSize;
                s.vertexAttribPointer(t.aVertexPosition, 2, s.FLOAT, !1, o, 0), s.vertexAttribPointer(t.aTextureCoord, 2, s.FLOAT, !1, o, 8), 
                s.vertexAttribPointer(t.colorAttribute, 4, s.UNSIGNED_BYTE, !0, o, 16), s.vertexAttribPointer(t.aTextureIndex, 1, s.FLOAT, !1, o, 20);
            }
            if (this.currentBatchSize > .5 * this.size) s.bufferSubData(s.ARRAY_BUFFER, 0, this.vertices); else {
                s.bindBuffer(s.ARRAY_BUFFER, this.vertexBuffer);
                var a = this.positions.subarray(0, this.currentBatchSize * this.vertexSize);
                s.bufferSubData(s.ARRAY_BUFFER, 0, a);
            }
            for (var r, h = 0, l = 0, c = null, u = this.renderSession.blendModeManager.currentBlendMode, d = null, p = !1, g = !1, m = 0, f = this.currentBatchSize; m < f; m++) {
                e = (r = this.sprites[m]).tilingTexture ? r.tilingTexture.baseTexture : r.texture.baseTexture, 
                p = u !== (i = r.blendMode), g = d !== (n = r.shader || this.defaultShader);
                var y = e.skipRender;
                if (y && 0 < r.children.length && (y = !1), (c !== e && !y || p || g) && (this.renderBatch(c, h, l), 
                l = m, h = 0, c = e, p && (u = i, this.renderSession.blendModeManager.setBlendMode(u)), 
                g)) {
                    (t = (d = n).shaders[s.id]) || ((t = new M.PixiShader(s)).fragmentSrc = d.fragmentSrc, 
                    t.uniforms = d.uniforms, t.init(), d.shaders[s.id] = t), this.renderSession.shaderManager.setShader(t), 
                    t.dirty && t.syncUniforms();
                    var v = this.renderSession.projection;
                    s.uniform2f(t.projectionVector, v.x, v.y);
                    var b = this.renderSession.offset;
                    s.uniform2f(t.offsetVector, b.x, b.y);
                }
                h++;
            }
            this.renderBatch(c, h, l), this.currentBatchSize = 0;
        }
    }, M.WebGLSpriteBatch.prototype.renderBatch = function(t, e, i) {
        if (0 !== e) {
            var n = this.gl;
            if (t._dirty[n.id]) {
                if (!this.renderSession.renderer.updateTexture(t)) return;
            } else n.bindTexture(n.TEXTURE_2D, t._glTextures[n.id]);
            n.drawElements(n.TRIANGLES, 6 * e, n.UNSIGNED_SHORT, 6 * i * 2), this.renderSession.drawCount++;
        }
    }, M.WebGLSpriteBatch.prototype.stop = function() {
        this.flush(), this.dirty = !0;
    }, M.WebGLSpriteBatch.prototype.start = function() {
        this.dirty = !0;
    }, M.WebGLSpriteBatch.prototype.destroy = function() {
        this.vertices = null, this.indices = null, this.gl.deleteBuffer(this.vertexBuffer), 
        this.gl.deleteBuffer(this.indexBuffer), this.currentBaseTexture = null, this.gl = null;
    }, M.WebGLFastSpriteBatch = function(t) {
        this.vertSize = 11, this.maxSize = 6e3, this.size = this.maxSize;
        var e = 4 * this.size * this.vertSize, i = 6 * this.maxSize;
        this.vertices = new Float32Array(e), this.indices = new Uint16Array(i), this.vertexBuffer = null, 
        this.indexBuffer = null;
        for (var n = this.lastIndexCount = 0, s = 0; n < i; n += 6, s += 4) this.indices[n + 0] = s + 0, 
        this.indices[n + 1] = s + 1, this.indices[n + 2] = s + 2, this.indices[n + 3] = s + 0, 
        this.indices[n + 4] = s + 2, this.indices[n + 5] = s + 3;
        this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.currentBlendMode = 0, 
        this.renderSession = null, this.shader = null, this.matrix = null, this.setContext(t);
    }, M.WebGLFastSpriteBatch.prototype.constructor = M.WebGLFastSpriteBatch, M.WebGLFastSpriteBatch.prototype.setContext = function(t) {
        this.gl = t, this.vertexBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), 
        t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.indices, t.STATIC_DRAW), 
        t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertices, t.DYNAMIC_DRAW);
    }, M.WebGLFastSpriteBatch.prototype.begin = function(t, e) {
        this.renderSession = e, this.shader = this.renderSession.shaderManager.fastShader, 
        this.matrix = t.worldTransform.toArray(!0), this.start();
    }, M.WebGLFastSpriteBatch.prototype.end = function() {
        this.flush();
    }, M.WebGLFastSpriteBatch.prototype.render = function(t) {
        var e = t.children, i = e[0];
        if (i.texture._uvs) {
            this.currentBaseTexture = i.texture.baseTexture, i.blendMode !== this.renderSession.blendModeManager.currentBlendMode && (this.flush(), 
            this.renderSession.blendModeManager.setBlendMode(i.blendMode));
            var n = this.currentBaseTexture.textureIndex, s = this.gl;
            s.activeTexture(s.TEXTURE0 + n), s.bindTexture(s.TEXTURE_2D, this.currentBaseTexture._glTextures[s.id]), 
            M.WebGLRenderer.textureArray[n] = this.currentBaseTexture;
            for (var o = 0, a = e.length; o < a; o++) this.renderSprite(e[o]);
            this.flush();
        }
    }, M.WebGLFastSpriteBatch.prototype.renderSprite = function(t) {
        var e = t.texture.baseTexture, i = this.gl, n = t.texture.baseTexture.textureIndex;
        if ((M.WebGLRenderer.textureArray[n] == e || !e._glTextures[i.id] || t.texture.baseTexture.skipRender || (this.flush(), 
        i.activeTexture(i.TEXTURE0 + n), i.bindTexture(i.TEXTURE_2D, e._glTextures[i.id]), 
        M.WebGLRenderer.textureArray[n] = e, t.texture._uvs)) && t.visible) {
            var s, o, a, r, h, l, c, u, d = this.vertices;
            if (s = t.texture._uvs, o = t.texture.frame.width, a = t.texture.frame.height, t.texture.trim) {
                var p = t.texture.trim;
                r = (h = p.x - t.anchor.x * p.width) + t.texture.crop.width, l = (c = p.y - t.anchor.y * p.height) + t.texture.crop.height;
            } else r = o * (1 - t.anchor.x), h = o * -t.anchor.x, l = a * (1 - t.anchor.y), 
            c = a * -t.anchor.y;
            u = 4 * this.currentBatchSize * this.vertSize, d[u++] = h, d[u++] = c, d[u++] = t.position.x, 
            d[u++] = t.position.y, d[u++] = t.scale.x, d[u++] = t.scale.y, d[u++] = t.rotation, 
            d[u++] = s.x0, d[u++] = s.y1, d[u++] = t.alpha, d[u++] = n, d[u++] = r, d[u++] = c, 
            d[u++] = t.position.x, d[u++] = t.position.y, d[u++] = t.scale.x, d[u++] = t.scale.y, 
            d[u++] = t.rotation, d[u++] = s.x1, d[u++] = s.y1, d[u++] = t.alpha, d[u++] = n, 
            d[u++] = r, d[u++] = l, d[u++] = t.position.x, d[u++] = t.position.y, d[u++] = t.scale.x, 
            d[u++] = t.scale.y, d[u++] = t.rotation, d[u++] = s.x2, d[u++] = s.y2, d[u++] = t.alpha, 
            d[u++] = n, d[u++] = h, d[u++] = l, d[u++] = t.position.x, d[u++] = t.position.y, 
            d[u++] = t.scale.x, d[u++] = t.scale.y, d[u++] = t.rotation, d[u++] = s.x3, d[u++] = s.y3, 
            d[u++] = t.alpha, d[u++] = n, this.currentBatchSize++, this.currentBatchSize >= this.size && this.flush();
        }
    }, M.WebGLFastSpriteBatch.prototype.flush = function() {
        if (0 !== this.currentBatchSize) {
            var t = this.gl;
            if (this.currentBaseTexture._glTextures[t.id]) {
                if (this.currentBatchSize > .5 * this.size) t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertices); else {
                    var e = this.vertices.subarray(0, 4 * this.currentBatchSize * this.vertSize);
                    t.bufferSubData(t.ARRAY_BUFFER, 0, e);
                }
                t.drawElements(t.TRIANGLES, 6 * this.currentBatchSize, t.UNSIGNED_SHORT, 0), this.currentBatchSize = 0, 
                this.renderSession.drawCount++;
            } else this.renderSession.renderer.updateTexture(this.currentBaseTexture, t);
        }
    }, M.WebGLFastSpriteBatch.prototype.stop = function() {
        this.flush();
    }, M.WebGLFastSpriteBatch.prototype.start = function() {
        var t = this.gl;
        t.activeTexture(t.TEXTURE0), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer);
        var e = this.renderSession.projection;
        t.uniform2f(this.shader.projectionVector, e.x, e.y), t.uniformMatrix3fv(this.shader.uMatrix, !1, this.matrix);
        var i = 4 * this.vertSize;
        t.vertexAttribPointer(this.shader.aVertexPosition, 2, t.FLOAT, !1, i, 0), t.vertexAttribPointer(this.shader.aPositionCoord, 2, t.FLOAT, !1, i, 8), 
        t.vertexAttribPointer(this.shader.aScale, 2, t.FLOAT, !1, i, 16), t.vertexAttribPointer(this.shader.aRotation, 1, t.FLOAT, !1, i, 24), 
        t.vertexAttribPointer(this.shader.aTextureCoord, 2, t.FLOAT, !1, i, 28), t.vertexAttribPointer(this.shader.colorAttribute, 1, t.FLOAT, !1, i, 36), 
        t.vertexAttribPointer(this.shader.aTextureIndex, 1, t.FLOAT, !1, i, 40);
    }, M.WebGLFilterManager = function() {
        this.filterStack = [], this.offsetX = 0, this.offsetY = 0;
    }, M.WebGLFilterManager.prototype.constructor = M.WebGLFilterManager, M.WebGLFilterManager.prototype.setContext = function(t) {
        this.gl = t, this.texturePool = [], this.initShaderBuffers();
    }, M.WebGLFilterManager.prototype.begin = function(t, e) {
        this.renderSession = t, this.defaultShader = t.shaderManager.defaultShader;
        var i = this.renderSession.projection;
        this.width = 2 * i.x, this.height = 2 * -i.y, this.buffer = e;
    }, M.WebGLFilterManager.prototype.pushFilter = function(t) {
        var e = this.gl, i = this.renderSession.projection, n = this.renderSession.offset;
        t._filterArea = t.target.filterArea || t.target.getBounds(), t._previous_stencil_mgr = this.renderSession.stencilManager, 
        this.renderSession.stencilManager = new M.WebGLStencilManager(), this.renderSession.stencilManager.setContext(e), 
        e.disable(e.STENCIL_TEST), this.filterStack.push(t);
        var s = t.filterPasses[0];
        this.offsetX += t._filterArea.x, this.offsetY += t._filterArea.y;
        var o = this.texturePool.pop();
        o ? o.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution) : o = new M.FilterTexture(this.gl, this.width * this.renderSession.resolution, this.height * this.renderSession.resolution), 
        e.bindTexture(e.TEXTURE_2D, o.texture);
        var a = t._filterArea, r = s.padding;
        a.x -= r, a.y -= r, a.width += 2 * r, a.height += 2 * r, a.x < 0 && (a.x = 0), a.width > this.width && (a.width = this.width), 
        a.y < 0 && (a.y = 0), a.height > this.height && (a.height = this.height), e.bindFramebuffer(e.FRAMEBUFFER, o.frameBuffer), 
        e.viewport(0, 0, a.width * this.renderSession.resolution, a.height * this.renderSession.resolution), 
        i.x = a.width / 2, i.y = -a.height / 2, n.x = -a.x, n.y = -a.y, e.colorMask(!0, !0, !0, !0), 
        e.clearColor(0, 0, 0, 0), e.clear(e.COLOR_BUFFER_BIT), t._glFilterTexture = o;
    }, M.WebGLFilterManager.prototype.popFilter = function() {
        var t = this.gl, e = this.filterStack.pop(), i = e._filterArea, n = e._glFilterTexture, s = this.renderSession.projection, o = this.renderSession.offset;
        if (1 < e.filterPasses.length) {
            t.viewport(0, 0, i.width * this.renderSession.resolution, i.height * this.renderSession.resolution), 
            t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = 0, this.vertexArray[1] = i.height, 
            this.vertexArray[2] = i.width, this.vertexArray[3] = i.height, this.vertexArray[4] = 0, 
            this.vertexArray[5] = 0, this.vertexArray[6] = i.width, this.vertexArray[7] = 0, 
            t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertexArray), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), 
            this.uvArray[2] = i.width / this.width, this.uvArray[5] = i.height / this.height, 
            this.uvArray[6] = i.width / this.width, this.uvArray[7] = i.height / this.height, 
            t.bufferSubData(t.ARRAY_BUFFER, 0, this.uvArray);
            var a = n, r = this.texturePool.pop();
            r || (r = new M.FilterTexture(this.gl, this.width * this.renderSession.resolution, this.height * this.renderSession.resolution)), 
            r.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution), 
            t.bindFramebuffer(t.FRAMEBUFFER, r.frameBuffer), t.clear(t.COLOR_BUFFER_BIT), t.disable(t.BLEND);
            for (var h = 0; h < e.filterPasses.length - 1; h++) {
                var l = e.filterPasses[h];
                t.bindFramebuffer(t.FRAMEBUFFER, r.frameBuffer), t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, a.texture), 
                this.applyFilterPass(l, i, i.width, i.height);
                var c = a;
                a = r, r = c;
            }
            t.enable(t.BLEND), n = a, this.texturePool.push(r);
        }
        var u = e.filterPasses[e.filterPasses.length - 1];
        this.offsetX -= i.x, this.offsetY -= i.y;
        var d = this.width, p = this.height, g = 0, m = 0, f = this.buffer;
        if (0 === this.filterStack.length) t.colorMask(!0, !0, !0, !0); else {
            var y = this.filterStack[this.filterStack.length - 1];
            d = (i = y._filterArea).width, p = i.height, g = i.x, m = i.y, f = y._glFilterTexture.frameBuffer;
        }
        s.x = d / 2, s.y = -p / 2, o.x = g, o.y = m;
        var v = (i = e._filterArea).x - g, b = i.y - m;
        t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = v, this.vertexArray[1] = b + i.height, 
        this.vertexArray[2] = v + i.width, this.vertexArray[3] = b + i.height, this.vertexArray[4] = v, 
        this.vertexArray[5] = b, this.vertexArray[6] = v + i.width, this.vertexArray[7] = b, 
        t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertexArray), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), 
        this.uvArray[2] = i.width / this.width, this.uvArray[5] = i.height / this.height, 
        this.uvArray[6] = i.width / this.width, this.uvArray[7] = i.height / this.height, 
        t.bufferSubData(t.ARRAY_BUFFER, 0, this.uvArray), t.viewport(0, 0, d * this.renderSession.resolution, p * this.renderSession.resolution), 
        t.bindFramebuffer(t.FRAMEBUFFER, f), t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, n.texture), 
        this.renderSession.stencilManager && this.renderSession.stencilManager.destroy(), 
        this.renderSession.stencilManager = e._previous_stencil_mgr, e._previous_stencil_mgr = null, 
        0 < this.renderSession.stencilManager.count ? t.enable(t.STENCIL_TEST) : t.disable(t.STENCIL_TEST), 
        this.applyFilterPass(u, i, d, p), this.texturePool.push(n), e._glFilterTexture = null;
    }, M.WebGLFilterManager.prototype.applyFilterPass = function(t, e, i, n) {
        var s = this.gl, o = t.shaders[s.id];
        o || ((o = new M.PixiShader(s)).fragmentSrc = t.fragmentSrc, o.uniforms = t.uniforms, 
        o.init(!0), t.shaders[s.id] = o), this.renderSession.shaderManager.setShader(o), 
        s.uniform2f(o.projectionVector, i / 2, -n / 2), s.uniform2f(o.offsetVector, 0, 0), 
        t.uniforms.dimensions && (t.uniforms.dimensions.value[0] = this.width, t.uniforms.dimensions.value[1] = this.height, 
        t.uniforms.dimensions.value[2] = this.vertexArray[0], t.uniforms.dimensions.value[3] = this.vertexArray[5]), 
        o.syncUniforms(), s.bindBuffer(s.ARRAY_BUFFER, this.vertexBuffer), s.vertexAttribPointer(o.aVertexPosition, 2, s.FLOAT, !1, 0, 0), 
        s.bindBuffer(s.ARRAY_BUFFER, this.uvBuffer), s.vertexAttribPointer(o.aTextureCoord, 2, s.FLOAT, !1, 0, 0), 
        s.bindBuffer(s.ARRAY_BUFFER, this.colorBuffer), s.vertexAttribPointer(o.colorAttribute, 2, s.FLOAT, !1, 0, 0), 
        s.bindBuffer(s.ELEMENT_ARRAY_BUFFER, this.indexBuffer), s.drawElements(s.TRIANGLES, 6, s.UNSIGNED_SHORT, 0), 
        this.renderSession.drawCount++;
    }, M.WebGLFilterManager.prototype.initShaderBuffers = function() {
        var t = this.gl;
        this.vertexBuffer = t.createBuffer(), this.uvBuffer = t.createBuffer(), this.colorBuffer = t.createBuffer(), 
        this.indexBuffer = t.createBuffer(), this.vertexArray = new Float32Array([ 0, 0, 1, 0, 0, 1, 1, 1 ]), 
        t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertexArray, t.STATIC_DRAW), 
        this.uvArray = new Float32Array([ 0, 0, 1, 0, 0, 1, 1, 1 ]), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), 
        t.bufferData(t.ARRAY_BUFFER, this.uvArray, t.STATIC_DRAW), this.colorArray = new Float32Array([ 1, 16777215, 1, 16777215, 1, 16777215, 1, 16777215 ]), 
        t.bindBuffer(t.ARRAY_BUFFER, this.colorBuffer), t.bufferData(t.ARRAY_BUFFER, this.colorArray, t.STATIC_DRAW), 
        t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, new Uint16Array([ 0, 1, 2, 1, 3, 2 ]), t.STATIC_DRAW);
    }, M.WebGLFilterManager.prototype.destroy = function() {
        var t = this.gl;
        this.filterStack = null, this.offsetX = 0;
        for (var e = this.offsetY = 0; e < this.texturePool.length; e++) this.texturePool[e].destroy();
        this.texturePool = null, t.deleteBuffer(this.vertexBuffer), t.deleteBuffer(this.uvBuffer), 
        t.deleteBuffer(this.colorBuffer), t.deleteBuffer(this.indexBuffer);
    };
    function o(t, e, i, n, s) {
        var o, a, r, h, l, c = t.createFramebuffer(), u = t.createRenderbuffer(), d = null;
        return t.activeTexture(t.TEXTURE0 + s), t.bindFramebuffer(t.FRAMEBUFFER, c), t.bindRenderbuffer(t.RENDERBUFFER, u), 
        t.framebufferRenderbuffer(t.FRAMEBUFFER, t.DEPTH_STENCIL_ATTACHMENT, t.RENDERBUFFER, this.renderBuffer), 
        a = e, r = i, h = n, l = (o = t).createTexture(), o.bindTexture(o.TEXTURE_2D, l), 
        o.texParameteri(o.TEXTURE_2D, o.TEXTURE_WRAP_S, o.CLAMP_TO_EDGE), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_WRAP_T, o.CLAMP_TO_EDGE), 
        o.texParameteri(o.TEXTURE_2D, o.TEXTURE_MAG_FILTER, h === M.scaleModes.LINEAR ? o.LINEAR : o.NEAREST), 
        o.texParameteri(o.TEXTURE_2D, o.TEXTURE_MIN_FILTER, h === M.scaleModes.LINEAR ? o.LINEAR : o.NEAREST), 
        o.texImage2D(o.TEXTURE_2D, 0, o.RGBA, a, r, 0, o.RGBA, o.UNSIGNED_BYTE, null), d = l, 
        t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, d, 0), 
        t.checkFramebufferStatus(t.FRAMEBUFFER), t.FRAMEBUFFER_COMPLETE, c.width = e, c.height = i, 
        c.targetTexture = d, c.renderBuffer = u, c;
    }
    return M.FilterTexture = function(t, e, i, n, s) {
        s = "number" == typeof s ? s : 0, this.gl = t, this.frameBuffer = o(t, e, i, n || M.scaleModes.DEFAULT, s), 
        this.texture = this.frameBuffer.targetTexture, this.width = e, this.height = i, 
        this.renderBuffer = this.frameBuffer.renderBuffer;
    }, M.FilterTexture.prototype.constructor = M.FilterTexture, M.FilterTexture.prototype.clear = function() {
        var t = this.gl;
        t.clearColor(0, 0, 0, 0), t.clear(t.COLOR_BUFFER_BIT);
    }, M.FilterTexture.prototype.resize = function(t, e) {
        if (this.width !== t || this.height !== e) {
            this.width = t, this.height = e;
            var i = this.gl;
            i.bindTexture(i.TEXTURE_2D, this.texture), i.texImage2D(i.TEXTURE_2D, 0, i.RGBA, t, e, 0, i.RGBA, i.UNSIGNED_BYTE, null), 
            i.bindRenderbuffer(i.RENDERBUFFER, this.renderBuffer), i.renderbufferStorage(i.RENDERBUFFER, i.DEPTH_STENCIL, t, e);
        }
    }, M.FilterTexture.prototype.destroy = function() {
        var t = this.gl;
        t.deleteFramebuffer(this.frameBuffer), t.deleteTexture(this.texture), this.frameBuffer = null, 
        this.texture = null;
    }, M.CanvasBuffer = function(t, e) {
        this.width = t, this.height = e, this.canvas = Phaser.CanvasPool.create(this, this.width, this.height), 
        this.context = this.canvas.getContext("2d"), this.canvas.width = t, this.canvas.height = e;
    }, M.CanvasBuffer.prototype.constructor = M.CanvasBuffer, M.CanvasBuffer.prototype.clear = function() {
        this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.clearRect(0, 0, this.width, this.height);
    }, M.CanvasBuffer.prototype.resize = function(t, e) {
        this.width = this.canvas.width = t, this.height = this.canvas.height = e;
    }, M.CanvasBuffer.prototype.destroy = function() {
        Phaser.CanvasPool.remove(this);
    }, M.CanvasMaskManager = function() {}, M.CanvasMaskManager.prototype.constructor = M.CanvasMaskManager, 
    M.CanvasMaskManager.prototype.pushMask = function(t, e) {
        var i = e.context;
        i.save();
        var n = t.alpha, s = t.worldTransform, o = e.resolution;
        i.setTransform(s.a * o, s.b * o, s.c * o, s.d * o, s.tx * o, s.ty * o), M.CanvasGraphics.renderGraphicsMask(t, i), 
        i.clip(), t.worldAlpha = n;
    }, M.CanvasMaskManager.prototype.popMask = function(t) {
        t.context.restore();
    }, M.CanvasTinter = function() {}, M.CanvasTinter.getTintedTexture = function(t, e) {
        var i = t.tintedTexture || Phaser.CanvasPool.create(this);
        return M.CanvasTinter.tintMethod(t.texture, e, i), i;
    }, M.CanvasTinter.tintWithMultiply = function(t, e, i) {
        var n = i.getContext("2d"), s = t.crop, o = s.width, a = s.height;
        t.rotated && (o = a, a = s.width), i.width === o && i.height === a || (i.width = o, 
        i.height = a), n.clearRect(0, 0, o, a), n.fillStyle = "#" + ("00000" + (0 | e).toString(16)).substr(-6), 
        n.fillRect(0, 0, o, a), n.globalCompositeOperation = "multiply", n.drawImage(t.baseTexture.source, s.x, s.y, o, a, 0, 0, o, a), 
        n.globalCompositeOperation = "destination-atop", n.drawImage(t.baseTexture.source, s.x, s.y, o, a, 0, 0, o, a);
    }, M.CanvasTinter.tintWithPerPixel = function(t, e, i) {
        var n = i.getContext("2d"), s = t.crop, o = s.width, a = s.height;
        t.rotated && (o = a, a = s.width), i.width === o && i.height === a || (i.width = o, 
        i.height = a), n.globalCompositeOperation = "copy", n.drawImage(t.baseTexture.source, s.x, s.y, o, a, 0, 0, o, a);
        for (var r = Phaser.Color.hexToRGBArray(e), h = r[0], l = r[1], c = r[2], u = n.getImageData(0, 0, o, a), d = u.data, p = 0; p < d.length; p += 4) if (d[p + 0] *= h, 
        d[p + 1] *= l, d[p + 2] *= c, !M.CanvasTinter.canHandleAlpha) {
            var g = d[p + 3];
            d[p + 0] /= 255 / g, d[p + 1] /= 255 / g, d[p + 2] /= 255 / g;
        }
        n.putImageData(u, 0, 0);
    }, M.CanvasRenderer = function(t, e) {
        if (this.game = t, M.defaultRenderer || (M.defaultRenderer = this), this.type = Phaser.CANVAS, 
        this.resolution = t.resolution, this.clearBeforeRender = t.clearBeforeRender, this.transparent = t.transparent, 
        this.autoResize = !1, this.width = t.width * this.resolution, this.height = t.height * this.resolution, 
        this.view = t.canvas, this.context = this.view.getContext("2d", {
            alpha: this.transparent
        }), !this.context) throw new Error("Failed to create a Canvas 2d context.");
        this.refresh = !0, this.count = 0, this.maskManager = new M.CanvasMaskManager(), 
        this.renderSession = {
            context: this.context,
            maskManager: this.maskManager,
            scaleMode: null,
            smoothProperty: Phaser.Canvas.getSmoothingPrefix(this.context),
            roundPixels: e.roundPixels || !1
        }, this.mapBlendModes(), this.resize(this.width, this.height);
    }, M.CanvasRenderer.prototype.constructor = M.CanvasRenderer, M.CanvasRenderer.prototype.render = function(t) {
        this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.globalAlpha = 1, this.renderSession.currentBlendMode = 0, 
        this.renderSession.shakeX = this.game.camera._shake.x, this.renderSession.shakeY = this.game.camera._shake.y, 
        this.context.globalCompositeOperation = "source-over", navigator.isCocoonJS && this.view.screencanvas && (this.context.fillStyle = "black", 
        this.context.clear()), this.clearBeforeRender && (this.transparent ? this.context.clearRect(0, 0, this.width, this.height) : t._bgColor && (this.context.fillStyle = t._bgColor.rgba, 
        this.context.fillRect(0, 0, this.width, this.height))), this.renderDisplayObject(t);
    }, M.CanvasRenderer.prototype.setTexturePriority = function() {}, M.CanvasRenderer.prototype.destroy = function(t) {
        void 0 === t && (t = !0), t && this.view.parent && this.view.parent.removeChild(this.view), 
        this.view = null, this.context = null, this.maskManager = null, this.renderSession = null;
    }, M.CanvasRenderer.prototype.resize = function(t, e) {
        this.width = t * this.resolution, this.height = e * this.resolution, this.view.width = this.width, 
        this.view.height = this.height, this.autoResize && (this.view.style.width = this.width / this.resolution + "px", 
        this.view.style.height = this.height / this.resolution + "px"), this.renderSession.smoothProperty && (this.context[this.renderSession.smoothProperty] = this.renderSession.scaleMode === M.scaleModes.LINEAR);
    }, M.CanvasRenderer.prototype.renderDisplayObject = function(t, e, i) {
        this.renderSession.context = e || this.context, this.renderSession.resolution = this.resolution, 
        t._renderCanvas(this.renderSession, i);
    }, M.CanvasRenderer.prototype.mapBlendModes = function() {
        if (!M.blendModesCanvas) {
            var t = [], e = M.blendModes, i = this.game.device.canUseMultiply;
            t[e.NORMAL] = "source-over", t[e.ADD] = "lighter", t[e.MULTIPLY] = i ? "multiply" : "source-over", 
            t[e.SCREEN] = i ? "screen" : "source-over", t[e.OVERLAY] = i ? "overlay" : "source-over", 
            t[e.DARKEN] = i ? "darken" : "source-over", t[e.LIGHTEN] = i ? "lighten" : "source-over", 
            t[e.COLOR_DODGE] = i ? "color-dodge" : "source-over", t[e.COLOR_BURN] = i ? "color-burn" : "source-over", 
            t[e.HARD_LIGHT] = i ? "hard-light" : "source-over", t[e.SOFT_LIGHT] = i ? "soft-light" : "source-over", 
            t[e.DIFFERENCE] = i ? "difference" : "source-over", t[e.EXCLUSION] = i ? "exclusion" : "source-over", 
            t[e.HUE] = i ? "hue" : "source-over", t[e.SATURATION] = i ? "saturation" : "source-over", 
            t[e.COLOR] = i ? "color" : "source-over", t[e.LUMINOSITY] = i ? "luminosity" : "source-over", 
            M.blendModesCanvas = t;
        }
    }, M.BaseTexture = function(t, e, i) {
        this.resolution = i || 1, this.width = 100, this.height = 100, this.scaleMode = e || M.scaleModes.DEFAULT, 
        this.hasLoaded = !1, this.source = t, this.premultipliedAlpha = !0, this._glTextures = [], 
        this.mipmap = !1, this.textureIndex = 0, this._dirty = [ !0, !0, !0, !0 ], t && ((this.source.complete || this.source.getContext) && this.source.width && this.source.height && (this.hasLoaded = !0, 
        this.width = this.source.naturalWidth || this.source.width, this.height = this.source.naturalHeight || this.source.height, 
        this.dirty()), this.skipRender = !1, this._powerOf2 = !1);
    }, M.BaseTexture.prototype.constructor = M.BaseTexture, M.BaseTexture.prototype.forceLoaded = function(t, e) {
        this.hasLoaded = !0, this.width = t, this.height = e, this.dirty();
    }, M.BaseTexture.prototype.destroy = function() {
        this.source && Phaser.CanvasPool.removeByCanvas(this.source), this.source = null, 
        this.unloadFromGPU();
    }, M.BaseTexture.prototype.dirty = function() {
        for (var t = 0; t < this._glTextures.length; t++) this._dirty[t] = !0;
    }, M.BaseTexture.prototype.unloadFromGPU = function() {
        this.dirty();
        for (var t = this._glTextures.length - 1; 0 <= t; t--) {
            var e = this._glTextures[t], i = M.glContexts[t];
            i && e && i.deleteTexture(e);
        }
        this._glTextures.length = 0, this.dirty();
    }, M.BaseTexture.fromCanvas = function(t, e, i) {
        return 0 === t.width && (t.width = 1), 0 === t.height && (t.height = 1), i = i || 1, 
        new M.BaseTexture(t, e, i);
    }, M.TextureSilentFail = !1, M.Texture = function(t, e, i, n) {
        this.noFrame = !1, e || (this.noFrame = !0, e = new M.Rectangle(0, 0, 1, 1)), t instanceof M.Texture && (t = t.baseTexture), 
        this.baseTexture = t, this.frame = e, this.trim = n, this.valid = !1, this.isTiling = !1, 
        this.requiresUpdate = !1, this.requiresReTint = !1, this._uvs = null, this.width = 0, 
        this.height = 0, this.crop = i || new M.Rectangle(0, 0, 1, 1), this.rotated = !1, 
        t.hasLoaded && (this.noFrame && (e = new M.Rectangle(0, 0, t.width, t.height)), 
        this.setFrame(e));
    }, M.Texture.prototype.constructor = M.Texture, M.Texture.prototype.onBaseTextureLoaded = function() {
        var t = this.baseTexture;
        this.noFrame && (this.frame = new M.Rectangle(0, 0, t.width, t.height)), this.setFrame(this.frame);
    }, M.Texture.prototype.destroy = function(t) {
        t && this.baseTexture.destroy(), this.valid = !1;
    }, M.Texture.prototype.setFrame = function(t) {
        if (this.noFrame = !1, this.frame = t, this.width = t.width, this.height = t.height, 
        this.crop.x = t.x, this.crop.y = t.y, this.crop.width = t.width, this.crop.height = t.height, 
        this.trim || !(t.x + t.width > this.baseTexture.width || t.y + t.height > this.baseTexture.height)) this.valid = t && t.width && t.height && this.baseTexture.source && this.baseTexture.hasLoaded, 
        this.trim && (this.width = this.trim.width, this.height = this.trim.height, this.frame.width = this.trim.width, 
        this.frame.height = this.trim.height), this.valid && this._updateUvs(); else {
            if (!M.TextureSilentFail) throw new Error("Texture Error: frame does not fit inside the base Texture dimensions " + this);
            this.valid = !1;
        }
    }, M.Texture.prototype._updateUvs = function() {
        this._uvs || (this._uvs = new M.TextureUvs());
        var t = this.crop, e = this.baseTexture.width, i = this.baseTexture.height;
        this._uvs.x0 = t.x / e, this._uvs.y0 = t.y / i, this._uvs.x1 = (t.x + t.width) / e, 
        this._uvs.y1 = t.y / i, this._uvs.x2 = (t.x + t.width) / e, this._uvs.y2 = (t.y + t.height) / i, 
        this._uvs.x3 = t.x / e, this._uvs.y3 = (t.y + t.height) / i;
    }, M.Texture.prototype._updateUvsInverted = function() {
        this._uvs || (this._uvs = new M.TextureUvs());
        var t = this.crop, e = this.baseTexture.width, i = this.baseTexture.height;
        this._uvs.x0 = t.x / e, this._uvs.y0 = t.y / i, this._uvs.x1 = (t.x + t.height) / e, 
        this._uvs.y1 = t.y / i, this._uvs.x2 = (t.x + t.height) / e, this._uvs.y2 = (t.y + t.width) / i, 
        this._uvs.x3 = t.x / e, this._uvs.y3 = (t.y + t.width) / i;
    }, M.Texture.fromCanvas = function(t, e) {
        var i = M.BaseTexture.fromCanvas(t, e);
        return new M.Texture(i);
    }, M.TextureUvs = function() {
        this.x0 = 0, this.y0 = 0, this.x1 = 0, this.y1 = 0, this.x2 = 0, this.y2 = 0, this.x3 = 0, 
        this.y3 = 0;
    }, "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = M), 
    exports.PIXI = M) : "undefined" != typeof define && define.amd ? define("PIXI", t.PIXI = M) : t.PIXI = M, 
    M;
}.call(this), function() {
    var o, t = this, z = z || {
        VERSION: "2.13.3",
        GAMES: [],
        AUTO: 0,
        CANVAS: 1,
        WEBGL: 2,
        HEADLESS: 3,
        WEBGL_MULTI: 4,
        NONE: 0,
        LEFT: 1,
        RIGHT: 2,
        UP: 3,
        DOWN: 4,
        SPRITE: 0,
        BUTTON: 1,
        IMAGE: 2,
        GRAPHICS: 3,
        TEXT: 4,
        TILESPRITE: 5,
        BITMAPTEXT: 6,
        GROUP: 7,
        RENDERTEXTURE: 8,
        TILEMAP: 9,
        TILEMAPLAYER: 10,
        EMITTER: 11,
        POLYGON: 12,
        BITMAPDATA: 13,
        CANVAS_FILTER: 14,
        WEBGL_FILTER: 15,
        ELLIPSE: 16,
        SPRITEBATCH: 17,
        RETROFONT: 18,
        POINTER: 19,
        ROPE: 20,
        CIRCLE: 21,
        RECTANGLE: 22,
        LINE: 23,
        MATRIX: 24,
        POINT: 25,
        ROUNDEDRECTANGLE: 26,
        CREATURE: 27,
        VIDEO: 28,
        PENDING_ATLAS: -1,
        HORIZONTAL: 0,
        VERTICAL: 1,
        LANDSCAPE: 0,
        PORTRAIT: 1,
        ANGLE_UP: 270,
        ANGLE_DOWN: 90,
        ANGLE_LEFT: 180,
        ANGLE_RIGHT: 0,
        ANGLE_NORTH_EAST: 315,
        ANGLE_NORTH_WEST: 225,
        ANGLE_SOUTH_EAST: 45,
        ANGLE_SOUTH_WEST: 135,
        TOP_LEFT: 0,
        TOP_CENTER: 1,
        TOP_RIGHT: 2,
        LEFT_TOP: 3,
        LEFT_CENTER: 4,
        LEFT_BOTTOM: 5,
        CENTER: 6,
        RIGHT_TOP: 7,
        RIGHT_CENTER: 8,
        RIGHT_BOTTOM: 9,
        BOTTOM_LEFT: 10,
        BOTTOM_CENTER: 11,
        BOTTOM_RIGHT: 12,
        blendModes: {
            NORMAL: 0,
            ADD: 1,
            MULTIPLY: 2,
            SCREEN: 3,
            OVERLAY: 4,
            DARKEN: 5,
            LIGHTEN: 6,
            COLOR_DODGE: 7,
            COLOR_BURN: 8,
            HARD_LIGHT: 9,
            SOFT_LIGHT: 10,
            DIFFERENCE: 11,
            EXCLUSION: 12,
            HUE: 13,
            SATURATION: 14,
            COLOR: 15,
            LUMINOSITY: 16
        },
        scaleModes: {
            DEFAULT: 0,
            LINEAR: 0,
            NEAREST: 1
        },
        PIXI: PIXI || {},
        _UID: 0
    };
    if ("undefined" != typeof AudioBufferSourceNode && (AudioBufferSourceNode.prototype.start || (AudioBufferSourceNode.prototype.start = AudioBufferSourceNode.prototype.noteGrainOn), 
    AudioBufferSourceNode.prototype.stop || (AudioBufferSourceNode.prototype.stop = AudioBufferSourceNode.prototype.noteOff)), 
    Math.trunc || (Math.trunc = function(t) {
        return t < 0 ? Math.ceil(t) : Math.floor(t);
    }), Function.prototype.bind || (Function.prototype.bind = (o = Array.prototype.slice, 
    function(e) {
        var i = this, n = o.call(arguments, 1);
        if ("function" != typeof i) throw new TypeError();
        function s() {
            var t = n.concat(o.call(arguments));
            i.apply(this instanceof s ? this : e, t);
        }
        return s.prototype = function t(e) {
            if (e && (t.prototype = e), !(this instanceof t)) return new t();
        }(i.prototype), s;
    })), Array.isArray || (Array.isArray = function(t) {
        return "[object Array]" === Object.prototype.toString.call(t);
    }), Array.prototype.forEach || (Array.prototype.forEach = function(t) {
        "use strict";
        if (null == this) throw new TypeError();
        var e = Object(this), i = e.length >>> 0;
        if ("function" != typeof t) throw new TypeError();
        for (var n = 2 <= arguments.length ? arguments[1] : void 0, s = 0; s < i; s++) s in e && t.call(n, e[s], s, e);
    }), "function" != typeof window.Uint32Array && "object" != typeof window.Uint32Array) {
        var e = function(t) {
            var e = new Array();
            window[t] = function(t) {
                if ("number" == typeof t) {
                    Array.call(this, t), this.length = t;
                    for (var e = 0; e < this.length; e++) this[e] = 0;
                } else {
                    Array.call(this, t.length), this.length = t.length;
                    for (e = 0; e < this.length; e++) this[e] = t[e];
                }
            }, window[t].prototype = e, window[t].constructor = window[t];
        };
        e("Float32Array"), e("Uint32Array"), e("Uint16Array"), e("Int16Array"), e("ArrayBuffer");
    }
    for (var i in window.console || (window.console = {}, window.console.log = window.console.assert = function() {}, 
    window.console.warn = window.console.assert = function() {}), Object.assign || (Object.assign = function(t, e) {
        "use strict";
        if (null == t) throw new TypeError("Cannot convert undefined or null to object");
        for (var i = Object(t), n = Object.prototype.hasOwnProperty, s = 1; s < arguments.length; s++) {
            var o = arguments[s];
            if (null != o) for (var a in o) n.call(o, a) && (i[a] = o[a]);
        }
        return i;
    }), z.Utils = {
        defaults: function(t, e) {
            for (var i = Object.keys(e), n = 0, s = i.length; n < s; n++) {
                var o = i[n];
                void 0 === t[o] && (t[o] = e[o]);
            }
            return t;
        },
        reverseString: function(t) {
            return t.split("").reverse().join("");
        },
        getProperty: function(t, e) {
            var i = e.split(".");
            switch (i.length) {
              case 1:
                return t[e];

              case 2:
                return t[i[0]][i[1]];

              case 3:
                return t[i[0]][i[1]][i[2]];

              case 4:
                return t[i[0]][i[1]][i[2]][i[3]];

              default:
                return this._getProperty(t, e);
            }
        },
        setProperties: function(t, e) {
            for (var i in e) this.setProperty(t, i, e[i]);
            return t;
        },
        setProperty: function(t, e, i) {
            var n = e.split(".");
            switch (n.length) {
              case 1:
                t[e] = i;
                break;

              case 2:
                t[n[0]][n[1]] = i;
                break;

              case 3:
                t[n[0]][n[1]][n[2]] = i;
                break;

              case 4:
                t[n[0]][n[1]][n[2]][n[3]] = i;
                break;

              default:
                this._setProperty(t, e, i);
            }
        },
        _getProperty: function(t, e) {
            for (var i = e.split("."), n = i.length, s = 0, o = t; s < n; ) {
                var a = i[s];
                if (null == o) return;
                o = o[a], s++;
            }
            return o;
        },
        _setProperty: function(t, e, i) {
            var n = e.split("."), s = n.length, o = 0, a = t, r = n[0];
            if (1 === s) t[e] = i; else {
                for (;o < s - 1; ) a = a[r], r = n[++o];
                a[r] = i;
            }
            return t;
        },
        chanceRoll: function(t) {
            return void 0 === t && (t = 50), 0 < t && 100 * Math.random() <= t;
        },
        randomChoice: function(t, e) {
            return Math.random() < .5 ? t : e;
        },
        parseDimension: function(t, e) {
            var i = 0, n = 0;
            return "string" == typeof t ? "%" === t.substr(-1) ? (i = parseInt(t, 10) / 100, 
            n = 0 === e ? window.innerWidth * i : window.innerHeight * i) : n = parseInt(t, 10) : n = t, 
            n;
        },
        pad: function(t, e, i, n) {
            if (void 0 === e) e = 0;
            if (void 0 === i) i = " ";
            if (void 0 === n) n = 3;
            var s = 0;
            if (e + 1 >= (t = t.toString()).length) switch (n) {
              case 1:
                t = new Array(e + 1 - t.length).join(i) + t;
                break;

              case 3:
                var o = Math.ceil((s = e - t.length) / 2);
                t = new Array(s - o + 1).join(i) + t + new Array(o + 1).join(i);
                break;

              default:
                t += new Array(e + 1 - t.length).join(i);
            }
            return t;
        },
        isPlainObject: function(t) {
            if ("object" != typeof t || t.nodeType || t === t.window) return !1;
            try {
                if (t.constructor && !{}.hasOwnProperty.call(t.constructor.prototype, "isPrototypeOf")) return !1;
            } catch (t) {
                return !1;
            }
            return !0;
        },
        extend: function() {
            var t, e, i, n, s, o, a = arguments[0] || {}, r = 1, h = arguments.length, l = !1;
            for ("boolean" == typeof a && (l = a, a = arguments[1] || {}, r = 2), h === r && (a = this, 
            --r); r < h; r++) if (null != (t = arguments[r])) for (e in t) i = a[e], a !== (n = t[e]) && (l && n && (z.Utils.isPlainObject(n) || (s = Array.isArray(n))) ? (s ? (s = !1, 
            o = i && Array.isArray(i) ? i : []) : o = i && z.Utils.isPlainObject(i) ? i : {}, 
            a[e] = z.Utils.extend(l, o, n)) : void 0 !== n && (a[e] = n));
            return a;
        },
        mixinPrototype: function(t, e, i) {
            void 0 === i && (i = !1);
            for (var n = Object.keys(e), s = 0; s < n.length; s++) {
                var o = n[s], a = e[o];
                !i && o in t || (!a || "function" != typeof a.get && "function" != typeof a.set ? t[o] = a : "function" == typeof a.clone ? t[o] = a.clone() : Object.defineProperty(t, o, a));
            }
        },
        mixin: function(t, e) {
            if (!t || "object" != typeof t) return e;
            for (var i in t) {
                var n = t[i];
                if (!n.childNodes && !n.cloneNode) {
                    var s = typeof t[i];
                    t[i] && "object" === s ? typeof e[i] === s ? e[i] = z.Utils.mixin(t[i], e[i]) : e[i] = z.Utils.mixin(t[i], new n.constructor()) : e[i] = t[i];
                }
            }
            return e;
        }
    }, z.Circle = function(t, e, i) {
        t = t || 0, e = e || 0, i = i || 0, this.x = t, this.y = e, this._diameter = i, 
        (this._radius = 0) < i && (this._radius = .5 * i), this.type = z.CIRCLE;
    }, z.Circle.prototype = {
        circumference: function() {
            return Math.PI * this._radius * 2;
        },
        random: function(t) {
            void 0 === t && (t = new z.Point());
            var e = 2 * Math.PI * Math.random(), i = Math.random() + Math.random(), n = 1 < i ? 2 - i : i, s = n * Math.cos(e), o = n * Math.sin(e);
            return t.x = this.x + s * this.radius, t.y = this.y + o * this.radius, t;
        },
        getBounds: function() {
            return new z.Rectangle(this.x - this.radius, this.y - this.radius, this.diameter, this.diameter);
        },
        setTo: function(t, e, i) {
            return this.x = t, this.y = e, this._diameter = i, this._radius = .5 * i, this;
        },
        copyFrom: function(t) {
            return this.setTo(t.x, t.y, t.diameter);
        },
        copyTo: function(t) {
            return t.x = this.x, t.y = this.y, t.diameter = this._diameter, t;
        },
        distance: function(t, e) {
            var i = z.Math.distance(this.x, this.y, t.x, t.y);
            return e ? Math.round(i) : i;
        },
        clone: function(t) {
            return null == t ? t = new z.Circle(this.x, this.y, this.diameter) : t.setTo(this.x, this.y, this.diameter), 
            t;
        },
        contains: function(t, e) {
            return z.Circle.contains(this, t, e);
        },
        circumferencePoint: function(t, e, i) {
            return z.Circle.circumferencePoint(this, t, e, i);
        },
        sample: function(t, e, i, n, s) {
            t || (t = 60), null == e && (e = 0), null == i && (i = z.Math.PI2), s || (s = []);
            for (var o = 0; o < t; ) this.circumferencePoint(z.Math.linear(e, i, o / t), n, s[o] || (s[o] = new z.Point())), 
            o += 1;
            return s;
        },
        offset: function(t, e) {
            return this.x += t, this.y += e, this;
        },
        offsetPoint: function(t) {
            return this.offset(t.x, t.y);
        },
        toString: function() {
            return "[{Phaser.Circle (x=" + this.x + " y=" + this.y + " diameter=" + this.diameter + " radius=" + this.radius + ")}]";
        }
    }, z.Circle.prototype.constructor = z.Circle, Object.defineProperty(z.Circle.prototype, "diameter", {
        get: function() {
            return this._diameter;
        },
        set: function(t) {
            0 < t && (this._diameter = t, this._radius = .5 * t);
        }
    }), Object.defineProperty(z.Circle.prototype, "radius", {
        get: function() {
            return this._radius;
        },
        set: function(t) {
            0 < t && (this._radius = t, this._diameter = 2 * t);
        }
    }), Object.defineProperty(z.Circle.prototype, "left", {
        get: function() {
            return this.x - this._radius;
        },
        set: function(t) {
            t > this.x ? (this._radius = 0, this._diameter = 0) : this.radius = this.x - t;
        }
    }), Object.defineProperty(z.Circle.prototype, "right", {
        get: function() {
            return this.x + this._radius;
        },
        set: function(t) {
            t < this.x ? (this._radius = 0, this._diameter = 0) : this.radius = t - this.x;
        }
    }), Object.defineProperty(z.Circle.prototype, "top", {
        get: function() {
            return this.y - this._radius;
        },
        set: function(t) {
            t > this.y ? (this._radius = 0, this._diameter = 0) : this.radius = this.y - t;
        }
    }), Object.defineProperty(z.Circle.prototype, "bottom", {
        get: function() {
            return this.y + this._radius;
        },
        set: function(t) {
            t < this.y ? (this._radius = 0, this._diameter = 0) : this.radius = t - this.y;
        }
    }), Object.defineProperty(z.Circle.prototype, "area", {
        get: function() {
            return 0 < this._radius ? Math.PI * this._radius * this._radius : 0;
        }
    }), Object.defineProperty(z.Circle.prototype, "empty", {
        get: function() {
            return 0 === this._diameter;
        },
        set: function(t) {
            !0 === t && this.setTo(0, 0, 0);
        }
    }), z.Circle.contains = function(t, e, i) {
        return 0 < t.radius && e >= t.left && e <= t.right && i >= t.top && i <= t.bottom && (t.x - e) * (t.x - e) + (t.y - i) * (t.y - i) <= t.radius * t.radius;
    }, z.Circle.equals = function(t, e) {
        return t.x === e.x && t.y === e.y && t.diameter === e.diameter;
    }, z.Circle.intersects = function(t, e) {
        return z.Math.distance(t.x, t.y, e.x, e.y) <= t.radius + e.radius;
    }, z.Circle.circumferencePoint = function(t, e, i, n) {
        return void 0 === i && (i = !1), void 0 === n && (n = new z.Point()), !0 === i && (e = z.Math.degToRad(e)), 
        n.x = t.x + t.radius * Math.cos(e), n.y = t.y + t.radius * Math.sin(e), n;
    }, z.Circle.intersectsRectangle = function(t, e) {
        var i = Math.abs(t.x - e.x - e.halfWidth);
        if (e.halfWidth + t.radius < i) return !1;
        var n = Math.abs(t.y - e.y - e.halfHeight);
        if (e.halfHeight + t.radius < n) return !1;
        if (i <= e.halfWidth || n <= e.halfHeight) return !0;
        var s = i - e.halfWidth, o = n - e.halfHeight;
        return s * s + o * o <= t.radius * t.radius;
    }, z.Circle.intersectsLine = function(t, e, i) {
        var n = t.x, s = t.y, o = (e.end.y - e.start.y) / (e.end.x - e.start.x), a = e.end.y - o * e.end.x, r = t.radius, h = t.radius, l = a + o * n, c = (n * (h * h) - o * (r * r) * (a - s) + r * h * Math.sqrt(r * r * (o * o) + h * h - l * l - s * s + 2 * l * s)) / (r * r * (o * o) + h * h), u = (n * (h * h) - o * (r * r) * (a - s) - r * h * Math.sqrt(r * r * (o * o) + h * h - l * l - s * s + 2 * l * s)) / (r * r * (o * o) + h * h), d = o * c + a, p = o * u + a, g = new z.Point(c, d), m = new z.Point(u, p), f = e.pointOnSegment(g.x, g.y, .01), y = e.pointOnSegment(m.x, m.y, .01);
        return f && y ? !i || [ g, m ] : f ? !i || [ g ] : y ? !i || [ m ] : !!i && [];
    }, PIXI.Circle = z.Circle, z.Ellipse = function(t, e, i, n) {
        t = t || 0, e = e || 0, i = i || 0, n = n || 0, this.x = t, this.y = e, this.width = i, 
        this.height = n, this.type = z.ELLIPSE;
    }, z.Ellipse.prototype = {
        setTo: function(t, e, i, n) {
            return this.x = t, this.y = e, this.width = i, this.height = n, this;
        },
        getBounds: function() {
            return new z.Rectangle(this.x - this.width, this.y - this.height, this.width, this.height);
        },
        copyFrom: function(t) {
            return this.setTo(t.x, t.y, t.width, t.height);
        },
        copyTo: function(t) {
            return t.x = this.x, t.y = this.y, t.width = this.width, t.height = this.height, 
            t;
        },
        clone: function(t) {
            return null == t ? t = new z.Ellipse(this.x, this.y, this.width, this.height) : t.setTo(this.x, this.y, this.width, this.height), 
            t;
        },
        contains: function(t, e) {
            return z.Ellipse.contains(this, t, e);
        },
        random: function(t) {
            void 0 === t && (t = new z.Point());
            var e = Math.random() * Math.PI * 2, i = Math.sqrt(Math.random());
            return t.x = this.centerX + .5 * i * Math.cos(e) * this.width, t.y = this.centerY + .5 * i * Math.sin(e) * this.height, 
            t;
        },
        toString: function() {
            return "[{Phaser.Ellipse (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + ")}]";
        }
    }, z.Ellipse.prototype.constructor = z.Ellipse, Object.defineProperty(z.Ellipse.prototype, "left", {
        get: function() {
            return this.x;
        },
        set: function(t) {
            this.x = t;
        }
    }), Object.defineProperty(z.Ellipse.prototype, "right", {
        get: function() {
            return this.x + this.width;
        },
        set: function(t) {
            t < this.x ? this.width = 0 : this.width = t - this.x;
        }
    }), Object.defineProperty(z.Ellipse.prototype, "top", {
        get: function() {
            return this.y;
        },
        set: function(t) {
            this.y = t;
        }
    }), Object.defineProperty(z.Ellipse.prototype, "bottom", {
        get: function() {
            return this.y + this.height;
        },
        set: function(t) {
            t < this.y ? this.height = 0 : this.height = t - this.y;
        }
    }), Object.defineProperty(z.Ellipse.prototype, "centerX", {
        get: function() {
            return this.x + .5 * this.width;
        }
    }), Object.defineProperty(z.Ellipse.prototype, "centerY", {
        get: function() {
            return this.y + .5 * this.height;
        }
    }), Object.defineProperty(z.Ellipse.prototype, "empty", {
        get: function() {
            return 0 === this.width || 0 === this.height;
        },
        set: function(t) {
            !0 === t && this.setTo(0, 0, 0, 0);
        }
    }), z.Ellipse.contains = function(t, e, i) {
        if (t.width <= 0 || t.height <= 0) return !1;
        var n = (e - t.x) / t.width - .5, s = (i - t.y) / t.height - .5;
        return (n *= n) + (s *= s) < .25;
    }, z.Ellipse.intersectsLine = function(t, e, i) {
        var n = t.x, s = t.y, o = (e.end.y - e.start.y) / (e.end.x - e.start.x), a = e.end.y - o * e.end.x, r = t.width / 2, h = t.height / 2, l = a + o * n, c = (n * (h * h) - o * (r * r) * (a - s) + r * h * Math.sqrt(r * r * (o * o) + h * h - l * l - s * s + 2 * l * s)) / (r * r * (o * o) + h * h), u = (n * (h * h) - o * (r * r) * (a - s) - r * h * Math.sqrt(r * r * (o * o) + h * h - l * l - s * s + 2 * l * s)) / (r * r * (o * o) + h * h), d = o * c + a, p = o * u + a, g = new z.Point(c, d), m = new z.Point(u, p), f = e.pointOnSegment(g.x, g.y, .01), y = e.pointOnSegment(m.x, m.y, .01);
        return f && y ? !i || [ g, m ] : f ? !i || [ g ] : y ? !i || [ m ] : !!i && [];
    }, PIXI.Ellipse = z.Ellipse, z.Line = function(t, e, i, n) {
        t = t || 0, e = e || 0, i = i || 0, n = n || 0, this.start = new z.Point(t, e), 
        this.end = new z.Point(i, n), this.type = z.LINE;
    }, z.Line.prototype = {
        setTo: function(t, e, i, n) {
            return this.start.setTo(t, e), this.end.setTo(i, n), this;
        },
        fromPoints: function(t, e) {
            return this.setTo(t.x, t.y, e.x, e.y), this;
        },
        fromSprite: function(t, e, i) {
            return void 0 === i && (i = !1), i ? this.setTo(t.centerX, t.centerY, e.centerX, e.centerY) : this.fromPoints(t, e);
        },
        fromAngle: function(t, e, i, n) {
            return this.start.setTo(t, e), this.end.setTo(t + Math.cos(i) * n, e + Math.sin(i) * n), 
            this;
        },
        rotate: function(t, e) {
            var i = (this.start.x + this.end.x) / 2, n = (this.start.y + this.end.y) / 2;
            return this.start.rotate(i, n, t, e), this.end.rotate(i, n, t, e), this;
        },
        rotateAround: function(t, e, i, n) {
            return this.start.rotate(t, e, i, n), this.end.rotate(t, e, i, n), this;
        },
        intersects: function(t, e, i) {
            return z.Line.intersectsPoints(this.start, this.end, t.start, t.end, e, i);
        },
        reflect: function(t) {
            return z.Line.reflect(this, t);
        },
        midPoint: function(t) {
            return void 0 === t && (t = new z.Point()), t.x = (this.start.x + this.end.x) / 2, 
            t.y = (this.start.y + this.end.y) / 2, t;
        },
        centerOn: function(t, e) {
            var i = t - (this.start.x + this.end.x) / 2, n = e - (this.start.y + this.end.y) / 2;
            this.start.add(i, n), this.end.add(i, n);
        },
        pointOnLine: function(t, e, i) {
            return z.Math.fuzzyEqual((t - this.start.x) * (this.end.y - this.start.y), (this.end.x - this.start.x) * (e - this.start.y), i || 0);
        },
        pointOnSegment: function(t, e, i) {
            var n = Math.min(this.start.x, this.end.x), s = Math.max(this.start.x, this.end.x), o = Math.min(this.start.y, this.end.y), a = Math.max(this.start.y, this.end.y);
            return this.pointOnLine(t, e, i) && n <= t && t <= s && o <= e && e <= a;
        },
        random: function(t) {
            void 0 === t && (t = new z.Point());
            var e = Math.random();
            return t.x = this.start.x + e * (this.end.x - this.start.x), t.y = this.start.y + e * (this.end.y - this.start.y), 
            t;
        },
        coordinatesOnLine: function(t, e) {
            void 0 === t && (t = 1), void 0 === e && (e = []);
            var i = Math.round(this.start.x), n = Math.round(this.start.y), s = Math.round(this.end.x), o = Math.round(this.end.y), a = Math.abs(s - i), r = Math.abs(o - n), h = i < s ? 1 : -1, l = n < o ? 1 : -1, c = a - r;
            e.push([ i, n ]);
            for (var u = 1; i !== s || n !== o; ) {
                var d = c << 1;
                -r < d && (c -= r, i += h), d < a && (c += a, n += l), u % t == 0 && e.push([ i, n ]), 
                u++;
            }
            return e;
        },
        clone: function(t) {
            return null == t ? t = new z.Line(this.start.x, this.start.y, this.end.x, this.end.y) : t.setTo(this.start.x, this.start.y, this.end.x, this.end.y), 
            t;
        }
    }, Object.defineProperty(z.Line.prototype, "length", {
        get: function() {
            return Math.sqrt((this.end.x - this.start.x) * (this.end.x - this.start.x) + (this.end.y - this.start.y) * (this.end.y - this.start.y));
        }
    }), Object.defineProperty(z.Line.prototype, "angle", {
        get: function() {
            return z.Point.angle(this.end, this.start);
        }
    }), Object.defineProperty(z.Line.prototype, "slope", {
        get: function() {
            return (this.end.y - this.start.y) / (this.end.x - this.start.x);
        }
    }), Object.defineProperty(z.Line.prototype, "perpSlope", {
        get: function() {
            return -(this.end.x - this.start.x) / (this.end.y - this.start.y);
        }
    }), Object.defineProperty(z.Line.prototype, "x", {
        get: function() {
            return Math.min(this.start.x, this.end.x);
        }
    }), Object.defineProperty(z.Line.prototype, "y", {
        get: function() {
            return Math.min(this.start.y, this.end.y);
        }
    }), Object.defineProperty(z.Line.prototype, "left", {
        get: function() {
            return Math.min(this.start.x, this.end.x);
        }
    }), Object.defineProperty(z.Line.prototype, "right", {
        get: function() {
            return Math.max(this.start.x, this.end.x);
        }
    }), Object.defineProperty(z.Line.prototype, "top", {
        get: function() {
            return Math.min(this.start.y, this.end.y);
        }
    }), Object.defineProperty(z.Line.prototype, "bottom", {
        get: function() {
            return Math.max(this.start.y, this.end.y);
        }
    }), Object.defineProperty(z.Line.prototype, "width", {
        get: function() {
            return Math.abs(this.start.x - this.end.x);
        }
    }), Object.defineProperty(z.Line.prototype, "height", {
        get: function() {
            return Math.abs(this.start.y - this.end.y);
        }
    }), Object.defineProperty(z.Line.prototype, "normalX", {
        get: function() {
            return Math.cos(this.angle - 1.5707963267948966);
        }
    }), Object.defineProperty(z.Line.prototype, "normalY", {
        get: function() {
            return Math.sin(this.angle - 1.5707963267948966);
        }
    }), Object.defineProperty(z.Line.prototype, "normalAngle", {
        get: function() {
            return z.Math.wrap(this.angle - 1.5707963267948966, -Math.PI, Math.PI);
        }
    }), z.Line.intersectsPoints = function(t, e, i, n, s, o) {
        void 0 === s && (s = !0), void 0 === o && (o = new z.Point());
        var a = e.y - t.y, r = n.y - i.y, h = t.x - e.x, l = i.x - n.x, c = e.x * t.y - t.x * e.y, u = n.x * i.y - i.x * n.y, d = a * l - r * h;
        if (0 === d) return null;
        if (o.x = (h * u - l * c) / d, o.y = (r * c - a * u) / d, s) {
            var p = (n.y - i.y) * (e.x - t.x) - (n.x - i.x) * (e.y - t.y), g = ((n.x - i.x) * (t.y - i.y) - (n.y - i.y) * (t.x - i.x)) / p, m = ((e.x - t.x) * (t.y - i.y) - (e.y - t.y) * (t.x - i.x)) / p;
            return 0 <= g && g <= 1 && 0 <= m && m <= 1 ? o : null;
        }
        return o;
    }, z.Line.intersects = function(t, e, i, n) {
        return z.Line.intersectsPoints(t.start, t.end, e.start, e.end, i, n);
    }, z.Line.intersectsRectangle = function(t, e) {
        if (0 === t.length || e.empty) return !1;
        var i = t.start.x, n = t.start.y, s = t.end.x, o = t.end.y, a = e.x, r = e.y, h = e.right, l = e.bottom, c = 0;
        if (a <= i && i <= h && r <= n && n <= l || a <= s && s <= h && r <= o && o <= l) return !0;
        if (i < a && a <= s) {
            if (r < (c = n + (o - n) * (a - i) / (s - i)) && c <= l) return !0;
        } else if (h < i && s <= h && r <= (c = n + (o - n) * (h - i) / (s - i)) && c <= l) return !0;
        if (n < r && r <= o) {
            if (a <= (c = i + (s - i) * (r - n) / (o - n)) && c <= h) return !0;
        } else if (l < n && o <= l && a <= (c = i + (s - i) * (l - n) / (o - n)) && c <= h) return !0;
        return !1;
    }, z.Line.intersectionWithRectangle = function(t, e, i) {
        var n = z.Line.intersectionWithRectangle;
        i || (i = new z.Point()), n.edges || (n.edges = [ new z.Line(), new z.Line(), new z.Line(), new z.Line() ]), 
        n.edgeIntersection || (n.edgeIntersection = new z.Point());
        var s = n.edges, o = n.edgeIntersection.set(0), a = e.x, r = e.y, h = e.right, l = e.bottom, c = 1 / 0;
        s[0].setTo(a, r, h, r), s[1].setTo(a, l, h, l), s[2].setTo(a, r, a, l), s[3].setTo(h, r, h, l);
        for (var u, d = 0; u = s[d]; d++) if (t.intersects(u, !0, o)) {
            var p = t.start.distance(o);
            p < c && (c = p, i.copyFrom(o));
        }
        return null != p ? i : null;
    }, z.Line.reflect = function(t, e) {
        return 2 * e.normalAngle - 3.141592653589793 - t.angle;
    }, z.Matrix = function(t, e, i, n, s, o) {
        null == t && (t = 1), null == e && (e = 0), null == i && (i = 0), null == n && (n = 1), 
        null == s && (s = 0), null == o && (o = 0), this.a = t, this.b = e, this.c = i, 
        this.d = n, this.tx = s, this.ty = o, this.type = z.MATRIX;
    }, z.Matrix.prototype = {
        fromArray: function(t) {
            return this.setTo(t[0], t[1], t[3], t[4], t[2], t[5]);
        },
        setTo: function(t, e, i, n, s, o) {
            return this.a = t, this.b = e, this.c = i, this.d = n, this.tx = s, this.ty = o, 
            this;
        },
        clone: function(t) {
            return null == t ? t = new z.Matrix(this.a, this.b, this.c, this.d, this.tx, this.ty) : (t.a = this.a, 
            t.b = this.b, t.c = this.c, t.d = this.d, t.tx = this.tx, t.ty = this.ty), t;
        },
        copyTo: function(t) {
            return t.copyFrom(this), t;
        },
        copyFrom: function(t) {
            return this.a = t.a, this.b = t.b, this.c = t.c, this.d = t.d, this.tx = t.tx, this.ty = t.ty, 
            this;
        },
        toArray: function(t, e) {
            return void 0 === e && (e = new Float32Array(9)), t ? (e[0] = this.a, e[1] = this.b, 
            e[2] = 0, e[3] = this.c, e[4] = this.d, e[5] = 0, e[6] = this.tx, e[7] = this.ty) : (e[0] = this.a, 
            e[1] = this.c, e[2] = this.tx, e[3] = this.b, e[4] = this.d, e[5] = this.ty, e[6] = 0, 
            e[7] = 0), e[8] = 1, e;
        },
        apply: function(t, e) {
            return void 0 === e && (e = new z.Point()), e.x = this.a * t.x + this.c * t.y + this.tx, 
            e.y = this.b * t.x + this.d * t.y + this.ty, e;
        },
        applyInverse: function(t, e) {
            void 0 === e && (e = new z.Point());
            var i = 1 / (this.a * this.d + this.c * -this.b), n = t.x, s = t.y;
            return e.x = this.d * i * n + -this.c * i * s + (this.ty * this.c - this.tx * this.d) * i, 
            e.y = this.a * i * s + -this.b * i * n + (-this.ty * this.a + this.tx * this.b) * i, 
            e;
        },
        translate: function(t, e) {
            return this.tx += t, this.ty += e, this;
        },
        scale: function(t, e) {
            return this.a *= t, this.d *= e, this.c *= t, this.b *= e, this.tx *= t, this.ty *= e, 
            this;
        },
        rotate: function(t) {
            var e = Math.cos(t), i = Math.sin(t), n = this.a, s = this.c, o = this.tx;
            return this.a = n * e - this.b * i, this.b = n * i + this.b * e, this.c = s * e - this.d * i, 
            this.d = s * i + this.d * e, this.tx = o * e - this.ty * i, this.ty = o * i + this.ty * e, 
            this;
        },
        append: function(t) {
            var e = this.a, i = this.b, n = this.c, s = this.d;
            return this.a = t.a * e + t.b * n, this.b = t.a * i + t.b * s, this.c = t.c * e + t.d * n, 
            this.d = t.c * i + t.d * s, this.tx = t.tx * e + t.ty * n + this.tx, this.ty = t.tx * i + t.ty * s + this.ty, 
            this;
        },
        identity: function() {
            return this.setTo(1, 0, 0, 1, 0, 0);
        }
    }, z.identityMatrix = new z.Matrix(), z.Point = function(t, e) {
        t = t || 0, e = e || 0, this.x = t, this.y = e, this.type = z.POINT;
    }, z.Point.prototype = {
        copyFrom: function(t) {
            return this.setTo(t.x, t.y);
        },
        invert: function() {
            return this.setTo(this.y, this.x);
        },
        setTo: function(t, e) {
            return z.Point.set(this, t, e);
        },
        set: function(t, e) {
            return z.Point.set(this, t, e);
        },
        setToPolar: function(t, e, i) {
            return null == e && (e = 1), i && (t = z.Math.degToRad(t)), this.setTo(Math.cos(t) * e, Math.sin(t) * e);
        },
        add: function(t, e) {
            return this.x += t, this.y += e, this;
        },
        subtract: function(t, e) {
            return this.x -= t, this.y -= e, this;
        },
        multiply: function(t, e) {
            return this.x *= t, this.y *= e, this;
        },
        divide: function(t, e) {
            return this.x /= t, this.y /= e, this;
        },
        clampX: function(t, e) {
            return this.x = z.Math.clamp(this.x, t, e), this;
        },
        clampY: function(t, e) {
            return this.y = z.Math.clamp(this.y, t, e), this;
        },
        clamp: function(t, e) {
            return this.x = z.Math.clamp(this.x, t, e), this.y = z.Math.clamp(this.y, t, e), 
            this;
        },
        clip: function(t) {
            var e = t.left, i = t.top, n = t.right, s = t.bottom;
            return this.x < e ? this.x = e : this.x > n && (this.x = n), this.y < i ? this.y = i : this.y > s && (this.y = s), 
            this;
        },
        clone: function(t) {
            return null == t ? t = new z.Point(this.x, this.y) : t.setTo(this.x, this.y), t;
        },
        copyTo: function(t) {
            return t.x = this.x, t.y = this.y, t;
        },
        distance: function(t, e) {
            return z.Point.distance(this, t, e);
        },
        equals: function(t) {
            return t.x === this.x && t.y === this.y;
        },
        equalsXY: function(t, e) {
            return this.x === t && this.y === e;
        },
        fuzzyEquals: function(t, e) {
            return z.Point.fuzzyEquals(this, t, e);
        },
        fuzzyEqualsXY: function(t, e, i) {
            return z.Point.fuzzyEqualsXY(this, t, e, i);
        },
        angle: function(t, e) {
            return this.angleXY(t.x, t.y, e);
        },
        angleXY: function(t, e, i) {
            var n = Math.atan2(e - this.y, t - this.x);
            return i ? z.Math.radToDeg(n) : n;
        },
        atan: function(t) {
            var e = Math.atan2(this.y, this.x);
            return t ? z.Math.radToDeg(e) : e;
        },
        rotate: function(t, e, i, n, s) {
            return z.Point.rotate(this, t, e, i, n, s);
        },
        getMagnitude: function() {
            return Math.sqrt(this.x * this.x + this.y * this.y);
        },
        getMagnitudeSq: function() {
            return this.x * this.x + this.y * this.y;
        },
        setMagnitude: function(t) {
            return this.normalize().multiply(t, t);
        },
        normalize: function() {
            if (!this.isZero()) {
                var t = this.getMagnitude();
                this.x /= t, this.y /= t;
            }
            return this;
        },
        limit: function(t) {
            return this.getMagnitudeSq() > t * t && this.setMagnitude(t), this;
        },
        expand: function(t) {
            return this.getMagnitudeSq() < t * t && this.setMagnitude(t), this;
        },
        isZero: function() {
            return 0 === this.x && 0 === this.y;
        },
        dot: function(t) {
            return this.x * t.x + this.y * t.y;
        },
        cross: function(t) {
            return this.x * t.y - this.y * t.x;
        },
        perp: function() {
            return this.setTo(-this.y, this.x);
        },
        rperp: function() {
            return this.setTo(this.y, -this.x);
        },
        normalRightHand: function() {
            return this.setTo(-1 * this.y, this.x);
        },
        floor: function() {
            return this.setTo(Math.floor(this.x), Math.floor(this.y));
        },
        ceil: function() {
            return this.setTo(Math.ceil(this.x), Math.ceil(this.y));
        },
        round: function() {
            return this.setTo(Math.round(this.x), Math.round(this.y));
        },
        toString: function() {
            return "[{Point (x=" + this.x + " y=" + this.y + ")}]";
        }
    }, z.Point.prototype.constructor = z.Point, z.Point.add = function(t, e, i) {
        return void 0 === i && (i = new z.Point()), i.x = t.x + e.x, i.y = t.y + e.y, i;
    }, z.Point.subtract = function(t, e, i) {
        return void 0 === i && (i = new z.Point()), i.x = t.x - e.x, i.y = t.y - e.y, i;
    }, z.Point.multiply = function(t, e, i) {
        return void 0 === i && (i = new z.Point()), i.x = t.x * e.x, i.y = t.y * e.y, i;
    }, z.Point.divide = function(t, e, i) {
        return void 0 === i && (i = new z.Point()), i.x = t.x / e.x, i.y = t.y / e.y, i;
    }, z.Point.equals = function(t, e) {
        return t.x === e.x && t.y === e.y;
    }, z.Point.equalsXY = function(t, e, i) {
        return t.x === e && t.y === i;
    }, z.Point.fuzzyEquals = function(t, e, i) {
        return z.Math.fuzzyEqual(t.x, e.x, i) && z.Math.fuzzyEqual(t.y, e.y, i);
    }, z.Point.fuzzyEqualsXY = function(t, e, i, n) {
        return z.Math.fuzzyEqual(t.x, e, n) && z.Math.fuzzyEqual(t.y, i, n);
    }, z.Point.angle = function(t, e) {
        return Math.atan2(t.y - e.y, t.x - e.x);
    }, z.Point.negative = function(t, e) {
        return void 0 === e && (e = new z.Point()), e.setTo(-t.x, -t.y);
    }, z.Point.multiplyAdd = function(t, e, i, n) {
        return void 0 === n && (n = new z.Point()), n.setTo(t.x + e.x * i, t.y + e.y * i);
    }, z.Point.interpolate = function(t, e, i, n) {
        return void 0 === n && (n = new z.Point()), n.setTo(t.x + (e.x - t.x) * i, t.y + (e.y - t.y) * i);
    }, z.Point.perp = function(t, e) {
        return void 0 === e && (e = new z.Point()), e.setTo(-t.y, t.x);
    }, z.Point.rperp = function(t, e) {
        return void 0 === e && (e = new z.Point()), e.setTo(t.y, -t.x);
    }, z.Point.distance = function(t, e, i) {
        var n = z.Math.distance(t.x, t.y, e.x, e.y);
        return i ? Math.round(n) : n;
    }, z.Point.project = function(t, e, i) {
        void 0 === i && (i = new z.Point());
        var n = t.dot(e) / e.getMagnitudeSq();
        return 0 !== n && i.setTo(n * e.x, n * e.y), i;
    }, z.Point.projectUnit = function(t, e, i) {
        void 0 === i && (i = new z.Point());
        var n = t.dot(e);
        return 0 !== n && i.setTo(n * e.x, n * e.y), i;
    }, z.Point.normalRightHand = function(t, e) {
        return void 0 === e && (e = new z.Point()), e.setTo(-1 * t.y, t.x);
    }, z.Point.normalize = function(t, e) {
        void 0 === e && (e = new z.Point());
        var i = t.getMagnitude();
        return 0 !== i && e.setTo(t.x / i, t.y / i), e;
    }, z.Point.rotate = function(t, e, i, n, s, o) {
        if (s && (n = z.Math.degToRad(n)), void 0 === o) {
            t.subtract(e, i);
            var a = Math.sin(n), r = Math.cos(n), h = r * t.x - a * t.y, l = a * t.x + r * t.y;
            t.x = h + e, t.y = l + i;
        } else {
            var c = n + Math.atan2(t.y - i, t.x - e);
            t.x = e + o * Math.cos(c), t.y = i + o * Math.sin(c);
        }
        return t;
    }, z.Point.centroid = function(t, e) {
        if (void 0 === e && (e = new z.Point()), "[object Array]" !== Object.prototype.toString.call(t)) throw new Error("Phaser.Point. Parameter 'points' must be an array");
        var i = t.length;
        if (i < 1) throw new Error("Phaser.Point. Parameter 'points' array must not be empty");
        if (1 === i) return e.copyFrom(t[0]), e;
        for (var n = 0; n < i; n++) z.Point.add(e, t[n], e);
        return e.divide(i, i), e;
    }, z.Point.parse = function(t, e, i) {
        e = e || "x", i = i || "y";
        var n = new z.Point();
        return t[e] && (n.x = parseFloat(t[e])), t[i] && (n.y = parseFloat(t[i])), n;
    }, z.Point.trunc = function(t) {
        return t.x = z.Math.trunc(t.x), t.y = z.Math.trunc(t.y), t;
    }, z.Point.isPoint = function(t) {
        return null != t && "number" == typeof t.x && "number" == typeof t.y;
    }, z.Point.set = function(t, e, i) {
        return t.x = e || 0, t.y = i || (0 !== i ? t.x : 0), t;
    }, z.Point.sortClockwise = function(t, e) {
        e || (e = this.centroid(t));
        var s = e.x, o = e.y;
        return t.sort(function(t, e) {
            if (0 <= t.x - s && e.x - s < 0) return -1;
            if (t.x - s < 0 && 0 <= e.x - s) return 1;
            if (t.x - s == 0 && e.x - s == 0) return 0 <= t.y - o || 0 <= e.y - o ? t.y > e.y ? 1 : -1 : e.y > t.y ? 1 : -1;
            var i = (t.x - s) * -(e.y - o) - (e.x - s) * -(t.y - o);
            if (i < 0) return -1;
            if (0 < i) return 1;
            var n = (t.x - s) * (t.x - s) + (t.y - o) * (t.y - o);
            return (e.x - s) * (e.x - s) + (e.y - o) * (e.y - o) < n ? -1 : 1;
        });
    }, PIXI.Point = z.Point, z.Polygon = function() {
        this.area = 0, this._points = [], 0 < arguments.length && this.setTo.apply(this, arguments), 
        this.closed = !0, this.flattened = !1, this.type = z.POLYGON;
    }, z.Polygon.prototype = {
        toNumberArray: function(t) {
            void 0 === t && (t = []);
            for (var e = 0; e < this._points.length; e++) "number" == typeof this._points[e] ? (t.push(this._points[e]), 
            t.push(this._points[e + 1]), e++) : (t.push(this._points[e].x), t.push(this._points[e].y));
            return t;
        },
        flatten: function() {
            return this._points = this.toNumberArray(), this.flattened = !0, this;
        },
        clone: function(t) {
            var e = this._points.slice();
            return null == t ? t = new z.Polygon(e) : t.setTo(e), t;
        },
        contains: function(t, e) {
            var i = !1;
            if (this.flattened) for (var n = -2, s = this._points.length - 2; (n += 2) < this._points.length; s = n) {
                var o = this._points[n], a = this._points[n + 1], r = this._points[s], h = this._points[s + 1];
                (a <= e && e < h || h <= e && e < a) && t < (r - o) * (e - a) / (h - a) + o && (i = !i);
            } else for (n = -1, s = this._points.length - 1; ++n < this._points.length; s = n) {
                o = this._points[n].x, a = this._points[n].y, r = this._points[s].x, h = this._points[s].y;
                (a <= e && e < h || h <= e && e < a) && t < (r - o) * (e - a) / (h - a) + o && (i = !i);
            }
            return i;
        },
        setTo: function(t) {
            if (this.area = 0, this._points = [], 0 < arguments.length) {
                Array.isArray(t) || (t = Array.prototype.slice.call(arguments));
                for (var e = Number.MAX_VALUE, i = 0, n = t.length; i < n; i++) {
                    if ("number" == typeof t[i]) {
                        var s = new PIXI.Point(t[i], t[i + 1]);
                        i++;
                    } else if (Array.isArray(t[i])) s = new PIXI.Point(t[i][0], t[i][1]); else s = new PIXI.Point(t[i].x, t[i].y);
                    this._points.push(s), s.y < e && (e = s.y);
                }
                this.calculateArea(e);
            }
            return this;
        },
        calculateArea: function(t) {
            for (var e, i, n, s, o = 0, a = this._points.length; o < a; o++) e = this._points[o], 
            i = o === a - 1 ? this._points[0] : this._points[o + 1], n = (e.y - t + (i.y - t)) / 2, 
            s = e.x - i.x, this.area += n * s;
            return this.area;
        }
    }, z.Polygon.prototype.constructor = z.Polygon, Object.defineProperty(z.Polygon.prototype, "points", {
        get: function() {
            return this._points;
        }
    }), PIXI.Polygon = z.Polygon, z.Rectangle = function(t, e, i, n) {
        t = t || 0, e = e || 0, i = i || 0, n = n || 0, this.x = t, this.y = e, this.width = i, 
        this.height = n, this.type = z.RECTANGLE;
    }, z.Rectangle.prototype = {
        offset: function(t, e) {
            return this.x += t, this.y += e, this;
        },
        offsetPoint: function(t) {
            return this.offset(t.x, t.y);
        },
        setTo: function(t, e, i, n) {
            return this.x = t, this.y = e, this.width = i, this.height = n, this;
        },
        scale: function(t, e) {
            return void 0 === e && (e = t), this.width *= t, this.height *= e, this;
        },
        centerOn: function(t, e) {
            return this.centerX = t, this.centerY = e, this;
        },
        floor: function() {
            this.x = Math.floor(this.x), this.y = Math.floor(this.y);
        },
        floorAll: function() {
            this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.width = Math.floor(this.width), 
            this.height = Math.floor(this.height);
        },
        ceil: function() {
            this.x = Math.ceil(this.x), this.y = Math.ceil(this.y);
        },
        ceilAll: function() {
            this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.width = Math.ceil(this.width), 
            this.height = Math.ceil(this.height);
        },
        copyFrom: function(t) {
            return this.setTo(t.x, t.y, t.width, t.height);
        },
        copyFromBounds: function(t) {
            return this.setTo(t.left, t.top, t.width, t.height);
        },
        copyTo: function(t) {
            return t.x = this.x, t.y = this.y, t.width = this.width, t.height = this.height, 
            t;
        },
        inflate: function(t, e) {
            return z.Rectangle.inflate(this, t, e);
        },
        size: function(t) {
            return z.Rectangle.size(this, t);
        },
        resize: function(t, e) {
            return this.width = t, this.height = e, this;
        },
        clone: function(t) {
            return z.Rectangle.clone(this, t);
        },
        contains: function(t, e) {
            return z.Rectangle.contains(this, t, e);
        },
        containsRect: function(t) {
            return z.Rectangle.containsRect(t, this);
        },
        equals: function(t) {
            return z.Rectangle.equals(this, t);
        },
        intersection: function(t, e) {
            return z.Rectangle.intersection(this, t, e);
        },
        intersects: function(t) {
            return z.Rectangle.intersects(this, t);
        },
        intersectsRaw: function(t, e, i, n, s) {
            return z.Rectangle.intersectsRaw(this, t, e, i, n, s);
        },
        union: function(t, e) {
            return z.Rectangle.union(this, t, e);
        },
        random: function(t) {
            return void 0 === t && (t = new z.Point()), t.x = this.randomX, t.y = this.randomY, 
            t;
        },
        getPoint: function(t, e) {
            switch (void 0 === e && (e = new z.Point()), t) {
              default:
              case z.TOP_LEFT:
                return e.set(this.x, this.y);

              case z.TOP_CENTER:
                return e.set(this.centerX, this.y);

              case z.TOP_RIGHT:
                return e.set(this.right, this.y);

              case z.LEFT_CENTER:
                return e.set(this.x, this.centerY);

              case z.CENTER:
                return e.set(this.centerX, this.centerY);

              case z.RIGHT_CENTER:
                return e.set(this.right, this.centerY);

              case z.BOTTOM_LEFT:
                return e.set(this.x, this.bottom);

              case z.BOTTOM_CENTER:
                return e.set(this.centerX, this.bottom);

              case z.BOTTOM_RIGHT:
                return e.set(this.right, this.bottom);
            }
        },
        sides: function(t, e, i, n) {
            arguments.length || (t = new z.Line(), e = new z.Line(), i = new z.Line(), n = new z.Line());
            var s = this.x, o = this.y, a = this.right, r = this.bottom;
            return t.setTo(s, o, a, o), e.setTo(a, o, a, r), i.setTo(s, r, a, r), n.setTo(s, o, s, r), 
            arguments.length ? null : [ t, e, i, n ];
        },
        toString: function() {
            return "[{Rectangle (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + " empty=" + this.empty + ")}]";
        }
    }, Object.defineProperty(z.Rectangle.prototype, "halfWidth", {
        get: function() {
            return Math.round(this.width / 2);
        }
    }), Object.defineProperty(z.Rectangle.prototype, "halfHeight", {
        get: function() {
            return Math.round(this.height / 2);
        }
    }), Object.defineProperty(z.Rectangle.prototype, "bottom", {
        get: function() {
            return this.y + this.height;
        },
        set: function(t) {
            t <= this.y ? this.height = 0 : this.height = t - this.y;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "bottomLeft", {
        get: function() {
            return new z.Point(this.x, this.bottom);
        },
        set: function(t) {
            this.x = t.x, this.bottom = t.y;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "bottomRight", {
        get: function() {
            return new z.Point(this.right, this.bottom);
        },
        set: function(t) {
            this.right = t.x, this.bottom = t.y;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "left", {
        get: function() {
            return this.x;
        },
        set: function(t) {
            t >= this.right ? this.width = 0 : this.width = this.right - t, this.x = t;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "right", {
        get: function() {
            return this.x + this.width;
        },
        set: function(t) {
            t <= this.x ? this.width = 0 : this.width = t - this.x;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "volume", {
        get: function() {
            return this.width * this.height;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "perimeter", {
        get: function() {
            return 2 * this.width + 2 * this.height;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "centerX", {
        get: function() {
            return this.x + this.halfWidth;
        },
        set: function(t) {
            this.x = t - this.halfWidth;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "centerY", {
        get: function() {
            return this.y + this.halfHeight;
        },
        set: function(t) {
            this.y = t - this.halfHeight;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "randomX", {
        get: function() {
            return this.x + Math.random() * this.width;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "randomY", {
        get: function() {
            return this.y + Math.random() * this.height;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "top", {
        get: function() {
            return this.y;
        },
        set: function(t) {
            t >= this.bottom ? (this.height = 0, this.y = t) : this.height = this.bottom - t;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "topLeft", {
        get: function() {
            return new z.Point(this.x, this.y);
        },
        set: function(t) {
            this.x = t.x, this.y = t.y;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "topRight", {
        get: function() {
            return new z.Point(this.x + this.width, this.y);
        },
        set: function(t) {
            this.right = t.x, this.y = t.y;
        }
    }), Object.defineProperty(z.Rectangle.prototype, "empty", {
        get: function() {
            return !this.width || !this.height;
        },
        set: function(t) {
            !0 === t && this.setTo(0, 0, 0, 0);
        }
    }), z.Rectangle.prototype.constructor = z.Rectangle, z.Rectangle.inflate = function(t, e, i) {
        return t.x -= e, t.width += 2 * e, t.y -= i, t.height += 2 * i, t;
    }, z.Rectangle.inflatePoint = function(t, e) {
        return z.Rectangle.inflate(t, e.x, e.y);
    }, z.Rectangle.size = function(t, e) {
        return null == e ? e = new z.Point(t.width, t.height) : e.setTo(t.width, t.height), 
        e;
    }, z.Rectangle.clone = function(t, e) {
        return null == e ? e = new z.Rectangle(t.x, t.y, t.width, t.height) : e.setTo(t.x, t.y, t.width, t.height), 
        e;
    }, z.Rectangle.createFromBounds = function(t, e) {
        return null == e && (e = new z.Rectangle(t.x, t.y, t.width, t.height)), e.copyFromBounds(t);
    }, z.Rectangle.contains = function(t, e, i) {
        return !(t.width <= 0 || t.height <= 0) && (e >= t.x && e < t.right && i >= t.y && i < t.bottom);
    }, z.Rectangle.containsRaw = function(t, e, i, n, s, o) {
        return t <= s && s < t + i && e <= o && o < e + n;
    }, z.Rectangle.containsPoint = function(t, e) {
        return z.Rectangle.contains(t, e.x, e.y);
    }, z.Rectangle.containsRect = function(t, e) {
        return !(t.volume > e.volume) && (t.x >= e.x && t.y >= e.y && t.right < e.right && t.bottom < e.bottom);
    }, z.Rectangle.equals = function(t, e) {
        return t.x === e.x && t.y === e.y && t.width === e.width && t.height === e.height;
    }, z.Rectangle.sameDimensions = function(t, e) {
        return t.width === e.width && t.height === e.height;
    }, z.Rectangle.intersection = function(t, e, i) {
        return void 0 === i && (i = new z.Rectangle()), z.Rectangle.intersects(t, e) && (i.x = Math.max(t.x, e.x), 
        i.y = Math.max(t.y, e.y), i.width = Math.min(t.right, e.right) - i.x, i.height = Math.min(t.bottom, e.bottom) - i.y), 
        i;
    }, z.Rectangle.intersects = function(t, e) {
        return !(t.width <= 0 || t.height <= 0 || e.width <= 0 || e.height <= 0) && !(t.right < e.x || t.bottom < e.y || t.x > e.right || t.y > e.bottom);
    }, z.Rectangle.intersectsRaw = function(t, e, i, n, s, o) {
        return void 0 === o && (o = 0), !(e > t.right + o || i < t.left - o || n > t.bottom + o || s < t.top - o);
    }, z.Rectangle.union = function(t, e, i) {
        return void 0 === i && (i = new z.Rectangle()), i.setTo(Math.min(t.x, e.x), Math.min(t.y, e.y), Math.max(t.right, e.right) - Math.min(t.left, e.left), Math.max(t.bottom, e.bottom) - Math.min(t.top, e.top));
    }, z.Rectangle.aabb = function(t, e) {
        void 0 === e && (e = new z.Rectangle());
        var i = Number.NEGATIVE_INFINITY, n = Number.POSITIVE_INFINITY, s = Number.NEGATIVE_INFINITY, o = Number.POSITIVE_INFINITY;
        return t.forEach(function(t) {
            t.x > i && (i = t.x), t.x < n && (n = t.x), t.y > s && (s = t.y), t.y < o && (o = t.y);
        }), e.setTo(n, o, i - n, s - o), e;
    }, PIXI.Rectangle = z.Rectangle, z.EmptyRectangle = new z.Rectangle(0, 0, 0, 0), 
    z.RoundedRectangle = function(t, e, i, n, s) {
        void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
        void 0 === s && (s = 20), this.x = t, this.y = e, this.width = i, this.height = n, 
        this.radius = s || 20, this.type = z.ROUNDEDRECTANGLE;
    }, z.RoundedRectangle.prototype = {
        clone: function() {
            return new z.RoundedRectangle(this.x, this.y, this.width, this.height, this.radius);
        },
        contains: function(t, e) {
            if (this.width <= 0 || this.height <= 0) return !1;
            var i = this.x;
            if (i <= t && t <= i + this.width) {
                var n = this.y;
                if (n <= e && e <= n + this.height) return !0;
            }
            return !1;
        }
    }, z.RoundedRectangle.prototype.constructor = z.RoundedRectangle, PIXI.RoundedRectangle = z.RoundedRectangle, 
    z.Camera = function(t, e, i, n, s, o) {
        this.game = t, this.world = t.world, this.id = 0, this.view = new z.Rectangle(i, n, s, o), 
        this.bounds = new z.Rectangle(i, n, s, o), this.deadzone = null, this.visible = !0, 
        this.roundPx = !0, this.atLimit = {
            x: !1,
            y: !1
        }, this.target = null, this.displayObject = null, this.scale = null, this.totalInView = 0, 
        this.lerp = new z.Point(1, 1), this.onShakeComplete = new z.Signal(), this.onFlashComplete = new z.Signal(), 
        this.onFadeComplete = new z.Signal(), this.fx = null, this._targetPosition = new z.Point(), 
        this._edge = 0, this._position = new z.Point(), this._shake = {
            intensity: 0,
            duration: 0,
            horizontal: !1,
            vertical: !1,
            shakeBounds: !0,
            x: 0,
            y: 0
        }, this._fxDuration = 0, this._fxType = 0, this._fixedView = new z.Rectangle();
    }, z.Camera.FOLLOW_LOCKON = 0, z.Camera.FOLLOW_PLATFORMER = 1, z.Camera.FOLLOW_TOPDOWN = 2, 
    z.Camera.FOLLOW_TOPDOWN_TIGHT = 3, z.Camera.SHAKE_BOTH = 4, z.Camera.SHAKE_HORIZONTAL = 5, 
    z.Camera.SHAKE_VERTICAL = 6, z.Camera.ENABLE_FX = !0, z.Camera.prototype = {
        boot: function() {
            this.displayObject = this.game.world, this.scale = this.game.world.scale, this.game.camera = this, 
            z.Graphics && z.Camera.ENABLE_FX && (this.fx = new z.Graphics(this.game), this.game.stage.addChild(this.fx));
        },
        preUpdate: function() {
            this.totalInView = 0;
        },
        follow: function(t, e, i, n) {
            var s;
            switch (void 0 === e && (e = z.Camera.FOLLOW_LOCKON), void 0 === i && (i = 1), void 0 === n && (n = 1), 
            this.target = t, this.lerp.set(i, n), e) {
              case z.Camera.FOLLOW_PLATFORMER:
                var o = this.width / 8, a = this.height / 3;
                this.deadzone = new z.Rectangle((this.width - o) / 2, (this.height - a) / 2 - .25 * a, o, a);
                break;

              case z.Camera.FOLLOW_TOPDOWN:
                s = Math.max(this.width, this.height) / 4, this.deadzone = new z.Rectangle((this.width - s) / 2, (this.height - s) / 2, s, s);
                break;

              case z.Camera.FOLLOW_TOPDOWN_TIGHT:
                s = Math.max(this.width, this.height) / 8, this.deadzone = new z.Rectangle((this.width - s) / 2, (this.height - s) / 2, s, s);
                break;

              case z.Camera.FOLLOW_LOCKON:
              default:
                this.deadzone = null;
            }
        },
        unfollow: function() {
            this.target = null;
        },
        focusOn: function(t) {
            this.setPosition(Math.round(t.x - this.view.halfWidth), Math.round(t.y - this.view.halfHeight));
        },
        focusOnXY: function(t, e) {
            this.setPosition(Math.round(t - this.view.halfWidth), Math.round(e - this.view.halfHeight));
        },
        shake: function(t, e, i, n, s) {
            return void 0 === t && (t = .05), void 0 === e && (e = 500), void 0 === i && (i = !0), 
            void 0 === n && (n = z.Camera.SHAKE_BOTH), void 0 === s && (s = !0), !(!i && 0 < this._shake.duration) && (this._shake.intensity = t, 
            this._shake.duration = e, this._shake.shakeBounds = s, this._shake.x = 0, this._shake.y = 0, 
            this._shake.horizontal = n === z.Camera.SHAKE_BOTH || n === z.Camera.SHAKE_HORIZONTAL, 
            this._shake.vertical = n === z.Camera.SHAKE_BOTH || n === z.Camera.SHAKE_VERTICAL, 
            !0);
        },
        flash: function(t, e, i, n) {
            return void 0 === t && (t = 16777215), void 0 === e && (e = 500), void 0 === i && (i = !1), 
            void 0 === n && (n = 1), !(!this.fx || !i && 0 < this._fxDuration) && (this.fx.clear(), 
            this.fx.beginFill(t, n), this.fx.drawRect(0, 0, this.width, this.height), this.fx.endFill(), 
            this.fx.alpha = 1, this._fxDuration = e, !(this._fxType = 0));
        },
        fade: function(t, e, i, n) {
            return void 0 === t && (t = 0), void 0 === e && (e = 500), void 0 === i && (i = !1), 
            void 0 === n && (n = 1), !(!this.fx || !i && 0 < this._fxDuration) && (this.fx.clear(), 
            this.fx.beginFill(t, n), this.fx.drawRect(0, 0, this.width, this.height), this.fx.endFill(), 
            this.fx.alpha = 0, this._fxDuration = e, this._fxType = 1, !0);
        },
        update: function() {
            0 < this._fxDuration && this.updateFX(), 0 < this._shake.duration && this.updateShake(), 
            this.bounds && this.checkBounds(), this.roundPx && (this.view.floor(), this._shake.x = Math.floor(this._shake.x), 
            this._shake.y = Math.floor(this._shake.y)), this.displayObject.position.x = -this.view.x, 
            this.displayObject.position.y = -this.view.y;
        },
        updateFX: function() {
            0 === this._fxType ? (this.fx.alpha -= this.game.time.elapsedMS / this._fxDuration, 
            this.fx.alpha <= 0 && (this._fxDuration = 0, this.fx.alpha = 0, this.onFlashComplete.dispatch())) : (this.fx.alpha += this.game.time.elapsedMS / this._fxDuration, 
            1 <= this.fx.alpha && (this._fxDuration = 0, this.fx.alpha = 1, this.onFadeComplete.dispatch()));
        },
        updateShake: function() {
            this._shake.duration -= this.game.time.elapsedMS, this._shake.duration <= 0 ? (this.onShakeComplete.dispatch(), 
            this._shake.x = 0, this._shake.y = 0) : (this._shake.horizontal && (this._shake.x = this.game.rnd.frac() * this._shake.intensity * this.view.width * 2 - this._shake.intensity * this.view.width), 
            this._shake.vertical && (this._shake.y = this.game.rnd.frac() * this._shake.intensity * this.view.height * 2 - this._shake.intensity * this.view.height));
        },
        updateTarget: function() {
            this._targetPosition.x = this.view.x + this.target.worldPosition.x, this._targetPosition.y = this.view.y + this.target.worldPosition.y, 
            this.deadzone ? (this._edge = this._targetPosition.x - this.view.x, this._edge < this.deadzone.left ? this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.deadzone.left, this.lerp.x) : this._edge > this.deadzone.right && (this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.deadzone.right, this.lerp.x)), 
            this._edge = this._targetPosition.y - this.view.y, this._edge < this.deadzone.top ? this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.deadzone.top, this.lerp.y) : this._edge > this.deadzone.bottom && (this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.deadzone.bottom, this.lerp.y))) : (this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.view.halfWidth, this.lerp.x), 
            this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.view.halfHeight, this.lerp.y)), 
            this.bounds && this.checkBounds(), this.roundPx && this.view.floor(), this.displayObject.position.x = -this.view.x, 
            this.displayObject.position.y = -this.view.y;
        },
        setBoundsToWorld: function() {
            this.bounds && this.bounds.copyFrom(this.game.world.bounds);
        },
        checkBounds: function() {
            this.atLimit.x = !1, this.atLimit.y = !1;
            var t = this.view.x + this._shake.x, e = this.view.right + this._shake.x, i = this.view.y + this._shake.y, n = this.view.bottom + this._shake.y;
            t <= this.bounds.x * this.scale.x ? (this.atLimit.x = !0, this.view.x = this.bounds.x * this.scale.x, 
            this._shake.shakeBounds || (this._shake.x = 0)) : e >= this.bounds.right * this.scale.x && (this.atLimit.x = !0, 
            this.view.x = this.bounds.right * this.scale.x - this.width, this._shake.shakeBounds || (this._shake.x = 0)), 
            i <= this.bounds.top * this.scale.y ? (this.atLimit.y = !0, this.view.y = this.bounds.top * this.scale.y, 
            this._shake.shakeBounds || (this._shake.y = 0)) : n >= this.bounds.bottom * this.scale.y && (this.atLimit.y = !0, 
            this.view.y = this.bounds.bottom * this.scale.y - this.height, this._shake.shakeBounds || (this._shake.y = 0));
        },
        setPosition: function(t, e) {
            this.view.x = t, this.view.y = e, this.bounds && this.checkBounds();
        },
        setSize: function(t, e) {
            this.view.width = t, this.view.height = e;
        },
        reset: function() {
            this.target = null, this.view.x = 0, this.view.y = 0, this._shake.duration = 0, 
            this._shake.x = 0, this._shake.y = 0, this.resetFX();
        },
        resetFX: function() {
            this.fx && (this.fx.clear(), this.fx.alpha = 0), this._fxDuration = 0;
        }
    }, z.Camera.prototype.constructor = z.Camera, Object.defineProperty(z.Camera.prototype, "x", {
        get: function() {
            return this.view.x;
        },
        set: function(t) {
            this.view.x = t, this.bounds && this.checkBounds();
        }
    }), Object.defineProperty(z.Camera.prototype, "y", {
        get: function() {
            return this.view.y;
        },
        set: function(t) {
            this.view.y = t, this.bounds && this.checkBounds();
        }
    }), Object.defineProperty(z.Camera.prototype, "position", {
        get: function() {
            return this._position.set(this.view.x, this.view.y), this._position;
        },
        set: function(t) {
            void 0 !== t.x && (this.view.x = t.x), void 0 !== t.y && (this.view.y = t.y), this.bounds && this.checkBounds();
        }
    }), Object.defineProperty(z.Camera.prototype, "width", {
        get: function() {
            return this.view.width;
        },
        set: function(t) {
            this.view.width = t;
        }
    }), Object.defineProperty(z.Camera.prototype, "height", {
        get: function() {
            return this.view.height;
        },
        set: function(t) {
            this.view.height = t;
        }
    }), Object.defineProperty(z.Camera.prototype, "shakeIntensity", {
        get: function() {
            return this._shake.intensity;
        },
        set: function(t) {
            this._shake.intensity = t;
        }
    }), Object.defineProperty(z.Camera.prototype, "fixedView", {
        get: function() {
            return this._fixedView.setTo(0, 0, this.view.width, this.view.height), this._fixedView;
        }
    }), Object.defineProperty(z.Camera.prototype, "centerX", {
        get: function() {
            return this.x + .5 * this.width;
        }
    }), Object.defineProperty(z.Camera.prototype, "centerY", {
        get: function() {
            return this.y + .5 * this.height;
        }
    }), z.State = function() {
        this.game = null, this.key = "", this.add = null, this.make = null, this.camera = null, 
        this.cache = null, this.input = null, this.load = null, this.math = null, this.sound = null, 
        this.scale = null, this.stage = null, this.state = null, this.time = null, this.tweens = null, 
        this.world = null, this.particles = null, this.physics = null, this.rnd = null;
    }, z.State.prototype = {
        init: function() {},
        preload: function() {},
        loadUpdate: function() {},
        loadRender: function() {},
        create: function() {},
        update: function() {},
        postUpdate: function() {},
        preRender: function() {},
        render: function() {},
        resize: function() {},
        paused: function() {},
        resumed: function() {},
        pauseUpdate: function() {},
        shutdown: function() {}
    }, z.State.prototype.constructor = z.State, z.StateManager = function(t, e) {
        this.game = t, this.states = {}, (this._pendingState = null) != e && (this._pendingState = e), 
        this._clearWorld = !1, this._clearCache = !1, this._created = !1, this._args = [], 
        this.current = "", this.onStateChange = new z.Signal(), this.onInitCallback = null, 
        this.onPreloadCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, 
        this.onRenderCallback = null, this.onResizeCallback = null, this.onPreRenderCallback = null, 
        this.onLoadUpdateCallback = null, this.onLoadRenderCallback = null, this.onPausedCallback = null, 
        this.onResumedCallback = null, this.onPauseUpdateCallback = null, this.onShutDownCallback = null;
    }, z.StateManager.prototype = {
        boot: function() {
            this.game.onPause.add(this.pause, this), this.game.onResume.add(this.resume, this), 
            null !== this._pendingState && "string" != typeof this._pendingState && this.add("default", this._pendingState, !0);
        },
        add: function(t, e, i) {
            var n;
            return void 0 === i && (i = !1), e instanceof z.State ? n = e : "object" == typeof e ? (n = e).game = this.game : "function" == typeof e && (n = new e(this.game)), 
            this.states[t] = n, i && (this.game.isBooted ? this.start(t) : this._pendingState = t), 
            n;
        },
        remove: function(t) {
            this.current === t && (this.callbackContext = null, this.onInitCallback = null, 
            this.onShutDownCallback = null, this.onPreloadCallback = null, this.onLoadRenderCallback = null, 
            this.onLoadUpdateCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, 
            this.onPreRenderCallback = null, this.onRenderCallback = null, this.onResizeCallback = null, 
            this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null), 
            delete this.states[t];
        },
        start: function(t, e, i) {
            void 0 === e && (e = !0), void 0 === i && (i = !1), this.checkState(t) && (this._pendingState = t, 
            this._clearWorld = e, this._clearCache = i, 3 < arguments.length && (this._args = Array.prototype.splice.call(arguments, 3)));
        },
        restart: function(t, e) {
            void 0 === t && (t = !0), void 0 === e && (e = !1), this._pendingState = this.current, 
            this._clearWorld = t, this._clearCache = e, 2 < arguments.length && (this._args = Array.prototype.slice.call(arguments, 2));
        },
        dummy: function() {},
        preUpdate: function() {
            if (this._pendingState && this.game.isBooted) {
                var t = this.current;
                if (this.clearCurrentState(), this.setCurrentState(this._pendingState), this.onStateChange.dispatch(this.current, t), 
                this.current !== this._pendingState) return;
                this._pendingState = null, this.onPreloadCallback ? (this.game.load.reset(!0), this.onPreloadCallback.call(this.callbackContext, this.game), 
                0 === this.game.load.totalQueuedFiles() && 0 === this.game.load.totalQueuedPacks() ? this.loadComplete() : this.game.load.start()) : this.loadComplete();
            }
        },
        clearCurrentState: function() {
            this.current && (this.onShutDownCallback && this.onShutDownCallback.call(this.callbackContext, this.game), 
            this.game.tweens.removeAll(), this.game.camera.reset(), this.game.input.reset(!0), 
            this.game.physics.clear(), this.game.time.removeAll(), this.game.scale.reset(this._clearWorld), 
            this.game.debug && this.game.debug.reset(), this._clearWorld && (this.game.world.shutdown(), 
            this._clearCache && this.game.cache.destroy()));
        },
        checkState: function(t) {
            var e = this.states[t];
            return !!e && !!(e.preload || e.create || e.update || e.render);
        },
        link: function(t) {
            var e = this.states[t];
            e.game = this.game, e.add = this.game.add, e.make = this.game.make, e.camera = this.game.camera, 
            e.cache = this.game.cache, e.input = this.game.input, e.load = this.game.load, e.math = this.game.math, 
            e.sound = this.game.sound, e.scale = this.game.scale, e.state = this, e.stage = this.game.stage, 
            e.time = this.game.time, e.tweens = this.game.tweens, e.world = this.game.world, 
            e.particles = this.game.particles, e.rnd = this.game.rnd, e.physics = this.game.physics, 
            e.key = t;
        },
        unlink: function(t) {
            var e = this.states[t];
            e && (e.game = null, e.add = null, e.make = null, e.camera = null, e.cache = null, 
            e.input = null, e.load = null, e.math = null, e.sound = null, e.scale = null, e.state = null, 
            e.stage = null, e.time = null, e.tweens = null, e.world = null, e.particles = null, 
            e.rnd = null, e.physics = null);
        },
        setCurrentState: function(t) {
            var e = this.states[t];
            this.callbackContext = e, this.link(t), this.onInitCallback = e.init || this.dummy, 
            this.onPreloadCallback = e.preload || null, this.onLoadRenderCallback = e.loadRender || null, 
            this.onLoadUpdateCallback = e.loadUpdate || null, this.onCreateCallback = e.create || null, 
            this.onUpdateCallback = e.update || null, this.onPostUpdateCallback = e.postUpdate || null, 
            this.onPreRenderCallback = e.preRender || null, this.onRenderCallback = e.render || null, 
            this.onResizeCallback = e.resize || null, this.onPausedCallback = e.paused || null, 
            this.onResumedCallback = e.resumed || null, this.onPauseUpdateCallback = e.pauseUpdate || null, 
            this.onShutDownCallback = e.shutdown || this.dummy, "" !== this.current && this.game.physics.reset(), 
            this.current = t, this._created = !1, this.onInitCallback.apply(this.callbackContext, this._args), 
            t === this._pendingState && (this._args = []), this.game._kickstart = !0;
        },
        getCurrentState: function() {
            return this.states[this.current];
        },
        loadComplete: function() {
            !1 === this._created && this.onCreateCallback ? (this._created = !0, this.onCreateCallback.call(this.callbackContext, this.game)) : this._created = !0;
        },
        loadUpdate: function() {
            !1 === this._created && this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game);
        },
        pause: function() {
            this._created && this.onPausedCallback && this.onPausedCallback.call(this.callbackContext, this.game);
        },
        resume: function() {
            this._created && this.onResumedCallback && this.onResumedCallback.call(this.callbackContext, this.game);
        },
        update: function() {
            this._created ? this.onUpdateCallback && this.onUpdateCallback.call(this.callbackContext, this.game) : this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game);
        },
        postUpdate: function() {
            this._created && this.onPostUpdateCallback && this.onPostUpdateCallback.call(this.callbackContext, this.game);
        },
        pauseUpdate: function() {
            this._created ? this.onPauseUpdateCallback && this.onPauseUpdateCallback.call(this.callbackContext, this.game) : this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game);
        },
        preRender: function(t) {
            this._created && this.onPreRenderCallback && this.onPreRenderCallback.call(this.callbackContext, this.game, t);
        },
        resize: function(t, e) {
            this.onResizeCallback && this.onResizeCallback.call(this.callbackContext, t, e);
        },
        render: function() {
            this._created ? this.onRenderCallback && (this.game.renderType === z.CANVAS ? (this.game.context.save(), 
            this.game.context.setTransform(1, 0, 0, 1, 0, 0), this.onRenderCallback.call(this.callbackContext, this.game), 
            this.game.context.restore()) : this.onRenderCallback.call(this.callbackContext, this.game)) : this.onLoadRenderCallback && this.onLoadRenderCallback.call(this.callbackContext, this.game);
        },
        destroy: function() {
            this._clearWorld = !0, this._clearCache = !0, this.clearCurrentState(), this.callbackContext = null, 
            this.onInitCallback = null, this.onShutDownCallback = null, this.onPreloadCallback = null, 
            this.onLoadRenderCallback = null, this.onLoadUpdateCallback = null, this.onCreateCallback = null, 
            this.onUpdateCallback = null, this.onPostUpdateCallback = null, this.onRenderCallback = null, 
            this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null, 
            this.game = null, this.states = {}, this._pendingState = null, this.current = "";
        }
    }, z.StateManager.prototype.constructor = z.StateManager, Object.defineProperty(z.StateManager.prototype, "created", {
        get: function() {
            return this._created;
        }
    }), z.Signal = function() {}, z.Signal.prototype = {
        _bindings: null,
        _prevParams: null,
        memorize: !1,
        _shouldPropagate: !0,
        active: !0,
        _boundDispatch: !1,
        validateListener: function(t, e) {
            if ("function" != typeof t) throw new Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}", e));
        },
        _registerListener: function(t, e, i, n, s) {
            var o, a = this._indexOfListener(t, i);
            if (-1 !== a) {
                if ((o = this._bindings[a]).isOnce() !== e) throw new Error("You cannot add" + (e ? "" : "Once") + "() then add" + (e ? "Once" : "") + "() the same listener without removing the relationship first.");
            } else o = new z.SignalBinding(this, t, e, i, n, s), this._addBinding(o);
            return this.memorize && this._prevParams && o.execute(this._prevParams), o;
        },
        _addBinding: function(t) {
            this._bindings || (this._bindings = []);
            for (var e = this._bindings.length; e--, this._bindings[e] && t._priority <= this._bindings[e]._priority; ) ;
            this._bindings.splice(e + 1, 0, t);
        },
        _indexOfListener: function(t, e) {
            if (!this._bindings) return -1;
            void 0 === e && (e = null);
            for (var i, n = this._bindings.length; n--; ) if ((i = this._bindings[n])._listener === t && i.context === e) return n;
            return -1;
        },
        has: function(t, e) {
            return -1 !== this._indexOfListener(t, e);
        },
        add: function(t, e, i) {
            this.validateListener(t, "add");
            var n = [];
            if (3 < arguments.length) for (var s = 3; s < arguments.length; s++) n.push(arguments[s]);
            return this._registerListener(t, !1, e, i, n);
        },
        addOnce: function(t, e, i) {
            this.validateListener(t, "addOnce");
            var n = [];
            if (3 < arguments.length) for (var s = 3; s < arguments.length; s++) n.push(arguments[s]);
            return this._registerListener(t, !0, e, i, n);
        },
        remove: function(t, e) {
            this.validateListener(t, "remove");
            var i = this._indexOfListener(t, e);
            return -1 !== i && (this._bindings[i]._destroy(), this._bindings.splice(i, 1)), 
            t;
        },
        removeAll: function(t) {
            if (void 0 === t && (t = null), this._bindings) {
                for (var e = this._bindings.length; e--; ) t ? this._bindings[e].context === t && (this._bindings[e]._destroy(), 
                this._bindings.splice(e, 1)) : this._bindings[e]._destroy();
                t || (this._bindings.length = 0);
            }
        },
        getNumListeners: function() {
            return this._bindings ? this._bindings.length : 0;
        },
        halt: function() {
            this._shouldPropagate = !1;
        },
        dispatch: function() {
            if (this.active && (this._bindings || this.memorize)) {
                var t = Array.prototype.slice.call(arguments);
                this.memorize && (this._prevParams = t);
                var e = this._bindings ? this._bindings.length : 0;
                if (e) {
                    var i = this._bindings.slice();
                    for (this._shouldPropagate = !0; i[--e] && this._shouldPropagate && !1 !== i[e].execute(t); ) ;
                }
            }
        },
        forget: function() {
            this._prevParams && (this._prevParams = null);
        },
        dispose: function() {
            this.removeAll(), this._bindings = null, this._prevParams && (this._prevParams = null);
        },
        toString: function() {
            return "[Phaser.Signal active:" + this.active + " numListeners:" + this.getNumListeners() + "]";
        }
    }, Object.defineProperty(z.Signal.prototype, "boundDispatch", {
        get: function() {
            var t = this;
            return this._boundDispatch || (this._boundDispatch = function() {
                return t.dispatch.apply(t, arguments);
            });
        }
    }), z.Signal.prototype.constructor = z.Signal, z.SignalBinding = function(t, e, i, n, s, o) {
        this._listener = e, i && (this._isOnce = !0), null != n && (this.context = n), this._signal = t, 
        s && (this._priority = s), o && o.length && (this._args = o);
    }, z.SignalBinding.prototype = {
        context: null,
        _isOnce: !1,
        _priority: 0,
        _args: null,
        callCount: 0,
        active: !0,
        params: null,
        execute: function(t) {
            var e, i;
            return this.active && this._listener && (i = this.params ? this.params.concat(t) : t, 
            this._args && (i = i.concat(this._args)), e = this._listener.apply(this.context, i), 
            this.callCount++, this._isOnce && this.detach()), e;
        },
        detach: function() {
            return this.isBound() ? this._signal.remove(this._listener, this.context) : null;
        },
        isBound: function() {
            return !!this._signal && !!this._listener;
        },
        isOnce: function() {
            return this._isOnce;
        },
        getListener: function() {
            return this._listener;
        },
        getSignal: function() {
            return this._signal;
        },
        _destroy: function() {
            delete this._signal, delete this._listener, delete this.context;
        },
        toString: function() {
            return "[Phaser.SignalBinding isOnce:" + this._isOnce + ", isBound:" + this.isBound() + ", active:" + this.active + "]";
        }
    }, z.SignalBinding.prototype.constructor = z.SignalBinding, z.Filter = function(t, e, i) {
        this.game = t, this.type = z.WEBGL_FILTER, this.passes = [ this ], this.shaders = [], 
        this.dirty = !0, this.padding = 0, this.prevPoint = new z.Point();
        var n = new Date();
        if (this.uniforms = {
            resolution: {
                type: "2f",
                value: {
                    x: 256,
                    y: 256
                }
            },
            time: {
                type: "1f",
                value: 0
            },
            mouse: {
                type: "2f",
                value: {
                    x: 0,
                    y: 0
                }
            },
            date: {
                type: "4fv",
                value: [ n.getFullYear(), n.getMonth(), n.getDate(), 60 * n.getHours() * 60 + 60 * n.getMinutes() + n.getSeconds() ]
            },
            sampleRate: {
                type: "1f",
                value: 44100
            },
            iChannel0: {
                type: "sampler2D",
                value: null,
                textureData: {
                    repeat: !0
                }
            },
            iChannel1: {
                type: "sampler2D",
                value: null,
                textureData: {
                    repeat: !0
                }
            },
            iChannel2: {
                type: "sampler2D",
                value: null,
                textureData: {
                    repeat: !0
                }
            },
            iChannel3: {
                type: "sampler2D",
                value: null,
                textureData: {
                    repeat: !0
                }
            }
        }, e) for (var s in e) this.uniforms[s] = e[s];
        "string" == typeof i && (i = i.split("\n")), this.fragmentSrc = i || [];
    }, z.Filter.prototype = {
        init: function() {},
        setResolution: function(t, e) {
            this.uniforms.resolution.value.x = t, this.uniforms.resolution.value.y = e;
        },
        update: function(t) {
            if (t) {
                var e = t.x / this.game.width, i = 1 - t.y / this.game.height;
                e === this.prevPoint.x && i === this.prevPoint.y || (this.uniforms.mouse.value.x = e.toFixed(2), 
                this.uniforms.mouse.value.y = i.toFixed(2), this.prevPoint.set(e, i));
            }
            this.uniforms.time.value = this.game.time.totalElapsedSeconds();
        },
        addToWorld: function(t, e, i, n, s, o) {
            void 0 === s && (s = 0), void 0 === o && (o = 0), null != i ? this.width = i : i = this.width, 
            null != n ? this.height = n : n = this.height;
            var a = this.game.add.image(t, e, z.Cache.DEFAULT);
            return a.width = i, a.height = n, a.anchor.set(s, o), a.filters = [ this ], a;
        },
        syncUniforms: function() {
            for (var t = 0; t < this.shaders.length; t++) this.shaders[t].dirty = !0;
        },
        destroy: function() {
            this.passes.length = 0, this.shaders.length = 0, this.fragmentSrc.length = 0, this.game = null, 
            this.uniforms = null, this.prevPoint = null;
        }
    }, z.Filter.prototype.constructor = z.Filter, Object.defineProperty(z.Filter.prototype, "width", {
        get: function() {
            return this.uniforms.resolution.value.x;
        },
        set: function(t) {
            this.uniforms.resolution.value.x = t;
        }
    }), Object.defineProperty(z.Filter.prototype, "height", {
        get: function() {
            return this.uniforms.resolution.value.y;
        },
        set: function(t) {
            this.uniforms.resolution.value.y = t;
        }
    }), z.Plugin = function(t, e) {
        void 0 === e && (e = null), this.game = t, this.parent = e, this.active = !1, this.visible = !1, 
        this.hasPreUpdate = !1, this.hasUpdate = !1, this.hasPostUpdate = !1, this.hasRender = !1, 
        this.hasPostRender = !1;
    }, z.Plugin.prototype = {
        preUpdate: function() {},
        update: function() {},
        render: function() {},
        postRender: function() {},
        destroy: function() {
            this.game = null, this.parent = null, this.active = !1, this.visible = !1;
        }
    }, z.Plugin.prototype.constructor = z.Plugin, z.PluginManager = function(t) {
        this.game = t, this.plugins = [], this._len = 0, this._i = 0;
    }, z.PluginManager.prototype = {
        add: function(t) {
            var e = Array.prototype.slice.call(arguments, 1), i = !1;
            return "function" == typeof t ? t = new t(this.game, this) : (t.game = this.game, 
            t.parent = this), "function" == typeof t.preUpdate && (i = t.hasPreUpdate = !0), 
            "function" == typeof t.update && (i = t.hasUpdate = !0), "function" == typeof t.postUpdate && (i = t.hasPostUpdate = !0), 
            "function" == typeof t.render && (i = t.hasRender = !0), "function" == typeof t.postRender && (i = t.hasPostRender = !0), 
            i ? ((t.hasPreUpdate || t.hasUpdate || t.hasPostUpdate) && (t.active = !0), (t.hasRender || t.hasPostRender) && (t.visible = !0), 
            this._len = this.plugins.push(t), "function" == typeof t.init && t.init.apply(t, e), 
            t) : null;
        },
        remove: function(t, e) {
            for (void 0 === e && (e = !0), this._i = this._len; this._i--; ) if (this.plugins[this._i] === t) return e && t.destroy(), 
            this.plugins.splice(this._i, 1), void this._len--;
        },
        removeAll: function() {
            for (this._i = this._len; this._i--; ) this.plugins[this._i].destroy();
            this.plugins.length = 0, this._len = 0;
        },
        preUpdate: function() {
            for (this._i = this._len; this._i--; ) this.plugins[this._i].active && this.plugins[this._i].hasPreUpdate && this.plugins[this._i].preUpdate();
        },
        update: function() {
            for (this._i = this._len; this._i--; ) this.plugins[this._i].active && this.plugins[this._i].hasUpdate && this.plugins[this._i].update();
        },
        postUpdate: function() {
            for (this._i = this._len; this._i--; ) this.plugins[this._i].active && this.plugins[this._i].hasPostUpdate && this.plugins[this._i].postUpdate();
        },
        render: function() {
            for (this._i = this._len; this._i--; ) this.plugins[this._i].visible && this.plugins[this._i].hasRender && this.plugins[this._i].render();
        },
        postRender: function() {
            for (this._i = this._len; this._i--; ) this.plugins[this._i].visible && this.plugins[this._i].hasPostRender && this.plugins[this._i].postRender();
        },
        destroy: function() {
            this.removeAll(), this.game = null;
        }
    }, z.PluginManager.prototype.constructor = z.PluginManager, z.Stage = function(t) {
        this.game = t, PIXI.DisplayObjectContainer.call(this), this.name = "_stage_root", 
        this.disableVisibilityChange = !1, this.exists = !0, this.worldTransform = new z.Matrix(), 
        (this.stage = this).currentRenderOrderID = 0, this._hiddenVar = "hidden", this._onChange = null, 
        this._bgColor = {
            r: 0,
            g: 0,
            b: 0,
            a: 0,
            color: 0,
            rgba: "#000000"
        }, this.game.transparent || (this._bgColor.a = 1), t.config && this.parseConfig(t.config);
    }, z.Stage.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), z.Stage.prototype.constructor = z.Stage, 
    z.Stage.prototype.parseConfig = function(t) {
        t.disableVisibilityChange && (this.disableVisibilityChange = t.disableVisibilityChange), 
        t.backgroundColor && this.setBackgroundColor(t.backgroundColor);
    }, z.Stage.prototype.boot = function() {
        z.DOM.getOffset(this.game.canvas, this.offset), z.Canvas.setUserSelect(this.game.canvas, "none"), 
        z.Canvas.setTouchAction(this.game.canvas, "none"), this.checkVisibility();
    }, z.Stage.prototype.preUpdate = function() {
        for (var t = this.currentRenderOrderID = 0; t < this.children.length; ) {
            var e = this.children[t];
            e.preUpdate(), this === e.parent && t++;
        }
    }, z.Stage.prototype.update = function() {
        for (var t = this.children.length; t--; ) this.children[t].update();
    }, z.Stage.prototype.postUpdate = function() {
        this.game.camera.update(), this.game.camera.target && (this.game.camera.target.postUpdate(), 
        this.updateTransform(), this.game.camera.updateTarget());
        for (var t = 0; t < this.children.length; t++) this.children[t].postUpdate();
        this.updateTransform();
    }, z.Stage.prototype.updateTransform = function() {
        this.worldAlpha = 1;
        for (var t = 0; t < this.children.length; t++) this.children[t].updateTransform();
    }, z.Stage.prototype.checkVisibility = function() {
        void 0 !== document.hidden ? this._hiddenVar = "visibilitychange" : void 0 !== document.webkitHidden ? this._hiddenVar = "webkitvisibilitychange" : void 0 !== document.mozHidden ? this._hiddenVar = "mozvisibilitychange" : void 0 !== document.msHidden ? this._hiddenVar = "msvisibilitychange" : this._hiddenVar = null;
        var e = this;
        this._onChange = function(t) {
            return e.visibilityChange(t);
        }, this._onChangePause = function() {
            return e._onChange({
                type: "pause"
            });
        }, this._onChangeResume = function() {
            return e._onChange({
                type: "resume"
            });
        }, this._onClick = function(t) {
            void 0 === document.hasFocus || document.hasFocus() || e.visibilityChange(t);
        }, this._hiddenVar && document.addEventListener(this._hiddenVar, this._onChange, !1), 
        window.onblur = this._onChange, window.onfocus = this._onChange, window.onpagehide = this._onChange, 
        window.onpageshow = this._onChange, window.addEventListener("click", this._onClick), 
        this.game.device.cocoonJSApp && CocoonJS.App && (CocoonJS.App.onSuspended && CocoonJS.App.onSuspended.addEventListener(this._onChangePause), 
        CocoonJS.App.onActivated && CocoonJS.App.onActivated.addEventListener(this._onChangeResume), 
        CocoonJS.App.on && (CocoonJS.App.on("activated", this._onChangeResume), CocoonJS.App.on("suspended", this._onChangePause)));
    }, z.Stage.prototype.visibilityChange = function(t) {
        switch (t.type) {
          case "blur":
          case "pagehide":
            return void this.game.focusLoss(t);

          case "click":
          case "focus":
          case "pageshow":
            return void this.game.focusGain(t);
        }
        this.disableVisibilityChange || (document.hidden || document.mozHidden || document.msHidden || document.webkitHidden || "pause" === t.type ? this.game.gamePaused(t) : this.game.gameResumed(t));
    }, z.Stage.prototype.setBackgroundColor = function(t) {
        this.game.transparent || (z.Color.valueToColor(t, this._bgColor), z.Color.updateColor(this._bgColor), 
        this._bgColor.r /= 255, this._bgColor.g /= 255, this._bgColor.b /= 255, this._bgColor.a = 1);
    }, z.Stage.prototype.destroy = function() {
        this._hiddenVar && document.removeEventListener(this._hiddenVar, this._onChange, !1), 
        window.onpagehide = null, window.onpageshow = null, window.onblur = null, window.onfocus = null, 
        window.removeEventListener("click", this._onClick);
    }, z.Stage.prototype.add = function(t, e, i) {
        return t.parent === this || (t.body && t.parent && t.parent.hash && t.parent.removeFromHash(t), 
        void 0 === i ? this.addChild(t) : this.addChildAt(t, i)), t;
    }, Object.defineProperty(z.Stage.prototype, "backgroundColor", {
        get: function() {
            return this._bgColor.color;
        },
        set: function(t) {
            this.setBackgroundColor(t);
        }
    }), Object.defineProperty(z.Stage.prototype, "smoothed", {
        get: function() {
            return PIXI.scaleModes.DEFAULT === PIXI.scaleModes.LINEAR;
        },
        set: function(t) {
            PIXI.scaleModes.DEFAULT = t ? PIXI.scaleModes.LINEAR : PIXI.scaleModes.NEAREST;
        }
    }), z.Group = function(t, e, i, n, s, o) {
        void 0 === n && (n = !1), void 0 === s && (s = !1), void 0 === o && (o = z.Physics.ARCADE), 
        this.game = t, void 0 === e && (e = t.world), this.name = i || "group", this.z = 0, 
        PIXI.DisplayObjectContainer.call(this), n ? (this.game.stage.addChild(this), this.z = this.game.stage.children.length) : e && (e.addChild(this), 
        this.z = e.children.length), this.type = z.GROUP, this.physicsType = z.GROUP, this.alive = !0, 
        this.exists = !0, this.ignoreDestroy = !1, this.pendingDestroy = !1, this.classType = z.Sprite, 
        this.cursor = null, this.inputEnableChildren = !1, this.updateOnlyExistingChildren = !1, 
        this.onChildInputDown = new z.Signal(), this.onChildInputUp = new z.Signal(), this.onChildInputOver = new z.Signal(), 
        this.onChildInputOut = new z.Signal(), this.enableBody = s, this.enableBodyDebug = !1, 
        this.physicsBodyType = o, this.physicsSortDirection = null, this.onDestroy = new z.Signal(), 
        this.cursorIndex = 0, this.fixedToCamera = !1, this.cameraOffset = new z.Point(), 
        this.hash = [], this._sortProperty = "z";
    }, z.Group.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), z.Group.prototype.constructor = z.Group, 
    z.Group.RETURN_NONE = 0, z.Group.RETURN_TOTAL = 1, z.Group.RETURN_CHILD = 2, z.Group.RETURN_ALL = 3, 
    z.Group.SORT_ASCENDING = -1, z.Group.SORT_DESCENDING = 1, z.Group.prototype.add = function(t, e, i) {
        return void 0 === e && (e = !1), t.parent === this || (t.body && t.parent && t.parent.hash && t.parent.removeFromHash(t), 
        void 0 === i ? (t.z = this.children.length, this.addChild(t)) : (this.addChildAt(t, i), 
        this.updateZ()), this.enableBody && t.hasOwnProperty("body") && null === t.body ? this.game.physics.enable(t, this.physicsBodyType) : t.body && this.addToHash(t), 
        !this.inputEnableChildren || t.input && !t.inputEnabled || (t.inputEnabled = !0), 
        !e && t.events && t.events.onAddedToGroup$dispatch(t, this), null === this.cursor && (this.cursor = t)), 
        t;
    }, z.Group.prototype.addAt = function(t, e, i) {
        return this.add(t, i, e);
    }, z.Group.prototype.addToHash = function(t) {
        if (t.parent === this && -1 === this.hash.indexOf(t)) return this.hash.push(t), 
        !0;
        return !1;
    }, z.Group.prototype.removeFromHash = function(t) {
        if (t) {
            var e = this.hash.indexOf(t);
            if (-1 !== e) return this.hash.splice(e, 1), !0;
        }
        return !1;
    }, z.Group.prototype.addMultiple = function(t, e) {
        if (t instanceof z.Group) t.moveAll(this, e); else if (Array.isArray(t)) for (var i = 0; i < t.length; i++) this.add(t[i], e);
        return t;
    }, z.Group.prototype.getAt = function(t) {
        return t < 0 || t >= this.children.length ? -1 : this.getChildAt(t);
    }, z.Group.prototype.create = function(t, e, i, n, s, o) {
        void 0 === s && (s = !0);
        var a = new this.classType(this.game, t, e, i, n);
        return a.exists = s, a.visible = s, a.alive = s, this.add(a, !1, o);
    }, z.Group.prototype.createMultiple = function(s, t, e, o, a, r) {
        void 0 === e && (e = 0), void 0 === o && (o = !1), Array.isArray(t) || (t = [ t ]), 
        Array.isArray(e) || (e = [ e ]);
        var h = this, l = [];
        return t.forEach(function(n) {
            e.forEach(function(t) {
                for (var e = 0; e < s; e++) {
                    var i = h.create(0, 0, n, t, o);
                    a && a.call(r || i, i, e), l.push(i);
                }
            });
        }), l;
    }, z.Group.prototype.updateZ = function() {
        for (var t = this.children.length; t--; ) this.children[t].z = t;
    }, z.Group.prototype.align = function(t, e, i, n, s, o) {
        if (void 0 === s && (s = z.TOP_LEFT), void 0 === o && (o = 0), 0 === this.children.length || o > this.children.length || -1 === t && -1 === e) return !1;
        for (var a = new z.Rectangle(0, 0, i, n), r = t * i, h = e * n, l = o; l < this.children.length; l++) {
            var c = this.children[l];
            if (c.alignIn) if (c.alignIn(a, s), -1 === t) a.y += n, a.y === h && (a.x += i, 
            a.y = 0); else if (-1 === e) a.x += i, a.x === r && (a.x = 0, a.y += n); else if (a.x += i, 
            a.x === r && (a.x = 0, a.y += n, a.y === h)) return !0;
        }
        return !0;
    }, z.Group.prototype.resetCursor = function(t) {
        if (void 0 === t && (t = 0), t > this.children.length - 1 && (t = 0), this.cursor) return this.cursorIndex = t, 
        this.cursor = this.children[this.cursorIndex], this.cursor;
    }, z.Group.prototype.next = function() {
        if (this.cursor) return this.cursorIndex >= this.children.length - 1 ? this.cursorIndex = 0 : this.cursorIndex++, 
        this.cursor = this.children[this.cursorIndex], this.cursor;
    }, z.Group.prototype.previous = function() {
        if (this.cursor) return 0 === this.cursorIndex ? this.cursorIndex = this.children.length - 1 : this.cursorIndex--, 
        this.cursor = this.children[this.cursorIndex], this.cursor;
    }, z.Group.prototype.swap = function(t, e) {
        this.swapChildren(t, e), this.updateZ();
    }, z.Group.prototype.bringToTop = function(t) {
        return t.parent === this && this.getIndex(t) < this.children.length && (this.remove(t, !1, !0), 
        this.add(t, !0)), t;
    }, z.Group.prototype.bringChildToTop = z.Group.prototype.bringToTop, z.Group.prototype.sendToBack = function(t) {
        return t.parent === this && 0 < this.getIndex(t) && (this.remove(t, !1, !0), this.addAt(t, 0, !0)), 
        t;
    }, z.Group.prototype.sendChildToBack = z.Group.prototype.sendToBack, z.Group.prototype.moveUp = function(t) {
        if (t.parent === this && this.getIndex(t) < this.children.length - 1) {
            var e = this.getIndex(t), i = this.getAt(e + 1);
            i && this.swap(t, i);
        }
        return t;
    }, z.Group.prototype.moveDown = function(t) {
        if (t.parent === this && 0 < this.getIndex(t)) {
            var e = this.getIndex(t), i = this.getAt(e - 1);
            i && this.swap(t, i);
        }
        return t;
    }, z.Group.prototype.xy = function(t, e, i) {
        if (t < 0 || t > this.children.length) return -1;
        this.getChildAt(t).x = e, this.getChildAt(t).y = i;
    }, z.Group.prototype.reverse = function() {
        this.children.reverse(), this.updateZ();
    }, z.Group.prototype.getIndex = function(t) {
        return this.children.indexOf(t);
    }, z.Group.prototype.getByName = function(t) {
        return this.getFirst("name", t);
    }, z.Group.prototype.replace = function(t, e) {
        var i = this.getIndex(t);
        if (-1 !== i) return e.parent && (e.parent instanceof z.Group ? e.parent.remove(e) : e.parent.removeChild(e)), 
        this.remove(t), this.addAt(e, i), t;
    }, z.Group.prototype.hasProperty = function(t, e) {
        var i = e.length;
        return 1 === i && e[0] in t || (2 === i && e[0] in t && e[1] in t[e[0]] || (3 === i && e[0] in t && e[1] in t[e[0]] && e[2] in t[e[0]][e[1]] || 4 === i && e[0] in t && e[1] in t[e[0]] && e[2] in t[e[0]][e[1]] && e[3] in t[e[0]][e[1]][e[2]]));
    }, z.Group.prototype.setProperty = function(t, e, i, n, s) {
        if (void 0 === s && (s = !1), n = n || 0, !this.hasProperty(t, e) && (!s || 0 < n)) return !1;
        var o = e.length;
        return 1 === o ? 0 === n ? t[e[0]] = i : 1 === n ? t[e[0]] += i : 2 === n ? t[e[0]] -= i : 3 === n ? t[e[0]] *= i : 4 === n && (t[e[0]] /= i) : 2 === o ? 0 === n ? t[e[0]][e[1]] = i : 1 === n ? t[e[0]][e[1]] += i : 2 === n ? t[e[0]][e[1]] -= i : 3 === n ? t[e[0]][e[1]] *= i : 4 === n && (t[e[0]][e[1]] /= i) : 3 === o ? 0 === n ? t[e[0]][e[1]][e[2]] = i : 1 === n ? t[e[0]][e[1]][e[2]] += i : 2 === n ? t[e[0]][e[1]][e[2]] -= i : 3 === n ? t[e[0]][e[1]][e[2]] *= i : 4 === n && (t[e[0]][e[1]][e[2]] /= i) : 4 === o && (0 === n ? t[e[0]][e[1]][e[2]][e[3]] = i : 1 === n ? t[e[0]][e[1]][e[2]][e[3]] += i : 2 === n ? t[e[0]][e[1]][e[2]][e[3]] -= i : 3 === n ? t[e[0]][e[1]][e[2]][e[3]] *= i : 4 === n && (t[e[0]][e[1]][e[2]][e[3]] /= i)), 
        !0;
    }, z.Group.prototype.checkProperty = function(t, e, i, n) {
        if (void 0 === n && (n = !1), this !== t.parent) return !1;
        var s = z.Utils.getProperty(t, e);
        return !(void 0 === s && n || s !== i);
    }, z.Group.prototype.set = function(t, e, i, n, s, o, a) {
        if (void 0 === a && (a = !1), e = e.split("."), void 0 === n && (n = !1), void 0 === s && (s = !1), 
        (!1 === n || n && t.alive) && (!1 === s || s && t.visible)) return this.setProperty(t, e, i, o, a);
    }, z.Group.prototype.setAll = function(t, e, i, n, s, o) {
        void 0 === i && (i = !1), void 0 === n && (n = !1), void 0 === o && (o = !1), t = t.split("."), 
        s = s || 0;
        for (var a = this.children.length, r = 0; r < a; r++) {
            var h = this.children[r];
            i && !h.alive || n && !h.visible || this.setProperty(h, t, e, s, o);
        }
    }, z.Group.prototype.setAllChildren = function(t, e, i, n, s, o) {
        void 0 === i && (i = !1), void 0 === n && (n = !1), void 0 === o && (o = !1), s = s || 0;
        for (var a = this.children.length, r = 0; r < a; r++) {
            var h = this.children[r];
            i && !h.alive || n && !h.visible || (h instanceof z.Group ? h.setAllChildren(t, e, i, n, s, o) : this.setProperty(h, t.split("."), e, s, o));
        }
    }, z.Group.prototype.checkAll = function(t, e, i, n, s) {
        void 0 === i && (i = !1), void 0 === n && (n = !1), void 0 === s && (s = !1);
        for (var o = 0; o < this.children.length; o++) {
            var a = this.children[o];
            if ((!i || a.alive) && (!n || a.visible) && !this.checkProperty(a, t, e, s)) return !1;
        }
        return !0;
    }, z.Group.prototype.checkAny = function(t, e, i, n) {
        void 0 === i && (i = !1), void 0 === n && (n = !1);
        for (var s = 0; s < this.children.length; s++) {
            var o = this.children[s];
            if ((!i || o.alive) && (!n || o.visible) && this.checkProperty(o, t, e)) return !0;
        }
        return !1;
    }, z.Group.prototype.addAll = function(t, e, i, n) {
        this.setAll(t, e, i, n, 1);
    }, z.Group.prototype.subAll = function(t, e, i, n) {
        this.setAll(t, e, i, n, 2);
    }, z.Group.prototype.multiplyAll = function(t, e, i, n) {
        this.setAll(t, e, i, n, 3);
    }, z.Group.prototype.divideAll = function(t, e, i, n) {
        this.setAll(t, e, i, n, 4);
    }, z.Group.prototype.kill = function() {
        this.alive = !1, this.exists = !1, this.visible = !1;
    }, z.Group.prototype.killAll = function() {
        this.callAllExists("kill", !0);
    }, z.Group.prototype.revive = function() {
        this.alive = !0, this.exists = !0, this.visible = !0;
    }, z.Group.prototype.reviveAll = function() {
        this.callAllExists("revive", !1);
    }, z.Group.prototype.resetAll = function(t, e, i, n, s) {
        this.forEach(this.resetChild, this, s, t, e, i, n);
    }, z.Group.prototype.callAllExists = function(t, e) {
        var i;
        if (2 < arguments.length) {
            i = [];
            for (var n = 2; n < arguments.length; n++) i.push(arguments[n]);
        }
        for (n = 0; n < this.children.length; n++) {
            var s = this.children[n];
            s.exists === e && s[t] && s[t].apply(s, i);
        }
    }, z.Group.prototype.callbackFromArray = function(t, e, i) {
        if (1 === i) {
            if (t[e[0]]) return t[e[0]];
        } else if (2 === i) {
            if (t[e[0]][e[1]]) return t[e[0]][e[1]];
        } else if (3 === i) {
            if (t[e[0]][e[1]][e[2]]) return t[e[0]][e[1]][e[2]];
        } else if (4 === i) {
            if (t[e[0]][e[1]][e[2]][e[3]]) return t[e[0]][e[1]][e[2]][e[3]];
        } else if (t[e]) return t[e];
        return !1;
    }, z.Group.prototype.callAll = function(t, e) {
        if (void 0 !== t) {
            var i, n = (t = t.split(".")).length;
            if (null == e || "" === e) e = null; else if ("string" == typeof e) var s = (e = e.split(".")).length;
            if (2 < arguments.length) {
                i = [];
                for (var o = 2; o < arguments.length; o++) i.push(arguments[o]);
            }
            var a = null, r = null;
            for (o = 0; o < this.children.length; o++) {
                var h = this.children[o];
                a = this.callbackFromArray(h, t, n), e && a ? (r = this.callbackFromArray(h, e, s), 
                a.apply(r, i)) : a && a.apply(h, i);
            }
        }
    }, z.Group.prototype.preUpdate = function() {
        if (this.pendingDestroy) return this.destroy(), !1;
        if (!this.exists || !this.parent.exists) return !(this.renderOrderID = -1);
        for (var t = 0; t < this.children.length; ) {
            var e = this.children[t];
            e.preUpdate(), this === e.parent && t++;
        }
        return !0;
    }, z.Group.prototype.update = function() {
        for (var t = this.children.length; t--; ) {
            var e = this.children.length;
            e <= t && (t = e - 1);
            var i = this.children[t];
            this.updateOnlyExistingChildren && !i.exists || i.update();
        }
    }, z.Group.prototype.postUpdate = function() {
        this.fixedToCamera && (this.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, 
        this.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y);
        for (var t = 0; t < this.children.length; t++) this.children[t].postUpdate();
    }, z.Group.prototype.filter = function(t, e) {
        for (var i = -1, n = this.children.length, s = []; ++i < n; ) {
            var o = this.children[i];
            (!e || e && o.exists) && t(o, i, this.children) && s.push(o);
        }
        return new z.ArraySet(s);
    }, z.Group.prototype.forEach = function(t, e, i) {
        if (void 0 === i && (i = !1), arguments.length <= 3) for (var n = 0; n < this.children.length; n++) {
            var s = this.children[n];
            i && !s.exists || t.call(e, s);
        } else {
            var o = [ null ];
            for (n = 3; n < arguments.length; n++) o.push(arguments[n]);
            for (n = 0; n < this.children.length; n++) {
                s = this.children[n];
                i && !s.exists || (o[0] = s, t.apply(e, o));
            }
        }
    }, z.Group.prototype.forEachExists = function(t, e) {
        var i;
        if (2 < arguments.length) {
            i = [ null ];
            for (var n = 2; n < arguments.length; n++) i.push(arguments[n]);
        }
        this.iterate("exists", !0, z.Group.RETURN_TOTAL, t, e, i);
    }, z.Group.prototype.forEachAlive = function(t, e) {
        var i;
        if (2 < arguments.length) {
            i = [ null ];
            for (var n = 2; n < arguments.length; n++) i.push(arguments[n]);
        }
        this.iterate("alive", !0, z.Group.RETURN_TOTAL, t, e, i);
    }, z.Group.prototype.forEachDead = function(t, e) {
        var i;
        if (2 < arguments.length) {
            i = [ null ];
            for (var n = 2; n < arguments.length; n++) i.push(arguments[n]);
        }
        this.iterate("alive", !1, z.Group.RETURN_TOTAL, t, e, i);
    }, z.Group.prototype.sort = function(t, e) {
        this.children.length < 2 || (void 0 === t && (t = "z"), void 0 === e && (e = z.Group.SORT_ASCENDING), 
        this._sortProperty = t, e === z.Group.SORT_ASCENDING ? this.children.sort(this.ascendingSortHandler.bind(this)) : this.children.sort(this.descendingSortHandler.bind(this)), 
        this.updateZ());
    }, z.Group.prototype.customSort = function(t, e) {
        this.children.length < 2 || (this.children.sort(t.bind(e)), this.updateZ());
    }, z.Group.prototype.ascendingSortHandler = function(t, e) {
        return t[this._sortProperty] < e[this._sortProperty] ? -1 : t[this._sortProperty] > e[this._sortProperty] ? 1 : t.z < e.z ? -1 : 1;
    }, z.Group.prototype.descendingSortHandler = function(t, e) {
        return t[this._sortProperty] < e[this._sortProperty] ? 1 : t[this._sortProperty] > e[this._sortProperty] ? -1 : 0;
    }, z.Group.prototype.iterate = function(t, e, i, n, s, o) {
        if (0 === this.children.length) {
            if (i === z.Group.RETURN_TOTAL) return 0;
            if (i === z.Group.RETURN_ALL) return [];
        }
        var a = 0;
        if (i === z.Group.RETURN_ALL) var r = [];
        for (var h = 0; h < this.children.length; h++) if (this.children[h][t] === e) {
            if (a++, n && (o ? (o[0] = this.children[h], n.apply(s, o)) : n.call(s, this.children[h])), 
            i === z.Group.RETURN_CHILD) return this.children[h];
            i === z.Group.RETURN_ALL && r.push(this.children[h]);
        }
        return i === z.Group.RETURN_TOTAL ? a : i === z.Group.RETURN_ALL ? r : null;
    }, z.Group.prototype.getFirst = function(t, e) {
        return this.iterate(t, e, z.Group.RETURN_CHILD);
    }, z.Group.prototype.getFirstExists = function(t, e, i, n, s, o) {
        void 0 === e && (e = !1), "boolean" != typeof t && (t = !0);
        var a = this.getFirst("exists", t);
        return null === a && e ? this.create(i, n, s, o) : this.resetChild(a, i, n, s, o);
    }, z.Group.prototype.getFirstAlive = function(t, e, i, n, s) {
        void 0 === t && (t = !1);
        var o = this.getFirst("alive", !0);
        return null === o && t ? this.create(e, i, n, s) : this.resetChild(o, e, i, n, s);
    }, z.Group.prototype.getFirstDead = function(t, e, i, n, s) {
        void 0 === t && (t = !1);
        var o = this.getFirst("alive", !1);
        return null === o && t ? this.create(e, i, n, s) : this.resetChild(o, e, i, n, s);
    }, z.Group.prototype.resetChild = function(t, e, i, n, s) {
        return null === t ? null : (void 0 === e && (e = null), void 0 === i && (i = null), 
        null !== e && null !== i && t.reset(e, i), void 0 !== n && t.loadTexture(n, s), 
        t);
    }, z.Group.prototype.getTop = function() {
        if (0 < this.children.length) return this.children[this.children.length - 1];
    }, z.Group.prototype.getBottom = function() {
        if (0 < this.children.length) return this.children[0];
    }, z.Group.prototype.getClosestTo = function(t, e, i) {
        for (var n = Number.MAX_VALUE, s = 0, o = null, a = 0; a < this.children.length; a++) {
            var r = this.children[a];
            r.exists && (s = Math.abs(z.Point.distance(t, r))) < n && (!e || e.call(i, r, s)) && (n = s, 
            o = r);
        }
        return o;
    }, z.Group.prototype.getFurthestFrom = function(t, e, i) {
        for (var n = 0, s = 0, o = null, a = 0; a < this.children.length; a++) {
            var r = this.children[a];
            r.exists && n < (s = Math.abs(z.Point.distance(t, r))) && (!e || e.call(i, r, s)) && (n = s, 
            o = r);
        }
        return o;
    }, z.Group.prototype.count = function(t, e) {
        return this.iterate(t, e, z.Group.RETURN_TOTAL);
    }, z.Group.prototype.countLiving = function() {
        return this.count("alive", !0);
    }, z.Group.prototype.countDead = function() {
        return this.count("alive", !1);
    }, z.Group.prototype.getRandom = function(t, e) {
        return void 0 === t && (t = 0), void 0 === e && (e = this.children.length), 0 === e ? null : z.ArrayUtils.getRandomItem(this.children, t, e);
    }, z.Group.prototype.getRandomExists = function(t, e) {
        var i = this.getAll("exists", !0, t, e);
        return this.game.rnd.pick(i);
    }, z.Group.prototype.getAll = function(t, e, i, n) {
        void 0 === i && (i = 0), void 0 === n && (n = this.children.length);
        for (var s = [], o = i; o < n; o++) {
            var a = this.children[o];
            t ? a[t] === e && s.push(a) : s.push(a);
        }
        return s;
    }, z.Group.prototype.remove = function(t, e, i) {
        if (void 0 === e && (e = !1), void 0 === i && (i = !1), 0 === this.children.length || -1 === this.children.indexOf(t)) return !1;
        i || !t.events || t.destroyPhase || t.events.onRemovedFromGroup$dispatch(t, this);
        var n = this.removeChild(t);
        return this.removeFromHash(t), this.updateZ(), this.cursor === t && this.next(), 
        e && n && n.destroy(!0), !0;
    }, z.Group.prototype.moveAll = function(t, e) {
        if (void 0 === e && (e = !1), 0 < this.children.length && t instanceof z.Group) {
            for (;t.add(this.children[0], e), 0 < this.children.length; ) ;
            this.hash = [], this.cursor = null;
        }
        return t;
    }, z.Group.prototype.removeAll = function(t, e, i) {
        if (void 0 === t && (t = !1), void 0 === e && (e = !1), void 0 === i && (i = !1), 
        0 !== this.children.length) {
            do {
                !e && this.children[0].events && this.children[0].events.onRemovedFromGroup$dispatch(this.children[0], this);
                var n = this.removeChild(this.children[0]);
                this.removeFromHash(n), t && n && n.destroy(!0, i);
            } while (0 < this.children.length);
            this.hash = [], this.cursor = null;
        }
    }, z.Group.prototype.removeBetween = function(t, e, i, n) {
        if (void 0 === e && (e = this.children.length - 1), void 0 === i && (i = !1), void 0 === n && (n = !1), 
        0 !== this.children.length) {
            if (e < t || t < 0 || e > this.children.length) return !1;
            for (var s = e; t <= s; ) {
                !n && this.children[s].events && this.children[s].events.onRemovedFromGroup$dispatch(this.children[s], this);
                var o = this.removeChild(this.children[s]);
                this.removeFromHash(o), i && o && o.destroy(!0), this.cursor === this.children[s] && (this.cursor = null), 
                s--;
            }
            this.updateZ();
        }
    }, z.Group.prototype.scatter = function(e, t) {
        null == e && (e = this.game.world.bounds), this.forEach(function(t) {
            t.position.set(e.randomX, e.randomY);
        }, null, t);
    }, z.Group.prototype.shuffle = function() {
        z.ArrayUtils.shuffle(this.children), this.updateZ();
    }, z.Group.prototype.destroy = function(t, e) {
        null === this.game || this.ignoreDestroy || (void 0 === t && (t = !0), void 0 === e && (e = !1), 
        this.onDestroy.dispatch(this, t, e), this.removeAll(t), this.cursor = null, this.filters = null, 
        this.pendingDestroy = !1, e || (this.parent && this.parent.removeChild(this), this.game = null, 
        this.exists = !1));
    }, Object.defineProperty(z.Group.prototype, "total", {
        get: function() {
            return this.iterate("exists", !0, z.Group.RETURN_TOTAL);
        }
    }), Object.defineProperty(z.Group.prototype, "length", {
        get: function() {
            return this.children.length;
        }
    }), Object.defineProperty(z.Group.prototype, "angle", {
        get: function() {
            return z.Math.radToDeg(this.rotation);
        },
        set: function(t) {
            this.rotation = z.Math.degToRad(t);
        }
    }), Object.defineProperty(z.Group.prototype, "centerX", {
        get: function() {
            return this.getBounds(this.parent).centerX;
        },
        set: function(t) {
            var e = this.getBounds(this.parent), i = this.x - e.x;
            this.x = t + i - e.halfWidth;
        }
    }), Object.defineProperty(z.Group.prototype, "centerY", {
        get: function() {
            return this.getBounds(this.parent).centerY;
        },
        set: function(t) {
            var e = this.getBounds(this.parent), i = this.y - e.y;
            this.y = t + i - e.halfHeight;
        }
    }), Object.defineProperty(z.Group.prototype, "left", {
        get: function() {
            return this.getBounds(this.parent).left;
        },
        set: function(t) {
            var e = this.getBounds(this.parent), i = this.x - e.x;
            this.x = t + i;
        }
    }), Object.defineProperty(z.Group.prototype, "right", {
        get: function() {
            return this.getBounds(this.parent).right;
        },
        set: function(t) {
            var e = this.getBounds(this.parent), i = this.x - e.x;
            this.x = t + i - e.width;
        }
    }), Object.defineProperty(z.Group.prototype, "top", {
        get: function() {
            return this.getBounds(this.parent).top;
        },
        set: function(t) {
            var e = this.getBounds(this.parent), i = this.y - e.y;
            this.y = t + i;
        }
    }), Object.defineProperty(z.Group.prototype, "bottom", {
        get: function() {
            return this.getBounds(this.parent).bottom;
        },
        set: function(t) {
            var e = this.getBounds(this.parent), i = this.y - e.y;
            this.y = t + i - e.height;
        }
    }), z.World = function(t) {
        z.Group.call(this, t, null, "__world", !1), this.bounds = new z.Rectangle(0, 0, t.width, t.height), 
        this.camera = null, this._definedSize = !1, this._width = t.width, this._height = t.height, 
        this.game.state.onStateChange.add(this.stateChange, this);
    }, z.World.prototype = Object.create(z.Group.prototype), z.World.prototype.constructor = z.World, 
    z.World.prototype.boot = function() {
        this.camera = new z.Camera(this.game, 0, 0, 0, this.game.width, this.game.height), 
        this.game.stage.addChild(this), this.camera.boot();
    }, z.World.prototype.stateChange = function() {
        this.x = 0, this.y = 0, this.camera.reset();
    }, z.World.prototype.setBounds = function(t, e, i, n) {
        this._definedSize = !0, this._width = i, this._height = n, this.bounds.setTo(t, e, i, n), 
        this.x = t, this.y = e, this.camera.bounds && this.camera.bounds.setTo(t, e, Math.max(i, this.game.width), Math.max(n, this.game.height)), 
        this.game.physics.setBoundsToWorld();
    }, z.World.prototype.resize = function(t, e) {
        this._definedSize && (t < this._width && (t = this._width), e < this._height && (e = this._height)), 
        this.bounds.width = t, this.bounds.height = e, this.game.camera.setBoundsToWorld(), 
        this.game.physics.setBoundsToWorld();
    }, z.World.prototype.shutdown = function() {
        this.destroy(!0, !0);
    }, z.World.prototype.wrap = function(t, e, i, n, s) {
        void 0 === e && (e = 0), void 0 === i && (i = !1), void 0 === n && (n = !0), void 0 === s && (s = !0), 
        i ? (t.getBounds(), n && (t.x + t._currentBounds.width < this.bounds.x ? t.x = this.bounds.right : t.x > this.bounds.right && (t.x = this.bounds.left)), 
        s && (t.y + t._currentBounds.height < this.bounds.top ? t.y = this.bounds.bottom : t.y > this.bounds.bottom && (t.y = this.bounds.top))) : (n && t.x + e < this.bounds.x ? t.x = this.bounds.right + e : n && t.x - e > this.bounds.right && (t.x = this.bounds.left - e), 
        s && t.y + e < this.bounds.top ? t.y = this.bounds.bottom + e : s && t.y - e > this.bounds.bottom && (t.y = this.bounds.top - e));
    }, z.World.prototype.wrapAll = function(t, e, i, n, s, o) {
        t.forEach(this.wrap, this, e, i, n, s, o);
    }, Object.defineProperty(z.World.prototype, "width", {
        get: function() {
            return this.bounds.width;
        },
        set: function(t) {
            t < this.game.width && (t = this.game.width), this.bounds.width = t, this._width = t, 
            this._definedSize = !0;
        }
    }), Object.defineProperty(z.World.prototype, "height", {
        get: function() {
            return this.bounds.height;
        },
        set: function(t) {
            t < this.game.height && (t = this.game.height), this.bounds.height = t, this._height = t, 
            this._definedSize = !0;
        }
    }), Object.defineProperty(z.World.prototype, "centerX", {
        get: function() {
            return this.bounds.halfWidth + this.bounds.x;
        }
    }), Object.defineProperty(z.World.prototype, "centerY", {
        get: function() {
            return this.bounds.halfHeight + this.bounds.y;
        }
    }), Object.defineProperty(z.World.prototype, "randomX", {
        get: function() {
            return this.bounds.x < 0 ? this.game.rnd.between(this.bounds.x, this.bounds.width - Math.abs(this.bounds.x)) : this.game.rnd.between(this.bounds.x, this.bounds.width);
        }
    }), Object.defineProperty(z.World.prototype, "randomY", {
        get: function() {
            return this.bounds.y < 0 ? this.game.rnd.between(this.bounds.y, this.bounds.height - Math.abs(this.bounds.y)) : this.game.rnd.between(this.bounds.y, this.bounds.height);
        }
    }), z.Game = function(t, e, i, n, s, o, a, r) {
        return this.id = z.GAMES.push(this) - 1, this.config = null, this.physicsConfig = r, 
        this.parent = "", this.width = 800, this.height = 600, this.resolution = 1, this._width = 800, 
        this._height = 600, this.transparent = !1, this.antialias = !0, this.multiTexture = !1, 
        this.preserveDrawingBuffer = !1, this.clearBeforeRender = !0, this.renderer = null, 
        this.renderType = z.AUTO, this.state = null, this.isBooted = !1, this.isRunning = !1, 
        this.raf = null, this.add = null, this.make = null, this.cache = null, this.input = null, 
        this.load = null, this.math = null, this.net = null, this.scale = null, this.sound = null, 
        this.stage = null, this.time = null, this.tweens = null, this.world = null, this.physics = null, 
        this.plugins = null, this.rnd = null, this.device = z.Device, this.camera = null, 
        this.canvas = null, this.context = null, this.debug = null, this.particles = null, 
        this.create = null, this.lockRender = !1, this.pendingDestroy = !1, this.stepping = !1, 
        this.pendingStep = !1, this.stepCount = 0, this.onPause = null, this.onResume = null, 
        this.onBlur = null, this.onFocus = null, this._paused = !1, this._codePaused = !1, 
        this.currentUpdateID = 0, this.updatesThisFrame = 1, this.rendersThisFrame = 1, 
        this._deltaTime = 0, this._lastCount = 0, this._spiraling = 0, this._kickstart = !0, 
        this.fpsProblemNotifier = new z.Signal(), this.forceSingleUpdate = !0, this.forceSingleRender = !0, 
        this.dropFrames = !1, this._nextFpsNotification = 0, 1 === arguments.length && "object" == typeof t ? this.parseConfig(t) : (this.config = {
            enableDebug: !0
        }, void 0 !== t && (this._width = t), void 0 !== e && (this._height = e), void 0 !== i && (this.renderType = i), 
        void 0 !== n && (this.parent = n), void 0 !== o && (this.transparent = o), void 0 !== a && (this.antialias = a), 
        this.rnd = new z.RandomDataGenerator([ (Date.now() * Math.random()).toString() ]), 
        this.state = new z.StateManager(this, s)), this.device.whenReady(this.boot, this), 
        this;
    }, z.Game.prototype = {
        parseConfig: function(t) {
            void 0 === (this.config = t).enableDebug && (this.config.enableDebug = !0), t.width && (this._width = t.width), 
            t.height && (this._height = t.height), t.renderer && (this.renderType = t.renderer), 
            t.parent && (this.parent = t.parent), void 0 !== t.transparent && (this.transparent = t.transparent), 
            void 0 !== t.antialias && (this.antialias = t.antialias), void 0 !== t.clearBeforeRender && (this.clearBeforeRender = t.clearBeforeRender), 
            void 0 !== t.multiTexture && (this.multiTexture = t.multiTexture), t.resolution && (this.resolution = t.resolution), 
            void 0 !== t.preserveDrawingBuffer && (this.preserveDrawingBuffer = t.preserveDrawingBuffer), 
            t.physicsConfig && (this.physicsConfig = t.physicsConfig);
            var e = [ (Date.now() * Math.random()).toString() ];
            t.seed && (e = t.seed), this.rnd = new z.RandomDataGenerator(e);
            var i = null;
            t.state && (i = t.state), this.state = new z.StateManager(this, i);
        },
        boot: function() {
            if (!this.isBooted) {
                if (this.onPause = new z.Signal(), this.onResume = new z.Signal(), this.onBlur = new z.Signal(), 
                this.onFocus = new z.Signal(), this.isBooted = !0, (PIXI.game = this).math = z.Math, 
                this.scale = new z.ScaleManager(this, this._width, this._height), this.stage = new z.Stage(this), 
                this.setUpRenderer(), this.world = new z.World(this), this.add = new z.GameObjectFactory(this), 
                this.make = new z.GameObjectCreator(this), this.cache = new z.Cache(this), this.load = new z.Loader(this), 
                this.time = new z.Time(this), this.tweens = new z.TweenManager(this), this.input = new z.Input(this), 
                this.sound = new z.SoundManager(this), this.physics = new z.Physics(this, this.physicsConfig), 
                this.particles = new z.Particles(this), this.create = new z.Create(this), this.plugins = new z.PluginManager(this), 
                this.net = new z.Net(this), this.time.boot(), this.stage.boot(), this.world.boot(), 
                this.scale.boot(), this.input.boot(this.config), this.sound.boot(), this.state.boot(), 
                this.config.enableDebug) this.debug = new z.Utils.Debug(this), this.debug.boot(); else {
                    var t = function() {};
                    this.debug = {
                        preUpdate: t,
                        update: t,
                        reset: t,
                        destroy: t,
                        isDisabled: !0
                    };
                }
                this.showDebugHeader(), this.isRunning = !0, this.config && this.config.forceSetTimeOut ? this.raf = new z.RequestAnimationFrame(this, this.config.forceSetTimeOut) : this.raf = new z.RequestAnimationFrame(this, !1), 
                this._kickstart = !0, this.focusWindow(), this.config.disableStart || (this.cache.isReady ? this.raf.start() : this.cache.onReady.addOnce(function() {
                    this.raf.start();
                }, this));
            }
        },
        showDebugHeader: function() {
            if (!window.PhaserGlobal || !window.PhaserGlobal.hideBanner) {
                var t = z.VERSION, e = "Canvas", i = "HTML Audio", n = 1;
                if (this.renderType === z.WEBGL ? (e = "WebGL", n++) : this.renderType === z.HEADLESS && (e = "Headless"), 
                this.device.webAudio && (i = "WebAudio", n++), this.device.ie) window.console; else for (var s = [ "%c %c %c Phaser CE v" + t + " | Pixi.js | " + e + " | " + i + "  %c %c %c http://phaser.io %c♥%c♥%c♥", "background: #fb8cb3", "background: #d44a52", "color: #ffffff; background: #871905;", "background: #d44a52", "background: #fb8cb3", "background: #ffffff" ], o = 0; o < 3; o++) o < n ? s.push("color: #ff2424; background: #fff") : s.push("color: #959595; background: #fff");
            }
        },
        setUpRenderer: function() {
            if (!this.device.canvas) throw new Error("Phaser.Game - Cannot create Canvas 2d context, aborting.");
            if (this.config.canvas ? this.canvas = this.config.canvas : this.canvas = z.Canvas.create(this, this.width, this.height, this.config.canvasID, !0), 
            this.config.canvasStyle ? this.canvas.style = this.config.canvasStyle : this.canvas.style["-webkit-full-screen"] = "width: 100%; height: 100%", 
            this.config.crisp && z.Canvas.setImageRenderingCrisp(this.canvas), this.renderType === z.WEBGL || this.renderType === z.WEBGL_MULTI || this.renderType === z.AUTO && this.device.webGL) {
                (this.multiTexture || this.renderType === z.WEBGL_MULTI) && (PIXI.enableMultiTexture(), 
                this.multiTexture = !0);
                try {
                    this.renderer = new PIXI.WebGLRenderer(this, this.config), this.renderType = z.WEBGL, 
                    this.context = null, this.canvas.addEventListener("webglcontextlost", this.contextLost.bind(this), !1), 
                    this.canvas.addEventListener("webglcontextrestored", this.contextRestored.bind(this), !1);
                } catch (t) {
                    if (PIXI.defaultRenderer = null, this.renderer = null, this.multiTexture = !1, PIXI._enableMultiTextureToggle = !1, 
                    this.renderType === z.WEBGL) throw t;
                }
            }
            this.renderer || (this.renderer = new PIXI.CanvasRenderer(this, this.config), this.context = this.renderer.context, 
            this.renderType === z.AUTO && (this.renderType = z.CANVAS)), this.device.cocoonJS && (this.canvas.screencanvas = this.renderType === z.CANVAS), 
            this.renderType !== z.HEADLESS && (this.stage.smoothed = this.antialias, z.Canvas.addToDOM(this.canvas, this.parent, !1), 
            z.Canvas.setTouchAction(this.canvas));
        },
        contextLost: function(t) {
            t.preventDefault(), this.renderer.contextLost = !0;
        },
        contextRestored: function() {
            this.renderer.initContext(), this.cache.clearGLTextures(), this.renderer.contextLost = !1;
        },
        update: function(t) {
            if (this.pendingDestroy) this.destroy(); else {
                if (this.time.update(t), this._kickstart) return this.updateLogic(this.time.desiredFpsMult), 
                this.updateRender(this.time.slowMotion * this.time.desiredFps), void (this._kickstart = !1);
                if (1 < this._spiraling && !this.forceSingleUpdate) this.time.time > this._nextFpsNotification && (this._nextFpsNotification = this.time.time + 1e4, 
                this.fpsProblemNotifier.dispatch()), this._deltaTime = 0, this._spiraling = 0, this.dropFrames ? this.rendersThisFrame = 0 : (this.updateRender(this.time.slowMotion * this.time.desiredFps), 
                this.rendersThisFrame = 1); else {
                    var e = 1e3 * this.time.slowMotion / this.time.desiredFps;
                    this._deltaTime += Math.max(Math.min(3 * e, this.time.elapsed), 0);
                    var i = 0;
                    for (this.updatesThisFrame = Math.floor(this._deltaTime / e), this.forceSingleUpdate && (this.updatesThisFrame = Math.min(1, this.updatesThisFrame)), 
                    this.forceSingleRender ? this.rendersThisFrame = 1 : this.rendersThisFrame = Math.min(1, this.updatesThisFrame); this._deltaTime >= e && (this._deltaTime -= e, 
                    this.currentUpdateID = i, this.updateLogic(this.time.desiredFpsMult), i++, !this.forceSingleUpdate || 1 !== i); ) this.time.refresh();
                    i > this._lastCount ? this._spiraling++ : i < this._lastCount && (this._spiraling = 0), 
                    this._lastCount = i, 0 < this.rendersThisFrame && this.updateRender(this._deltaTime / e);
                }
                this.renderer.type === z.WEBGL && this.renderer.gl.flush();
            }
        },
        updateLogic: function(t) {
            this._paused || this.pendingStep ? (this.scale.pauseUpdate(), this.state.pauseUpdate(t), 
            this.debug.preUpdate(), this.input.pauseUpdate()) : (this.stepping && (this.pendingStep = !0), 
            this.time.countUpdate(), this.scale.preUpdate(), this.debug.preUpdate(), this.camera.preUpdate(), 
            this.physics.preUpdate(), this.state.preUpdate(t), this.plugins.preUpdate(t), this.stage.preUpdate(), 
            this.state.update(), this.stage.update(), this.tweens.update(), this.sound.update(), 
            this.input.update(), this.physics.update(), this.plugins.update(), this.stage.postUpdate(), 
            this.state.postUpdate(), this.plugins.postUpdate()), this.stage.updateTransform();
        },
        updateRender: function(t) {
            this.lockRender || this.renderType === z.HEADLESS || (this.time.countRender(), this.state.preRender(t), 
            this.renderer.render(this.stage), this.plugins.render(t), this.state.render(t), 
            this.plugins.postRender(t));
        },
        enableStep: function() {
            this.stepping = !0, this.pendingStep = !1, this.stepCount = 0;
        },
        disableStep: function() {
            this.stepping = !1, this.pendingStep = !1;
        },
        step: function() {
            this.pendingStep = !1, this.stepCount++;
        },
        destroy: function() {
            this.raf.stop(), this.debug.destroy(), this.state.destroy(), this.sound.destroy(), 
            this.scale.destroy(), this.stage.destroy(), this.input.destroy(), this.physics.destroy(), 
            this.plugins.destroy(), this.tweens.destroy(), this.debug = null, this.state = null, 
            this.sound = null, this.scale = null, this.stage = null, this.input = null, this.physics = null, 
            this.plugins = null, this.tweens = null, this.cache = null, this.load = null, this.time = null, 
            this.world = null, this.isBooted = !1, this.renderer.destroy(!1), z.Canvas.removeFromDOM(this.canvas), 
            PIXI.game === this && (PIXI.game = null), PIXI.defaultRenderer = null, z.GAMES[this.id] = null;
        },
        gamePaused: function(t) {
            this._paused || (this._paused = !0, this.time.gamePaused(), this.sound.muteOnPause && this.sound.setMute(), 
            this.onPause.dispatch(t), this.device.cordova && this.device.iOS && (this.lockRender = !0));
        },
        gameResumed: function(t) {
            this._paused && !this._codePaused && (this._paused = !1, this.time.gameResumed(), 
            this.input.reset(), this.sound.muteOnPause && this.sound.unsetMute(), this.onResume.dispatch(t), 
            this.device.cordova && this.device.iOS && (this.lockRender = !1));
        },
        focusLoss: function(t) {
            this.onBlur.dispatch(t), this.stage.disableVisibilityChange || this.gamePaused(t);
        },
        focusGain: function(t) {
            this.focusWindow(), this.onFocus.dispatch(t), this.stage.disableVisibilityChange || this.gameResumed(t);
        },
        focusWindow: function() {
            window.focus && (!window.PhaserGlobal || window.PhaserGlobal && !window.PhaserGlobal.stopFocus) && window.focus();
        }
    }, z.Game.prototype.constructor = z.Game, Object.defineProperty(z.Game.prototype, "paused", {
        get: function() {
            return this._paused;
        },
        set: function(t) {
            !0 === t ? (!1 === this._paused && (this._paused = !0, this.sound.muteOnPause && this.sound.setMute(), 
            this.time.gamePaused(), this.onPause.dispatch(this)), this._codePaused = !0) : (this._paused && (this._paused = !1, 
            this.input.reset(), this.sound.unsetMute(), this.time.gameResumed(), this.onResume.dispatch(this)), 
            this._codePaused = !1);
        }
    }), z.Input = function(t) {
        this.game = t, this.hitCanvas = null, this.hitContext = null, this.moveCallbacks = [], 
        this.customCandidateHandler = null, this.customCandidateHandlerContext = null, this.pollRate = 0, 
        this.enabled = !0, this.multiInputOverride = z.Input.MOUSE_TOUCH_COMBINE, this.position = null, 
        this.speed = null, this.circle = null, this.scale = null, this.maxPointers = -1, 
        this.tapRate = 200, this.doubleTapRate = 300, this.holdRate = 2e3, this.justPressedRate = 200, 
        this.justReleasedRate = 200, this.recordPointerHistory = !1, this.recordRate = 100, 
        this.recordLimit = 100, this.touchLockCallbacks = [], this.pointer1 = null, this.pointer2 = null, 
        this.pointer3 = null, this.pointer4 = null, this.pointer5 = null, this.pointer6 = null, 
        this.pointer7 = null, this.pointer8 = null, this.pointer9 = null, this.pointer10 = null, 
        this.pointers = [], this.activePointer = null, this.mousePointer = null, this.mouse = null, 
        this.keyboard = null, this.touch = null, this.mspointer = null, this.gamepad = null, 
        this.resetLocked = !1, this.onDown = null, this.onUp = null, this.onTap = null, 
        this.onHold = null, this.minPriorityID = 0, this.interactiveItems = new z.ArraySet(), 
        this._localPoint = new z.Point(), this._pollCounter = 0, this._oldPosition = null, 
        this._x = 0, this._y = 0;
    }, z.Input.MOUSE_OVERRIDES_TOUCH = 0, z.Input.TOUCH_OVERRIDES_MOUSE = 1, z.Input.MOUSE_TOUCH_COMBINE = 2, 
    z.Input.MAX_POINTERS = 10, z.Input.prototype = {
        boot: function(t) {
            "maxPointers" in t && (this.maxPointers = t.maxPointers), this.maxPointers = 1, 
            this.mousePointer = new z.Pointer(this.game, 0, z.PointerMode.CURSOR), this.addPointer(), 
            this.addPointer(), this.mouse = new z.Mouse(this.game), this.touch = new z.Touch(this.game), 
            this.mspointer = new z.MSPointer(this.game), this.mouseWheel = new z.MouseWheel(this.game), 
            this.pointerLock = new z.PointerLock(this.game), z.Keyboard && (this.keyboard = new z.Keyboard(this.game)), 
            z.Gamepad && (this.gamepad = new z.Gamepad(this.game)), this.onDown = new z.Signal(), 
            this.onUp = new z.Signal(), this.onTap = new z.Signal(), this.onHold = new z.Signal(), 
            this.scale = new z.Point(1, 1), this.speed = new z.Point(), this.position = new z.Point(), 
            this._oldPosition = new z.Point(), this.circle = new z.Circle(0, 0, 45), this.activePointer = this.mousePointer, 
            this.hitCanvas = z.CanvasPool.create(this, 1, 1), this.hitContext = this.hitCanvas.getContext("2d"), 
            this.game.device.mspointer && !1 !== t.mspointer ? this.mspointer.start() : this.game.device.touch && !1 !== t.touch && this.touch.start(), 
            this.mspointer.active || !1 === t.mouse || this.mouse.start(), !(this.mousePointer.active = !0) !== t.mouseWheel && this.mouseWheel.start(), 
            !1 !== t.pointerLock && this.pointerLock.start(), this.keyboard && !1 !== t.keyboard && this.keyboard.start();
            var e = this;
            this._onClickTrampoline = function(t) {
                e.onClickTrampoline(t);
            }, this.game.canvas.addEventListener("click", this._onClickTrampoline, !1);
        },
        destroy: function() {
            this.mouse.stop(), this.mouseWheel.stop(), this.touch.stop(), this.mspointer.stop(), 
            this.pointerLock.stop(), this.keyboard && this.keyboard.stop(), this.gamepad && this.gamepad.stop(), 
            this.moveCallbacks = [], z.CanvasPool.remove(this), this.game.canvas.removeEventListener("click", this._onClickTrampoline);
        },
        setInteractiveCandidateHandler: function(t, e) {
            this.customCandidateHandler = t, this.customCandidateHandlerContext = e;
        },
        addMoveCallback: function(t, e) {
            this.moveCallbacks.push({
                callback: t,
                context: e
            });
        },
        addTouchLockCallback: function(t, e, i) {
            void 0 === i && (i = !1), this.touchLockCallbacks.push({
                callback: t,
                context: e,
                onEnd: i
            });
        },
        removeTouchLockCallback: function(t, e) {
            for (var i = this.touchLockCallbacks.length; i--; ) if (this.touchLockCallbacks[i].callback === t && this.touchLockCallbacks[i].context === e) return this.touchLockCallbacks.splice(i, 1), 
            !0;
            return !1;
        },
        executeTouchLockCallbacks: function(t, e) {
            for (var i = this.touchLockCallbacks.length; i--; ) {
                var n = this.touchLockCallbacks[i];
                n.onEnd === t && n.callback.call(n.context, this, e) && this.touchLockCallbacks.splice(i, 1);
            }
        },
        deleteMoveCallback: function(t, e) {
            for (var i = this.moveCallbacks.length; i--; ) if (this.moveCallbacks[i].callback === t && this.moveCallbacks[i].context === e) return void this.moveCallbacks.splice(i, 1);
        },
        addPointer: function() {
            if (this.pointers.length >= z.Input.MAX_POINTERS) return null;
            var t = this.pointers.length + 1, e = new z.Pointer(this.game, t, z.PointerMode.CONTACT);
            return this.pointers.push(e), this["pointer" + t] = e;
        },
        update: function() {
            if (this.keyboard && this.keyboard.update(), 0 < this.pollRate && this._pollCounter < this.pollRate) this._pollCounter++; else {
                this.speed.x = this.position.x - this._oldPosition.x, this.speed.y = this.position.y - this._oldPosition.y, 
                this._oldPosition.copyFrom(this.position), this.mousePointer.update(), this.gamepad && this.gamepad.active && this.gamepad.update();
                for (var t = 0; t < this.pointers.length; t++) this.pointers[t].update();
                this._pollCounter = 0;
            }
        },
        pauseUpdate: function() {
            this.gamepad && this.gamepad.active && this.gamepad.update();
        },
        reset: function(t) {
            if (this.game.isBooted && !this.resetLocked) {
                void 0 === t && (t = !1), this.mousePointer.reset(), this.keyboard && this.keyboard.reset(t);
                for (var e = 0; e < this.pointers.length; e++) this.pointers[e].reset();
                "none" !== this.game.canvas.style.cursor && (this.game.canvas.style.cursor = ""), 
                t && (this.onDown.dispose(), this.onUp.dispose(), this.onTap.dispose(), this.onHold.dispose(), 
                this.onDown = new z.Signal(), this.onUp = new z.Signal(), this.onTap = new z.Signal(), 
                this.onHold = new z.Signal(), this.moveCallbacks = []), this._pollCounter = 0;
            }
        },
        resetSpeed: function(t, e) {
            this._oldPosition.setTo(t, e), this.speed.setTo(0, 0);
        },
        startPointer: function(t) {
            if (0 <= this.maxPointers && this.countActivePointers(this.maxPointers) >= this.maxPointers) return null;
            if (!this.pointer1.active) return this.pointer1.start(t);
            if (!this.pointer2.active) return this.pointer2.start(t);
            for (var e = 2; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (!i.active) return i.start(t);
            }
            return null;
        },
        updatePointer: function(t) {
            if (this.pointer1.active && this.pointer1.identifier === t.identifier) return this.pointer1.move(t);
            if (this.pointer2.active && this.pointer2.identifier === t.identifier) return this.pointer2.move(t);
            for (var e = 2; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (i.active && i.identifier === t.identifier) return i.move(t);
            }
            return null;
        },
        stopPointer: function(t) {
            if (this.pointer1.active && this.pointer1.identifier === t.identifier) return this.pointer1.stop(t);
            if (this.pointer2.active && this.pointer2.identifier === t.identifier) return this.pointer2.stop(t);
            for (var e = 2; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (i.active && i.identifier === t.identifier) return i.stop(t);
            }
            return null;
        },
        countActivePointers: function(t) {
            void 0 === t && (t = this.pointers.length);
            for (var e = t, i = 0; i < this.pointers.length && 0 < e; i++) {
                this.pointers[i].active && e--;
            }
            return t - e;
        },
        getPointer: function(t) {
            void 0 === t && (t = !1);
            for (var e = 0; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (i.active === t) return i;
            }
            return null;
        },
        getPointerFromIdentifier: function(t) {
            for (var e = 0; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (i.identifier === t) return i;
            }
            return null;
        },
        getPointerFromId: function(t) {
            for (var e = 0; e < this.pointers.length; e++) {
                var i = this.pointers[e];
                if (i.pointerId === t) return i;
            }
            return null;
        },
        getLocalPosition: function(t, e, i) {
            void 0 === i && (i = new z.Point());
            var n = t.worldTransform, s = 1 / (n.a * n.d + n.c * -n.b);
            return i.setTo(n.d * s * e.x + -n.c * s * e.y + (n.ty * n.c - n.tx * n.d) * s, n.a * s * e.y + -n.b * s * e.x + (-n.ty * n.a + n.tx * n.b) * s);
        },
        hitTest: function(t, e, i) {
            if (!t.worldVisible) return !1;
            if (this.getLocalPosition(t, e, this._localPoint), i.copyFrom(this._localPoint), 
            t.hitArea && t.hitArea.contains) return t.hitArea.contains(this._localPoint.x, this._localPoint.y);
            if (z.Creature && t instanceof z.Creature) {
                var n = Math.abs(t.width), s = Math.abs(t.height), o = t.x - n * t.anchorX;
                if (this.game.camera.x + e.x >= o && this.game.camera.x + e.x < o + n) {
                    var a = t.y - s * t.anchorY;
                    if (this.game.camera.y + e.y >= a && this.game.camera.y + e.y < a + s) return !0;
                }
            } else if (t instanceof z.TileSprite) {
                n = t.width, s = t.height, o = -n * t.anchor.x;
                if (this._localPoint.x >= o && this._localPoint.x < o + n) {
                    a = -s * t.anchor.y;
                    if (this._localPoint.y >= a && this._localPoint.y < a + s) return !0;
                }
            } else if (t instanceof PIXI.Sprite) {
                n = t.texture.frame.width / t.texture.baseTexture.resolution, s = t.texture.frame.height / t.texture.baseTexture.resolution, 
                o = -n * t.anchor.x;
                if (this._localPoint.x >= o && this._localPoint.x < o + n) {
                    a = -s * t.anchor.y;
                    if (this._localPoint.y >= a && this._localPoint.y < a + s) return !0;
                }
            } else if (t instanceof z.Graphics) for (var r = 0; r < t.graphicsData.length; r++) {
                var h = t.graphicsData[r];
                if (h.fill && (h.shape && h.shape.contains(this._localPoint.x, this._localPoint.y))) return !0;
            }
            for (r = 0; r < t.children.length; r++) if (this.hitTest(t.children[r], e, i)) return !0;
            return !1;
        },
        onClickTrampoline: function() {
            this.activePointer.processClickTrampolines();
        },
        callAll: function(t, e) {
            for (var i = this.interactiveItems.list, n = i.length; n--; ) {
                var s = i[n];
                s && s.enabled && s[t](e);
            }
        }
    }, z.Input.prototype.constructor = z.Input, Object.defineProperty(z.Input.prototype, "x", {
        get: function() {
            return this._x;
        },
        set: function(t) {
            this._x = Math.floor(t);
        }
    }), Object.defineProperty(z.Input.prototype, "y", {
        get: function() {
            return this._y;
        },
        set: function(t) {
            this._y = Math.floor(t);
        }
    }), Object.defineProperty(z.Input.prototype, "pollLocked", {
        get: function() {
            return 0 < this.pollRate && this._pollCounter < this.pollRate;
        }
    }), Object.defineProperty(z.Input.prototype, "totalInactivePointers", {
        get: function() {
            return this.pointers.length - this.countActivePointers();
        }
    }), Object.defineProperty(z.Input.prototype, "totalActivePointers", {
        get: function() {
            return this.countActivePointers();
        }
    }), Object.defineProperty(z.Input.prototype, "worldX", {
        get: function() {
            return this.game.camera.view.x + this.x;
        }
    }), Object.defineProperty(z.Input.prototype, "worldY", {
        get: function() {
            return this.game.camera.view.y + this.y;
        }
    }), z.Mouse = function(t) {
        this.game = t, this.input = t.input, this.callbackContext = this.game, this.mouseDownCallback = null, 
        this.mouseUpCallback = null, this.mouseOutCallback = null, this.mouseOverCallback = null, 
        this.capture = !1, this.active = !1, this.enabled = !0, this.stopOnGameOut = !1, 
        this.event = null, this._onMouseDown = null, this._onMouseMove = null, this._onMouseUp = null, 
        this._onMouseOut = null, this._onMouseOver = null;
    }, z.Mouse.NO_BUTTON = -1, z.Mouse.LEFT_BUTTON = 0, z.Mouse.MIDDLE_BUTTON = 1, z.Mouse.RIGHT_BUTTON = 2, 
    z.Mouse.BACK_BUTTON = 3, z.Mouse.FORWARD_BUTTON = 4, z.Mouse.prototype = {
        start: function() {
            var t = this.game.device;
            if (t.isAndroidStockBrowser() && this.input.touch.active) return !1;
            if (null !== this._onMouseDown) return !1;
            var e = this;
            this._onMouseDown = function(t) {
                return e.onMouseDown(t);
            }, this._onMouseMove = function(t) {
                return e.onMouseMove(t);
            }, this._onMouseUp = function(t) {
                return e.onMouseUp(t);
            }, this._onMouseUpGlobal = function(t) {
                return e.onMouseUpGlobal(t);
            }, this._onMouseOutGlobal = function(t) {
                return e.onMouseOutGlobal(t);
            }, this._onMouseOut = function(t) {
                return e.onMouseOut(t);
            }, this._onMouseOver = function(t) {
                return e.onMouseOver(t);
            };
            var i = this.game.canvas;
            return i.addEventListener("mousedown", this._onMouseDown, !0), i.addEventListener("mousemove", this._onMouseMove, !0), 
            i.addEventListener("mouseup", this._onMouseUp, !0), t.cocoonJS || (window.addEventListener("mouseup", this._onMouseUpGlobal, !0), 
            window.addEventListener("mouseout", this._onMouseOutGlobal, !0), i.addEventListener("mouseover", this._onMouseOver, !0), 
            i.addEventListener("mouseout", this._onMouseOut, !0)), this.active = !0;
        },
        onMouseDown: function(t) {
            this.event = t, this.capture && t.preventDefault(), this.mouseDownCallback && this.mouseDownCallback.call(this.callbackContext, t), 
            this.input.enabled && this.enabled && (t.identifier = 0, this.input.mousePointer.start(t));
        },
        onMouseMove: function(t) {
            this.event = t, this.capture && t.preventDefault(), this.mouseMoveCallback && this.mouseMoveCallback.call(this.callbackContext, t), 
            this.input.enabled && this.enabled && (t.identifier = 0, this.input.mousePointer.move(t));
        },
        onMouseUp: function(t) {
            this.event = t, this.capture && t.preventDefault(), this.mouseUpCallback && this.mouseUpCallback.call(this.callbackContext, t), 
            this.input.enabled && this.enabled && (t.identifier = 0, this.input.mousePointer.stop(t));
        },
        onMouseUpGlobal: function(t) {
            this.input.mousePointer.withinGame || (this.mouseUpCallback && this.mouseUpCallback.call(this.callbackContext, t), 
            t.identifier = 0, this.input.mousePointer.stop(t));
        },
        onMouseOutGlobal: function(t) {
            this.event = t, this.capture && t.preventDefault(), this.input.mousePointer.withinGame = !1, 
            this.input.enabled && this.enabled && (this.input.mousePointer.stop(t), this.input.mousePointer.resetButtons());
        },
        onMouseOut: function(t) {
            this.event = t, this.capture && t.preventDefault(), this.input.mousePointer.withinGame = !1, 
            this.mouseOutCallback && this.mouseOutCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (this.input.mousePointer.updateButtons(t), 
            this.stopOnGameOut && (t.identifier = 0, this.input.mousePointer.stop(t), this.input.callAll("_pointerOutHandler", this.input.mousePointer)));
        },
        onMouseOver: function(t) {
            this.event = t, this.capture && t.preventDefault(), this.input.mousePointer.withinGame = !0, 
            this.mouseOverCallback && this.mouseOverCallback.call(this.callbackContext, t), 
            this.input.enabled && this.enabled && this.input.mousePointer.updateButtons(t);
        },
        stop: function() {
            var t = this.game.canvas;
            t.removeEventListener("mousedown", this._onMouseDown, !0), t.removeEventListener("mousemove", this._onMouseMove, !0), 
            t.removeEventListener("mouseup", this._onMouseUp, !0), t.removeEventListener("mouseover", this._onMouseOver, !0), 
            t.removeEventListener("mouseout", this._onMouseOut, !0), window.removeEventListener("mouseup", this._onMouseUpGlobal, !0), 
            window.removeEventListener("mouseout", this._onMouseOutGlobal, !0), this.active = !1;
        }
    }, z.Mouse.prototype.constructor = z.Mouse, z.MouseWheel = function(t) {
        this.game = t, this.input = t.input, this.element = t.canvas, this.preventDefault = !0, 
        this.active = !1, this.callback = null, this.callbackContext = t, this.delta = 0, 
        this.wheelEventName = t.device.wheelEvent, this.boundOnWheelHandler = this.onWheelHandler.bind(this), 
        this.eventProxy = null;
    }, z.MouseWheel.UP = 1, z.MouseWheel.DOWN = -1, z.MouseWheel.prototype.start = function() {
        return !(!this.wheelEventName || this.active) && (this.element.addEventListener(this.wheelEventName, this.boundOnWheelHandler, !0), 
        "mousewheel" === this.wheelEventName ? this.eventProxy = new z.WheelEventProxy(-.025, 1) : "DOMMouseScroll" === this.wheelEventName && (this.eventProxy = new z.WheelEventProxy(1, 1)), 
        this.active = !0);
    }, z.MouseWheel.prototype.stop = function() {
        this.active && (this.element.removeEventListener(this.wheelEventName, this.boundOnWheelHandler, !0), 
        this.active = !1);
    }, z.MouseWheel.prototype.onWheelHandler = function(t) {
        this.eventProxy && (t = this.eventProxy.bindEvent(t)), this.preventDefault && t.preventDefault(), 
        this.delta = z.Math.clamp(-t.deltaY, -1, 1), this.callback && this.callback.call(this.callbackContext, t);
    }, z.MSPointer = function(t) {
        this.game = t, this.input = t.input, this.callbackContext = this.game, this.pointerDownCallback = null, 
        this.pointerMoveCallback = null, this.pointerUpCallback = null, this.pointerOutCallback = null, 
        this.pointerOverCallback = null, this.capture = !1, this.event = null, this.active = !1, 
        this.enabled = !0, this.stopOnGameOut = !1, this._onMSPointerDown = null, this._onMSPointerMove = null, 
        this._onMSPointerUp = null, this._onMSPointerUpGlobal = null, this._onMSPointerOut = null, 
        this._onMSPointerOver = null;
    }, z.MSPointer.prototype = {
        start: function() {
            if (!this.game.device.mspointer) return !1;
            if (null !== this._onMSPointerDown) return !1;
            var e = this;
            this._onMSPointerDown = function(t) {
                return e.onPointerDown(t);
            }, this._onMSPointerMove = function(t) {
                return e.onPointerMove(t);
            }, this._onMSPointerUp = function(t) {
                return e.onPointerUp(t);
            }, this._onMSPointerUpGlobal = function(t) {
                return e.onPointerUpGlobal(t);
            }, this._onMSPointerOut = function(t) {
                return e.onPointerOut(t);
            }, this._onMSPointerOver = function(t) {
                return e.onPointerOver(t);
            };
            var t = this.game.canvas;
            return t.addEventListener("MSPointerDown", this._onMSPointerDown, !1), t.addEventListener("MSPointerMove", this._onMSPointerMove, !1), 
            t.addEventListener("MSPointerUp", this._onMSPointerUp, !1), t.addEventListener("pointerdown", this._onMSPointerDown, !1), 
            t.addEventListener("pointermove", this._onMSPointerMove, !1), t.addEventListener("pointerup", this._onMSPointerUp, !1), 
            t.style["-ms-content-zooming"] = "none", t.style["-ms-touch-action"] = "none", this.game.device.cocoonJS || (window.addEventListener("MSPointerUp", this._onMSPointerUpGlobal, !0), 
            t.addEventListener("MSPointerOver", this._onMSPointerOver, !0), t.addEventListener("MSPointerOut", this._onMSPointerOut, !0), 
            window.addEventListener("pointerup", this._onMSPointerUpGlobal, !0), t.addEventListener("pointerover", this._onMSPointerOver, !0), 
            t.addEventListener("pointerout", this._onMSPointerOut, !0)), this.active = !0;
        },
        onPointerDown: function(t) {
            this.game.input.executeTouchLockCallbacks(!1, t), this.event = t, this.capture && t.preventDefault(), 
            this.pointerDownCallback && this.pointerDownCallback.call(this.callbackContext, t), 
            this.input.enabled && this.enabled && (t.identifier = t.pointerId, "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.start(t) : this.input.startPointer(t));
        },
        onPointerMove: function(t) {
            this.event = t, this.capture && t.preventDefault(), this.pointerMoveCallback && this.pointerMoveCallback.call(this.callbackContext, t), 
            this.input.enabled && this.enabled && (t.identifier = t.pointerId, "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.move(t) : this.input.updatePointer(t));
        },
        onPointerUp: function(t) {
            this.game.input.executeTouchLockCallbacks(!0, t), this.event = t, this.capture && t.preventDefault(), 
            this.pointerUpCallback && this.pointerUpCallback.call(this.callbackContext, t), 
            this.input.enabled && this.enabled && (t.identifier = t.pointerId, "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.stop(t) : this.input.stopPointer(t));
        },
        onPointerUpGlobal: function(t) {
            if (t.identifier = t.pointerId, "mouse" !== t.pointerType && 4 !== t.pointerType || this.input.mousePointer.withinGame) {
                var e = this.input.getPointerFromIdentifier(t.identifier);
                e && e.withinGame && this.onPointerUp(t);
            } else this.onPointerUp(t);
        },
        onPointerOut: function(t) {
            if (this.event = t, this.capture && t.preventDefault(), t.identifier = t.pointerId, 
            "mouse" === t.pointerType || 4 === t.pointerType) this.input.mousePointer.withinGame = !1; else {
                var e = this.input.getPointerFromIdentifier(t.identifier);
                e && (e.withinGame = !1);
            }
            this.pointerOutCallback && this.pointerOutCallback.call(this.callbackContext, t), 
            this.input.enabled && this.enabled && this.stopOnGameOut && (t.identifier = 0, e || (e = this.input.mousePointer), 
            e.stop(t), this.input.callAll("_pointerOutHandler", e));
        },
        onPointerOver: function(t) {
            if (this.event = t, this.capture && t.preventDefault(), t.identifier = t.pointerId, 
            "mouse" === t.pointerType || 4 === t.pointerType) this.input.mousePointer.withinGame = !0; else {
                var e = this.input.getPointerFromIdentifier(t.identifier);
                e && (e.withinGame = !0);
            }
            this.pointerOverCallback && this.pointerOverCallback.call(this.callbackContext, t);
        },
        stop: function() {
            var t = this.game.canvas;
            t.removeEventListener("MSPointerDown", this._onMSPointerDown, !1), t.removeEventListener("MSPointerMove", this._onMSPointerMove, !1), 
            t.removeEventListener("MSPointerUp", this._onMSPointerUp, !1), t.removeEventListener("pointerdown", this._onMSPointerDown, !1), 
            t.removeEventListener("pointermove", this._onMSPointerMove, !1), t.removeEventListener("pointerup", this._onMSPointerUp, !1), 
            window.removeEventListener("MSPointerUp", this._onMSPointerUpGlobal, !0), t.removeEventListener("MSPointerOver", this._onMSPointerOver, !0), 
            t.removeEventListener("MSPointerOut", this._onMSPointerOut, !0), window.removeEventListener("pointerup", this._onMSPointerUpGlobal, !0), 
            t.removeEventListener("pointerover", this._onMSPointerOver, !0), t.removeEventListener("pointerout", this._onMSPointerOut, !0), 
            this.active = !1;
        }
    }, z.MSPointer.prototype.constructor = z.MSPointer, z.DeviceButton = function(t, e) {
        this.parent = t, this.game = t.game, this.event = null, this.isDown = !1, this.isUp = !0, 
        this.timeDown = 0, this.timeUp = 0, this.repeats = 0, this.altKey = !1, this.shiftKey = !1, 
        this.ctrlKey = !1, this.value = 0, this.buttonCode = e, this.onDown = new z.Signal(), 
        this.onUp = new z.Signal(), this.onFloat = new z.Signal();
    }, z.DeviceButton.prototype = {
        start: function(t, e) {
            this.isDown || (this.isDown = !0, this.isUp = !1, this.timeDown = this.game.time.time, 
            this.repeats = 0, this.event = t, this.value = e, t && (this.altKey = t.altKey, 
            this.shiftKey = t.shiftKey, this.ctrlKey = t.ctrlKey), this.onDown.dispatch(this, e));
        },
        stop: function(t, e) {
            this.isUp || (this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, 
            this.event = t, this.value = e, t && (this.altKey = t.altKey, this.shiftKey = t.shiftKey, 
            this.ctrlKey = t.ctrlKey), this.onUp.dispatch(this, e));
        },
        startStop: function(t, e, i) {
            t ? this.start(e, i) : this.stop(e, i);
        },
        padFloat: function(t) {
            this.isDown = !1, this.isUp = !1, this.value = t, this.onFloat.dispatch(this, t);
        },
        justPressed: function(t) {
            return t = t || 250, this.isDown && this.timeDown + t > this.game.time.time;
        },
        justReleased: function(t) {
            return t = t || 250, this.isUp && this.timeUp + t > this.game.time.time;
        },
        reset: function() {
            this.isDown = !1, this.isUp = !0, this.timeDown = this.game.time.time, this.repeats = 0, 
            this.altKey = !1, this.shiftKey = !1, this.ctrlKey = !1;
        },
        destroy: function() {
            this.onDown.dispose(), this.onUp.dispose(), this.onFloat.dispose(), this.parent = null, 
            this.game = null;
        }
    }, z.DeviceButton.prototype.constructor = z.DeviceButton, Object.defineProperty(z.DeviceButton.prototype, "duration", {
        get: function() {
            return this.isUp ? -1 : this.game.time.time - this.timeDown;
        }
    }), z.Pointer = function(t, e, i) {
        this.game = t, this.id = e, this.type = z.POINTER, this.exists = !0, this.identifier = 0, 
        this.pointerId = null, this.pointerMode = i || z.PointerMode.CURSOR | z.PointerMode.CONTACT, 
        this.target = null, this.button = null, this.leftButton = new z.DeviceButton(this, z.Pointer.LEFT_BUTTON), 
        this.middleButton = new z.DeviceButton(this, z.Pointer.MIDDLE_BUTTON), this.rightButton = new z.DeviceButton(this, z.Pointer.RIGHT_BUTTON), 
        this.backButton = new z.DeviceButton(this, z.Pointer.BACK_BUTTON), this.forwardButton = new z.DeviceButton(this, z.Pointer.FORWARD_BUTTON), 
        this.eraserButton = new z.DeviceButton(this, z.Pointer.ERASER_BUTTON), this._holdSent = !1, 
        this._history = [], this._nextDrop = 0, this._stateReset = !1, this.withinGame = !1, 
        this.clientX = -1, this.clientY = -1, this.pageX = -1, this.pageY = -1, this.screenX = -1, 
        this.screenY = -1, this.rawMovementX = 0, this.rawMovementY = 0, this.movementX = 0, 
        this.movementY = 0, this.x = -1, this.y = -1, this.isMouse = 0 === e, this.isDown = !1, 
        this.isUp = !0, this.timeDown = 0, this.timeUp = 0, this.previousTapTime = 0, this.totalTouches = 0, 
        this.msSinceLastClick = Number.MAX_VALUE, this.targetObject = null, this.interactiveCandidates = [], 
        this.active = !1, this.dirty = !1, this.position = new z.Point(), this.positionDown = new z.Point(), 
        this.positionUp = new z.Point(), this.circle = new z.Circle(0, 0, 44), this._clickTrampolines = null, 
        this._trampolineTargetObject = null;
    }, z.Pointer.NO_BUTTON = 0, z.Pointer.LEFT_BUTTON = 1, z.Pointer.RIGHT_BUTTON = 2, 
    z.Pointer.MIDDLE_BUTTON = 4, z.Pointer.BACK_BUTTON = 8, z.Pointer.FORWARD_BUTTON = 16, 
    z.Pointer.ERASER_BUTTON = 32, z.Pointer.prototype = {
        resetButtons: function() {
            this.isDown = !1, this.isUp = !0, this.isMouse && (this.leftButton.reset(), this.middleButton.reset(), 
            this.rightButton.reset(), this.backButton.reset(), this.forwardButton.reset(), this.eraserButton.reset());
        },
        processButtonsDown: function(t, e) {
            switch (t) {
              case z.Mouse.LEFT_BUTTON:
                this.leftButton.start(e);
                break;

              case z.Mouse.RIGHT_BUTTON:
                this.rightButton.start(e);
                break;

              case z.Mouse.MIDDLE_BUTTON:
                this.middleButton.start(e);
                break;

              case z.Mouse.BACK_BUTTON:
                this.backButton.start(e);
                break;

              case z.Mouse.FORWARD_BUTTON:
                this.forwardButton.start(e);
            }
        },
        processButtonsUp: function(t, e) {
            switch (t) {
              case z.Mouse.LEFT_BUTTON:
                this.leftButton.stop(e);
                break;

              case z.Mouse.RIGHT_BUTTON:
                this.rightButton.stop(e);
                break;

              case z.Mouse.MIDDLE_BUTTON:
                this.middleButton.stop(e);
                break;

              case z.Mouse.BACK_BUTTON:
                this.backButton.stop(e);
                break;

              case z.Mouse.FORWARD_BUTTON:
                this.forwardButton.stop(e);
            }
        },
        processButtonsUpDown: function(t, e) {
            var i = e.type.toLowerCase().substr(-4), n = "down" === i, s = "move" === i;
            void 0 !== t ? (n && 1 === t && e.ctrlKey && (t = 2), this.leftButton.startStop(z.Pointer.LEFT_BUTTON & t, e), 
            this.rightButton.startStop(z.Pointer.RIGHT_BUTTON & t, e), this.middleButton.startStop(z.Pointer.MIDDLE_BUTTON & t, e), 
            this.backButton.startStop(z.Pointer.BACK_BUTTON & t, e), this.forwardButton.startStop(z.Pointer.FORWARD_BUTTON & t, e), 
            this.eraserButton.startStop(z.Pointer.ERASER_BUTTON & t, e)) : void 0 !== e.button ? n && e.ctrlKey && 0 === e.button ? this.rightButton.start(e) : n ? this.processButtonsDown(e.button, e) : s || this.processButtonsUp(e.button, e) : n ? e.ctrlKey ? this.rightButton.start(e) : this.leftButton.start(e) : (this.leftButton.stop(e), 
            this.rightButton.stop(e));
        },
        updateButtons: function(t) {
            this.button = t.button, this.processButtonsUpDown(t.buttons, t), this.isUp = !0, 
            this.isDown = !1, (this.leftButton.isDown || this.rightButton.isDown || this.middleButton.isDown || this.backButton.isDown || this.forwardButton.isDown || this.eraserButton.isDown) && (this.isUp = !1, 
            this.isDown = !0);
        },
        start: function(t) {
            var e = this.game.input;
            return t.pointerId && (this.pointerId = t.pointerId), this.identifier = t.identifier, 
            this.target = t.target, this.isMouse ? this.updateButtons(t) : (this.isDown = !0, 
            this.isUp = !1), this.active = !0, this.withinGame = !0, this.dirty = !1, this._history = [], 
            this._clickTrampolines = null, this._trampolineTargetObject = null, this.msSinceLastClick = this.game.time.time - this.timeDown, 
            this.timeDown = this.game.time.time, this._holdSent = !1, this.move(t, !0), this.positionDown.setTo(this.x, this.y), 
            (e.multiInputOverride === z.Input.MOUSE_OVERRIDES_TOUCH || e.multiInputOverride === z.Input.MOUSE_TOUCH_COMBINE || e.multiInputOverride === z.Input.TOUCH_OVERRIDES_MOUSE && 0 === e.totalActivePointers) && (e.x = this.x, 
            e.y = this.y, e.position.setTo(this.x, this.y), e.onDown.dispatch(this, t), e.resetSpeed(this.x, this.y)), 
            this._stateReset = !1, this.totalTouches++, null !== this.targetObject && this.targetObject._touchedHandler(this), 
            this;
        },
        update: function() {
            var t = this.game.input;
            this.active && (this.dirty && (0 < t.interactiveItems.total && this.processInteractiveObjects(!1), 
            this.dirty = !1), !1 === this._holdSent && this.duration >= t.holdRate && ((t.multiInputOverride === z.Input.MOUSE_OVERRIDES_TOUCH || t.multiInputOverride === z.Input.MOUSE_TOUCH_COMBINE || t.multiInputOverride === z.Input.TOUCH_OVERRIDES_MOUSE && 0 === t.totalActivePointers) && t.onHold.dispatch(this), 
            this._holdSent = !0), t.recordPointerHistory && this.game.time.time >= this._nextDrop && (this._nextDrop = this.game.time.time + t.recordRate, 
            this._history.push({
                x: this.position.x,
                y: this.position.y
            }), this._history.length > t.recordLimit && this._history.shift()));
        },
        move: function(t, e) {
            var i = this.game.input;
            if (!i.pollLocked) {
                void 0 === e && (e = !1), void 0 !== t.button && (this.button = t.button), this.isMouse && this.updateButtons(t), 
                this.clientX = t.clientX, this.clientY = t.clientY, this.pageX = t.pageX, this.pageY = t.pageY, 
                this.screenX = t.screenX, this.screenY = t.screenY, this.isMouse && i.pointerLock.locked && !e && (this.rawMovementX = t.movementX || t.mozMovementX || t.webkitMovementX || 0, 
                this.rawMovementY = t.movementY || t.mozMovementY || t.webkitMovementY || 0, this.movementX += this.rawMovementX, 
                this.movementY += this.rawMovementY), this.x = (this.pageX - this.game.scale.offset.x) * i.scale.x, 
                this.y = (this.pageY - this.game.scale.offset.y) * i.scale.y, this.position.setTo(this.x, this.y), 
                this.circle.x = this.x, this.circle.y = this.y, (i.multiInputOverride === z.Input.MOUSE_OVERRIDES_TOUCH || i.multiInputOverride === z.Input.MOUSE_TOUCH_COMBINE || i.multiInputOverride === z.Input.TOUCH_OVERRIDES_MOUSE && 0 === i.totalActivePointers) && (i.activePointer = this, 
                i.x = this.x, i.y = this.y, i.position.setTo(i.x, i.y), i.circle.x = i.x, i.circle.y = i.y), 
                this.withinGame = this.game.scale.bounds.contains(this.pageX, this.pageY);
                for (var n = i.moveCallbacks.length; n--; ) i.moveCallbacks[n].callback.call(i.moveCallbacks[n].context, this, this.x, this.y, e, t);
                return null === this.targetObject || this.game.paused && !this.targetObject.noPause || !0 !== this.targetObject.isDragged ? 0 < i.interactiveItems.total && this.processInteractiveObjects(e) : !1 === this.targetObject.update(this) && (this.targetObject = null), 
                this;
            }
        },
        processInteractiveObjects: function(t) {
            var e = 0, i = -1, n = null, s = this.game.input.interactiveItems.first;
            for (this.interactiveCandidates = []; s; ) s.checked = !1, !s.validForInput(i, e, !1) || this.game.paused && !s.sprite.noPause || (s.checked = !0, 
            (t && s.checkPointerDown(this, !0) || !t && s.checkPointerOver(this, !0)) && (e = s.sprite.renderOrderID, 
            i = s.priorityID, n = s, this.interactiveCandidates.push(s))), s = this.game.input.interactiveItems.next;
            for (s = this.game.input.interactiveItems.first; s; ) !s.checked && s.validForInput(i, e, !0) && (t && s.checkPointerDown(this, !1) || !t && s.checkPointerOver(this, !1)) && (e = s.sprite.renderOrderID, 
            i = s.priorityID, n = s, this.interactiveCandidates.push(s)), s = this.game.input.interactiveItems.next;
            return this.game.input.customCandidateHandler && (n = this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext, this, this.interactiveCandidates, n)), 
            this.swapTarget(n, !1), null !== this.targetObject;
        },
        swapTarget: function(t, e) {
            void 0 === e && (e = !1), null === t ? this.targetObject && (this.targetObject._pointerOutHandler(this, e), 
            this.targetObject = null) : null === this.targetObject ? (this.targetObject = t)._pointerOverHandler(this, e) : this.targetObject === t ? !1 === t.update(this) && (this.targetObject = null) : (this.targetObject._pointerOutHandler(this, e), 
            this.targetObject = t, this.targetObject._pointerOverHandler(this, e));
        },
        leave: function(t) {
            this.withinGame = !1, this.move(t, !1);
        },
        stop: function(t) {
            var e = this.game.input;
            if (!this._stateReset || !this.withinGame) {
                if (this.timeUp = this.game.time.time, (e.multiInputOverride === z.Input.MOUSE_OVERRIDES_TOUCH || e.multiInputOverride === z.Input.MOUSE_TOUCH_COMBINE || e.multiInputOverride === z.Input.TOUCH_OVERRIDES_MOUSE && 0 === e.totalActivePointers) && (e.onUp.dispatch(this, t), 
                0 <= this.duration && this.duration <= e.tapRate)) {
                    var i = this.timeUp - this.previousTapTime < e.doubleTapRate;
                    e.onTap.dispatch(this, i, t), this.previousTapTime = this.timeUp;
                }
                return this.isMouse ? this.updateButtons(t) : (this.isDown = !1, this.isUp = !0), 
                0 < this.id && (this.active = !1), this.withinGame = this.game.scale.bounds.contains(t.pageX, t.pageY), 
                this.pointerId = null, this.identifier = null, this.positionUp.setTo(this.x, this.y), 
                !1 === this.isMouse && e.currentPointers--, e.callAll("_releasedHandler", this), 
                this._clickTrampolines && (this._trampolineTargetObject = this.targetObject), this.targetObject = null, 
                this;
            }
            t.preventDefault();
        },
        amazingHardSop: function() {
            var t = this.game.input;
            return this.isDown = !1, this.isUp = !0, this.active = !1, this.pointerId = null, 
            this.identifier = null, this.positionUp.setTo(this.x, this.y), !1 === this.isMouse && t.currentPointers--, 
            t.callAll("_releasedHandler", this), this.targetObject = null, this;
        },
        justPressed: function(t) {
            return t = t || this.game.input.justPressedRate, !0 === this.isDown && this.timeDown + t > this.game.time.time;
        },
        justReleased: function(t) {
            return t = t || this.game.input.justReleasedRate, this.isUp && this.timeUp + t > this.game.time.time;
        },
        addClickTrampoline: function(t, e, i, n) {
            if (this.isDown) {
                for (var s = this._clickTrampolines = this._clickTrampolines || [], o = 0; o < s.length; o++) if (s[o].name === t) {
                    s.splice(o, 1);
                    break;
                }
                s.push({
                    name: t,
                    targetObject: this.targetObject,
                    callback: e,
                    callbackContext: i,
                    callbackArgs: n
                });
            }
        },
        processClickTrampolines: function() {
            var t = this._clickTrampolines;
            if (t) {
                for (var e = 0; e < t.length; e++) {
                    var i = t[e];
                    i.targetObject === this._trampolineTargetObject && i.callback.apply(i.callbackContext, i.callbackArgs);
                }
                this._clickTrampolines = null, this._trampolineTargetObject = null;
            }
        },
        reset: function() {
            !1 === this.isMouse && (this.active = !1), this.pointerId = null, this.identifier = null, 
            this.dirty = !1, this.totalTouches = 0, this._holdSent = !1, this._history.length = 0, 
            this._stateReset = !0, this.resetButtons(), this.targetObject && this.targetObject._releasedHandler(this), 
            this.targetObject = null;
        },
        resetMovement: function() {
            this.movementX = 0, this.movementY = 0;
        }
    }, z.Pointer.prototype.constructor = z.Pointer, Object.defineProperty(z.Pointer.prototype, "duration", {
        get: function() {
            return this.isUp ? -1 : this.game.time.time - this.timeDown;
        }
    }), Object.defineProperty(z.Pointer.prototype, "worldX", {
        get: function() {
            return this.game.world.camera.x + this.x;
        }
    }), Object.defineProperty(z.Pointer.prototype, "worldY", {
        get: function() {
            return this.game.world.camera.y + this.y;
        }
    }), z.PointerMode = {
        CURSOR: 1,
        CONTACT: 2
    }, z.PointerModes = {}, z.PointerModes[z.PointerMode.CURSOR] = "CURSOR", z.PointerModes[z.PointerMode.CONTACT] = "CONTACT", 
    z.Touch = function(t) {
        this.game = t, this.active = !1, this.enabled = !0, this.callbackContext = this.game, 
        this.touchStartCallback = null, this.touchMoveCallback = null, this.touchEndCallback = null, 
        this.touchEnterCallback = null, this.touchLeaveCallback = null, this.touchCancelCallback = null, 
        this.preventDefault = !0, this.event = null, this._onTouchStart = null, this._onTouchMove = null, 
        this._onTouchEnd = null, this._onTouchEnter = null, this._onTouchLeave = null, this._onTouchCancel = null, 
        this._onTouchMove = null;
    }, z.Touch.prototype = {
        start: function() {
            if (!this.game.device.touch) return !1;
            if (null !== this._onTouchStart) return !1;
            var e = this;
            return this._onTouchStart = function(t) {
                return e.onTouchStart(t);
            }, this._onTouchMove = function(t) {
                return e.onTouchMove(t);
            }, this._onTouchEnd = function(t) {
                return e.onTouchEnd(t);
            }, this._onTouchEnter = function(t) {
                return e.onTouchEnter(t);
            }, this._onTouchLeave = function(t) {
                return e.onTouchLeave(t);
            }, this._onTouchCancel = function(t) {
                return e.onTouchCancel(t);
            }, this.game.canvas.addEventListener("touchstart", this._onTouchStart, !1), this.game.canvas.addEventListener("touchmove", this._onTouchMove, !1), 
            this.game.canvas.addEventListener("touchend", this._onTouchEnd, !1), this.game.canvas.addEventListener("touchcancel", this._onTouchCancel, !1), 
            this.game.device.cocoonJS || (this.game.canvas.addEventListener("touchenter", this._onTouchEnter, !1), 
            this.game.canvas.addEventListener("touchleave", this._onTouchLeave, !1)), this.active = !0;
        },
        consumeDocumentTouches: function() {
            this._documentTouchMove = function(t) {
                t.preventDefault();
            }, document.addEventListener("touchmove", this._documentTouchMove, !1);
        },
        onTouchStart: function(t) {
            if (this.game.input.executeTouchLockCallbacks(!1, t), this.event = t, this.game.input.enabled && this.enabled) {
                this.touchStartCallback && this.touchStartCallback.call(this.callbackContext, t), 
                this.preventDefault && t.cancelable && t.preventDefault();
                for (var e = 0; e < t.changedTouches.length; e++) this.game.input.startPointer(t.changedTouches[e]);
            }
        },
        onTouchCancel: function(t) {
            if (this.event = t, this.touchCancelCallback && this.touchCancelCallback.call(this.callbackContext, t), 
            this.game.input.enabled && this.enabled) {
                this.preventDefault && t.preventDefault();
                for (var e = 0; e < t.changedTouches.length; e++) this.game.input.stopPointer(t.changedTouches[e]);
            }
        },
        onTouchEnter: function(t) {
            this.event = t, this.touchEnterCallback && this.touchEnterCallback.call(this.callbackContext, t), 
            this.game.input.enabled && this.enabled && this.preventDefault && t.preventDefault();
        },
        onTouchLeave: function(t) {
            this.event = t, this.touchLeaveCallback && this.touchLeaveCallback.call(this.callbackContext, t), 
            this.preventDefault && t.preventDefault();
        },
        onTouchMove: function(t) {
            this.event = t, this.touchMoveCallback && this.touchMoveCallback.call(this.callbackContext, t), 
            this.preventDefault && t.cancelable && t.preventDefault();
            for (var e = 0; e < t.changedTouches.length; e++) this.game.input.updatePointer(t.changedTouches[e]);
        },
        onTouchEnd: function(t) {
            this.game.input.executeTouchLockCallbacks(!0, t), this.event = t, this.touchEndCallback && this.touchEndCallback.call(this.callbackContext, t), 
            this.preventDefault && t.cancelable && t.preventDefault();
            for (var e = 0; e < t.changedTouches.length; e++) this.game.input.stopPointer(t.changedTouches[e]);
        },
        stop: function() {
            this.game.device.touch && (this.game.canvas.removeEventListener("touchstart", this._onTouchStart), 
            this.game.canvas.removeEventListener("touchmove", this._onTouchMove), this.game.canvas.removeEventListener("touchend", this._onTouchEnd), 
            this.game.canvas.removeEventListener("touchenter", this._onTouchEnter), this.game.canvas.removeEventListener("touchleave", this._onTouchLeave), 
            this.game.canvas.removeEventListener("touchcancel", this._onTouchCancel), this.active = !1);
        }
    }, z.Touch.prototype.constructor = z.Touch, z.InputHandler = function(t) {
        this.sprite = t, this.game = t.game, this.enabled = !1, this.checked = !1, this.priorityID = 0, 
        this.useHandCursor = !1, this._setHandCursor = !1, this.isDragged = !1, this.allowHorizontalDrag = !0, 
        this.allowVerticalDrag = !0, this.bringToTop = !1, this.snapOffset = null, this.snapOnDrag = !1, 
        this.snapOnRelease = !1, this.snapX = 0, this.snapY = 0, this.snapOffsetX = 0, this.snapOffsetY = 0, 
        this.pixelPerfectOver = !1, this.pixelPerfectClick = !1, this.pixelPerfectAlpha = 255, 
        this.draggable = !1, this.boundsRect = null, this.boundsSprite = null, this.scaleLayer = !1, 
        this.dragOffset = new z.Point(), this.dragFromCenter = !1, this.dragStopBlocksInputUp = !1, 
        this.dragStartPoint = new z.Point(), this.dragDistanceThreshold = 0, this.dragTimeThreshold = 0, 
        this.downPoint = new z.Point(), this.snapPoint = new z.Point(), this._dragPoint = new z.Point(), 
        this._dragPhase = !1, this._pendingDrag = !1, this._dragTimePass = !1, this._dragDistancePass = !1, 
        this._wasEnabled = !1, this._tempPoint = new z.Point(), this._pointerData = [], 
        this._pointerData.push({
            id: 0,
            x: 0,
            y: 0,
            camX: 0,
            camY: 0,
            isDown: !1,
            isUp: !1,
            isOver: !1,
            isOut: !1,
            timeOver: 0,
            timeOut: 0,
            timeDown: 0,
            timeUp: 0,
            downDuration: 0,
            isDragged: !1
        });
    }, z.InputHandler.prototype = {
        start: function(t, e) {
            if (t = t || 0, void 0 === e && (e = !1), !1 === this.enabled) {
                this.game.input.interactiveItems.add(this), this.useHandCursor = e, this.priorityID = t;
                for (var i = 0; i < 10; i++) this._pointerData[i] = {
                    id: i,
                    x: 0,
                    y: 0,
                    isDown: !1,
                    isUp: !1,
                    isOver: !1,
                    isOut: !1,
                    timeOver: 0,
                    timeOut: 0,
                    timeDown: 0,
                    timeUp: 0,
                    downDuration: 0,
                    isDragged: !1
                };
                this.snapOffset = new z.Point(), this.enabled = !0, this._wasEnabled = !0;
            }
            return this.sprite.events.onAddedToGroup.add(this.addedToGroup, this), this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup, this), 
            this.sprite;
        },
        addedToGroup: function() {
            this._dragPhase || this._wasEnabled && !this.enabled && this.start();
        },
        removedFromGroup: function() {
            this._dragPhase || (this.enabled ? (this._wasEnabled = !0, this.stop()) : this._wasEnabled = !1);
        },
        reset: function() {
            this.enabled = !1;
            for (var t = 0; t < 10; t++) this._pointerData[t] = {
                id: t,
                x: 0,
                y: 0,
                isDown: !1,
                isUp: !1,
                isOver: !1,
                isOut: !1,
                timeOver: 0,
                timeOut: 0,
                timeDown: 0,
                timeUp: 0,
                downDuration: 0,
                isDragged: !1
            };
        },
        stop: function() {
            !1 !== this.enabled && (this.enabled = !1, this.game.input.interactiveItems.remove(this));
        },
        destroy: function() {
            this.sprite && (this._setHandCursor && (this.game.canvas.style.cursor = "", this._setHandCursor = !1), 
            this.enabled = !1, this.game.input.interactiveItems.remove(this), this._pointerData.length = 0, 
            this.boundsRect = null, this.boundsSprite = null, this.sprite = null);
        },
        validForInput: function(t, e, i) {
            return void 0 === i && (i = !0), !(!this.enabled || 0 === this.sprite.scale.x || 0 === this.sprite.scale.y || this.priorityID < this.game.input.minPriorityID || this.sprite.parent && this.sprite.parent.ignoreChildInput) && (!(!i && (this.pixelPerfectClick || this.pixelPerfectOver)) && (this.priorityID > t || this.priorityID === t && this.sprite.renderOrderID > e));
        },
        isPixelPerfect: function() {
            return this.pixelPerfectClick || this.pixelPerfectOver;
        },
        pointerX: function(t) {
            return t = t || 0, this._pointerData[t].x;
        },
        pointerY: function(t) {
            return t = t || 0, this._pointerData[t].y;
        },
        pointerDown: function(t) {
            return t = t || 0, this._pointerData[t].isDown;
        },
        pointerUp: function(t) {
            return t = t || 0, this._pointerData[t].isUp;
        },
        pointerTimeDown: function(t) {
            return t = t || 0, this._pointerData[t].timeDown;
        },
        pointerTimeUp: function(t) {
            return t = t || 0, this._pointerData[t].timeUp;
        },
        pointerOver: function(t) {
            if (!this.enabled) return !1;
            if (void 0 === t) {
                for (var e = 0; e < 10; e++) if (this._pointerData[e].isOver) return !0;
                return !1;
            }
            return this._pointerData[t].isOver;
        },
        pointerOut: function(t) {
            if (!this.enabled) return !1;
            if (void 0 !== t) return this._pointerData[t].isOut;
            for (var e = 0; e < 10; e++) if (this._pointerData[e].isOut) return !0;
        },
        pointerTimeOver: function(t) {
            return t = t || 0, this._pointerData[t].timeOver;
        },
        pointerTimeOut: function(t) {
            return t = t || 0, this._pointerData[t].timeOut;
        },
        pointerDragged: function(t) {
            return t = t || 0, this._pointerData[t].isDragged;
        },
        checkPointerDown: function(t, e) {
            return !!(t.isDown && this.enabled && this.sprite && this.sprite.parent && this.sprite.visible && this.sprite.parent.visible && 0 !== this.sprite.worldScale.x && 0 !== this.sprite.worldScale.y) && (!!this.game.input.hitTest(this.sprite, t, this._tempPoint) && (void 0 === e && (e = !1), 
            !(!e && this.pixelPerfectClick) || this.checkPixel(this._tempPoint.x, this._tempPoint.y)));
        },
        checkPointerOver: function(t, e) {
            return !!(this.enabled && this.sprite && this.sprite.parent && this.sprite.visible && this.sprite.parent.visible && 0 !== this.sprite.worldScale.x && 0 !== this.sprite.worldScale.y) && (!!this.game.input.hitTest(this.sprite, t, this._tempPoint) && (void 0 === e && (e = !1), 
            !(!e && this.pixelPerfectOver) || this.checkPixel(this._tempPoint.x, this._tempPoint.y)));
        },
        checkPixel: function(t, e, i) {
            if (this.sprite.texture.baseTexture.source) {
                if (null === t && null === e) {
                    this.game.input.getLocalPosition(this.sprite, i, this._tempPoint);
                    t = this._tempPoint.x, e = this._tempPoint.y;
                }
                if (0 !== this.sprite.anchor.x && (t -= -this.sprite.texture.frame.width * this.sprite.anchor.x), 
                0 !== this.sprite.anchor.y && (e -= -this.sprite.texture.frame.height * this.sprite.anchor.y), 
                t += this.sprite.texture.frame.x, e += this.sprite.texture.frame.y, this.sprite.texture.trim && (t -= this.sprite.texture.trim.x, 
                e -= this.sprite.texture.trim.y, t < this.sprite.texture.crop.x || t > this.sprite.texture.crop.right || e < this.sprite.texture.crop.y || e > this.sprite.texture.crop.bottom)) return this._dx = t, 
                this._dy = e, !1;
                if (this._dx = t, this._dy = e, this.game.input.hitContext.clearRect(0, 0, 1, 1), 
                this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source, t, e, 1, 1, 0, 0, 1, 1), 
                this.game.input.hitContext.getImageData(0, 0, 1, 1).data[3] >= this.pixelPerfectAlpha) return !0;
            }
            return !1;
        },
        update: function(t) {
            if (null !== this.sprite && void 0 !== this.sprite.parent) return this.enabled && this.sprite.visible && this.sprite.parent.visible ? this._pendingDrag ? (this._dragDistancePass || (this._dragDistancePass = z.Math.distance(t.x, t.y, this.downPoint.x, this.downPoint.y) >= this.dragDistanceThreshold), 
            this._dragDistancePass && this._dragTimePass && this.startDrag(t), !0) : this.draggable && this._draggedPointerID === t.id ? this.updateDrag(t, !1) : this._pointerData[t.id].isOver ? this.checkPointerOver(t) ? (this._pointerData[t.id].x = t.x - this.sprite.x, 
            this._pointerData[t.id].y = t.y - this.sprite.y, !0) : (this._pointerOutHandler(t), 
            !1) : void 0 : (this._pointerOutHandler(t), !1);
        },
        _pointerOverHandler: function(t, e) {
            if (null !== this.sprite) {
                var i = this._pointerData[t.id];
                if (!1 === i.isOver || t.dirty) {
                    var n = !1 === i.isOver;
                    i.isOver = !0, i.isOut = !1, i.timeOver = this.game.time.time, i.x = t.x - this.sprite.x, 
                    i.y = t.y - this.sprite.y, this.useHandCursor && !1 === i.isDragged && (this.game.canvas.style.cursor = "pointer", 
                    this._setHandCursor = !0), !e && n && this.sprite && this.sprite.events && this.sprite.events.onInputOver$dispatch(this.sprite, t), 
                    this.sprite.parent && this.sprite.parent.onChildInputOver && this.sprite.parent.onChildInputOver.dispatch(this.sprite, t);
                }
            }
        },
        _pointerOutHandler: function(t, e) {
            if (null !== this.sprite) {
                var i = this._pointerData[t.id];
                i.isOver = !1, i.isOut = !0, i.timeOut = this.game.time.time, this.useHandCursor && !1 === i.isDragged && (this.game.canvas.style.cursor = "", 
                this._setHandCursor = !1), !e && this.sprite && this.sprite.events && (this.sprite.events.onInputOut$dispatch(this.sprite, t), 
                this.sprite && this.sprite.parent && this.sprite.parent.onChildInputOut && this.sprite.parent.onChildInputOut.dispatch(this.sprite, t));
            }
        },
        _touchedHandler: function(t) {
            if (null !== this.sprite) {
                var e = this._pointerData[t.id];
                if (!e.isDown && e.isOver) {
                    if (this.pixelPerfectClick && !this.checkPixel(null, null, t)) return;
                    if (e.isDown = !0, e.isUp = !1, e.timeDown = this.game.time.time, this.downPoint.set(t.x, t.y), 
                    t.dirty = !0, this.sprite && this.sprite.events && (this.sprite.events.onInputDown$dispatch(this.sprite, t), 
                    this.sprite && this.sprite.parent && this.sprite.parent.onChildInputDown && this.sprite.parent.onChildInputDown.dispatch(this.sprite, t), 
                    null === this.sprite)) return;
                    this.draggable && !1 === this.isDragged && (0 === this.dragTimeThreshold && 0 === this.dragDistanceThreshold ? this.startDrag(t) : (this._pendingDrag = !0, 
                    this._dragDistancePass = 0 === this.dragDistanceThreshold, 0 < this.dragTimeThreshold ? (this._dragTimePass = !1, 
                    this.game.time.events.add(this.dragTimeThreshold, this.dragTimeElapsed, this, t)) : this._dragTimePass = !0)), 
                    this.bringToTop && this.sprite.bringToTop();
                }
            }
        },
        dragTimeElapsed: function(t) {
            this._dragTimePass = !0, this._pendingDrag && this.sprite && this._dragDistancePass && this.startDrag(t);
        },
        _releasedHandler: function(t) {
            if (null !== this.sprite) {
                var e = this._pointerData[t.id];
                if (e.isDown && t.isUp) {
                    e.isDown = !1, e.isUp = !0, e.timeUp = this.game.time.time, e.downDuration = e.timeUp - e.timeDown;
                    var i = this.checkPointerOver(t);
                    this.sprite && this.sprite.events && (this.dragStopBlocksInputUp && (!this.dragStopBlocksInputUp || this.draggable && this.isDragged && this._draggedPointerID === t.id) || this.sprite.events.onInputUp$dispatch(this.sprite, t, i), 
                    this.sprite && this.sprite.parent && this.sprite.parent.onChildInputUp && this.sprite.parent.onChildInputUp.dispatch(this.sprite, t, i), 
                    i && (i = this.checkPointerOver(t))), !(e.isOver = i) && this.useHandCursor && (this.game.canvas.style.cursor = "default", 
                    this._setHandCursor = !1), t.dirty = !0, this._pendingDrag = !1, this.draggable && this.isDragged && this._draggedPointerID === t.id && this.stopDrag(t);
                }
            }
        },
        updateDrag: function(t, e) {
            var i = this.game.camera, n = this.dragOffset, s = this._dragPoint, o = this._pointerData[t.id], a = this.snapPoint, r = this.sprite;
            if (void 0 === e && (e = !1), t.isUp) return this.stopDrag(t), !1;
            var h = this.globalToLocal(t);
            if (r.fixedToCamera) var l = i.scale.x * h.x + s.x + n.x, c = i.scale.y * h.y + s.y + n.y; else l = h.x + s.x + n.x, 
            c = h.y + s.y + n.y;
            if (r.fixedToCamera) {
                var u = r.cameraOffset, d = u.x, p = u.y;
                this.allowHorizontalDrag && (u.x = l - i.x), this.allowVerticalDrag && (u.y = c - i.y), 
                this.boundsRect && this.checkBoundsRect(), this.boundsSprite && this.checkBoundsSprite(), 
                this.snapOnDrag && (u.x = Math.round((u.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, 
                u.y = Math.round((u.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY, 
                a.set(u.x, u.y));
                var g = u.x - d, m = u.y - p;
            } else {
                var f = i.x - o.camX, y = i.y - o.camY;
                d = r.x, p = r.y;
                this.allowHorizontalDrag && (r.x = l + f), this.allowVerticalDrag && (r.y = c + y), 
                this.boundsRect && this.checkBoundsRect(), this.boundsSprite && this.checkBoundsSprite(), 
                this.snapOnDrag && (r.x = Math.round((r.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, 
                r.y = Math.round((r.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY, 
                a.set(r.x, r.y));
                g = r.x - d, m = r.y - p;
            }
            return this.sprite.events.onDragUpdate.dispatch(r, t, l, c, a, e, g, m), !0;
        },
        justOver: function(t, e) {
            return t = t || 0, e = e || 500, this._pointerData[t].isOver && this.overDuration(t) < e;
        },
        justOut: function(t, e) {
            return t = t || 0, e = e || 500, this._pointerData[t].isOut && this.game.time.time - this._pointerData[t].timeOut < e;
        },
        justPressed: function(t, e) {
            return t = t || 0, e = e || 500, this._pointerData[t].isDown && this.downDuration(t) < e;
        },
        justReleased: function(t, e) {
            return t = t || 0, e = e || 500, this._pointerData[t].isUp && this.game.time.time - this._pointerData[t].timeUp < e;
        },
        overDuration: function(t) {
            return t = t || 0, this._pointerData[t].isOver ? this.game.time.time - this._pointerData[t].timeOver : -1;
        },
        downDuration: function(t) {
            return t = t || 0, this._pointerData[t].isDown ? this.game.time.time - this._pointerData[t].timeDown : -1;
        },
        enableDrag: function(t, e, i, n, s, o) {
            void 0 === t && (t = !1), void 0 === e && (e = !1), void 0 === i && (i = !1), void 0 === n && (n = 255), 
            void 0 === s && (s = null), void 0 === o && (o = null), this._dragPoint = new z.Point(), 
            this.draggable = !0, this.bringToTop = e, this.dragOffset = new z.Point(), this.dragFromCenter = t, 
            this.pixelPerfectClick = i, this.pixelPerfectAlpha = n, s && (this.boundsRect = s), 
            o && (this.boundsSprite = o);
        },
        disableDrag: function() {
            if (this._pointerData) for (var t = 0; t < 10; t++) this._pointerData[t].isDragged = !1;
            this.draggable = !1, this.isDragged = !1, this._draggedPointerID = -1, this._pendingDrag = !1;
        },
        startDrag: function(t) {
            var e = this.sprite.x, i = this.sprite.y, n = this.globalToLocal(t);
            if (this.isDragged = !0, this._draggedPointerID = t.id, this._pointerData[t.id].camX = this.game.camera.x, 
            this._pointerData[t.id].camY = this.game.camera.y, this._pointerData[t.id].isDragged = !0, 
            this.sprite.fixedToCamera) {
                if (this.dragFromCenter) {
                    var s = this.sprite.getBounds(), o = this.globalToLocal(new z.Point(s.centerX, s.centerY));
                    this.sprite.cameraOffset.x = n.x + (this.sprite.cameraOffset.x - o.x), this.sprite.cameraOffset.y = n.y + (this.sprite.cameraOffset.y - o.y);
                }
                this._dragPoint.setTo(this.sprite.cameraOffset.x - t.x, this.sprite.cameraOffset.y - t.y);
            } else {
                if (this.dragFromCenter) {
                    s = this.sprite.getBounds(), o = this.globalToLocal(new z.Point(s.centerX, s.centerY));
                    this.sprite.x = n.x + (this.sprite.x - o.x), this.sprite.y = n.y + (this.sprite.y - o.y);
                }
                this._dragPoint.setTo(this.sprite.x - n.x, this.sprite.y - n.y);
            }
            this.updateDrag(t, !0), this.bringToTop && (this._dragPhase = !0, this.sprite.bringToTop()), 
            this.dragStartPoint.set(e, i), this.sprite.events.onDragStart$dispatch(this.sprite, t, e, i), 
            this._pendingDrag = !1;
        },
        globalToLocalX: function(t) {
            return this.scaleLayer && (t -= this.game.scale.grid.boundsFluid.x, t *= this.game.scale.grid.scaleFluidInversed.x), 
            t;
        },
        globalToLocalY: function(t) {
            return this.scaleLayer && (t -= this.game.scale.grid.boundsFluid.y, t *= this.game.scale.grid.scaleFluidInversed.y), 
            t;
        },
        globalToLocal: function(t) {
            return this.sprite.parent ? this.game.input.getLocalPosition(this.sprite.parent, {
                x: t.x,
                y: t.y
            }) : t;
        },
        stopDrag: function(t) {
            this.isDragged = !1, this._draggedPointerID = -1, this._pointerData[t.id].isDragged = !1, 
            this._dragPhase = !1, this._pendingDrag = !1, this.snapOnRelease && (this.sprite.fixedToCamera ? (this.sprite.cameraOffset.x = Math.round((this.sprite.cameraOffset.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, 
            this.sprite.cameraOffset.y = Math.round((this.sprite.cameraOffset.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY) : (this.sprite.x = Math.round((this.sprite.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, 
            this.sprite.y = Math.round((this.sprite.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY)), 
            this.sprite.events.onDragStop$dispatch(this.sprite, t), !1 === this.checkPointerOver(t) && this._pointerOutHandler(t);
        },
        setDragLock: function(t, e) {
            void 0 === t && (t = !0), void 0 === e && (e = !0), this.allowHorizontalDrag = t, 
            this.allowVerticalDrag = e;
        },
        enableSnap: function(t, e, i, n, s, o) {
            void 0 === i && (i = !0), void 0 === n && (n = !1), void 0 === s && (s = 0), void 0 === o && (o = 0), 
            this.snapX = t, this.snapY = e, this.snapOffsetX = s, this.snapOffsetY = o, this.snapOnDrag = i, 
            this.snapOnRelease = n;
        },
        disableSnap: function() {
            this.snapOnDrag = !1, this.snapOnRelease = !1;
        },
        checkBoundsRect: function() {
            this.sprite.fixedToCamera ? (this.sprite.cameraOffset.x < this.boundsRect.left ? this.sprite.cameraOffset.x = this.boundsRect.left : this.sprite.cameraOffset.x + this.sprite.width > this.boundsRect.right && (this.sprite.cameraOffset.x = this.boundsRect.right - this.sprite.width), 
            this.sprite.cameraOffset.y < this.boundsRect.top ? this.sprite.cameraOffset.y = this.boundsRect.top : this.sprite.cameraOffset.y + this.sprite.height > this.boundsRect.bottom && (this.sprite.cameraOffset.y = this.boundsRect.bottom - this.sprite.height)) : (this.sprite.left < this.boundsRect.left ? this.sprite.x = this.boundsRect.x + this.sprite.offsetX : this.sprite.right > this.boundsRect.right && (this.sprite.x = this.boundsRect.right - (this.sprite.width - this.sprite.offsetX)), 
            this.sprite.top < this.boundsRect.top ? this.sprite.y = this.boundsRect.top + this.sprite.offsetY : this.sprite.bottom > this.boundsRect.bottom && (this.sprite.y = this.boundsRect.bottom - (this.sprite.height - this.sprite.offsetY)));
        },
        checkBoundsSprite: function() {
            this.sprite.fixedToCamera && this.boundsSprite.fixedToCamera ? (this.sprite.cameraOffset.x < this.boundsSprite.cameraOffset.x ? this.sprite.cameraOffset.x = this.boundsSprite.cameraOffset.x : this.sprite.cameraOffset.x + this.sprite.width > this.boundsSprite.cameraOffset.x + this.boundsSprite.width && (this.sprite.cameraOffset.x = this.boundsSprite.cameraOffset.x + this.boundsSprite.width - this.sprite.width), 
            this.sprite.cameraOffset.y < this.boundsSprite.cameraOffset.y ? this.sprite.cameraOffset.y = this.boundsSprite.cameraOffset.y : this.sprite.cameraOffset.y + this.sprite.height > this.boundsSprite.cameraOffset.y + this.boundsSprite.height && (this.sprite.cameraOffset.y = this.boundsSprite.cameraOffset.y + this.boundsSprite.height - this.sprite.height)) : (this.sprite.left < this.boundsSprite.left ? this.sprite.x = this.boundsSprite.left + this.sprite.offsetX : this.sprite.right > this.boundsSprite.right && (this.sprite.x = this.boundsSprite.right - (this.sprite.width - this.sprite.offsetX)), 
            this.sprite.top < this.boundsSprite.top ? this.sprite.y = this.boundsSprite.top + this.sprite.offsetY : this.sprite.bottom > this.boundsSprite.bottom && (this.sprite.y = this.boundsSprite.bottom - (this.sprite.height - this.sprite.offsetY)));
        }
    }, z.InputHandler.prototype.constructor = z.InputHandler, z.PointerLock = function(t) {
        this.game = t, this.input = t.input, this.element = t.canvas, this.active = !1, 
        this.locked = !1, this.onChange = new z.Signal(), this.onError = new z.Signal(), 
        this.boundOnChangeHandler = this.onChangeHandler.bind(this), this.boundOnErrorHandler = this.onErrorHandler.bind(this);
        var e = t.device;
        this.pointerLockElement = e.pointerLockElement, this.pointerlockchange = e.pointerlockchange, 
        this.pointerlockerror = e.pointerlockerror;
    }, z.PointerLock.prototype.start = function() {
        return !(!this.game.device.pointerLock || this.active) && (this.element.requestPointerLock || (this.element.requestPointerLock = this.element.mozRequestPointerLock || this.element.webkitRequestPointerLock), 
        document.exitPointerLock || (document.exitPointerLock = document.mozExitPointerLock || document.webkitExitPointerLock), 
        document.addEventListener(this.pointerlockchange, this.boundOnChangeHandler, !0), 
        document.addEventListener(this.pointerlockerror, this.boundOnErrorHandler, !0), 
        this.active = !0);
    }, z.PointerLock.prototype.stop = function() {
        this.active && (document.removeEventListener(this.pointerlockchange, this.boundOnChangeHandler, !0), 
        document.removeEventListener(this.pointerlockerror, this.boundOnErrorHandler, !0), 
        this.active = !1);
    }, z.PointerLock.prototype.request = function() {
        this.active && !this.locked && this.element.requestPointerLock();
    }, z.PointerLock.prototype.exit = function() {
        document.exitPointerLock();
    }, z.PointerLock.prototype.onChangeHandler = function(t) {
        this.locked = document[this.pointerLockElement] === this.element, this.onChange.dispatch(this.locked, t);
    }, z.PointerLock.prototype.onErrorHandler = function(t) {
        this.onError.dispatch(t);
    }, z.Gamepad = function(t) {
        this.game = t, this._gamepadIndexMap = {}, this._rawPads = [], this._active = !1, 
        this.enabled = !0, this._gamepadSupportAvailable = !!navigator.webkitGetGamepads || !!navigator.webkitGamepads || -1 !== navigator.userAgent.indexOf("Firefox/") || !!navigator.getGamepads, 
        this._prevRawGamepadTypes = [], this._prevTimestamps = [], (this.callbackContext = this).onConnectCallback = null, 
        this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, 
        this.onAxisCallback = null, this.onFloatCallback = null, this._ongamepadconnected = null, 
        this._gamepaddisconnected = null, this._gamepads = [ new z.SinglePad(t, this), new z.SinglePad(t, this), new z.SinglePad(t, this), new z.SinglePad(t, this) ];
    }, z.Gamepad.prototype = {
        addCallbacks: function(t, e) {
            void 0 !== e && (this.onConnectCallback = "function" == typeof e.onConnect ? e.onConnect : this.onConnectCallback, 
            this.onDisconnectCallback = "function" == typeof e.onDisconnect ? e.onDisconnect : this.onDisconnectCallback, 
            this.onDownCallback = "function" == typeof e.onDown ? e.onDown : this.onDownCallback, 
            this.onUpCallback = "function" == typeof e.onUp ? e.onUp : this.onUpCallback, this.onAxisCallback = "function" == typeof e.onAxis ? e.onAxis : this.onAxisCallback, 
            this.onFloatCallback = "function" == typeof e.onFloat ? e.onFloat : this.onFloatCallback, 
            this.callbackContext = t);
        },
        start: function() {
            if (!this._active) {
                this._active = !0;
                var e = this;
                this._onGamepadConnected = function(t) {
                    return e.onGamepadConnected(t);
                }, this._onGamepadDisconnected = function(t) {
                    return e.onGamepadDisconnected(t);
                }, window.addEventListener("gamepadconnected", this._onGamepadConnected, !1), window.addEventListener("gamepaddisconnected", this._onGamepadDisconnected, !1);
            }
        },
        onGamepadConnected: function(t) {
            var e = t.gamepad;
            this._rawPads.push(e), this._gamepads[e.index].connect(e);
        },
        onGamepadDisconnected: function(t) {
            var e = t.gamepad;
            for (var i in this._rawPads) this._rawPads[i].index === e.index && this._rawPads.splice(i, 1);
            this._gamepads[e.index].disconnect();
        },
        update: function() {
            this._pollGamepads(), this.pad1.pollStatus(), this.pad2.pollStatus(), this.pad3.pollStatus(), 
            this.pad4.pollStatus();
        },
        _pollGamepads: function() {
            if (this._active) {
                if (navigator.getGamepads) var t = navigator.getGamepads(); else if (navigator.webkitGetGamepads) t = navigator.webkitGetGamepads(); else if (navigator.webkitGamepads) t = navigator.webkitGamepads();
                if (t) {
                    for (var e = !(this._rawPads = []), i = 0; i < t.length && (typeof t[i] !== this._prevRawGamepadTypes[i] && (e = !0, 
                    this._prevRawGamepadTypes[i] = typeof t[i]), t[i] && this._rawPads.push(t[i]), 3 !== i); i++) ;
                    for (var n = 0; n < this._gamepads.length; n++) this._gamepads[n]._rawPad = this._rawPads[n];
                    if (e) {
                        for (var s, o = {
                            rawIndices: {},
                            padIndices: {}
                        }, a = 0; a < this._gamepads.length; a++) if ((s = this._gamepads[a]).connected) for (var r = 0; r < this._rawPads.length; r++) this._rawPads[r].index === s.index && (o.rawIndices[s.index] = !0, 
                        o.padIndices[a] = !0);
                        for (var h = 0; h < this._gamepads.length; h++) if (s = this._gamepads[h], !o.padIndices[h]) {
                            this._rawPads.length < 1 && s.disconnect();
                            for (var l = 0; l < this._rawPads.length && !o.padIndices[h]; l++) {
                                var c = this._rawPads[l];
                                if (c) {
                                    if (o.rawIndices[c.index]) {
                                        s.disconnect();
                                        continue;
                                    }
                                    s.connect(c), o.rawIndices[c.index] = !0, o.padIndices[h] = !0;
                                } else s.disconnect();
                            }
                        }
                    }
                }
            }
        },
        setDeadZones: function(t) {
            for (var e = 0; e < this._gamepads.length; e++) this._gamepads[e].deadZone = t;
        },
        stop: function() {
            this._active = !1, window.removeEventListener("gamepadconnected", this._onGamepadConnected), 
            window.removeEventListener("gamepaddisconnected", this._onGamepadDisconnected);
        },
        reset: function() {
            this.update();
            for (var t = 0; t < this._gamepads.length; t++) this._gamepads[t].reset();
        },
        justPressed: function(t, e) {
            for (var i = 0; i < this._gamepads.length; i++) if (!0 === this._gamepads[i].justPressed(t, e)) return !0;
            return !1;
        },
        justReleased: function(t, e) {
            for (var i = 0; i < this._gamepads.length; i++) if (!0 === this._gamepads[i].justReleased(t, e)) return !0;
            return !1;
        },
        isDown: function(t) {
            for (var e = 0; e < this._gamepads.length; e++) if (!0 === this._gamepads[e].isDown(t)) return !0;
            return !1;
        },
        destroy: function() {
            this.stop();
            for (var t = 0; t < this._gamepads.length; t++) this._gamepads[t].destroy();
        }
    }, z.Gamepad.prototype.constructor = z.Gamepad, Object.defineProperty(z.Gamepad.prototype, "active", {
        get: function() {
            return this._active;
        }
    }), Object.defineProperty(z.Gamepad.prototype, "supported", {
        get: function() {
            return this._gamepadSupportAvailable;
        }
    }), Object.defineProperty(z.Gamepad.prototype, "padsConnected", {
        get: function() {
            return this._rawPads.length;
        }
    }), Object.defineProperty(z.Gamepad.prototype, "pad1", {
        get: function() {
            return this._gamepads[0];
        }
    }), Object.defineProperty(z.Gamepad.prototype, "pad2", {
        get: function() {
            return this._gamepads[1];
        }
    }), Object.defineProperty(z.Gamepad.prototype, "pad3", {
        get: function() {
            return this._gamepads[2];
        }
    }), Object.defineProperty(z.Gamepad.prototype, "pad4", {
        get: function() {
            return this._gamepads[3];
        }
    }), z.Gamepad.BUTTON_0 = 0, z.Gamepad.BUTTON_1 = 1, z.Gamepad.BUTTON_2 = 2, z.Gamepad.BUTTON_3 = 3, 
    z.Gamepad.BUTTON_4 = 4, z.Gamepad.BUTTON_5 = 5, z.Gamepad.BUTTON_6 = 6, z.Gamepad.BUTTON_7 = 7, 
    z.Gamepad.BUTTON_8 = 8, z.Gamepad.BUTTON_9 = 9, z.Gamepad.BUTTON_10 = 10, z.Gamepad.BUTTON_11 = 11, 
    z.Gamepad.BUTTON_12 = 12, z.Gamepad.BUTTON_13 = 13, z.Gamepad.BUTTON_14 = 14, z.Gamepad.BUTTON_15 = 15, 
    z.Gamepad.AXIS_0 = 0, z.Gamepad.AXIS_1 = 1, z.Gamepad.AXIS_2 = 2, z.Gamepad.AXIS_3 = 3, 
    z.Gamepad.AXIS_4 = 4, z.Gamepad.AXIS_5 = 5, z.Gamepad.AXIS_6 = 6, z.Gamepad.AXIS_7 = 7, 
    z.Gamepad.AXIS_8 = 8, z.Gamepad.AXIS_9 = 9, z.Gamepad.XBOX360_A = 0, z.Gamepad.XBOX360_B = 1, 
    z.Gamepad.XBOX360_X = 2, z.Gamepad.XBOX360_Y = 3, z.Gamepad.XBOX360_LEFT_BUMPER = 4, 
    z.Gamepad.XBOX360_RIGHT_BUMPER = 5, z.Gamepad.XBOX360_LEFT_TRIGGER = 6, z.Gamepad.XBOX360_RIGHT_TRIGGER = 7, 
    z.Gamepad.XBOX360_BACK = 8, z.Gamepad.XBOX360_START = 9, z.Gamepad.XBOX360_STICK_LEFT_BUTTON = 10, 
    z.Gamepad.XBOX360_STICK_RIGHT_BUTTON = 11, z.Gamepad.XBOX360_DPAD_LEFT = 14, z.Gamepad.XBOX360_DPAD_RIGHT = 15, 
    z.Gamepad.XBOX360_DPAD_UP = 12, z.Gamepad.XBOX360_DPAD_DOWN = 13, z.Gamepad.XBOX360_STICK_LEFT_X = 0, 
    z.Gamepad.XBOX360_STICK_LEFT_Y = 1, z.Gamepad.XBOX360_STICK_RIGHT_X = 2, z.Gamepad.XBOX360_STICK_RIGHT_Y = 3, 
    z.Gamepad.PS3XC_X = 0, z.Gamepad.PS3XC_CIRCLE = 1, z.Gamepad.PS3XC_SQUARE = 2, z.Gamepad.PS3XC_TRIANGLE = 3, 
    z.Gamepad.PS3XC_L1 = 4, z.Gamepad.PS3XC_R1 = 5, z.Gamepad.PS3XC_L2 = 6, z.Gamepad.PS3XC_R2 = 7, 
    z.Gamepad.PS3XC_SELECT = 8, z.Gamepad.PS3XC_START = 9, z.Gamepad.PS3XC_STICK_LEFT_BUTTON = 10, 
    z.Gamepad.PS3XC_STICK_RIGHT_BUTTON = 11, z.Gamepad.PS3XC_DPAD_UP = 12, z.Gamepad.PS3XC_DPAD_DOWN = 13, 
    z.Gamepad.PS3XC_DPAD_LEFT = 14, z.Gamepad.PS3XC_DPAD_RIGHT = 15, z.Gamepad.PS3XC_STICK_LEFT_X = 0, 
    z.Gamepad.PS3XC_STICK_LEFT_Y = 1, z.Gamepad.PS3XC_STICK_RIGHT_X = 2, z.Gamepad.PS3XC_STICK_RIGHT_Y = 3, 
    z.SinglePad = function(t, e) {
        this.game = t, this.index = null, this.connected = !1, (this.callbackContext = this).onConnectCallback = null, 
        this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, 
        this.onAxisCallback = null, this.onFloatCallback = null, this.deadZone = .26, this._padParent = e, 
        this._rawPad = null, this._prevTimestamp = null, this._buttons = [], this._buttonsLen = 0, 
        this._axes = [], this._axesLen = 0;
    }, z.SinglePad.prototype = {
        addCallbacks: function(t, e) {
            void 0 !== e && (this.onConnectCallback = "function" == typeof e.onConnect ? e.onConnect : this.onConnectCallback, 
            this.onDisconnectCallback = "function" == typeof e.onDisconnect ? e.onDisconnect : this.onDisconnectCallback, 
            this.onDownCallback = "function" == typeof e.onDown ? e.onDown : this.onDownCallback, 
            this.onUpCallback = "function" == typeof e.onUp ? e.onUp : this.onUpCallback, this.onAxisCallback = "function" == typeof e.onAxis ? e.onAxis : this.onAxisCallback, 
            this.onFloatCallback = "function" == typeof e.onFloat ? e.onFloat : this.onFloatCallback, 
            this.callbackContext = t);
        },
        getButton: function(t) {
            return this._buttons[t] ? this._buttons[t] : null;
        },
        pollStatus: function() {
            if (this.connected && this.game.input.enabled && this.game.input.gamepad.enabled && this._rawPad && (!this._rawPad.timestamp || this._rawPad.timestamp !== this._prevTimestamp)) {
                for (var t = 0; t < this._buttonsLen; t++) {
                    var e = isNaN(this._rawPad.buttons[t]) ? this._rawPad.buttons[t].value : this._rawPad.buttons[t];
                    e !== this._buttons[t].value && (1 === e ? this.processButtonDown(t, e) : 0 === e ? this.processButtonUp(t, e) : this.processButtonFloat(t, e));
                }
                for (var i = 0; i < this._axesLen; i++) {
                    var n = this._rawPad.axes[i];
                    0 < n && n > this.deadZone || n < 0 && n < -this.deadZone ? this.processAxisChange(i, n) : this.processAxisChange(i, 0);
                }
                this._prevTimestamp = this._rawPad.timestamp;
            }
        },
        connect: function(t) {
            var e = !this.connected;
            this.connected = !0, this.index = t.index, this._rawPad = t, this._buttons = [], 
            this._buttonsLen = t.buttons.length, this._axes = [], this._axesLen = t.axes.length;
            for (var i = 0; i < this._axesLen; i++) this._axes[i] = t.axes[i];
            for (var n in t.buttons) n = parseInt(n, 10), this._buttons[n] = new z.DeviceButton(this, n);
            e && this._padParent.onConnectCallback && this._padParent.onConnectCallback.call(this._padParent.callbackContext, this.index), 
            e && this.onConnectCallback && this.onConnectCallback.call(this.callbackContext);
        },
        disconnect: function() {
            var t = this.connected, e = this.index;
            this.connected = !1, this.index = null, this._rawPad = void 0;
            for (var i = 0; i < this._buttonsLen; i++) this._buttons[i].destroy();
            this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0, t && this._padParent.onDisconnectCallback && this._padParent.onDisconnectCallback.call(this._padParent.callbackContext, e), 
            t && this.onDisconnectCallback && this.onDisconnectCallback.call(this.callbackContext);
        },
        destroy: function() {
            this._rawPad = void 0;
            for (var t = 0; t < this._buttonsLen; t++) this._buttons[t].destroy();
            this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0, this.onConnectCallback = null, 
            this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, 
            this.onAxisCallback = null, this.onFloatCallback = null;
        },
        processAxisChange: function(t, e) {
            this._axes[t] !== e && (this._axes[t] = e, this._padParent.onAxisCallback && this._padParent.onAxisCallback.call(this._padParent.callbackContext, this, t, e), 
            this.onAxisCallback && this.onAxisCallback.call(this.callbackContext, this, t, e));
        },
        processButtonDown: function(t, e) {
            this._buttons[t] && this._buttons[t].start(null, e), this._padParent.onDownCallback && this._padParent.onDownCallback.call(this._padParent.callbackContext, t, e, this.index), 
            this.onDownCallback && this.onDownCallback.call(this.callbackContext, t, e);
        },
        processButtonUp: function(t, e) {
            this._padParent.onUpCallback && this._padParent.onUpCallback.call(this._padParent.callbackContext, t, e, this.index), 
            this.onUpCallback && this.onUpCallback.call(this.callbackContext, t, e), this._buttons[t] && this._buttons[t].stop(null, e);
        },
        processButtonFloat: function(t, e) {
            this._padParent.onFloatCallback && this._padParent.onFloatCallback.call(this._padParent.callbackContext, t, e, this.index), 
            this.onFloatCallback && this.onFloatCallback.call(this.callbackContext, t, e), this._buttons[t] && this._buttons[t].padFloat(e);
        },
        axis: function(t) {
            return !!this._axes[t] && this._axes[t];
        },
        isDown: function(t) {
            return !!this._buttons[t] && this._buttons[t].isDown;
        },
        isUp: function(t) {
            return !!this._buttons[t] && this._buttons[t].isUp;
        },
        justReleased: function(t, e) {
            if (this._buttons[t]) return this._buttons[t].justReleased(e);
        },
        justPressed: function(t, e) {
            if (this._buttons[t]) return this._buttons[t].justPressed(e);
        },
        buttonValue: function(t) {
            return this._buttons[t] ? this._buttons[t].value : null;
        },
        reset: function() {
            for (var t = 0; t < this._axes.length; t++) this._axes[t] = 0;
        }
    }, z.SinglePad.prototype.constructor = z.SinglePad, z.Key = function(t, e) {
        this.game = t, this._enabled = !0, this.event = null, this.isDown = !1, this.isUp = !0, 
        this.altKey = !1, this.ctrlKey = !1, this.shiftKey = !1, this.timeDown = 0, this.duration = 0, 
        this.timeUp = -2500, this.durationUp = -2500, this.repeats = 0, this.keyCode = e, 
        this.onDown = new z.Signal(), this.onHoldCallback = null, this.onHoldContext = null, 
        this.onUp = new z.Signal(), this._justDown = !1, this._justUp = !1;
    }, z.Key.prototype = {
        update: function() {
            this._enabled && (this.isDown ? (this.duration = this.game.time.time - this.timeDown, 
            this.repeats++, this.onHoldCallback && this.onHoldCallback.call(this.onHoldContext, this)) : this.durationUp = this.game.time.time - this.timeUp);
        },
        processKeyDown: function(t) {
            this._enabled && (this.event = t, this.isDown || (this.altKey = t.altKey, this.ctrlKey = t.ctrlKey, 
            this.shiftKey = t.shiftKey, this.isDown = !0, this.isUp = !1, this.timeDown = this.game.time.time, 
            this.duration = 0, this.durationUp = this.game.time.time - this.timeUp, this.repeats = 0, 
            this._justDown = !0, this.onDown.dispatch(this)));
        },
        processKeyUp: function(t) {
            this._enabled && (this.event = t, this.isUp || (this.isDown = !1, this.isUp = !0, 
            this.timeUp = this.game.time.time, this.duration = this.game.time.time - this.timeDown, 
            this.durationUp = 0, this._justUp = !0, this.onUp.dispatch(this)));
        },
        reset: function(t) {
            void 0 === t && (t = !0), this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, 
            this.duration = 0, this.durationUp = -2500, this._enabled = !0, this._justDown = !1, 
            this._justUp = !1, t && (this.onDown.removeAll(), this.onUp.removeAll(), this.onHoldCallback = null, 
            this.onHoldContext = null);
        },
        downDuration: function(t) {
            return void 0 === t && (t = 50), this.isDown && this.duration < t;
        },
        upDuration: function(t) {
            return void 0 === t && (t = 50), !this.isDown && this.game.time.time - this.timeUp < t;
        },
        justPressed: function() {
            return this.isDown && 0 === this.duration;
        },
        justReleased: function() {
            return !this.isDown && 0 === this.durationUp;
        }
    }, Object.defineProperty(z.Key.prototype, "justDown", {
        get: function() {
            var t = this._justDown;
            return this._justDown = !1, t;
        }
    }), Object.defineProperty(z.Key.prototype, "justUp", {
        get: function() {
            var t = this._justUp;
            return this._justUp = !1, t;
        }
    }), Object.defineProperty(z.Key.prototype, "enabled", {
        get: function() {
            return this._enabled;
        },
        set: function(t) {
            (t = !!t) !== this._enabled && (t || this.reset(!1), this._enabled = t);
        }
    }), z.Key.prototype.constructor = z.Key, z.Keyboard = function(t) {
        this.game = t, this.active = !1, this.enabled = !0, this.event = null, this.pressEvent = null, 
        (this.callbackContext = this).onDownCallback = null, this.onPressCallback = null, 
        this.onUpCallback = null, this._keys = [], this._capture = [], this._onKeyDown = null, 
        this._onKeyPress = null, this._onKeyUp = null, this._i = 0, this._k = 0;
    }, z.Keyboard.prototype = {
        addCallbacks: function(t, e, i, n) {
            this.callbackContext = t, null != e && (this.onDownCallback = e), null != i && (this.onUpCallback = i), 
            null != n && (this.onPressCallback = n);
        },
        removeCallbacks: function() {
            (this.callbackContext = this).onDownCallback = null, this.onUpCallback = null, this.onPressCallback = null;
        },
        addKey: function(t) {
            return this._keys[t] || (this._keys[t] = new z.Key(this.game, t), this.addKeyCapture(t)), 
            this._keys[t];
        },
        addKeys: function(t) {
            var e = {};
            for (var i in t) e[i] = this.addKey(t[i]);
            return e;
        },
        removeKey: function(t) {
            this._keys[t] && (this._keys[t] = null, this.removeKeyCapture(t));
        },
        createCursorKeys: function() {
            return this.addKeys({
                up: z.KeyCode.UP,
                down: z.KeyCode.DOWN,
                left: z.KeyCode.LEFT,
                right: z.KeyCode.RIGHT
            });
        },
        start: function() {
            if (this.game.device.cocoonJS) return !1;
            if (this.active) return !1;
            var e = this;
            return this._onKeyDown = function(t) {
                return e.processKeyDown(t);
            }, this._onKeyUp = function(t) {
                return e.processKeyUp(t);
            }, this._onKeyPress = function(t) {
                return e.processKeyPress(t);
            }, window.addEventListener("keydown", this._onKeyDown, !1), window.addEventListener("keyup", this._onKeyUp, !1), 
            window.addEventListener("keypress", this._onKeyPress, !1), this.active = !0;
        },
        stop: function() {
            window.removeEventListener("keydown", this._onKeyDown), window.removeEventListener("keyup", this._onKeyUp), 
            window.removeEventListener("keypress", this._onKeyPress), this._onKeyDown = null, 
            this._onKeyUp = null, this._onKeyPress = null, this.active = !1;
        },
        destroy: function() {
            this.stop(), this.clearCaptures(), this._keys.length = 0, this._i = 0;
        },
        addKeyCapture: function(t) {
            if ("object" == typeof t) for (var e in t) this._capture[t[e]] = !0; else this._capture[t] = !0;
        },
        removeKeyCapture: function(t) {
            delete this._capture[t];
        },
        clearCaptures: function() {
            this._capture = {};
        },
        update: function() {
            for (this._i = this._keys.length; this._i--; ) this._keys[this._i] && this._keys[this._i].update();
        },
        processKeyDown: function(t) {
            if (this.event = t, this.game.input.enabled && this.enabled) {
                var e = t.keyCode;
                this._capture[e] && t.preventDefault(), this._keys[e] || (this._keys[e] = new z.Key(this.game, e)), 
                this._keys[e].processKeyDown(t), this._k = e, this.onDownCallback && this.onDownCallback.call(this.callbackContext, t);
            }
        },
        processKeyPress: function(t) {
            this.pressEvent = t, this.game.input.enabled && this.enabled && this.onPressCallback && this.onPressCallback.call(this.callbackContext, String.fromCharCode(t.charCode), t);
        },
        processKeyUp: function(t) {
            if (this.event = t, this.game.input.enabled && this.enabled) {
                var e = t.keyCode;
                this._capture[e] && t.preventDefault(), this._keys[e] || (this._keys[e] = new z.Key(this.game, e)), 
                this._keys[e].processKeyUp(t), this.onUpCallback && this.onUpCallback.call(this.callbackContext, t);
            }
        },
        reset: function(t) {
            void 0 === t && (t = !0), this.event = null;
            for (var e = this._keys.length; e--; ) this._keys[e] && this._keys[e].reset(t);
        },
        downDuration: function(t, e) {
            return this._keys[t] ? this._keys[t].downDuration(e) : null;
        },
        upDuration: function(t, e) {
            return this._keys[t] ? this._keys[t].upDuration(e) : null;
        },
        justPressed: function(t) {
            return this._keys[t] ? this._keys[t].justPressed() : null;
        },
        justReleased: function(t) {
            return this._keys[t] ? this._keys[t].justReleased() : null;
        },
        isDown: function(t) {
            return this._keys[t] ? this._keys[t].isDown : null;
        }
    }, Object.defineProperty(z.Keyboard.prototype, "lastChar", {
        get: function() {
            return this.event && 32 === this.event.charCode ? "" : this.pressEvent ? String.fromCharCode(this.pressEvent.charCode) : null;
        }
    }), Object.defineProperty(z.Keyboard.prototype, "lastKey", {
        get: function() {
            return this._keys[this._k];
        }
    }), z.Keyboard.prototype.constructor = z.Keyboard, z.KeyCode = {
        A: "A".charCodeAt(0),
        B: "B".charCodeAt(0),
        C: "C".charCodeAt(0),
        D: "D".charCodeAt(0),
        E: "E".charCodeAt(0),
        F: "F".charCodeAt(0),
        G: "G".charCodeAt(0),
        H: "H".charCodeAt(0),
        I: "I".charCodeAt(0),
        J: "J".charCodeAt(0),
        K: "K".charCodeAt(0),
        L: "L".charCodeAt(0),
        M: "M".charCodeAt(0),
        N: "N".charCodeAt(0),
        O: "O".charCodeAt(0),
        P: "P".charCodeAt(0),
        Q: "Q".charCodeAt(0),
        R: "R".charCodeAt(0),
        S: "S".charCodeAt(0),
        T: "T".charCodeAt(0),
        U: "U".charCodeAt(0),
        V: "V".charCodeAt(0),
        W: "W".charCodeAt(0),
        X: "X".charCodeAt(0),
        Y: "Y".charCodeAt(0),
        Z: "Z".charCodeAt(0),
        ZERO: "0".charCodeAt(0),
        ONE: "1".charCodeAt(0),
        TWO: "2".charCodeAt(0),
        THREE: "3".charCodeAt(0),
        FOUR: "4".charCodeAt(0),
        FIVE: "5".charCodeAt(0),
        SIX: "6".charCodeAt(0),
        SEVEN: "7".charCodeAt(0),
        EIGHT: "8".charCodeAt(0),
        NINE: "9".charCodeAt(0),
        NUMPAD_0: 96,
        NUMPAD_1: 97,
        NUMPAD_2: 98,
        NUMPAD_3: 99,
        NUMPAD_4: 100,
        NUMPAD_5: 101,
        NUMPAD_6: 102,
        NUMPAD_7: 103,
        NUMPAD_8: 104,
        NUMPAD_9: 105,
        NUMPAD_MULTIPLY: 106,
        NUMPAD_ADD: 107,
        NUMPAD_ENTER: 108,
        NUMPAD_SUBTRACT: 109,
        NUMPAD_DECIMAL: 110,
        NUMPAD_DIVIDE: 111,
        F1: 112,
        F2: 113,
        F3: 114,
        F4: 115,
        F5: 116,
        F6: 117,
        F7: 118,
        F8: 119,
        F9: 120,
        F10: 121,
        F11: 122,
        F12: 123,
        F13: 124,
        F14: 125,
        F15: 126,
        COLON: 186,
        EQUALS: 187,
        COMMA: 188,
        UNDERSCORE: 189,
        PERIOD: 190,
        QUESTION_MARK: 191,
        TILDE: 192,
        OPEN_BRACKET: 219,
        BACKWARD_SLASH: 220,
        CLOSED_BRACKET: 221,
        QUOTES: 222,
        BACKSPACE: 8,
        TAB: 9,
        CLEAR: 12,
        ENTER: 13,
        SHIFT: 16,
        CONTROL: 17,
        ALT: 18,
        CAPS_LOCK: 20,
        ESC: 27,
        SPACEBAR: 32,
        PAGE_UP: 33,
        PAGE_DOWN: 34,
        END: 35,
        HOME: 36,
        LEFT: 37,
        UP: 38,
        RIGHT: 39,
        DOWN: 40,
        PLUS: 43,
        MINUS: 44,
        INSERT: 45,
        DELETE: 46,
        HELP: 47,
        NUM_LOCK: 144
    }, z.KeyCode) z.KeyCode.hasOwnProperty(i) && !i.match(/[a-z]/) && (z.Keyboard[i] = z.KeyCode[i]);
    for (var n in z.Component = function() {}, z.Component.Angle = function() {}, z.Component.Angle.prototype = {
        angle: {
            get: function() {
                return z.Math.wrapAngle(z.Math.radToDeg(this.rotation));
            },
            set: function(t) {
                this.rotation = z.Math.degToRad(z.Math.wrapAngle(t));
            }
        }
    }, z.Component.Animation = function() {}, z.Component.Animation.prototype = {
        play: function(t, e, i, n) {
            if (this.animations) return this.animations.play(t, e, i, n);
        }
    }, z.Component.AutoCull = function() {}, z.Component.AutoCull.prototype = {
        autoCull: !1,
        inCamera: {
            get: function() {
                return this.autoCull || this.checkWorldBounds || (this._bounds.copyFrom(this.getBounds()), 
                this._bounds.x += this.game.camera.view.x, this._bounds.y += this.game.camera.view.y), 
                this.game.world.camera.view.intersects(this._bounds);
            }
        }
    }, z.Component.Bounds = function() {}, z.Component.Bounds.prototype = {
        offsetX: {
            get: function() {
                return this.anchor.x * this.width;
            }
        },
        offsetY: {
            get: function() {
                return this.anchor.y * this.height;
            }
        },
        centerX: {
            get: function() {
                return this.x - this.offsetX + .5 * this.width;
            },
            set: function(t) {
                this.x = t + this.offsetX - .5 * this.width;
            }
        },
        centerY: {
            get: function() {
                return this.y - this.offsetY + .5 * this.height;
            },
            set: function(t) {
                this.y = t + this.offsetY - .5 * this.height;
            }
        },
        left: {
            get: function() {
                return this.x - this.offsetX;
            },
            set: function(t) {
                this.x = t + this.offsetX;
            }
        },
        right: {
            get: function() {
                return this.x + this.width - this.offsetX;
            },
            set: function(t) {
                this.x = t - this.width + this.offsetX;
            }
        },
        top: {
            get: function() {
                return this.y - this.offsetY;
            },
            set: function(t) {
                this.y = t + this.offsetY;
            }
        },
        bottom: {
            get: function() {
                return this.y + this.height - this.offsetY;
            },
            set: function(t) {
                this.y = t - this.height + this.offsetY;
            }
        },
        alignIn: function(t, e, i, n) {
            switch (void 0 === i && (i = 0), void 0 === n && (n = 0), e) {
              default:
              case z.TOP_LEFT:
                this.left = t.left - i, this.top = t.top - n;
                break;

              case z.TOP_CENTER:
                this.centerX = t.centerX + i, this.top = t.top - n;
                break;

              case z.TOP_RIGHT:
                this.right = t.right + i, this.top = t.top - n;
                break;

              case z.LEFT_CENTER:
                this.left = t.left - i, this.centerY = t.centerY + n;
                break;

              case z.CENTER:
                this.centerX = t.centerX + i, this.centerY = t.centerY + n;
                break;

              case z.RIGHT_CENTER:
                this.right = t.right + i, this.centerY = t.centerY + n;
                break;

              case z.BOTTOM_LEFT:
                this.left = t.left - i, this.bottom = t.bottom + n;
                break;

              case z.BOTTOM_CENTER:
                this.centerX = t.centerX + i, this.bottom = t.bottom + n;
                break;

              case z.BOTTOM_RIGHT:
                this.right = t.right + i, this.bottom = t.bottom + n;
            }
            return this;
        },
        alignTo: function(t, e, i, n) {
            switch (void 0 === i && (i = 0), void 0 === n && (n = 0), e) {
              default:
              case z.TOP_LEFT:
                this.left = t.left - i, this.bottom = t.top - n;
                break;

              case z.TOP_CENTER:
                this.centerX = t.centerX + i, this.bottom = t.top - n;
                break;

              case z.TOP_RIGHT:
                this.right = t.right + i, this.bottom = t.top - n;
                break;

              case z.LEFT_TOP:
                this.right = t.left - i, this.top = t.top - n;
                break;

              case z.LEFT_CENTER:
                this.right = t.left - i, this.centerY = t.centerY + n;
                break;

              case z.LEFT_BOTTOM:
                this.right = t.left - i, this.bottom = t.bottom + n;
                break;

              case z.RIGHT_TOP:
                this.left = t.right + i, this.top = t.top - n;
                break;

              case z.RIGHT_CENTER:
                this.left = t.right + i, this.centerY = t.centerY + n;
                break;

              case z.RIGHT_BOTTOM:
                this.left = t.right + i, this.bottom = t.bottom + n;
                break;

              case z.BOTTOM_LEFT:
                this.left = t.left - i, this.top = t.bottom + n;
                break;

              case z.BOTTOM_CENTER:
                this.centerX = t.centerX + i, this.top = t.bottom + n;
                break;

              case z.BOTTOM_RIGHT:
                this.right = t.right + i, this.top = t.bottom + n;
            }
            return this;
        }
    }, z.Group.prototype.alignIn = z.Component.Bounds.prototype.alignIn, z.Group.prototype.alignTo = z.Component.Bounds.prototype.alignTo, 
    z.Component.BringToTop = function() {}, z.Component.BringToTop.prototype.bringToTop = function() {
        return this.parent && this.parent.bringChildToTop && this.parent.bringChildToTop(this), 
        this;
    }, z.Component.BringToTop.prototype.sendToBack = function() {
        return this.parent && this.parent.sendChildToBack && this.parent.sendChildToBack(this), 
        this;
    }, z.Component.BringToTop.prototype.moveUp = function() {
        return this.parent && this.parent.moveUp(this), this;
    }, z.Component.BringToTop.prototype.moveDown = function() {
        return this.parent && this.parent.moveDown(this), this;
    }, z.Component.Core = function() {}, z.Component.Core.skipTypeChecks = !1, z.Component.Core.install = function(t) {
        z.Utils.mixinPrototype(this, z.Component.Core.prototype), this.components = {};
        for (var e = 0; e < t.length; e++) {
            var i = t[e], n = !1;
            "Destroy" === i && (n = !0), z.Utils.mixinPrototype(this, z.Component[i].prototype, n), 
            this.components[i] = !0;
        }
    }, z.Component.Core.init = function(t, e, i, n, s) {
        if (!z.Component.Core.skipTypeChecks) {
            if (!(t instanceof z.Game)) throw new Error("The value passed as the `game` argument (" + t + ") is not an instance of Phaser.Game.");
            "number" != typeof e && (e = 0), "number" != typeof i && (i = 0);
        }
        this.game = t, this.key = n, this.data = {}, this.position.set(e, i), this.world = new z.Point(e, i), 
        this.previousPosition = new z.Point(e, i), this.events = new z.Events(this), this._bounds = new z.Rectangle(), 
        this.components.PhysicsBody && (this.body = this.body), this.components.Animation && (this.animations = new z.AnimationManager(this)), 
        this.components.LoadTexture && null !== n && this.loadTexture(n, s), this.components.FixedToCamera && (this.cameraOffset = new z.Point(e, i));
    }, z.Component.Core.preUpdate = function() {
        return this.pendingDestroy ? (this.destroy(), !1) : (this.previousPosition.set(this.world.x, this.world.y), 
        this.previousRotation = this.rotation, this.exists && this.parent.exists ? (this.world.setTo(this.game.camera.x + this.worldTransform.tx, this.game.camera.y + this.worldTransform.ty), 
        this.visible && (this.renderOrderID = this.game.stage.currentRenderOrderID++), this.animations && this.animations.update(), 
        this.body && this.body.preUpdate(), this.preUpdateChildren(), !0) : !(this.renderOrderID = -1));
    }, z.Component.Core.prototype = {
        game: null,
        name: "",
        data: {},
        components: {},
        z: 0,
        events: void 0,
        animations: void 0,
        key: "",
        world: null,
        debug: !1,
        previousPosition: null,
        previousRotation: 0,
        renderOrderID: 0,
        fresh: !0,
        pendingDestroy: !1,
        _bounds: null,
        _exists: !0,
        exists: {
            get: function() {
                return this._exists;
            },
            set: function(t) {
                t ? (this._exists = !0, this.body && this.body.type === z.Physics.P2JS && this.body.addToWorld(), 
                this.visible = !0) : (this._exists = !1, this.body && this.body.type === z.Physics.P2JS && this.body.removeFromWorld(), 
                this.visible = !1);
            }
        },
        preUpdateChildren: function() {
            for (var t = 0; t < this.children.length; ) {
                var e = this.children[t];
                e.preUpdate(), this === e.parent && t++;
            }
        },
        update: function() {},
        postUpdate: function() {
            this.customRender && this.key.render(), this.components.PhysicsBody && z.Component.PhysicsBody.postUpdate.call(this), 
            this.components.FixedToCamera && z.Component.FixedToCamera.postUpdate.call(this);
            for (var t = 0; t < this.children.length; t++) this.children[t].postUpdate();
        }
    }, z.Component.Crop = function() {}, z.Component.Crop.prototype = {
        cropRect: null,
        _crop: null,
        crop: function(t, e) {
            void 0 === e && (e = !1), t ? (e && null !== this.cropRect ? this.cropRect.setTo(t.x, t.y, t.width, t.height) : e && null === this.cropRect ? this.cropRect = new z.Rectangle(t.x, t.y, t.width, t.height) : this.cropRect = t, 
            this.updateCrop()) : (this._crop = null, this.cropRect = null, this.resetFrame());
        },
        updateCrop: function() {
            if (this.cropRect) {
                var t = this.texture.crop.x, e = this.texture.crop.y, i = this.texture.crop.width, n = this.texture.crop.height;
                this._crop = z.Rectangle.clone(this.cropRect, this._crop), this._crop.x += this._frame.x, 
                this._crop.y += this._frame.y;
                var s = Math.max(this._frame.x, this._crop.x), o = Math.max(this._frame.y, this._crop.y), a = Math.min(this._frame.right, this._crop.right) - s, r = Math.min(this._frame.bottom, this._crop.bottom) - o;
                this.texture.crop.x = s, this.texture.crop.y = o, this.texture.crop.width = a, this.texture.crop.height = r, 
                this.texture.frame.width = Math.min(a, this.cropRect.width), this.texture.frame.height = Math.min(r, this.cropRect.height), 
                this.texture.width = this.texture.frame.width, this.texture.height = this.texture.frame.height, 
                this.texture._updateUvs(), 16777215 === this.tint || t === s && e === o && i === a && n === r || (this.texture.requiresReTint = !0);
            }
        }
    }, z.Component.Delta = function() {}, z.Component.Delta.prototype = {
        deltaX: {
            get: function() {
                return this.world.x - this.previousPosition.x;
            }
        },
        deltaY: {
            get: function() {
                return this.world.y - this.previousPosition.y;
            }
        },
        deltaZ: {
            get: function() {
                return this.rotation - this.previousRotation;
            }
        }
    }, z.Component.Destroy = function() {}, z.Component.Destroy.prototype = {
        destroyPhase: !1,
        destroy: function(t, e) {
            if (null !== this.game && !this.destroyPhase) {
                void 0 === t && (t = !0), void 0 === e && (e = !1), this.destroyPhase = !0, this.events && this.events.onDestroy$dispatch(this), 
                this.parent && (this.parent instanceof z.Group ? this.parent.remove(this) : this.parent.removeChild(this)), 
                this.input && this.input.destroy(), this.animations && this.animations.destroy(), 
                this.body && this.body.destroy(), this.events && this.events.destroy(), this.game.tweens.removeFrom(this);
                var i = this.children.length;
                if (t) for (;i--; ) this.children[i].destroy(t); else for (;i--; ) this.removeChild(this.children[i]);
                this._crop && (this._crop = null, this.cropRect = null), this._frame && (this._frame = null), 
                z.Video && this.key instanceof z.Video && this.key.onChangeSource.remove(this.resizeFrame, this), 
                z.BitmapText && this._glyphs && (this._glyphs = []), this.alive = !1, this.exists = !1, 
                this.visible = !1, this.filters = null, this.mask = null, this.game = null, this.data = {}, 
                this.renderable = !1, this.transformCallback && (this.transformCallback = null, 
                this.transformCallbackContext = null), this.hitArea = null, this.parent = null, 
                this.stage = null, this.worldTransform = null, this.filterArea = null, this._bounds = null, 
                this._currentBounds = null, this._mask = null, this._destroyCachedSprite(), e && this.texture.destroy(!0), 
                this.destroyPhase = !1, this.pendingDestroy = !1;
            }
        }
    }, z.Events = function(t) {
        this.parent = t;
    }, z.Events.prototype = {
        destroy: function() {
            this._parent = null, this._onDestroy && this._onDestroy.dispose(), this._onAddedToGroup && this._onAddedToGroup.dispose(), 
            this._onRemovedFromGroup && this._onRemovedFromGroup.dispose(), this._onKilled && this._onKilled.dispose(), 
            this._onRevived && this._onRevived.dispose(), this._onEnterBounds && this._onEnterBounds.dispose(), 
            this._onOutOfBounds && this._onOutOfBounds.dispose(), this._onInputOver && this._onInputOver.dispose(), 
            this._onInputOut && this._onInputOut.dispose(), this._onInputDown && this._onInputDown.dispose(), 
            this._onInputUp && this._onInputUp.dispose(), this._onDragStart && this._onDragStart.dispose(), 
            this._onDragUpdate && this._onDragUpdate.dispose(), this._onDragStop && this._onDragStop.dispose(), 
            this._onAnimationStart && this._onAnimationStart.dispose(), this._onAnimationComplete && this._onAnimationComplete.dispose(), 
            this._onAnimationLoop && this._onAnimationLoop.dispose();
        },
        onAddedToGroup: null,
        onRemovedFromGroup: null,
        onDestroy: null,
        onKilled: null,
        onRevived: null,
        onOutOfBounds: null,
        onEnterBounds: null,
        onInputOver: null,
        onInputOut: null,
        onInputDown: null,
        onInputUp: null,
        onDragStart: null,
        onDragUpdate: null,
        onDragStop: null,
        onAnimationStart: null,
        onAnimationComplete: null,
        onAnimationLoop: null
    }, z.Events.prototype.constructor = z.Events, z.Events.prototype) z.Events.prototype.hasOwnProperty(n) && 0 === n.indexOf("on") && null === z.Events.prototype[n] && function(t, e) {
        "use strict";
        Object.defineProperty(z.Events.prototype, t, {
            get: function() {
                return this[e] || (this[e] = new z.Signal());
            }
        }), z.Events.prototype[t + "$dispatch"] = function() {
            return this[e] ? this[e].dispatch.apply(this[e], arguments) : null;
        };
    }(n, "_" + n);
    z.Component.FixedToCamera = function() {}, z.Component.FixedToCamera.postUpdate = function() {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, 
        this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y);
    }, z.Component.FixedToCamera.prototype = {
        _fixedToCamera: !1,
        fixedToCamera: {
            get: function() {
                return this._fixedToCamera;
            },
            set: function(t) {
                t ? (this._fixedToCamera = !0, this.cameraOffset.set(this.x, this.y)) : this._fixedToCamera = !1;
            }
        },
        cameraOffset: new z.Point()
    }, z.Component.Health = function() {}, z.Component.Health.prototype = {
        health: 1,
        maxHealth: 100,
        damage: function(t) {
            return this.alive && (this.health -= t, this.health <= 0 && this.kill()), this;
        },
        setHealth: function(t) {
            return this.health = t, this.health > this.maxHealth && (this.health = this.maxHealth), 
            this;
        },
        heal: function(t) {
            return this.alive && (this.health += t, this.health > this.maxHealth && (this.health = this.maxHealth)), 
            this;
        }
    }, z.Component.InCamera = function() {}, z.Component.InCamera.prototype = {
        inCamera: {
            get: function() {
                return this.game.world.camera.view.intersects(this._bounds);
            }
        }
    }, z.Component.InputEnabled = function() {}, z.Component.InputEnabled.prototype = {
        input: null,
        inputEnabled: {
            get: function() {
                return this.input && this.input.enabled;
            },
            set: function(t) {
                t ? null === this.input ? (this.input = new z.InputHandler(this), this.input.start()) : this.input && !this.input.enabled && this.input.start() : this.input && this.input.enabled && this.input.stop();
            }
        }
    }, z.Component.InWorld = function() {}, z.Component.InWorld.preUpdate = function() {
        if (this.pendingDestroy) return this.destroy(), !1;
        if (this.autoCull || this.checkWorldBounds) {
            if (this._bounds.copyFrom(this.getBounds()), this._bounds.x += this.game.camera.view.x, 
            this._bounds.y += this.game.camera.view.y, this.autoCull) if (this.game.world.camera.view.intersects(this._bounds)) this.renderable = !0, 
            this.game.world.camera.totalInView++; else if (this.renderable = !1, this.outOfCameraBoundsKill) return this.kill(), 
            !1;
            if (this.checkWorldBounds) if (this._outOfBoundsFired && this.game.world.bounds.intersects(this._bounds)) this._outOfBoundsFired = !1, 
            this.events.onEnterBounds$dispatch(this); else if (!this._outOfBoundsFired && !this.game.world.bounds.intersects(this._bounds) && (this._outOfBoundsFired = !0, 
            this.events.onOutOfBounds$dispatch(this), this.outOfBoundsKill)) return this.kill(), 
            !1;
        }
        return !0;
    }, z.Component.InWorld.prototype = {
        checkWorldBounds: !1,
        outOfBoundsKill: !1,
        outOfCameraBoundsKill: !1,
        _outOfBoundsFired: !1,
        inWorld: {
            get: function() {
                return this.game.world.bounds.intersects(this.getBounds());
            }
        }
    }, z.Component.LifeSpan = function() {}, z.Component.LifeSpan.preUpdate = function() {
        return this.pendingDestroy ? (this.destroy(), !1) : !(0 < this.lifespan && (this.lifespan -= this.game.time.physicsElapsedMS, 
        this.lifespan <= 0)) || (this.kill(), !1);
    }, z.Component.LifeSpan.prototype = {
        alive: !0,
        lifespan: 0,
        revive: function(t) {
            return void 0 === t && (t = 100), this.alive = !0, this.exists = !0, this.visible = !0, 
            "function" == typeof this.setHealth && this.setHealth(t), this.events && this.events.onRevived$dispatch(this), 
            this;
        },
        kill: function() {
            return this.alive = !1, this.exists = !1, this.visible = !1, this.events && this.events.onKilled$dispatch(this), 
            this;
        }
    }, z.Component.LoadTexture = function() {}, z.Component.LoadTexture.prototype = {
        customRender: !1,
        _frame: null,
        loadTexture: function(t, e, i) {
            t === z.PENDING_ATLAS ? (t = e, e = 0) : e = e || 0, (i || void 0 === i) && this.animations && this.animations.stop(), 
            this.key = t, this.customRender = !1;
            var n = this.game.cache, s = !0, o = this.texture.baseTexture.scaleMode === PIXI.scaleModes.LINEAR;
            if (z.RenderTexture && t instanceof z.RenderTexture) this.key = t.key, this.setTexture(t); else if (z.BitmapData && t instanceof z.BitmapData) this.customRender = !0, 
            this.setTexture(t.texture), s = n.hasFrameData(t.key, z.Cache.BITMAPDATA) ? !this.animations.loadFrameData(n.getFrameData(t.key, z.Cache.BITMAPDATA), e) : !this.animations.loadFrameData(t.frameData, 0); else if (z.Video && t instanceof z.Video) {
                this.customRender = !0;
                var a = t.texture.valid;
                this.setTexture(t.texture), this.setFrame(t.texture.frame.clone()), t.onChangeSource.add(this.resizeFrame, this), 
                this.texture.valid = a;
            } else if (z.Tilemap && t instanceof z.TilemapLayer) this.setTexture(PIXI.Texture.fromCanvas(t.canvas)); else if (t instanceof PIXI.Texture) o = t.baseTexture.scaleMode === PIXI.scaleModes.LINEAR, 
            this.setTexture(t); else {
                var r = n.getImage(t, !0);
                this.key = r.key, this.setTexture(new PIXI.Texture(r.base)), this.texture.baseTexture.skipRender = "__default" === t, 
                s = !this.animations.loadFrameData(r.frameData, e);
            }
            s && (this._frame = z.Rectangle.clone(this.texture.frame)), o || (this.texture.baseTexture.scaleMode = 1);
        },
        setFrame: function(t) {
            this._frame = t, this.texture.frame.x = t.x, this.texture.frame.y = t.y, this.texture.frame.width = t.width, 
            this.texture.frame.height = t.height, this.texture.crop.x = t.x, this.texture.crop.y = t.y, 
            this.texture.crop.width = t.width, this.texture.crop.height = t.height, t.trimmed ? (this.texture.trim ? (this.texture.trim.x = t.spriteSourceSizeX, 
            this.texture.trim.y = t.spriteSourceSizeY, this.texture.trim.width = t.sourceSizeW, 
            this.texture.trim.height = t.sourceSizeH) : this.texture.trim = {
                x: t.spriteSourceSizeX,
                y: t.spriteSourceSizeY,
                width: t.sourceSizeW,
                height: t.sourceSizeH
            }, this.texture.width = t.sourceSizeW, this.texture.height = t.sourceSizeH, this.texture.frame.width = t.sourceSizeW, 
            this.texture.frame.height = t.sourceSizeH) : !t.trimmed && this.texture.trim && (this.texture.trim = null), 
            t.rotated && (this.texture.rotated = !0), this.cropRect && this.updateCrop(), this.texture.requiresReTint = !0, 
            this.texture._updateUvs(), this.tilingTexture && (this.refreshTexture = !0);
        },
        resizeFrame: function(t, e, i) {
            this.texture.frame.resize(e, i), this.texture.setFrame(this.texture.frame);
        },
        resetFrame: function() {
            this._frame && this.setFrame(this._frame);
        },
        frame: {
            get: function() {
                return this.animations.frame;
            },
            set: function(t) {
                this.animations.frame = t;
            }
        },
        frameName: {
            get: function() {
                return this.animations.frameName;
            },
            set: function(t) {
                this.animations.frameName = t;
            }
        }
    }, z.Component.Overlap = function() {}, z.Component.Overlap.prototype = {
        overlap: function(t) {
            return z.Rectangle.intersects(this.getBounds(), t.getBounds());
        }
    }, z.Component.PhysicsBody = function() {}, z.Component.PhysicsBody.preUpdate = function() {
        return this.pendingDestroy ? (this.destroy(), !1) : this.fresh && this.exists ? (this.world.setTo(this.parent.position.x + this.position.x, this.parent.position.y + this.position.y), 
        this.worldTransform.tx = this.world.x, this.worldTransform.ty = this.world.y, this.previousPosition.set(this.world.x, this.world.y), 
        this.previousRotation = this.rotation, this.body && this.body.preUpdate(), this.fresh = !1, 
        this.preUpdateChildren(), !1) : (this.previousPosition.set(this.world.x, this.world.y), 
        this.previousRotation = this.rotation, !(!this._exists || !this.parent.exists) || !(this.renderOrderID = -1));
    }, z.Component.PhysicsBody.postUpdate = function() {
        this.exists && this.body && this.body.postUpdate();
    }, z.Component.PhysicsBody.prototype = {
        body: null,
        x: {
            get: function() {
                return this.position.x;
            },
            set: function(t) {
                this.position.x = t, this.body && !this.body.dirty && (this.body._reset = !0);
            }
        },
        y: {
            get: function() {
                return this.position.y;
            },
            set: function(t) {
                this.position.y = t, this.body && !this.body.dirty && (this.body._reset = !0);
            }
        }
    }, z.Component.Reset = function() {}, z.Component.Reset.prototype.reset = function(t, e, i) {
        return void 0 === i && (i = 1), this.world.set(t, e), this.position.set(t, e), this.fresh = !0, 
        this.exists = !0, this.visible = !0, this.renderable = !0, this.components.InWorld && (this._outOfBoundsFired = !1), 
        this.components.LifeSpan && (this.alive = !0, this.health = i), this.components.PhysicsBody && this.body && this.body.reset(t, e, !1, !1), 
        this;
    }, z.Component.ScaleMinMax = function() {}, z.Component.ScaleMinMax.prototype = {
        transformCallback: null,
        transformCallbackContext: this,
        scaleMin: null,
        scaleMax: null,
        checkTransform: function(t) {
            this.scaleMin && (t.a < this.scaleMin.x && (t.a = this.scaleMin.x), t.d < this.scaleMin.y && (t.d = this.scaleMin.y)), 
            this.scaleMax && (t.a > this.scaleMax.x && (t.a = this.scaleMax.x), t.d > this.scaleMax.y && (t.d = this.scaleMax.y));
        },
        setScaleMinMax: function(t, e, i, n) {
            void 0 === e ? e = i = n = t : void 0 === i && (i = n = e, e = t), null === t ? this.scaleMin = null : this.scaleMin ? this.scaleMin.set(t, e) : this.scaleMin = new z.Point(t, e), 
            null === i ? this.scaleMax = null : this.scaleMax ? this.scaleMax.set(i, n) : this.scaleMax = new z.Point(i, n), 
            null === this.scaleMin ? this.transformCallback = null : (this.transformCallback = this.checkTransform, 
            this.transformCallbackContext = this);
        }
    }, z.Component.Smoothed = function() {}, z.Component.Smoothed.prototype = {
        smoothed: {
            get: function() {
                return !this.texture.baseTexture.scaleMode;
            },
            set: function(t) {
                t ? this.texture && 0 !== this.texture.baseTexture.scaleMode && (this.texture.baseTexture.scaleMode = 0, 
                this.texture.baseTexture.dirty()) : this.texture && 1 !== this.texture.baseTexture.scaleMode && (this.texture.baseTexture.scaleMode = 1, 
                this.texture.baseTexture.dirty());
            }
        }
    }, z.GameObjectFactory = function(t) {
        this.game = t, this.world = this.game.world;
    }, z.GameObjectFactory.prototype = {
        existing: function(t) {
            return this.world.add(t);
        },
        weapon: function(t, e, i, n, s) {
            var o = this.game.plugins.add(z.Weapon);
            return s && (o.bulletClass = s), o.createBullets(t, e, i, n), o;
        },
        image: function(t, e, i, n, s) {
            return void 0 === s && (s = this.world), s.add(new z.Image(this.game, t, e, i, n));
        },
        sprite: function(t, e, i, n, s) {
            return void 0 === s && (s = this.world), s.add(new z.Sprite(this.game, t, e, i, n));
        },
        creature: function(t, e, i, n, s, o, a) {
            void 0 === s && (s = this.world);
            var r = new z.Creature(this.game, t, e, i, n, o, a);
            return s.add(r), r;
        },
        tween: function(t) {
            return this.game.tweens.create(t);
        },
        group: function(t, e, i, n, s) {
            return new z.Group(this.game, t, e, i, n, s);
        },
        physicsGroup: function(t, e, i, n) {
            return new z.Group(this.game, e, i, n, !0, t);
        },
        spriteBatch: function(t, e, i) {
            return void 0 === t && (t = null), void 0 === e && (e = "group"), void 0 === i && (i = !1), 
            new z.SpriteBatch(this.game, t, e, i);
        },
        audio: function(t, e, i, n) {
            return this.game.sound.add(t, e, i, n);
        },
        sound: function(t, e, i, n) {
            return this.game.sound.add(t, e, i, n);
        },
        audioSprite: function(t) {
            return this.game.sound.addSprite(t);
        },
        tileSprite: function(t, e, i, n, s, o, a) {
            return void 0 === a && (a = this.world), a.add(new z.TileSprite(this.game, t, e, i, n, s, o));
        },
        rope: function(t, e, i, n, s, o) {
            return void 0 === o && (o = this.world), o.add(new z.Rope(this.game, t, e, i, n, s));
        },
        text: function(t, e, i, n, s) {
            return void 0 === s && (s = this.world), s.add(new z.Text(this.game, t, e, i, n));
        },
        button: function(t, e, i, n, s, o, a, r, h, l) {
            return void 0 === l && (l = this.world), l.add(new z.Button(this.game, t, e, i, n, s, o, a, r, h));
        },
        graphics: function(t, e, i) {
            return void 0 === i && (i = this.world), i.add(new z.Graphics(this.game, t, e));
        },
        emitter: function(t, e, i) {
            return this.game.particles.add(new z.Particles.Arcade.Emitter(this.game, t, e, i));
        },
        retroFont: function(t, e, i, n, s, o, a, r, h) {
            return new z.RetroFont(this.game, t, e, i, n, s, o, a, r, h);
        },
        bitmapText: function(t, e, i, n, s, o) {
            return void 0 === o && (o = this.world), o.add(new z.BitmapText(this.game, t, e, i, n, s));
        },
        tilemap: function(t, e, i, n, s) {
            return new z.Tilemap(this.game, t, e, i, n, s);
        },
        renderTexture: function(t, e, i, n) {
            void 0 !== i && "" !== i || (i = this.game.rnd.uuid()), void 0 === n && (n = !1);
            var s = new z.RenderTexture(this.game, t, e, i);
            return n && this.game.cache.addRenderTexture(i, s), s;
        },
        video: function(t, e) {
            return new z.Video(this.game, t, e);
        },
        bitmapData: function(t, e, i, n) {
            void 0 === n && (n = !1), void 0 !== i && "" !== i || (i = this.game.rnd.uuid());
            var s = new z.BitmapData(this.game, i, t, e);
            return n && this.game.cache.addBitmapData(i, s), s;
        },
        filter: function(t) {
            var e = Array.prototype.slice.call(arguments, 1);
            return (t = new z.Filter[t](this.game)).init.apply(t, e), t;
        },
        plugin: function() {
            return this.game.plugins.add.apply(this.game.plugins, arguments);
        }
    }, z.GameObjectFactory.prototype.constructor = z.GameObjectFactory, z.GameObjectCreator = function(t) {
        this.game = t, this.world = this.game.world;
    }, z.GameObjectCreator.prototype = {
        image: function(t, e, i, n) {
            return new z.Image(this.game, t, e, i, n);
        },
        sprite: function(t, e, i, n) {
            return new z.Sprite(this.game, t, e, i, n);
        },
        tween: function(t) {
            return new z.Tween(t, this.game, this.game.tweens);
        },
        group: function(t, e, i, n, s) {
            return new z.Group(this.game, t || null, e, i, n, s);
        },
        spriteBatch: function(t, e, i) {
            return void 0 === e && (e = "group"), void 0 === i && (i = !1), new z.SpriteBatch(this.game, t, e, i);
        },
        audio: function(t, e, i, n) {
            return this.game.sound.add(t, e, i, n);
        },
        audioSprite: function(t) {
            return this.game.sound.addSprite(t);
        },
        sound: function(t, e, i, n) {
            return this.game.sound.add(t, e, i, n);
        },
        tileSprite: function(t, e, i, n, s, o) {
            return new z.TileSprite(this.game, t, e, i, n, s, o);
        },
        rope: function(t, e, i, n, s) {
            return new z.Rope(this.game, t, e, i, n, s);
        },
        text: function(t, e, i, n) {
            return new z.Text(this.game, t, e, i, n);
        },
        button: function(t, e, i, n, s, o, a, r, h) {
            return new z.Button(this.game, t, e, i, n, s, o, a, r, h);
        },
        graphics: function(t, e) {
            return new z.Graphics(this.game, t, e);
        },
        emitter: function(t, e, i) {
            return new z.Particles.Arcade.Emitter(this.game, t, e, i);
        },
        retroFont: function(t, e, i, n, s, o, a, r, h) {
            return new z.RetroFont(this.game, t, e, i, n, s, o, a, r, h);
        },
        bitmapText: function(t, e, i, n, s, o) {
            return new z.BitmapText(this.game, t, e, i, n, s, o);
        },
        tilemap: function(t, e, i, n, s) {
            return new z.Tilemap(this.game, t, e, i, n, s);
        },
        renderTexture: function(t, e, i, n) {
            void 0 !== i && "" !== i || (i = this.game.rnd.uuid()), void 0 === n && (n = !1);
            var s = new z.RenderTexture(this.game, t, e, i);
            return n && this.game.cache.addRenderTexture(i, s), s;
        },
        bitmapData: function(t, e, i, n) {
            void 0 === n && (n = !1), void 0 !== i && "" !== i || (i = this.game.rnd.uuid());
            var s = new z.BitmapData(this.game, i, t, e);
            return n && this.game.cache.addBitmapData(i, s), s;
        },
        filter: function(t) {
            var e = Array.prototype.slice.call(arguments, 1);
            return (t = new z.Filter[t](this.game)).init.apply(t, e), t;
        }
    }, z.GameObjectCreator.prototype.constructor = z.GameObjectCreator, z.Sprite = function(t, e, i, n, s) {
        e = e || 0, i = i || 0, n = n || null, s = s || null, this.type = z.SPRITE, this.physicsType = z.SPRITE, 
        PIXI.Sprite.call(this, z.Cache.DEFAULT), z.Component.Core.init.call(this, t, e, i, n, s);
    }, z.Sprite.prototype = Object.create(PIXI.Sprite.prototype), z.Sprite.prototype.constructor = z.Sprite, 
    z.Component.Core.install.call(z.Sprite.prototype, [ "Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Delta", "Destroy", "FixedToCamera", "Health", "InCamera", "InputEnabled", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "ScaleMinMax", "Smoothed" ]), 
    z.Sprite.prototype.preUpdatePhysics = z.Component.PhysicsBody.preUpdate, z.Sprite.prototype.preUpdateLifeSpan = z.Component.LifeSpan.preUpdate, 
    z.Sprite.prototype.preUpdateInWorld = z.Component.InWorld.preUpdate, z.Sprite.prototype.preUpdateCore = z.Component.Core.preUpdate, 
    z.Sprite.prototype.preUpdate = function() {
        return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore();
    }, z.Image = function(t, e, i, n, s) {
        e = e || 0, i = i || 0, n = n || null, s = s || null, this.type = z.IMAGE, PIXI.Sprite.call(this, z.Cache.DEFAULT), 
        z.Component.Core.init.call(this, t, e, i, n, s);
    }, z.Image.prototype = Object.create(PIXI.Sprite.prototype), z.Image.prototype.constructor = z.Image, 
    z.Component.Core.install.call(z.Image.prototype, [ "Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Destroy", "FixedToCamera", "InputEnabled", "LifeSpan", "LoadTexture", "Overlap", "Reset", "ScaleMinMax", "Smoothed" ]), 
    z.Image.prototype.preUpdateLifeSpan = z.Component.LifeSpan.preUpdate, z.Image.prototype.preUpdateInWorld = z.Component.InWorld.preUpdate, 
    z.Image.prototype.preUpdateCore = z.Component.Core.preUpdate, z.Image.prototype.preUpdate = function() {
        return !(!this.preUpdateInWorld() || !this.preUpdateLifeSpan()) && this.preUpdateCore();
    }, z.Button = function(t, e, i, n, s, o, a, r, h, l) {
        e = e || 0, i = i || 0, n = n || null, s = s || null, o = o || this, z.Image.call(this, t, e, i, n, r), 
        this.type = z.BUTTON, this.physicsType = z.SPRITE, this._onOverFrame = null, this._onOutFrame = null, 
        this._onDownFrame = null, this._onUpFrame = null, this.onOverSound = null, this.onOutSound = null, 
        this.onDownSound = null, this.onUpSound = null, this.onOverSoundMarker = "", this.onOutSoundMarker = "", 
        this.onDownSoundMarker = "", this.onUpSoundMarker = "", this.onInputOver = new z.Signal(), 
        this.onInputOut = new z.Signal(), this.onInputDown = new z.Signal(), this.onInputUp = new z.Signal(), 
        this.onOverMouseOnly = !0, this.justReleasedPreventsOver = z.PointerMode.CONTACT, 
        this.freezeFrames = !1, this.forceOut = !1, this.inputEnabled = !0, this.input.start(0, !0), 
        this.input.useHandCursor = !0, this.setFrames(a, r, h, l), null !== s && this.onInputUp.add(s, o), 
        this.events.onInputOver.add(this.onInputOverHandler, this), this.events.onInputOut.add(this.onInputOutHandler, this), 
        this.events.onInputDown.add(this.onInputDownHandler, this), this.events.onInputUp.add(this.onInputUpHandler, this);
    }, z.Button.prototype = Object.create(z.Image.prototype), z.Button.prototype.constructor = z.Button;
    var h = "Over", l = "Out", c = "Down", u = "Up";
    return z.Button.prototype.clearFrames = function() {
        this.setFrames(null, null, null, null);
    }, z.Button.prototype.setStateFrame = function(t, e, i) {
        var n = "_on" + t + "Frame";
        null !== e ? (this[n] = e, i && this.changeStateFrame(t)) : this[n] = null;
    }, z.Button.prototype.changeStateFrame = function(t) {
        if (this.freezeFrames) return !1;
        var e = this["_on" + t + "Frame"];
        return "string" == typeof e ? (this.frameName = e, !0) : "number" == typeof e && (this.frame = e, 
        !0);
    }, z.Button.prototype.setFrames = function(t, e, i, n) {
        this.setStateFrame(h, t, this.input.pointerOver()), this.setStateFrame(l, e, !this.input.pointerOver()), 
        this.setStateFrame(c, i, this.input.pointerDown()), this.setStateFrame(u, n, this.input.pointerUp());
    }, z.Button.prototype.setStateSound = function(t, e, i) {
        var n = "on" + t + "Sound", s = "on" + t + "SoundMarker";
        e instanceof z.Sound || e instanceof z.AudioSprite ? (this[n] = e, this[s] = "string" == typeof i ? i : "") : (this[n] = null, 
        this[s] = "");
    }, z.Button.prototype.playStateSound = function(t) {
        var e = this["on" + t + "Sound"];
        if (e) {
            var i = this["on" + t + "SoundMarker"];
            return e.play(i), !0;
        }
        return !1;
    }, z.Button.prototype.setSounds = function(t, e, i, n, s, o, a, r) {
        this.setStateSound(h, t, e), this.setStateSound(l, s, o), this.setStateSound(c, i, n), 
        this.setStateSound(u, a, r);
    }, z.Button.prototype.setOverSound = function(t, e) {
        this.setStateSound(h, t, e);
    }, z.Button.prototype.setOutSound = function(t, e) {
        this.setStateSound(l, t, e);
    }, z.Button.prototype.setDownSound = function(t, e) {
        this.setStateSound(c, t, e);
    }, z.Button.prototype.setUpSound = function(t, e) {
        this.setStateSound(u, t, e);
    }, z.Button.prototype.onInputOverHandler = function(t, e) {
        e.justReleased() && (this.justReleasedPreventsOver & e.pointerMode) === e.pointerMode || (this.changeStateFrame(h), 
        this.onOverMouseOnly && !e.isMouse || (this.playStateSound(h), this.onInputOver && this.onInputOver.dispatch(this, e)));
    }, z.Button.prototype.onInputOutHandler = function(t, e) {
        this.changeStateFrame(l), this.playStateSound(l), this.onInputOut && this.onInputOut.dispatch(this, e);
    }, z.Button.prototype.onInputDownHandler = function(t, e) {
        this.changeStateFrame(c), this.playStateSound(c), this.onInputDown && this.onInputDown.dispatch(this, e);
    }, z.Button.prototype.onInputUpHandler = function(t, e, i) {
        (this.playStateSound(u), this.onInputUp && this.onInputUp.dispatch(this, e, i), 
        this.freezeFrames) || (!0 === this.forceOut || (this.forceOut & e.pointerMode) === e.pointerMode ? this.changeStateFrame(l) : this.changeStateFrame(u) || (i ? this.changeStateFrame(h) : this.changeStateFrame(l)));
    }, z.SpriteBatch = function(t, e, i, n) {
        null == e && (e = t.world), z.Group.call(this, t, e, i, n), this.type = z.SPRITEBATCH, 
        this.fastSpriteBatch = null, this.ready = !1;
    }, z.SpriteBatch.prototype = Object.create(z.Group.prototype), z.SpriteBatch.prototype.constructor = z.SpriteBatch, 
    z.SpriteBatch.prototype._renderWebGL = function(t) {
        !this.visible || this.alpha <= 0 || !this.children.length || (this.ready || (this.fastSpriteBatch = new PIXI.WebGLFastSpriteBatch(t.gl), 
        this.ready = !0), this.fastSpriteBatch.gl !== t.gl && this.fastSpriteBatch.setContext(t.gl), 
        t.spriteBatch.stop(), t.shaderManager.setShader(t.shaderManager.fastShader), this.fastSpriteBatch.begin(this, t), 
        this.fastSpriteBatch.render(this), t.spriteBatch.start());
    }, z.SpriteBatch.prototype._renderCanvas = function(t) {
        if (this.visible && !(this.alpha <= 0) && this.children.length) {
            var e = t.context;
            e.globalAlpha = this.worldAlpha, this.displayObjectUpdateTransform();
            for (var i = this.worldTransform, n = !0, s = 0; s < this.children.length; s++) {
                var o = this.children[s];
                if (o.visible) {
                    var a = o.texture, r = a.frame;
                    if (e.globalAlpha = this.worldAlpha * o.alpha, o.rotation % (2 * Math.PI) == 0) n && (e.setTransform(i.a, i.b, i.c, i.d, i.tx, i.ty), 
                    n = !1), e.drawImage(a.baseTexture.source, r.x, r.y, r.width, r.height, o.anchor.x * (-r.width * o.scale.x) + o.position.x + .5 + t.shakeX | 0, o.anchor.y * (-r.height * o.scale.y) + o.position.y + .5 + t.shakeY | 0, r.width * o.scale.x, r.height * o.scale.y); else {
                        n || (n = !0), o.displayObjectUpdateTransform();
                        var h = o.worldTransform, l = h.tx * t.resolution + t.shakeX, c = h.ty * t.resolution + t.shakeY;
                        t.roundPixels ? e.setTransform(h.a, h.b, h.c, h.d, 0 | l, 0 | c) : e.setTransform(h.a, h.b, h.c, h.d, l, c), 
                        e.drawImage(a.baseTexture.source, r.x, r.y, r.width, r.height, o.anchor.x * -r.width + .5 | 0, o.anchor.y * -r.height + .5 | 0, r.width, r.height);
                    }
                }
            }
        }
    }, z.BitmapData = function(t, e, i, n, s) {
        void 0 !== i && 0 !== i || (i = 256), void 0 !== n && 0 !== n || (n = 256), void 0 === s && (s = !1), 
        this.game = t, this.key = e, this.width = i, this.height = n, this.canvas = z.Canvas.create(this, i, n, null, s), 
        this.context = this.canvas.getContext("2d", {
            alpha: !0
        }), this.ctx = this.context, this.smoothProperty = t.renderType === z.CANVAS ? t.renderer.renderSession.smoothProperty : z.Canvas.getSmoothingPrefix(this.context), 
        this.imageData = this.context.getImageData(0, 0, i, n), this.data = null, this.imageData && (this.data = this.imageData.data), 
        this.pixels = null, this.data && (this.imageData.data.buffer ? (this.buffer = this.imageData.data.buffer, 
        this.pixels = new Uint32Array(this.buffer)) : window.ArrayBuffer ? (this.buffer = new ArrayBuffer(this.imageData.data.length), 
        this.pixels = new Uint32Array(this.buffer)) : this.pixels = this.imageData.data), 
        this.baseTexture = new PIXI.BaseTexture(this.canvas, null, this.game.resolution), 
        this.texture = new PIXI.Texture(this.baseTexture), this.frameData = new z.FrameData(), 
        this.textureFrame = this.frameData.addFrame(new z.Frame(0, 0, 0, i, n, "bitmapData")), 
        this.texture.frame = this.textureFrame, this.type = z.BITMAPDATA, this.disableTextureUpload = !1, 
        this.dirty = !1, this.cls = this.clear, this._image = null, this._pos = new z.Point(), 
        this._size = new z.Point(), this._scale = new z.Point(), this._rotate = 0, this._alpha = {
            prev: 1,
            current: 1
        }, this._anchor = new z.Point(), this._tempR = 0, this._tempG = 0, this._tempB = 0, 
        this._circle = new z.Circle(), this._swapCanvas = void 0;
    }, z.BitmapData.prototype = {
        move: function(t, e, i) {
            return 0 !== t && this.moveH(t, i), 0 !== e && this.moveV(e, i), this;
        },
        moveH: function(t, e) {
            void 0 === e && (e = !0), void 0 === this._swapCanvas && (this._swapCanvas = z.CanvasPool.create(this, this.width, this.height));
            var i = this._swapCanvas.getContext("2d"), n = this.height, s = this.canvas;
            if (i.clearRect(0, 0, this.width, this.height), t < 0) {
                t = Math.abs(t);
                var o = this.width - t;
                e && i.drawImage(s, 0, 0, t, n, o, 0, t, n), i.drawImage(s, t, 0, o, n, 0, 0, o, n);
            } else {
                o = this.width - t;
                e && i.drawImage(s, o, 0, t, n, 0, 0, t, n), i.drawImage(s, 0, 0, o, n, t, 0, o, n);
            }
            return this.clear(), this.copy(this._swapCanvas);
        },
        moveV: function(t, e) {
            void 0 === e && (e = !0), void 0 === this._swapCanvas && (this._swapCanvas = z.CanvasPool.create(this, this.width, this.height));
            var i = this._swapCanvas.getContext("2d"), n = this.width, s = this.canvas;
            if (i.clearRect(0, 0, this.width, this.height), t < 0) {
                t = Math.abs(t);
                var o = this.height - t;
                e && i.drawImage(s, 0, 0, n, t, 0, o, n, t), i.drawImage(s, 0, t, n, o, 0, 0, n, o);
            } else {
                o = this.height - t;
                e && i.drawImage(s, 0, o, n, t, 0, 0, n, t), i.drawImage(s, 0, 0, n, o, 0, t, n, o);
            }
            return this.clear(), this.copy(this._swapCanvas);
        },
        add: function(t) {
            if (Array.isArray(t)) for (var e = 0; e < t.length; e++) t[e].loadTexture && t[e].loadTexture(this); else t.loadTexture(this);
            return this;
        },
        load: function(t) {
            if ("string" == typeof t && (t = this.game.cache.getImage(t)), t) return this.resize(t.width, t.height), 
            this.cls(), this.draw(t), this.update(), this;
        },
        clear: function(t, e, i, n) {
            return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = this.width), 
            void 0 === n && (n = this.height), this.context.clearRect(t, e, i, n), this.dirty = !0, 
            this;
        },
        fill: function(t, e, i, n) {
            return void 0 === n && (n = 1), this.context.fillStyle = "rgba(" + t + "," + e + "," + i + "," + n + ")", 
            this.context.fillRect(0, 0, this.width, this.height), this.dirty = !0, this;
        },
        generateTexture: function(i, n, s) {
            var o = this.game.cache, a = new Image();
            if (n && (a.onload = function() {
                var t = o.addImage(i, "", a), e = new PIXI.Texture(t.base);
                n.call(s || null, e), a.onload = null;
            }), a.src = this.canvas.toDataURL("image/png"), !n) {
                var t = o.addImage(i, "", a);
                return new PIXI.Texture(t.base);
            }
            return null;
        },
        resize: function(t, e) {
            return t === this.width && e === this.height || (this.width = t, this.height = e, 
            this.canvas.width = t, this.canvas.height = e, void 0 !== this._swapCanvas && (this._swapCanvas.width = t, 
            this._swapCanvas.height = e), this.baseTexture.width = t, this.baseTexture.height = e, 
            this.textureFrame.width = t, this.textureFrame.height = e, this.texture.width = t, 
            this.texture.height = e, this.texture.crop.width = t, this.texture.crop.height = e, 
            this.update(), this.dirty = !0), this;
        },
        update: function(t, e, i, n) {
            return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = Math.max(1, this.width)), 
            void 0 === n && (n = Math.max(1, this.height)), this.imageData = this.context.getImageData(t, e, i, n), 
            this.data = this.imageData.data, this.imageData.data.buffer ? (this.buffer = this.imageData.data.buffer, 
            this.pixels = new Uint32Array(this.buffer)) : window.ArrayBuffer ? (this.buffer = new ArrayBuffer(this.imageData.data.length), 
            this.pixels = new Uint32Array(this.buffer)) : this.pixels = this.imageData.data, 
            this;
        },
        processPixelRGB: function(t, e, i, n, s, o) {
            void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === s && (s = this.width), 
            void 0 === o && (o = this.height);
            for (var a = i + s, r = n + o, h = z.Color.createColor(), l = {
                r: 0,
                g: 0,
                b: 0,
                a: 0
            }, c = !1, u = n; u < r; u++) for (var d = i; d < a; d++) z.Color.unpackPixel(this.getPixel32(d, u), h), 
            !1 !== (l = t.call(e, h, d, u)) && null != l && (this.setPixel32(d, u, l.r, l.g, l.b, l.a, !1), 
            c = !0);
            return c && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0), 
            this;
        },
        processPixel: function(t, e, i, n, s, o) {
            void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === s && (s = this.width), 
            void 0 === o && (o = this.height);
            for (var a = i + s, r = n + o, h = 0, l = 0, c = !1, u = n; u < r; u++) for (var d = i; d < a; d++) h = this.getPixel32(d, u), 
            (l = t.call(e, h, d, u)) !== h && (this.pixels[u * this.width + d] = l, c = !0);
            return c && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0), 
            this;
        },
        replaceRGB: function(t, e, i, n, s, o, a, r, h) {
            var l = 0, c = 0, u = this.width, d = this.height, p = z.Color.packPixel(t, e, i, n);
            void 0 !== h && h instanceof z.Rectangle && (l = h.x, c = h.y, u = h.width, d = h.height);
            for (var g = 0; g < d; g++) for (var m = 0; m < u; m++) this.getPixel32(l + m, c + g) === p && this.setPixel32(l + m, c + g, s, o, a, r, !1);
            return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this;
        },
        setHSL: function(t, e, i, n) {
            var s = t || 0 === t, o = e || 0 === e, a = i || 0 === i;
            if (s || o || a) {
                void 0 === n && (n = new z.Rectangle(0, 0, this.width, this.height));
                for (var r = z.Color.createColor(), h = n.y; h < n.bottom; h++) for (var l = n.x; l < n.right; l++) z.Color.unpackPixel(this.getPixel32(l, h), r, !0), 
                s && (r.h = t), o && (r.s = e), a && (r.l = i), z.Color.HSLtoRGB(r.h, r.s, r.l, r), 
                this.setPixel32(l, h, r.r, r.g, r.b, r.a, !1);
                return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this;
            }
        },
        shiftHSL: function(t, e, i, n) {
            if (null == t && (t = !1), null == e && (e = !1), null == i && (i = !1), t || e || i) {
                void 0 === n && (n = new z.Rectangle(0, 0, this.width, this.height));
                for (var s = z.Color.createColor(), o = n.y; o < n.bottom; o++) for (var a = n.x; a < n.right; a++) z.Color.unpackPixel(this.getPixel32(a, o), s, !0), 
                t && (s.h = this.game.math.wrap(s.h + t, 0, 1)), e && (s.s = this.game.math.clamp(s.s + e, 0, 1)), 
                i && (s.l = this.game.math.clamp(s.l + i, 0, 1)), z.Color.HSLtoRGB(s.h, s.s, s.l, s), 
                this.setPixel32(a, o, s.r, s.g, s.b, s.a, !1);
                return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this;
            }
        },
        setPixel32: function(t, e, i, n, s, o, a) {
            return void 0 === a && (a = !0), 0 <= t && t <= this.width && 0 <= e && e <= this.height && (z.Device.LITTLE_ENDIAN ? this.pixels[e * this.width + t] = o << 24 | s << 16 | n << 8 | i : this.pixels[e * this.width + t] = i << 24 | n << 16 | s << 8 | o, 
            a && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0)), this;
        },
        setPixel: function(t, e, i, n, s, o) {
            return this.setPixel32(t, e, i, n, s, 255, o);
        },
        getPixel: function(t, e, i) {
            i || (i = z.Color.createColor());
            var n = ~~(t + e * this.width);
            return n *= 4, i.r = this.data[n], i.g = this.data[++n], i.b = this.data[++n], i.a = this.data[++n], 
            i;
        },
        getPixel32: function(t, e) {
            if (0 <= t && t <= this.width && 0 <= e && e <= this.height) return this.pixels[e * this.width + t];
        },
        getPixelRGB: function(t, e, i, n, s) {
            return z.Color.unpackPixel(this.getPixel32(t, e), i, n, s);
        },
        getPixels: function(t) {
            return this.context.getImageData(t.x, t.y, t.width, t.height);
        },
        getFirstPixel: function(t) {
            void 0 === t && (t = 0);
            var e = z.Color.createColor(), i = 0, n = 0, s = 1, o = !1;
            for (1 === t ? (s = -1, n = this.height) : 3 === t && (s = -1, i = this.width); z.Color.unpackPixel(this.getPixel32(i, n), e), 
            0 === t || 1 === t ? ++i === this.width && (i = 0, ((n += s) >= this.height || n <= 0) && (o = !0)) : 2 !== t && 3 !== t || ++n === this.height && (n = 0, 
            ((i += s) >= this.width || i <= 0) && (o = !0)), 0 === e.a && !o; ) ;
            return e.x = i, e.y = n, e;
        },
        getBounds: function(t) {
            return void 0 === t && (t = new z.Rectangle()), t.x = this.getFirstPixel(2).x, t.x === this.width ? t.setTo(0, 0, 0, 0) : (t.y = this.getFirstPixel(0).y, 
            t.width = this.getFirstPixel(3).x - t.x + 1, t.height = this.getFirstPixel(1).y - t.y + 1, 
            t);
        },
        addToWorld: function(t, e, i, n, s, o) {
            s = s || 1, o = o || 1;
            var a = this.game.add.image(t, e, this);
            return a.anchor.set(i, n), a.scale.set(s, o), a;
        },
        copy: function(t, e, i, n, s, o, a, r, h, l, c, u, d, p, g, m, f) {
            if (null == t && (t = this), t instanceof z.RenderTexture && (t = t.getCanvas()), 
            (this._image = t) instanceof z.Sprite || t instanceof z.Image || t instanceof z.Text || t instanceof PIXI.Sprite) this._pos.set(t.texture.crop.x, t.texture.crop.y), 
            this._size.set(t.texture.crop.width, t.texture.crop.height), this._scale.set(t.scale.x, t.scale.y), 
            this._anchor.set(t.anchor.x, t.anchor.y), this._rotate = t.rotation, this._alpha.current = t.alpha, 
            t.texture instanceof z.RenderTexture ? this._image = t.texture.getCanvas() : this._image = t.texture.baseTexture.source, 
            null == o && (o = t.x), null == a && (a = t.y), t.texture.trim && (o += t.texture.trim.x - t.anchor.x * t.texture.trim.width, 
            a += t.texture.trim.y - t.anchor.y * t.texture.trim.height), 16777215 !== t.tint && (t.cachedTint !== t.tint && (t.cachedTint = t.tint, 
            t.tintedTexture = PIXI.CanvasTinter.getTintedTexture(t, t.tint)), this._image = t.tintedTexture, 
            this._pos.set(0)); else {
                if (this._pos.set(0), this._scale.set(1), this._anchor.set(0), this._rotate = 0, 
                this._alpha.current = 1, t instanceof z.BitmapData) this._image = t.canvas; else if ("string" == typeof t) {
                    if (null === (t = this.game.cache.getImage(t))) return this;
                    this._image = t;
                }
                this._size.set(this._image.width, this._image.height);
            }
            if (null == e && (e = 0), null == i && (i = 0), n && (this._size.x = n), s && (this._size.y = s), 
            null == o && (o = e), null == a && (a = i), null == r && (r = this._size.x), null == h && (h = this._size.y), 
            "number" == typeof l && (this._rotate = l), "number" == typeof c && (this._anchor.x = c), 
            "number" == typeof u && (this._anchor.y = u), "number" == typeof d && (this._scale.x = d), 
            "number" == typeof p && (this._scale.y = p), "number" == typeof g && (this._alpha.current = g), 
            void 0 === m && (m = null), void 0 === f && (f = !1), this._alpha.current <= 0 || 0 === this._scale.x || 0 === this._scale.y || 0 === this._size.x || 0 === this._size.y) return this;
            var y = this.context;
            return this._alpha.prev = y.globalAlpha, y.save(), y.globalAlpha = this._alpha.current, 
            m && (this.op = m), f && (o |= 0, a |= 0), y.translate(o, a), y.scale(this._scale.x, this._scale.y), 
            y.rotate(this._rotate), y.drawImage(this._image, this._pos.x + e, this._pos.y + i, this._size.x, this._size.y, -r * this._anchor.x, -h * this._anchor.y, r, h), 
            y.restore(), y.globalAlpha = this._alpha.prev, this.dirty = !0, this;
        },
        copyTransform: function(t, e, i) {
            if (void 0 === e && (e = null), void 0 === i && (i = !1), !t.hasOwnProperty("worldTransform") || !t.worldVisible || 0 === t.worldAlpha) return this;
            var n = t.worldTransform;
            if (this._pos.set(t.texture.crop.x, t.texture.crop.y), this._size.set(t.texture.crop.width, t.texture.crop.height), 
            0 === n.a || 0 === n.d || 0 === this._size.x || 0 === this._size.y) return this;
            t.texture instanceof z.RenderTexture ? this._image = t.texture.getCanvas() : this._image = t.texture.baseTexture.source;
            var s = n.tx, o = n.ty;
            t.texture.trim && (s += t.texture.trim.x - t.anchor.x * t.texture.trim.width, o += t.texture.trim.y - t.anchor.y * t.texture.trim.height), 
            16777215 !== t.tint && (t.cachedTint !== t.tint && (t.cachedTint = t.tint, t.tintedTexture = PIXI.CanvasTinter.getTintedTexture(t, t.tint)), 
            this._image = t.tintedTexture, this._pos.set(0)), i && (s |= 0, o |= 0);
            var a = this.context;
            return this._alpha.prev = a.globalAlpha, a.save(), a.globalAlpha = this._alpha.current, 
            e && (this.op = e), a[this.smoothProperty] = t.texture.baseTexture.scaleMode === PIXI.scaleModes.LINEAR, 
            a.setTransform(n.a, n.b, n.c, n.d, s, o), a.drawImage(this._image, this._pos.x, this._pos.y, this._size.x, this._size.y, -this._size.x * t.anchor.x, -this._size.y * t.anchor.y, this._size.x, this._size.y), 
            a.restore(), a.globalAlpha = this._alpha.prev, this.dirty = !0, this;
        },
        copyRect: function(t, e, i, n, s, o, a) {
            return this.copy(t, e.x, e.y, e.width, e.height, i, n, e.width, e.height, 0, 0, 0, 1, 1, s, o, a);
        },
        draw: function(t, e, i, n, s, o, a) {
            return this.copy(t, null, null, null, null, e, i, n, s, null, null, null, null, null, null, o, a);
        },
        drawGroup: function(t, e, i) {
            return 0 < t.total && t.forEachExists(this.drawGroupProxy, this, e, i), this;
        },
        drawGroupProxy: function(t, e, i) {
            if (t.hasOwnProperty("texture") && this.copyTransform(t, e, i), t.type === z.GROUP && t.exists) this.drawGroup(t, e, i); else if (t.hasOwnProperty("children") && 0 < t.children.length) for (var n = 0; n < t.children.length; n++) t.children[n].exists && this.copyTransform(t.children[n], e, i);
        },
        drawFull: function(t, e, i) {
            if (!1 === t.worldVisible || 0 === t.worldAlpha || t.hasOwnProperty("exists") && !1 === t.exists) return this;
            if (t.type !== z.GROUP && t.type !== z.EMITTER && t.type !== z.BITMAPTEXT) if (t.type === z.GRAPHICS) {
                var n = t.getBounds();
                this.ctx.save(), this.ctx.translate(n.x, n.y), PIXI.CanvasGraphics.renderGraphics(t, this.ctx), 
                this.ctx.restore();
            } else this.copy(t, null, null, null, null, t.worldPosition.x, t.worldPosition.y, null, null, t.worldRotation, null, null, t.worldScale.x, t.worldScale.y, t.worldAlpha, e, i);
            if (t.children) for (var s = 0; s < t.children.length; s++) this.drawFull(t.children[s], e, i);
            return this;
        },
        shadow: function(t, e, i, n) {
            var s = this.context;
            return null == t ? s.shadowColor = "rgba(0,0,0,0)" : (s.shadowColor = t, s.shadowBlur = 0 === e ? 0 : e || 5, 
            s.shadowOffsetX = 0 === i ? 0 : i || 10, s.shadowOffsetY = 0 === n ? 0 : n || 10), 
            this;
        },
        alphaMask: function(t, e, i, n) {
            return null == n ? this.draw(e).blendSourceAtop() : this.draw(e, n.x, n.y, n.width, n.height).blendSourceAtop(), 
            null == i ? this.draw(t).blendReset() : this.draw(t, i.x, i.y, i.width, i.height).blendReset(), 
            this;
        },
        extract: function(n, s, o, a, r, t, h, l, c) {
            return void 0 === r && (r = 255), void 0 === t && (t = !1), void 0 === h && (h = s), 
            void 0 === l && (l = o), void 0 === c && (c = a), t && n.resize(this.width, this.height), 
            this.processPixelRGB(function(t, e, i) {
                return t.r === s && t.g === o && t.b === a && n.setPixel32(e, i, h, l, c, r, !1), 
                !1;
            }, this), n.context.putImageData(n.imageData, 0, 0), n.dirty = !0, n;
        },
        rect: function(t, e, i, n, s) {
            return void 0 !== s && (this.context.fillStyle = s), this.context.fillRect(t, e, i, n), 
            this;
        },
        text: function(t, e, i, n, s, o) {
            void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = "14px Courier"), 
            void 0 === s && (s = "rgb(255,255,255)"), void 0 === o && (o = !0);
            var a = this.context, r = a.font;
            return a.font = n, o && (a.fillStyle = "rgb(0,0,0)", a.fillText(t, e + 1, i + 1)), 
            a.fillStyle = s, a.fillText(t, e, i), a.font = r, this;
        },
        circle: function(t, e, i, n) {
            var s = this.context;
            return void 0 !== n && (s.fillStyle = n), s.beginPath(), s.arc(t, e, i, 0, 2 * Math.PI, !1), 
            s.closePath(), s.fill(), this;
        },
        line: function(t, e, i, n, s, o) {
            void 0 === s && (s = "#fff"), void 0 === o && (o = 1);
            var a = this.context;
            return a.beginPath(), a.moveTo(t, e), a.lineTo(i, n), a.lineWidth = o, a.strokeStyle = s, 
            a.stroke(), a.closePath(), this;
        },
        polygon: function(t, e, i, n) {
            void 0 === n && (n = "#fff"), void 0 === i && (i = 0);
            var s = this.context;
            e && (s.fillStyle = e), i && (s.lineWidth = i, s.strokeStyle = n), s.beginPath(), 
            s.moveTo(t[0].x, t[0].y);
            for (var o = 1, a = t.length; o < a; o++) {
                var r = t[o];
                s.lineTo(r.x, r.y);
            }
            return s.closePath(), e && s.fill(), i && s.stroke(), this;
        },
        textureLine: function(t, e, i) {
            if (void 0 === i && (i = "repeat-x"), "string" != typeof e || (e = this.game.cache.getImage(e))) {
                var n = t.length;
                "no-repeat" === i && n > e.width && (n = e.width);
                var s = this.context;
                return s.fillStyle = s.createPattern(e, i), this._circle = new z.Circle(t.start.x, t.start.y, e.height), 
                this._circle.circumferencePoint(t.angle - 1.5707963267948966, !1, this._pos), s.save(), 
                s.translate(this._pos.x, this._pos.y), s.rotate(t.angle), s.fillRect(0, 0, n, e.height), 
                s.restore(), this.dirty = !0, this;
            }
        },
        render: function() {
            return !this.disableTextureUpload && this.dirty && (this.baseTexture.dirty(), this.dirty = !1), 
            this;
        },
        destroy: function() {
            this.frameData.destroy(), this.texture.destroy(!0), z.CanvasPool.remove(this);
        },
        blendReset: function() {
            return this.op = "source-over", this;
        },
        blendSourceOver: function() {
            return this.op = "source-over", this;
        },
        blendSourceIn: function() {
            return this.op = "source-in", this;
        },
        blendSourceOut: function() {
            return this.op = "source-out", this;
        },
        blendSourceAtop: function() {
            return this.op = "source-atop", this;
        },
        blendDestinationOver: function() {
            return this.op = "destination-over", this;
        },
        blendDestinationIn: function() {
            return this.op = "destination-in", this;
        },
        blendDestinationOut: function() {
            return this.op = "destination-out", this;
        },
        blendDestinationAtop: function() {
            return this.op = "destination-atop", this;
        },
        blendXor: function() {
            return this.op = "xor", this;
        },
        blendAdd: function() {
            return this.op = "lighter", this;
        },
        blendMultiply: function() {
            return this.op = "multiply", this;
        },
        blendScreen: function() {
            return this.op = "screen", this;
        },
        blendOverlay: function() {
            return this.op = "overlay", this;
        },
        blendDarken: function() {
            return this.op = "darken", this;
        },
        blendLighten: function() {
            return this.op = "lighten", this;
        },
        blendColorDodge: function() {
            return this.op = "color-dodge", this;
        },
        blendColorBurn: function() {
            return this.op = "color-burn", this;
        },
        blendHardLight: function() {
            return this.op = "hard-light", this;
        },
        blendSoftLight: function() {
            return this.op = "soft-light", this;
        },
        blendDifference: function() {
            return this.op = "difference", this;
        },
        blendExclusion: function() {
            return this.op = "exclusion", this;
        },
        blendHue: function() {
            return this.op = "hue", this;
        },
        blendSaturation: function() {
            return this.op = "saturation", this;
        },
        blendColor: function() {
            return this.op = "color", this;
        },
        blendLuminosity: function() {
            return this.op = "luminosity", this;
        },
        copyBitmapData: function(t, e, i) {
            t.update();
            for (var n, s = 0; s < t.height; s++) {
                n = (i + s) * this.width + e;
                for (var o = 0; o < t.width; o++) this.pixels[n + o] = t.pixels[s * t.width + o];
            }
            return this;
        }
    }, Object.defineProperty(z.BitmapData.prototype, "smoothed", {
        get: function() {
            return z.Canvas.getSmoothingEnabled(this.context);
        },
        set: function(t) {
            z.Canvas.setSmoothingEnabled(this.context, t);
        }
    }), Object.defineProperty(z.BitmapData.prototype, "op", {
        get: function() {
            return this.context.globalCompositeOperation;
        },
        set: function(t) {
            this.context.globalCompositeOperation = t;
        }
    }), z.BitmapData.getTransform = function(t, e, i, n, s, o) {
        return "number" != typeof t && (t = 0), "number" != typeof e && (e = 0), "number" != typeof i && (i = 1), 
        "number" != typeof n && (n = 1), "number" != typeof s && (s = 0), "number" != typeof o && (o = 0), 
        {
            sx: i,
            sy: n,
            scaleX: i,
            scaleY: n,
            skewX: s,
            skewY: o,
            translateX: t,
            translateY: e,
            tx: t,
            ty: e
        };
    }, z.BitmapData.prototype.constructor = z.BitmapData, z.EarCut = {}, z.EarCut.Triangulate = function(t, e, i) {
        i = i || 2;
        var n, s, o, a, r, h, l, c = e && e.length, u = c ? e[0] * i : t.length, d = z.EarCut.linkedList(t, 0, u, i, !0), p = [];
        if (!d) return p;
        if (c && (d = z.EarCut.eliminateHoles(t, e, d, i)), t.length > 80 * i) {
            n = o = t[0], s = a = t[1];
            for (var g = i; g < u; g += i) (r = t[g]) < n && (n = r), (h = t[g + 1]) < s && (s = h), 
            o < r && (o = r), a < h && (a = h);
            l = Math.max(o - n, a - s);
        }
        return z.EarCut.earcutLinked(d, p, i, n, s, l), p;
    }, z.EarCut.linkedList = function(t, e, i, n, s) {
        var o, a, r, h = 0;
        for (o = e, a = i - n; o < i; o += n) h += (t[a] - t[o]) * (t[o + 1] + t[a + 1]), 
        a = o;
        if (s === 0 < h) for (o = e; o < i; o += n) r = z.EarCut.insertNode(o, t[o], t[o + 1], r); else for (o = i - n; e <= o; o -= n) r = z.EarCut.insertNode(o, t[o], t[o + 1], r);
        return r;
    }, z.EarCut.filterPoints = function(t, e) {
        if (!t) return t;
        e || (e = t);
        var i, n = t;
        do {
            if (i = !1, n.steiner || !z.EarCut.equals(n, n.next) && 0 !== z.EarCut.area(n.prev, n, n.next)) n = n.next; else {
                if (z.EarCut.removeNode(n), (n = e = n.prev) === n.next) return null;
                i = !0;
            }
        } while (i || n !== e);
        return e;
    }, z.EarCut.earcutLinked = function(t, e, i, n, s, o, a) {
        if (t) {
            !a && o && z.EarCut.indexCurve(t, n, s, o);
            for (var r, h, l = t; t.prev !== t.next; ) if (r = t.prev, h = t.next, o ? z.EarCut.isEarHashed(t, n, s, o) : z.EarCut.isEar(t)) e.push(r.i / i), 
            e.push(t.i / i), e.push(h.i / i), z.EarCut.removeNode(t), t = h.next, l = h.next; else if ((t = h) === l) {
                a ? 1 === a ? (t = z.EarCut.cureLocalIntersections(t, e, i), z.EarCut.earcutLinked(t, e, i, n, s, o, 2)) : 2 === a && z.EarCut.splitEarcut(t, e, i, n, s, o) : z.EarCut.earcutLinked(z.EarCut.filterPoints(t), e, i, n, s, o, 1);
                break;
            }
        }
    }, z.EarCut.isEar = function(t) {
        var e = t.prev, i = t, n = t.next;
        if (0 <= z.EarCut.area(e, i, n)) return !1;
        for (var s = t.next.next; s !== t.prev; ) {
            if (z.EarCut.pointInTriangle(e.x, e.y, i.x, i.y, n.x, n.y, s.x, s.y) && 0 <= z.EarCut.area(s.prev, s, s.next)) return !1;
            s = s.next;
        }
        return !0;
    }, z.EarCut.isEarHashed = function(t, e, i, n) {
        var s = t.prev, o = t, a = t.next;
        if (0 <= z.EarCut.area(s, o, a)) return !1;
        for (var r = s.x < o.x ? s.x < a.x ? s.x : a.x : o.x < a.x ? o.x : a.x, h = s.y < o.y ? s.y < a.y ? s.y : a.y : o.y < a.y ? o.y : a.y, l = s.x > o.x ? s.x > a.x ? s.x : a.x : o.x > a.x ? o.x : a.x, c = s.y > o.y ? s.y > a.y ? s.y : a.y : o.y > a.y ? o.y : a.y, u = z.EarCut.zOrder(r, h, e, i, n), d = z.EarCut.zOrder(l, c, e, i, n), p = t.nextZ; p && p.z <= d; ) {
            if (p !== t.prev && p !== t.next && z.EarCut.pointInTriangle(s.x, s.y, o.x, o.y, a.x, a.y, p.x, p.y) && 0 <= z.EarCut.area(p.prev, p, p.next)) return !1;
            p = p.nextZ;
        }
        for (p = t.prevZ; p && p.z >= u; ) {
            if (p !== t.prev && p !== t.next && z.EarCut.pointInTriangle(s.x, s.y, o.x, o.y, a.x, a.y, p.x, p.y) && 0 <= z.EarCut.area(p.prev, p, p.next)) return !1;
            p = p.prevZ;
        }
        return !0;
    }, z.EarCut.cureLocalIntersections = function(t, e, i) {
        var n = t;
        do {
            var s = n.prev, o = n.next.next;
            z.EarCut.intersects(s, n, n.next, o) && z.EarCut.locallyInside(s, o) && z.EarCut.locallyInside(o, s) && (e.push(s.i / i), 
            e.push(n.i / i), e.push(o.i / i), z.EarCut.removeNode(n), z.EarCut.removeNode(n.next), 
            n = t = o), n = n.next;
        } while (n !== t);
        return n;
    }, z.EarCut.splitEarcut = function(t, e, i, n, s, o) {
        var a = t;
        do {
            for (var r = a.next.next; r !== a.prev; ) {
                if (a.i !== r.i && z.EarCut.isValidDiagonal(a, r)) {
                    var h = z.EarCut.splitPolygon(a, r);
                    return a = z.EarCut.filterPoints(a, a.next), h = z.EarCut.filterPoints(h, h.next), 
                    z.EarCut.earcutLinked(a, e, i, n, s, o), void z.EarCut.earcutLinked(h, e, i, n, s, o);
                }
                r = r.next;
            }
            a = a.next;
        } while (a !== t);
    }, z.EarCut.eliminateHoles = function(t, e, i, n) {
        var s, o, a, r, h, l = [];
        for (s = 0, o = e.length; s < o; s++) a = e[s] * n, r = s < o - 1 ? e[s + 1] * n : t.length, 
        (h = z.EarCut.linkedList(t, a, r, n, !1)) === h.next && (h.steiner = !0), l.push(z.EarCut.getLeftmost(h));
        for (l.sort(z.EarCut.compareX), s = 0; s < l.length; s++) z.EarCut.eliminateHole(l[s], i), 
        i = z.EarCut.filterPoints(i, i.next);
        return i;
    }, z.EarCut.compareX = function(t, e) {
        return t.x - e.x;
    }, z.EarCut.eliminateHole = function(t, e) {
        if (e = z.EarCut.findHoleBridge(t, e)) {
            var i = z.EarCut.splitPolygon(e, t);
            z.EarCut.filterPoints(i, i.next);
        }
    }, z.EarCut.findHoleBridge = function(t, e) {
        var i, n = e, s = t.x, o = t.y, a = -1 / 0;
        do {
            if (o <= n.y && o >= n.next.y) {
                var r = n.x + (o - n.y) * (n.next.x - n.x) / (n.next.y - n.y);
                r <= s && a < r && (a = r, i = n.x < n.next.x ? n : n.next);
            }
            n = n.next;
        } while (n !== e);
        if (!i) return null;
        if (t.x === i.x) return i.prev;
        var h, l = i, c = 1 / 0;
        for (n = i.next; n !== l; ) s >= n.x && n.x >= i.x && z.EarCut.pointInTriangle(o < i.y ? s : a, o, i.x, i.y, o < i.y ? a : s, o, n.x, n.y) && ((h = Math.abs(o - n.y) / (s - n.x)) < c || h === c && n.x > i.x) && z.EarCut.locallyInside(n, t) && (i = n, 
        c = h), n = n.next;
        return i;
    }, z.EarCut.indexCurve = function(t, e, i, n) {
        for (var s = t; null === s.z && (s.z = z.EarCut.zOrder(s.x, s.y, e, i, n)), s.prevZ = s.prev, 
        s.nextZ = s.next, (s = s.next) !== t; ) ;
        s.prevZ.nextZ = null, s.prevZ = null, z.EarCut.sortLinked(s);
    }, z.EarCut.sortLinked = function(t) {
        var e, i, n, s, o, a, r, h, l = 1;
        do {
            for (i = t, o = t = null, a = 0; i; ) {
                for (a++, n = i, e = r = 0; e < l && (r++, n = n.nextZ); e++) ;
                for (h = l; 0 < r || 0 < h && n; ) 0 === r ? (n = (s = n).nextZ, h--) : 0 !== h && n ? i.z <= n.z ? (i = (s = i).nextZ, 
                r--) : (n = (s = n).nextZ, h--) : (i = (s = i).nextZ, r--), o ? o.nextZ = s : t = s, 
                s.prevZ = o, o = s;
                i = n;
            }
            o.nextZ = null, l *= 2;
        } while (1 < a);
        return t;
    }, z.EarCut.zOrder = function(t, e, i, n, s) {
        return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - i) / s) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - n) / s) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1;
    }, z.EarCut.getLeftmost = function(t) {
        for (var e = t, i = t; e.x < i.x && (i = e), (e = e.next) !== t; ) ;
        return i;
    }, z.EarCut.pointInTriangle = function(t, e, i, n, s, o, a, r) {
        return 0 <= (s - a) * (e - r) - (t - a) * (o - r) && 0 <= (t - a) * (n - r) - (i - a) * (e - r) && 0 <= (i - a) * (o - r) - (s - a) * (n - r);
    }, z.EarCut.isValidDiagonal = function(t, e) {
        return z.EarCut.equals(t, e) || t.next.i !== e.i && t.prev.i !== e.i && !z.EarCut.intersectsPolygon(t, e) && z.EarCut.locallyInside(t, e) && z.EarCut.locallyInside(e, t) && z.EarCut.middleInside(t, e);
    }, z.EarCut.area = function(t, e, i) {
        return (e.y - t.y) * (i.x - e.x) - (e.x - t.x) * (i.y - e.y);
    }, z.EarCut.equals = function(t, e) {
        return t.x === e.x && t.y === e.y;
    }, z.EarCut.intersects = function(t, e, i, n) {
        return 0 < z.EarCut.area(t, e, i) != 0 < z.EarCut.area(t, e, n) && 0 < z.EarCut.area(i, n, t) != 0 < z.EarCut.area(i, n, e);
    }, z.EarCut.intersectsPolygon = function(t, e) {
        var i = t;
        do {
            if (i.i !== t.i && i.next.i !== t.i && i.i !== e.i && i.next.i !== e.i && z.EarCut.intersects(i, i.next, t, e)) return !0;
            i = i.next;
        } while (i !== t);
        return !1;
    }, z.EarCut.locallyInside = function(t, e) {
        return z.EarCut.area(t.prev, t, t.next) < 0 ? 0 <= z.EarCut.area(t, e, t.next) && 0 <= z.EarCut.area(t, t.prev, e) : z.EarCut.area(t, e, t.prev) < 0 || z.EarCut.area(t, t.next, e) < 0;
    }, z.EarCut.middleInside = function(t, e) {
        for (var i = t, n = !1, s = (t.x + e.x) / 2, o = (t.y + e.y) / 2; i.y > o != i.next.y > o && s < (i.next.x - i.x) * (o - i.y) / (i.next.y - i.y) + i.x && (n = !n), 
        (i = i.next) !== t; ) ;
        return n;
    }, z.EarCut.splitPolygon = function(t, e) {
        var i = new z.EarCut.Node(t.i, t.x, t.y), n = new z.EarCut.Node(e.i, e.x, e.y), s = t.next, o = e.prev;
        return (t.next = e).prev = t, (i.next = s).prev = i, (n.next = i).prev = n, (o.next = n).prev = o, 
        n;
    }, z.EarCut.insertNode = function(t, e, i, n) {
        var s = new z.EarCut.Node(t, e, i);
        return n ? (s.next = n.next, (s.prev = n).next.prev = s, n.next = s) : (s.prev = s).next = s, 
        s;
    }, z.EarCut.removeNode = function(t) {
        t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), 
        t.nextZ && (t.nextZ.prevZ = t.prevZ);
    }, z.EarCut.Node = function(t, e, i) {
        this.i = t, this.x = e, this.y = i, this.prev = null, this.next = null, this.z = null, 
        this.prevZ = null, this.nextZ = null, this.steiner = !1;
    }, PIXI.WebGLGraphics = function() {}, PIXI.WebGLGraphics.stencilBufferLimit = 6, 
    PIXI.WebGLGraphics.renderGraphics = function(t, e) {
        var i, n = e.gl, s = e.projection, o = e.offset, a = e.shaderManager.primitiveShader;
        t.dirty && PIXI.WebGLGraphics.updateGraphics(t, n);
        var r = t._webGL[n.id];
        if (r) for (var h = 0; h < r.data.length; h++) 1 === r.data[h].mode ? (i = r.data[h], 
        e.stencilManager.pushStencil(t, i, e), n.drawElements(n.TRIANGLE_FAN, 4, n.UNSIGNED_SHORT, 2 * (i.indices.length - 4)), 
        e.stencilManager.popStencil(t, i, e)) : (i = r.data[h], e.shaderManager.setShader(a), 
        a = e.shaderManager.primitiveShader, n.uniformMatrix3fv(a.translationMatrix, !1, t.worldTransform.toArray(!0)), 
        n.uniform1f(a.flipY, 1), n.uniform2f(a.projectionVector, s.x, -s.y), n.uniform2f(a.offsetVector, -o.x, -o.y), 
        n.uniform3fv(a.tintColor, z.Color.hexToRGBArray(t.tint)), n.uniform1f(a.alpha, t.worldAlpha), 
        n.bindBuffer(n.ARRAY_BUFFER, i.buffer), n.vertexAttribPointer(a.aVertexPosition, 2, n.FLOAT, !1, 24, 0), 
        n.vertexAttribPointer(a.colorAttribute, 4, n.FLOAT, !1, 24, 8), n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, i.indexBuffer), 
        n.drawElements(n.TRIANGLE_STRIP, i.indices.length, n.UNSIGNED_SHORT, 0));
    }, PIXI.WebGLGraphics.updateGraphics = function(t, e) {
        var i, n, s = t._webGL[e.id];
        if (s || (s = t._webGL[e.id] = {
            lastIndex: 0,
            data: [],
            gl: e
        }), t.dirty = !1, t.clearDirty) {
            for (t.clearDirty = !1, i = 0; i < s.data.length; i++) {
                var o = s.data[i];
                o.reset(), PIXI.WebGLGraphics.graphicsDataPool.push(o);
            }
            s.data = [], s.lastIndex = 0;
        }
        for (i = s.lastIndex; i < t.graphicsData.length; i++) {
            var a = t.graphicsData[i];
            if (a.type === z.POLYGON) {
                if (a.points = a.shape.points.slice(), a.shape.closed && (a.points[0] === a.points[a.points.length - 2] && a.points[1] === a.points[a.points.length - 1] || a.points.push(a.points[0], a.points[1])), 
                a.fill) if (a.points.length >= PIXI.WebGLGraphics.stencilBufferLimit) if (a.points.length < 2 * PIXI.WebGLGraphics.stencilBufferLimit) n = PIXI.WebGLGraphics.switchMode(s, 0), 
                PIXI.WebGLGraphics.buildPoly(a, n) || (n = PIXI.WebGLGraphics.switchMode(s, 1), 
                PIXI.WebGLGraphics.buildComplexPoly(a, n)); else n = PIXI.WebGLGraphics.switchMode(s, 1), 
                PIXI.WebGLGraphics.buildComplexPoly(a, n);
                0 < a.lineWidth && (n = PIXI.WebGLGraphics.switchMode(s, 0), PIXI.WebGLGraphics.buildLine(a, n));
            } else n = PIXI.WebGLGraphics.switchMode(s, 0), a.type === z.RECTANGLE ? PIXI.WebGLGraphics.buildRectangle(a, n) : a.type === z.CIRCLE || a.type === z.ELLIPSE ? PIXI.WebGLGraphics.buildCircle(a, n) : a.type === z.ROUNDEDRECTANGLE && PIXI.WebGLGraphics.buildRoundedRectangle(a, n);
            s.lastIndex++;
        }
        for (i = 0; i < s.data.length; i++) (n = s.data[i]).dirty && n.upload();
    }, PIXI.WebGLGraphics.switchMode = function(t, e) {
        var i;
        return t.data.length && (i = t.data[t.data.length - 1]).mode === e && 1 !== e || ((i = PIXI.WebGLGraphics.graphicsDataPool.pop() || new PIXI.WebGLGraphicsData(t.gl)).mode = e, 
        t.data.push(i)), i.dirty = !0, i;
    }, PIXI.WebGLGraphics.buildRectangle = function(t, e) {
        var i = t.shape, n = i.x, s = i.y, o = i.width, a = i.height;
        if (t.fill) {
            var r = z.Color.hexToRGBArray(t.fillColor), h = t.fillAlpha, l = r[0] * h, c = r[1] * h, u = r[2] * h, d = e.points, p = e.indices, g = d.length / 6;
            d.push(n, s), d.push(l, c, u, h), d.push(n + o, s), d.push(l, c, u, h), d.push(n, s + a), 
            d.push(l, c, u, h), d.push(n + o, s + a), d.push(l, c, u, h), p.push(g, g, g + 1, g + 2, g + 3, g + 3);
        }
        if (t.lineWidth) {
            var m = t.points;
            t.points = [ n, s, n + o, s, n + o, s + a, n, s + a, n, s ], PIXI.WebGLGraphics.buildLine(t, e), 
            t.points = m;
        }
    }, PIXI.WebGLGraphics.buildRoundedRectangle = function(t, e) {
        var i = t.shape, n = i.x, s = i.y, o = i.width, a = i.height, r = i.radius, h = [];
        if (h.push(n, s + r), h = (h = (h = (h = h.concat(PIXI.WebGLGraphics.quadraticBezierCurve(n, s + a - r, n, s + a, n + r, s + a))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(n + o - r, s + a, n + o, s + a, n + o, s + a - r))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(n + o, s + r, n + o, s, n + o - r, s))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(n + r, s, n, s, n, s + r)), 
        t.fill) {
            var l = z.Color.hexToRGBArray(t.fillColor), c = t.fillAlpha, u = l[0] * c, d = l[1] * c, p = l[2] * c, g = e.points, m = e.indices, f = g.length / 6, y = z.EarCut.Triangulate(h, null, 2), v = 0;
            for (v = 0; v < y.length; v += 3) m.push(y[v] + f), m.push(y[v] + f), m.push(y[v + 1] + f), 
            m.push(y[v + 2] + f), m.push(y[v + 2] + f);
            for (v = 0; v < h.length; v++) g.push(h[v], h[++v], u, d, p, c);
        }
        if (t.lineWidth) {
            var b = t.points;
            t.points = h, PIXI.WebGLGraphics.buildLine(t, e), t.points = b;
        }
    }, PIXI.WebGLGraphics.quadraticBezierCurve = function(t, e, i, n, s, o) {
        var a, r, h, l, c, u, d = [];
        function p(t, e, i) {
            return t + (e - t) * i;
        }
        for (var g = 0, m = 0; m <= 20; m++) a = p(t, i, g = m / 20), r = p(e, n, g), h = p(i, s, g), 
        l = p(n, o, g), c = p(a, h, g), u = p(r, l, g), d.push(c, u);
        return d;
    }, PIXI.WebGLGraphics.buildCircle = function(t, e) {
        var i, n, s = t.shape, o = s.x, a = s.y;
        t.type === z.CIRCLE ? (i = s.radius, n = s.radius) : (i = s.width, n = s.height);
        var r = 2 * Math.PI / 40, h = 0;
        if (t.fill) {
            var l = z.Color.hexToRGBArray(t.fillColor), c = t.fillAlpha, u = l[0] * c, d = l[1] * c, p = l[2] * c, g = e.points, m = e.indices, f = g.length / 6;
            for (m.push(f), h = 0; h < 41; h++) g.push(o, a, u, d, p, c), g.push(o + Math.sin(r * h) * i, a + Math.cos(r * h) * n, u, d, p, c), 
            m.push(f++, f++);
            m.push(f - 1);
        }
        if (t.lineWidth) {
            var y = t.points;
            for (t.points = [], h = 0; h < 41; h++) t.points.push(o + Math.sin(r * h) * i, a + Math.cos(r * h) * n);
            PIXI.WebGLGraphics.buildLine(t, e), t.points = y;
        }
    }, PIXI.WebGLGraphics.buildLine = function(t, e) {
        var i = 0, n = t.points;
        if (0 !== n.length) {
            if (t.lineWidth % 2) for (i = 0; i < n.length; i++) n[i] += .5;
            var s = new PIXI.Point(n[0], n[1]), o = new PIXI.Point(n[n.length - 2], n[n.length - 1]);
            if (s.x === o.x && s.y === o.y) {
                (n = n.slice()).pop(), n.pop();
                var a = (o = new PIXI.Point(n[n.length - 2], n[n.length - 1])).x + .5 * (s.x - o.x), r = o.y + .5 * (s.y - o.y);
                n.unshift(a, r), n.push(a, r);
            }
            var h, l, c, u, d, p, g, m, f, y, v, b, _, S, x, w, A, P, C, T, E, I, B = e.points, L = e.indices, R = n.length / 2, O = n.length, M = B.length / 6, k = t.lineWidth / 2, D = z.Color.hexToRGBArray(t.lineColor), G = t.lineAlpha, U = D[0] * G, F = D[1] * G, N = D[2] * G;
            for (c = n[0], u = n[1], d = n[2], f = -(u - (p = n[3])), y = c - d, f /= I = Math.sqrt(f * f + y * y), 
            y /= I, f *= k, y *= k, B.push(c - f, u - y, U, F, N, G), B.push(c + f, u + y, U, F, N, G), 
            i = 1; i < R - 1; i++) c = n[2 * (i - 1)], u = n[2 * (i - 1) + 1], d = n[2 * i], 
            p = n[2 * i + 1], g = n[2 * (i + 1)], m = n[2 * (i + 1) + 1], f = -(u - p), y = c - d, 
            f /= I = Math.sqrt(f * f + y * y), y /= I, f *= k, y *= k, v = -(p - m), b = d - g, 
            v /= I = Math.sqrt(v * v + b * b), b /= I, A = (-f + c) * (-y + p) - (-f + d) * (-y + u), 
            T = (-(v *= k) + g) * (-(b *= k) + p) - (-v + d) * (-b + m), E = (x = -y + u - (-y + p)) * (C = -v + d - (-v + g)) - (P = -b + m - (-b + p)) * (w = -f + d - (-f + c)), 
            Math.abs(E) < .1 ? (E += 10.1, B.push(d - f, p - y, U, F, N, G), B.push(d + f, p + y, U, F, N, G)) : 19600 < ((h = (w * T - C * A) / E) - d) * (h - d) + ((l = (P * A - x * T) / E) - p) + (l - p) ? (_ = f - v, 
            S = y - b, _ /= I = Math.sqrt(_ * _ + S * S), S /= I, _ *= k, S *= k, B.push(d - _, p - S), 
            B.push(U, F, N, G), B.push(d + _, p + S), B.push(U, F, N, G), B.push(d - _, p - S), 
            B.push(U, F, N, G), O++) : (B.push(h, l), B.push(U, F, N, G), B.push(d - (h - d), p - (l - p)), 
            B.push(U, F, N, G));
            for (c = n[2 * (R - 2)], u = n[2 * (R - 2) + 1], d = n[2 * (R - 1)], f = -(u - (p = n[2 * (R - 1) + 1])), 
            y = c - d, f /= I = Math.sqrt(f * f + y * y), y /= I, f *= k, y *= k, B.push(d - f, p - y), 
            B.push(U, F, N, G), B.push(d + f, p + y), B.push(U, F, N, G), L.push(M), i = 0; i < O; i++) L.push(M++);
            L.push(M - 1);
        }
    }, PIXI.WebGLGraphics.buildComplexPoly = function(t, e) {
        var i = t.points.slice();
        if (!(i.length < 6)) {
            var n = e.indices;
            e.points = i, e.alpha = t.fillAlpha, e.color = z.Color.hexToRGBArray(t.fillColor);
            for (var s, o, a = 1 / 0, r = -1 / 0, h = 1 / 0, l = -1 / 0, c = 0; c < i.length; c += 2) a = (s = i[c]) < a ? s : a, 
            r = r < s ? s : r, h = (o = i[c + 1]) < h ? o : h, l = l < o ? o : l;
            i.push(a, h, r, h, r, l, a, l);
            var u = i.length / 2;
            for (c = 0; c < u; c++) n.push(c);
        }
    }, PIXI.WebGLGraphics.buildPoly = function(t, e) {
        var i = t.points;
        if (!(i.length < 6)) {
            var n = e.points, s = e.indices, o = i.length / 2, a = z.Color.hexToRGBArray(t.fillColor), r = t.fillAlpha, h = a[0] * r, l = a[1] * r, c = a[2] * r, u = z.EarCut.Triangulate(i, null, 2);
            if (!u) return !1;
            var d = n.length / 6, p = 0;
            for (p = 0; p < u.length; p += 3) s.push(u[p] + d), s.push(u[p] + d), s.push(u[p + 1] + d), 
            s.push(u[p + 2] + d), s.push(u[p + 2] + d);
            for (p = 0; p < o; p++) n.push(i[2 * p], i[2 * p + 1], h, l, c, r);
            return !0;
        }
    }, PIXI.WebGLGraphics.graphicsDataPool = [], PIXI.WebGLGraphicsData = function(t) {
        this.gl = t, this.color = [ 0, 0, 0 ], this.points = [], this.indices = [], this.buffer = t.createBuffer(), 
        this.indexBuffer = t.createBuffer(), this.mode = 1, this.alpha = 1, this.dirty = !0;
    }, PIXI.WebGLGraphicsData.prototype.reset = function() {
        this.points = [], this.indices = [];
    }, PIXI.WebGLGraphicsData.prototype.upload = function() {
        var t = this.gl;
        this.glPoints = new Float32Array(this.points), t.bindBuffer(t.ARRAY_BUFFER, this.buffer), 
        t.bufferData(t.ARRAY_BUFFER, this.glPoints, t.STATIC_DRAW), this.glIndicies = new Uint16Array(this.indices), 
        t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.glIndicies, t.STATIC_DRAW), 
        this.dirty = !1;
    }, PIXI.CanvasGraphics = function() {}, PIXI.CanvasGraphics.renderGraphics = function(t, e) {
        var i = t.worldAlpha;
        t.dirty && (this.updateGraphicsTint(t), t.dirty = !1);
        for (var n = 0; n < t.graphicsData.length; n++) {
            var s = t.graphicsData[n], o = s.shape, a = s._fillTint, r = s._lineTint;
            if (e.lineWidth = s.lineWidth, s.type === z.POLYGON) {
                e.beginPath();
                var h = o.points;
                e.moveTo(h[0], h[1]);
                for (var l = 1; l < h.length / 2; l++) e.lineTo(h[2 * l], h[2 * l + 1]);
                o.closed && e.lineTo(h[0], h[1]), h[0] === h[h.length - 2] && h[1] === h[h.length - 1] && e.closePath(), 
                s.fill && (e.globalAlpha = s.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), 
                e.fill()), s.lineWidth && (e.globalAlpha = s.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | r).toString(16)).substr(-6), 
                e.stroke());
            } else if (s.type === z.RECTANGLE) (s.fillColor || 0 === s.fillColor) && (e.globalAlpha = s.fillAlpha * i, 
            e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fillRect(o.x, o.y, o.width, o.height)), 
            s.lineWidth && (e.globalAlpha = s.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | r).toString(16)).substr(-6), 
            e.strokeRect(o.x, o.y, o.width, o.height)); else if (s.type === z.CIRCLE) e.beginPath(), 
            e.arc(o.x, o.y, o.radius, 0, 2 * Math.PI), e.closePath(), s.fill && (e.globalAlpha = s.fillAlpha * i, 
            e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fill()), s.lineWidth && (e.globalAlpha = s.lineAlpha * i, 
            e.strokeStyle = "#" + ("00000" + (0 | r).toString(16)).substr(-6), e.stroke()); else if (s.type === z.ELLIPSE) {
                var c = 2 * o.width, u = 2 * o.height, d = o.x - c / 2, p = o.y - u / 2;
                e.beginPath();
                var g = c / 2 * .5522848, m = u / 2 * .5522848, f = d + c, y = p + u, v = d + c / 2, b = p + u / 2;
                e.moveTo(d, b), e.bezierCurveTo(d, b - m, v - g, p, v, p), e.bezierCurveTo(v + g, p, f, b - m, f, b), 
                e.bezierCurveTo(f, b + m, v + g, y, v, y), e.bezierCurveTo(v - g, y, d, b + m, d, b), 
                e.closePath(), s.fill && (e.globalAlpha = s.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), 
                e.fill()), s.lineWidth && (e.globalAlpha = s.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | r).toString(16)).substr(-6), 
                e.stroke());
            } else if (s.type === z.ROUNDEDRECTANGLE) {
                var _ = o.x, S = o.y, x = o.width, w = o.height, A = o.radius, P = Math.min(x, w) / 2 | 0;
                A = P < A ? P : A, e.beginPath(), e.moveTo(_, S + A), e.lineTo(_, S + w - A), e.quadraticCurveTo(_, S + w, _ + A, S + w), 
                e.lineTo(_ + x - A, S + w), e.quadraticCurveTo(_ + x, S + w, _ + x, S + w - A), 
                e.lineTo(_ + x, S + A), e.quadraticCurveTo(_ + x, S, _ + x - A, S), e.lineTo(_ + A, S), 
                e.quadraticCurveTo(_, S, _, S + A), e.closePath(), (s.fillColor || 0 === s.fillColor) && (e.globalAlpha = s.fillAlpha * i, 
                e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fill()), s.lineWidth && (e.globalAlpha = s.lineAlpha * i, 
                e.strokeStyle = "#" + ("00000" + (0 | r).toString(16)).substr(-6), e.stroke());
            }
        }
    }, PIXI.CanvasGraphics.renderGraphicsMask = function(t, e) {
        var i = t.graphicsData.length;
        if (0 !== i) {
            e.beginPath();
            for (var n = 0; n < i; n++) {
                var s = t.graphicsData[n], o = s.shape;
                if (s.type === z.POLYGON) {
                    var a = o.points;
                    e.moveTo(a[0], a[1]);
                    for (var r = 1; r < a.length / 2; r++) e.lineTo(a[2 * r], a[2 * r + 1]);
                    a[0] === a[a.length - 2] && a[1] === a[a.length - 1] && e.closePath();
                } else if (s.type === z.RECTANGLE) e.rect(o.x, o.y, o.width, o.height), e.closePath(); else if (s.type === z.CIRCLE) e.arc(o.x, o.y, o.radius, 0, 2 * Math.PI), 
                e.closePath(); else if (s.type === z.ELLIPSE) {
                    var h = 2 * o.width, l = 2 * o.height, c = o.x - h / 2, u = o.y - l / 2, d = h / 2 * .5522848, p = l / 2 * .5522848, g = c + h, m = u + l, f = c + h / 2, y = u + l / 2;
                    e.moveTo(c, y), e.bezierCurveTo(c, y - p, f - d, u, f, u), e.bezierCurveTo(f + d, u, g, y - p, g, y), 
                    e.bezierCurveTo(g, y + p, f + d, m, f, m), e.bezierCurveTo(f - d, m, c, y + p, c, y), 
                    e.closePath();
                } else if (s.type === z.ROUNDEDRECTANGLE) {
                    var v = o.x, b = o.y, _ = o.width, S = o.height, x = o.radius, w = Math.min(_, S) / 2 | 0;
                    x = w < x ? w : x, e.moveTo(v, b + x), e.lineTo(v, b + S - x), e.quadraticCurveTo(v, b + S, v + x, b + S), 
                    e.lineTo(v + _ - x, b + S), e.quadraticCurveTo(v + _, b + S, v + _, b + S - x), 
                    e.lineTo(v + _, b + x), e.quadraticCurveTo(v + _, b, v + _ - x, b), e.lineTo(v + x, b), 
                    e.quadraticCurveTo(v, b, v, b + x), e.closePath();
                }
            }
        }
    }, PIXI.CanvasGraphics.updateGraphicsTint = function(t) {
        if (16777215 !== t.tint) for (var e = (t.tint >> 16 & 255) / 255, i = (t.tint >> 8 & 255) / 255, n = (255 & t.tint) / 255, s = 0; s < t.graphicsData.length; s++) {
            var o = t.graphicsData[s], a = 0 | o.fillColor, r = 0 | o.lineColor;
            o._fillTint = ((a >> 16 & 255) / 255 * e * 255 << 16) + ((a >> 8 & 255) / 255 * i * 255 << 8) + (255 & a) / 255 * n * 255, 
            o._lineTint = ((r >> 16 & 255) / 255 * e * 255 << 16) + ((r >> 8 & 255) / 255 * i * 255 << 8) + (255 & r) / 255 * n * 255;
        }
    }, z.GraphicsData = function(t, e, i, n, s, o, a) {
        this.lineWidth = t, this.lineColor = e, this.lineAlpha = i, this._lineTint = e, 
        this.fillColor = n, this.fillAlpha = s, this._fillTint = n, this.fill = o, this.shape = a, 
        this.type = a.type;
    }, z.GraphicsData.prototype.constructor = z.GraphicsData, z.GraphicsData.prototype.clone = function() {
        return new z.GraphicsData(this.lineWidth, this.lineColor, this.lineAlpha, this.fillColor, this.fillAlpha, this.fill, this.shape);
    }, z.Graphics = function(t, e, i) {
        void 0 === e && (e = 0), void 0 === i && (i = 0), this.type = z.GRAPHICS, this.physicsType = z.SPRITE, 
        this.anchor = new z.Point(), PIXI.DisplayObjectContainer.call(this), this.renderable = !0, 
        this.fillAlpha = 1, this.lineWidth = 0, this.lineColor = 0, this.graphicsData = [], 
        this.tint = 16777215, this.blendMode = PIXI.blendModes.NORMAL, this.currentPath = null, 
        this._webGL = [], this.isMask = !1, this.boundsPadding = 0, this._localBounds = new z.Rectangle(0, 0, 1, 1), 
        this.dirty = !0, this._boundsDirty = !1, this.webGLDirty = !1, this.cachedSpriteDirty = !1, 
        z.Component.Core.init.call(this, t, e, i, "", null);
    }, z.Graphics.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), 
    z.Graphics.prototype.constructor = z.Graphics, z.Component.Core.install.call(z.Graphics.prototype, [ "Angle", "AutoCull", "Bounds", "Destroy", "FixedToCamera", "InputEnabled", "InWorld", "LifeSpan", "PhysicsBody", "Reset" ]), 
    z.Graphics.prototype.preUpdatePhysics = z.Component.PhysicsBody.preUpdate, z.Graphics.prototype.preUpdateLifeSpan = z.Component.LifeSpan.preUpdate, 
    z.Graphics.prototype.preUpdateInWorld = z.Component.InWorld.preUpdate, z.Graphics.prototype.preUpdateCore = z.Component.Core.preUpdate, 
    z.Graphics.prototype.preUpdate = function() {
        return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore();
    }, z.Graphics.prototype.postUpdate = function() {
        z.Component.PhysicsBody.postUpdate.call(this), z.Component.FixedToCamera.postUpdate.call(this), 
        this._boundsDirty && (this.updateLocalBounds(), this._boundsDirty = !1);
        for (var t = 0; t < this.children.length; t++) this.children[t].postUpdate();
    }, z.Graphics.prototype.destroy = function(t) {
        this.clear(), z.Component.Destroy.prototype.destroy.call(this, t);
    }, z.Graphics.prototype.drawTriangle = function(t, e) {
        void 0 === e && (e = !1);
        var i = new z.Polygon(t);
        if (e) {
            var n = new z.Point(this.game.camera.x - t[0].x, this.game.camera.y - t[0].y), s = new z.Point(t[1].x - t[0].x, t[1].y - t[0].y), o = new z.Point(t[1].x - t[2].x, t[1].y - t[2].y).cross(s);
            0 < n.dot(o) && this.drawPolygon(i);
        } else this.drawPolygon(i);
    }, z.Graphics.prototype.drawTriangles = function(t, e, i) {
        void 0 === i && (i = !1);
        var n, s = new z.Point(), o = new z.Point(), a = new z.Point(), r = [];
        if (e) if (t[0] instanceof z.Point) for (n = 0; n < e.length / 3; n++) r.push(t[e[3 * n]]), 
        r.push(t[e[3 * n + 1]]), r.push(t[e[3 * n + 2]]), 3 === r.length && (this.drawTriangle(r, i), 
        r = []); else for (n = 0; n < e.length; n++) s.x = t[2 * e[n]], s.y = t[2 * e[n] + 1], 
        r.push(s.copyTo({})), 3 === r.length && (this.drawTriangle(r, i), r = []); else if (t[0] instanceof z.Point) for (n = 0; n < t.length / 3; n++) this.drawTriangle([ t[3 * n], t[3 * n + 1], t[3 * n + 2] ], i); else for (n = 0; n < t.length / 6; n++) s.x = t[6 * n + 0], 
        s.y = t[6 * n + 1], o.x = t[6 * n + 2], o.y = t[6 * n + 3], a.x = t[6 * n + 4], 
        a.y = t[6 * n + 5], this.drawTriangle([ s, o, a ], i);
    }, z.Graphics.prototype.lineStyle = function(t, e, i) {
        return this.lineWidth = t || 0, this.lineColor = e || 0, this.lineAlpha = void 0 === i ? 1 : i, 
        this.currentPath && (this.currentPath.shape.points.length ? this.drawShape(new z.Polygon(this.currentPath.shape.points.slice(-2))) : (this.currentPath.lineWidth = this.lineWidth, 
        this.currentPath.lineColor = this.lineColor, this.currentPath.lineAlpha = this.lineAlpha)), 
        this;
    }, z.Graphics.prototype.moveTo = function(t, e) {
        return this.drawShape(new z.Polygon([ t, e ])), this;
    }, z.Graphics.prototype.lineTo = function(t, e) {
        return this.currentPath || this.moveTo(0, 0), this.currentPath.shape.points.push(t, e), 
        this.dirty = !0, this._boundsDirty = !0, this;
    }, z.Graphics.prototype.quadraticCurveTo = function(t, e, i, n) {
        this.currentPath ? 0 === this.currentPath.shape.points.length && (this.currentPath.shape.points = [ 0, 0 ]) : this.moveTo(0, 0);
        var s, o, a = this.currentPath.shape.points;
        0 === a.length && this.moveTo(0, 0);
        for (var r = a[a.length - 2], h = a[a.length - 1], l = 0, c = 1; c <= 20; ++c) s = r + (t - r) * (l = c / 20), 
        o = h + (e - h) * l, a.push(s + (t + (i - t) * l - s) * l, o + (e + (n - e) * l - o) * l);
        return this.dirty = !0, this._boundsDirty = !0, this;
    }, z.Graphics.prototype.bezierCurveTo = function(t, e, i, n, s, o) {
        this.currentPath ? 0 === this.currentPath.shape.points.length && (this.currentPath.shape.points = [ 0, 0 ]) : this.moveTo(0, 0);
        for (var a, r, h, l, c, u = this.currentPath.shape.points, d = u[u.length - 2], p = u[u.length - 1], g = 0, m = 1; m <= 20; ++m) h = (r = (a = 1 - (g = m / 20)) * a) * a, 
        c = (l = g * g) * g, u.push(h * d + 3 * r * g * t + 3 * a * l * i + c * s, h * p + 3 * r * g * e + 3 * a * l * n + c * o);
        return this.dirty = !0, this._boundsDirty = !0, this;
    }, z.Graphics.prototype.arcTo = function(t, e, i, n, s) {
        this.currentPath ? 0 === this.currentPath.shape.points.length && this.currentPath.shape.points.push(t, e) : this.moveTo(t, e);
        var o = this.currentPath.shape.points, a = o[o.length - 2], r = o[o.length - 1] - e, h = a - t, l = n - e, c = i - t, u = Math.abs(r * c - h * l);
        if (u < 1e-8 || 0 === s) o[o.length - 2] === t && o[o.length - 1] === e || o.push(t, e); else {
            var d = r * r + h * h, p = l * l + c * c, g = r * l + h * c, m = s * Math.sqrt(d) / u, f = s * Math.sqrt(p) / u, y = m * g / d, v = f * g / p, b = m * c + f * h, _ = m * l + f * r, S = h * (f + y), x = r * (f + y), w = c * (m + v), A = l * (m + v), P = Math.atan2(x - _, S - b), C = Math.atan2(A - _, w - b);
            this.arc(b + t, _ + e, s, P, C, c * r < h * l);
        }
        return this.dirty = !0, this._boundsDirty = !0, this;
    }, z.Graphics.prototype.arc = function(t, e, i, n, s, o, a) {
        if (n === s) return this;
        void 0 === o && (o = !1), void 0 === a && (a = 40), !o && s <= n ? s += 2 * Math.PI : o && n <= s && (n += 2 * Math.PI);
        var r = o ? -1 * (n - s) : s - n, h = Math.ceil(Math.abs(r) / (2 * Math.PI)) * a;
        if (0 === r) return this;
        var l = t + Math.cos(n) * i, c = e + Math.sin(n) * i;
        o && this.filling ? this.moveTo(t, e) : this.moveTo(l, c);
        for (var u = this.currentPath.shape.points, d = r / (2 * h), p = 2 * d, g = Math.cos(d), m = Math.sin(d), f = h - 1, y = f % 1 / f, v = 0; v <= f; v++) {
            var b = d + n + p * (v + y * v), _ = Math.cos(b), S = -Math.sin(b);
            u.push((g * _ + m * S) * i + t, (g * -S + m * _) * i + e);
        }
        return this.dirty = !0, this._boundsDirty = !0, this;
    }, z.Graphics.prototype.beginFill = function(t, e) {
        return this.filling = !0, this.fillColor = t || 0, this.fillAlpha = void 0 === e ? 1 : e, 
        this.currentPath && this.currentPath.shape.points.length <= 2 && (this.currentPath.fill = this.filling, 
        this.currentPath.fillColor = this.fillColor, this.currentPath.fillAlpha = this.fillAlpha), 
        this;
    }, z.Graphics.prototype.endFill = function() {
        return this.filling = !1, this.fillColor = null, this.fillAlpha = 1, this;
    }, z.Graphics.prototype.drawRect = function(t, e, i, n) {
        return this.drawShape(new z.Rectangle(t, e, i, n)), this;
    }, z.Graphics.prototype.drawRoundedRect = function(t, e, i, n, s) {
        return this.drawShape(new z.RoundedRectangle(t, e, i, n, s)), this;
    }, z.Graphics.prototype.drawCircle = function(t, e, i) {
        return this.drawShape(new z.Circle(t, e, i)), this;
    }, z.Graphics.prototype.drawEllipse = function(t, e, i, n) {
        return this.drawShape({
            x: t,
            y: e,
            width: i,
            height: n,
            type: z.ELLIPSE
        }), this;
    }, z.Graphics.prototype.drawPolygon = function(t) {
        t instanceof z.Polygon && (t = t.points);
        var e = t;
        if (!Array.isArray(e)) {
            e = new Array(arguments.length);
            for (var i = 0; i < e.length; ++i) e[i] = arguments[i];
        }
        return this.drawShape(new z.Polygon(e)), this;
    }, z.Graphics.prototype.clear = function() {
        return this.lineWidth = 0, this.filling = !1, this.dirty = !0, this._boundsDirty = !0, 
        this.clearDirty = !0, this.graphicsData = [], this.updateLocalBounds(), this;
    }, z.Graphics.prototype.generateTexture = function(t, e, i) {
        void 0 === t && (t = 1), void 0 === e && (e = PIXI.scaleModes.DEFAULT), void 0 === i && (i = 0);
        var n = this.getBounds();
        n.width += i, n.height += i;
        var s = new PIXI.CanvasBuffer(n.width * t, n.height * t), o = PIXI.Texture.fromCanvas(s.canvas, e);
        return o.baseTexture.resolution = t, s.context.scale(t, t), s.context.translate(-n.x, -n.y), 
        PIXI.CanvasGraphics.renderGraphics(this, s.context), o;
    }, z.Graphics.prototype._renderWebGL = function(t) {
        if (!1 !== this.visible && 0 !== this.alpha && !0 !== this.isMask) {
            if (this._cacheAsBitmap) return (this.dirty || this.cachedSpriteDirty) && (this._generateCachedSprite(), 
            this.updateCachedSpriteTexture(), this.cachedSpriteDirty = !1, this.dirty = !1), 
            this._cachedSprite.worldAlpha = this.worldAlpha, void PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite, t);
            if (t.spriteBatch.stop(), t.blendModeManager.setBlendMode(this.blendMode), this._mask && t.maskManager.pushMask(this._mask, t), 
            this._filters && t.filterManager.pushFilter(this._filterBlock), this.blendMode !== t.spriteBatch.currentBlendMode) {
                t.spriteBatch.currentBlendMode = this.blendMode;
                var e = PIXI.blendModesWebGL[t.spriteBatch.currentBlendMode];
                t.spriteBatch.gl.blendFunc(e[0], e[1]);
            }
            if (this.webGLDirty && (this.dirty = !0, this.webGLDirty = !1), PIXI.WebGLGraphics.renderGraphics(this, t), 
            this.children.length) {
                t.spriteBatch.start();
                for (var i = 0; i < this.children.length; i++) this.children[i]._renderWebGL(t);
                t.spriteBatch.stop();
            }
            this._filters && t.filterManager.popFilter(), this._mask && t.maskManager.popMask(this.mask, t), 
            t.drawCount++, t.spriteBatch.start();
        }
    }, z.Graphics.prototype._renderCanvas = function(t) {
        if (!1 !== this.visible && 0 !== this.alpha && !0 !== this.isMask) {
            if (this._prevTint !== this.tint && (this.dirty = !0, this._prevTint = this.tint), 
            this._cacheAsBitmap) return (this.dirty || this.cachedSpriteDirty) && (this._generateCachedSprite(), 
            this.updateCachedSpriteTexture(), this.cachedSpriteDirty = !1, this.dirty = !1), 
            this._cachedSprite.alpha = this.alpha, void PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite, t);
            var e = t.context, i = this.worldTransform;
            this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode, e.globalCompositeOperation = PIXI.blendModesCanvas[t.currentBlendMode]), 
            this._mask && t.maskManager.pushMask(this._mask, t);
            var n = t.resolution, s = i.tx * t.resolution + t.shakeX, o = i.ty * t.resolution + t.shakeY;
            e.setTransform(i.a * n, i.b * n, i.c * n, i.d * n, s, o), PIXI.CanvasGraphics.renderGraphics(this, e);
            for (var a = 0; a < this.children.length; a++) this.children[a]._renderCanvas(t);
            this._mask && t.maskManager.popMask(t);
        }
    }, z.Graphics.prototype.getBounds = function(t) {
        if (this._currentBounds) return this._currentBounds;
        if (this.isMask) return z.EmptyRectangle;
        this.dirty && (this.updateLocalBounds(), this.webGLDirty = !0, this.cachedSpriteDirty = !0, 
        this.dirty = !1);
        var e = this._localBounds, i = e.x, n = e.width + e.x, s = e.y, o = e.height + e.y, a = t || this.worldTransform, r = a.a, h = a.b, l = a.c, c = a.d, u = a.tx, d = a.ty, p = r * n + l * o + u, g = c * o + h * n + d, m = r * i + l * o + u, f = c * o + h * i + d, y = r * i + l * s + u, v = c * s + h * i + d, b = r * n + l * s + u, _ = c * s + h * n + d, S = p, x = g, w = p, A = g;
        return w = b < (w = y < (w = m < w ? m : w) ? y : w) ? b : w, A = _ < (A = v < (A = f < A ? f : A) ? v : A) ? _ : A, 
        S = (S = (S = S < m ? m : S) < y ? y : S) < b ? b : S, x = (x = (x = x < f ? f : x) < v ? v : x) < _ ? _ : x, 
        this._bounds.x = w, this._bounds.width = S - w, this._bounds.y = A, this._bounds.height = x - A, 
        this._currentBounds = this._bounds, this._currentBounds;
    }, z.Graphics.prototype.getLocalBounds = function() {
        var t = this.worldTransform;
        this.worldTransform = z.identityMatrix;
        for (var e = 0; e < this.children.length; e++) this.children[e].updateTransform();
        var i = this.getBounds();
        for (this.worldTransform = t, e = 0; e < this.children.length; e++) this.children[e].updateTransform();
        return i;
    }, z.Graphics.prototype.containsPoint = function(t, e) {
        void 0 === e && (e = new z.Point()), this.worldTransform.applyInverse(t, e);
        for (var i = this.graphicsData, n = 0; n < i.length; n++) {
            var s = i[n];
            if (s.fill && (s.shape && s.shape.contains(e.x, e.y))) return !0;
        }
        return !1;
    }, z.Graphics.prototype.getVisualBounds = function(t) {
        return this._boundsDirty && (this.updateLocalBounds(), this._boundsDirty = !1), 
        this._localBounds.clone(t);
    }, z.Graphics.prototype.updateLocalBounds = function() {
        var t = 1 / 0, e = -1 / 0, i = 1 / 0, n = -1 / 0;
        if (this.graphicsData.length) for (var s, o, a, r, h, l, c = 0; c < this.graphicsData.length; c++) {
            var u = this.graphicsData[c], d = u.type, p = u.lineWidth;
            if (s = u.shape, d === z.RECTANGLE || d === z.ROUNDEDRECTANGLE) a = s.x - p / 2, 
            r = s.y - p / 2, t = a < t ? a : t, e = e < a + (h = s.width + p) ? a + h : e, i = r < i ? r : i, 
            n = n < r + (l = s.height + p) ? r + l : n; else if (d === z.CIRCLE) a = s.x, r = s.y, 
            t = a - (h = s.radius + p / 2) < t ? a - h : t, e = e < a + h ? a + h : e, i = r - (l = s.radius + p / 2) < i ? r - l : i, 
            n = n < r + l ? r + l : n; else if (d === z.ELLIPSE) a = s.x, r = s.y, t = a - (h = s.width + p / 2) < t ? a - h : t, 
            e = e < a + h ? a + h : e, i = r - (l = s.height + p / 2) < i ? r - l : i, n = n < r + l ? r + l : n; else {
                o = s.points;
                for (var g = 0; g < o.length; g++) o[g] instanceof z.Point ? (a = o[g].x, r = o[g].y) : (a = o[g], 
                r = o[g + 1], g < o.length - 1 && g++), t = a - p < t ? a - p : t, e = e < a + p ? a + p : e, 
                i = r - p < i ? r - p : i, n = n < r + p ? r + p : n;
            }
        } else n = i = e = t = 0;
        var m = this.boundsPadding;
        this._localBounds.x = t - m, this._localBounds.width = e - t + 2 * m, this._localBounds.y = i - m, 
        this._localBounds.height = n - i + 2 * m;
    }, z.Graphics.prototype._generateCachedSprite = function() {
        var t = this.getLocalBounds();
        if (this._cachedSprite) this._cachedSprite.buffer.resize(t.width, t.height); else {
            var e = new PIXI.CanvasBuffer(t.width, t.height), i = PIXI.Texture.fromCanvas(e.canvas);
            this._cachedSprite = new PIXI.Sprite(i), this._cachedSprite.buffer = e, this._cachedSprite.worldTransform = this.worldTransform;
        }
        this._cachedSprite.anchor.x = -t.x / t.width, this._cachedSprite.anchor.y = -t.y / t.height, 
        this._cachedSprite.buffer.context.translate(-t.x, -t.y), this.worldAlpha = 1, PIXI.CanvasGraphics.renderGraphics(this, this._cachedSprite.buffer.context), 
        this._cachedSprite.alpha = this.alpha;
    }, z.Graphics.prototype.updateCachedSpriteTexture = function() {
        var t = this._cachedSprite, e = t.texture, i = t.buffer.canvas;
        e.baseTexture.width = i.width, e.baseTexture.height = i.height, e.crop.width = e.frame.width = i.width, 
        e.crop.height = e.frame.height = i.height, t._width = i.width, t._height = i.height, 
        e.baseTexture.dirty();
    }, z.Graphics.prototype.destroyCachedSprite = function() {
        this._cachedSprite.texture.destroy(!0), this._cachedSprite = null;
    }, z.Graphics.prototype.drawShape = function(t) {
        this.currentPath && this.currentPath.shape.points.length <= 2 && this.graphicsData.pop(), 
        this.currentPath = null, t instanceof z.Polygon && (t = t.clone()).flatten();
        var e = new z.GraphicsData(this.lineWidth, this.lineColor, this.lineAlpha, this.fillColor, this.fillAlpha, this.filling, t);
        return this.graphicsData.push(e), e.type === z.POLYGON && (e.shape.closed = this.filling, 
        this.currentPath = e), this.dirty = !0, this._boundsDirty = !0, e;
    }, Object.defineProperty(z.Graphics.prototype, "cacheAsBitmap", {
        get: function() {
            return this._cacheAsBitmap;
        },
        set: function(t) {
            this._cacheAsBitmap = t, this._cacheAsBitmap ? this._generateCachedSprite() : this.destroyCachedSprite(), 
            this.dirty = !0, this.webGLDirty = !0;
        }
    }), z.RenderTexture = function(t, e, i, n, s, o, a, r) {
        if (void 0 === e && (e = 100), void 0 === i && (i = 100), void 0 === n && (n = ""), 
        void 0 === s && (s = z.scaleModes.DEFAULT), void 0 === o && (o = 1), void 0 === a && (a = PIXI.defaultRenderer), 
        void 0 === r && (r = 0), this.game = t, this.key = n, this.type = z.RENDERTEXTURE, 
        this._tempMatrix = new z.Matrix(), this.width = e, this.height = i, this.resolution = o, 
        this.frame = new z.Rectangle(0, 0, this.width * this.resolution, this.height * this.resolution), 
        this.crop = this.frame.clone(), this.baseTexture = new PIXI.BaseTexture(), this.baseTexture.width = this.width * this.resolution, 
        this.baseTexture.height = this.height * this.resolution, this.baseTexture._glTextures = [], 
        this.baseTexture.resolution = this.resolution, this.baseTexture.scaleMode = s, this.baseTexture.hasLoaded = !0, 
        PIXI.Texture.call(this, this.baseTexture, this.frame.clone()), this.renderer = a, 
        this.renderer.type === z.WEBGL) {
            var h = this.renderer.gl;
            this.baseTexture.textureIndex = r, this.baseTexture._dirty[h.id] = !1, this.textureBuffer = new PIXI.FilterTexture(h, this.width, this.height, this.baseTexture.scaleMode, r), 
            this.baseTexture._glTextures[h.id] = this.textureBuffer.texture, this.projection = new z.Point(.5 * this.width, .5 * -this.height);
        } else this.textureBuffer = new PIXI.CanvasBuffer(this.width * this.resolution, this.height * this.resolution), 
        this.baseTexture.source = this.textureBuffer.canvas;
        this.valid = !0, this.tempMatrix = new z.Matrix(), this._updateUvs();
    }, z.RenderTexture.prototype = Object.create(PIXI.Texture.prototype), z.RenderTexture.prototype.constructor = z.RenderTexture, 
    z.RenderTexture.prototype.renderXY = function(t, e, i, n) {
        t.updateTransform(), this._tempMatrix.copyFrom(t.worldTransform), this._tempMatrix.tx = e, 
        this._tempMatrix.ty = i, this.renderer.type === z.WEBGL ? this._renderWebGL(t, this._tempMatrix, n) : this._renderCanvas(t, this._tempMatrix, n);
    }, z.RenderTexture.prototype.renderRawXY = function(t, e, i, n) {
        this._tempMatrix.identity().translate(e, i), this.renderer.type === z.WEBGL ? this._renderWebGL(t, this._tempMatrix, n) : this._renderCanvas(t, this._tempMatrix, n);
    }, z.RenderTexture.prototype.render = function(t, e, i) {
        null == e ? this._tempMatrix.copyFrom(t.worldTransform) : this._tempMatrix.copyFrom(e), 
        this.renderer.type === z.WEBGL ? this._renderWebGL(t, this._tempMatrix, i) : this._renderCanvas(t, this._tempMatrix, i);
    }, z.RenderTexture.prototype.resize = function(t, e, i) {
        t === this.width && e === this.height || (this.valid = 0 < t && 0 < e, this.width = t, 
        this.height = e, this.frame.width = this.crop.width = t * this.resolution, this.frame.height = this.crop.height = e * this.resolution, 
        i && (this.baseTexture.width = this.width * this.resolution, this.baseTexture.height = this.height * this.resolution), 
        this.renderer.type === z.WEBGL && (this.projection.x = this.width / 2, this.projection.y = -this.height / 2), 
        this.valid && this.textureBuffer.resize(this.width, this.height));
    }, z.RenderTexture.prototype.clear = function() {
        this.valid && (this.renderer.type === z.WEBGL && this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER, this.textureBuffer.frameBuffer), 
        this.textureBuffer.clear());
    }, z.RenderTexture.prototype._renderWebGL = function(t, e, i) {
        if (this.valid && 0 !== t.alpha) {
            var n = t.worldTransform;
            n.identity(), n.translate(0, 2 * this.projection.y), e && n.append(e), n.scale(1, -1);
            for (var s = 0; s < t.children.length; s++) t.children[s].updateTransform();
            var o = this.renderer.gl;
            o.viewport(0, 0, this.width * this.resolution, this.height * this.resolution), o.bindFramebuffer(o.FRAMEBUFFER, this.textureBuffer.frameBuffer), 
            i && this.textureBuffer.clear(), this.renderer.spriteBatch.dirty = !0, this.renderer.renderDisplayObject(t, this.projection, this.textureBuffer.frameBuffer, e), 
            this.renderer.spriteBatch.dirty = !0, o.bindFramebuffer(o.FRAMEBUFFER, null);
        }
    }, z.RenderTexture.prototype._renderCanvas = function(t, e, i) {
        if (this.valid && 0 !== t.alpha) {
            var n = t.worldTransform;
            n.identity(), e && n.append(e);
            for (var s = 0; s < t.children.length; s++) t.children[s].updateTransform();
            i && this.textureBuffer.clear();
            var o = this.renderer.resolution;
            this.renderer.resolution = this.resolution, this.renderer.renderDisplayObject(t, this.textureBuffer.context, e), 
            this.renderer.resolution = o;
        }
    }, z.RenderTexture.prototype.getImage = function() {
        var t = new Image();
        return t.src = this.getBase64(), t;
    }, z.RenderTexture.prototype.getBase64 = function() {
        return this.getCanvas().toDataURL();
    }, z.RenderTexture.prototype.getCanvas = function() {
        if (this.renderer.type === z.WEBGL) {
            var t = this.renderer.gl, e = this.textureBuffer.width, i = this.textureBuffer.height, n = new Uint8Array(4 * e * i);
            t.bindFramebuffer(t.FRAMEBUFFER, this.textureBuffer.frameBuffer), t.readPixels(0, 0, e, i, t.RGBA, t.UNSIGNED_BYTE, n), 
            t.bindFramebuffer(t.FRAMEBUFFER, null);
            var s = new PIXI.CanvasBuffer(e, i), o = s.context.getImageData(0, 0, e, i);
            return o.data.set(n), s.context.putImageData(o, 0, 0), s.canvas;
        }
        return this.textureBuffer.canvas;
    }, z.Text = function(t, e, i, n, s) {
        e = e || 0, i = i || 0, n = null == n ? "" : n.toString(), this.canvas = z.CanvasPool.create(this), 
        z.Sprite.call(this, t, e, i, PIXI.Texture.fromCanvas(this.canvas)), this.type = z.TEXT, 
        this.physicsType = z.SPRITE, this.padding = new z.Point(), this.textBounds = null, 
        this.context = this.canvas.getContext("2d"), this.colors = [], this.strokeColors = [], 
        this.fontStyles = [], this.fontWeights = [], this.autoRound = !1, this.useAdvancedWrap = !1, 
        this.splitRegExp = /(?:\r\n|\r|\n)/, this.characterLimitSize = -1, this.characterLimitSuffix = "", 
        this._testString = "|MÉq", this._res = t.renderer.resolution, this._text = n, this._fontComponents = null, 
        this._lineSpacing = 0, this._charCount = 0, this._width = 0, this._height = 0, this.style = {}, 
        this.setStyle(s || {}), "" !== n && this.updateText();
    }, z.Text.prototype = Object.create(z.Sprite.prototype), z.Text.prototype.constructor = z.Text, 
    z.Text.prototype.preUpdate = function() {
        return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore();
    }, z.Text.prototype.update = function() {}, z.Text.prototype.destroy = function(t) {
        this.texture.destroy(!0), z.Component.Destroy.prototype.destroy.call(this, t);
    }, z.Text.prototype.setShadow = function(t, e, i, n, s, o) {
        return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = "rgba(0, 0, 0, 1)"), 
        void 0 === n && (n = 0), void 0 === s && (s = !0), void 0 === o && (o = !0), this.style.shadowOffsetX = t, 
        this.style.shadowOffsetY = e, this.style.shadowColor = i, this.style.shadowBlur = n, 
        this.style.shadowStroke = s, this.style.shadowFill = o, this.dirty = !0, this;
    }, z.Text.prototype.setStyle = function(t, e) {
        void 0 === e && (e = !1);
        var i = Object.assign({}, t);
        i.font = t.font || "bold 20pt Arial", i.backgroundColor = t.backgroundColor || null, 
        i.fill = t.fill || "black", i.align = (t.align || "left").toLowerCase(), i.boundsAlignH = (t.boundsAlignH || "left").toLowerCase(), 
        i.boundsAlignV = (t.boundsAlignV || "top").toLowerCase(), i.stroke = t.stroke || "black", 
        i.strokeThickness = Number(t.strokeThickness) || 0, i.wordWrap = t.wordWrap || !1, 
        i.wordWrapWidth = t.wordWrapWidth || 100, i.maxLines = t.maxLines || 0, i.shadowOffsetX = t.shadowOffsetX || 0, 
        i.shadowOffsetY = t.shadowOffsetY || 0, i.shadowColor = t.shadowColor || "rgba(0,0,0,0)", 
        i.shadowBlur = t.shadowBlur || 0, i.tabs = t.tabs || 0;
        var n = this.fontToComponents(i.font);
        return i.fontStyle && (n.fontStyle = i.fontStyle), i.fontVariant && (n.fontVariant = i.fontVariant), 
        i.fontWeight && (n.fontWeight = i.fontWeight), i.fontSize && ("number" == typeof i.fontSize && (i.fontSize = i.fontSize + "px"), 
        n.fontSize = i.fontSize), this._fontComponents = n, i.font = this.componentsToFont(this._fontComponents), 
        this.style = i, this.dirty = !0, e && this.updateText(), this;
    }, z.Text.prototype.updateText = function() {
        this.texture.baseTexture.resolution = this._res, this.context.font = this.style.font;
        var t = this.text;
        -1 < this.characterLimitSize && this.characterLimitSize < t.length && (t = this.text.substring(0, this.characterLimitSize) + this.characterLimitSuffix), 
        this.style.wordWrap && (t = this.runWordWrap(this.text));
        var e = t.split(this.splitRegExp), i = this.style.tabs, n = [], s = 0, o = this.determineFontProperties(this.style.font), a = e.length;
        0 < this.style.maxLines && this.style.maxLines < e.length && (a = this.style.maxLines);
        for (var r = this._charCount = 0; r < a; r++) {
            if (0 === i) {
                var h = this.style.strokeThickness + this.padding.x;
                0 < this.colors.length || 0 < this.strokeColors.length || 0 < this.fontWeights.length || 0 < this.fontStyles.length ? h += this.measureLine(e[r]) : h += this.context.measureText(e[r]).width, 
                this.style.wordWrap && (h -= this.context.measureText(" ").width);
            } else {
                var l = e[r].split(/(?:\t)/);
                h = this.padding.x + this.style.strokeThickness;
                if (Array.isArray(i)) for (var c = 0, u = 0; u < l.length; u++) {
                    var d = 0;
                    d = 0 < this.colors.length || 0 < this.strokeColors.length || 0 < this.fontWeights.length || 0 < this.fontStyles.length ? this.measureLine(l[u]) : Math.ceil(this.context.measureText(l[u]).width), 
                    0 < u && (c += i[u - 1]), h = c + d;
                } else for (u = 0; u < l.length; u++) {
                    0 < this.colors.length || 0 < this.strokeColors.length || 0 < this.fontWeights.length || 0 < this.fontStyles.length ? h += this.measureLine(l[u]) : h += Math.ceil(this.context.measureText(l[u]).width), 
                    h += this.game.math.snapToCeil(h, i) - h;
                }
            }
            n[r] = Math.ceil(h), s = Math.max(s, n[r]);
        }
        this.canvas.width = s * this._res;
        var p, g, m = o.fontSize + this.style.strokeThickness + this.padding.y, f = m * a, y = this._lineSpacing;
        for (y < 0 && Math.abs(y) > m && (y = -m), 0 !== y && (f += 0 < y ? y * e.length : y * (e.length - 1)), 
        this.canvas.height = f * this._res, this.context.scale(this._res, this._res), navigator.isCocoonJS && this.context.clearRect(0, 0, this.canvas.width, this.canvas.height), 
        this.style.backgroundColor && (this.context.fillStyle = this.style.backgroundColor, 
        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)), this.context.fillStyle = this.style.fill, 
        this.context.font = this.style.font, this.context.strokeStyle = this.style.stroke, 
        this.context.textBaseline = "alphabetic", this.context.lineWidth = this.style.strokeThickness, 
        this.context.lineCap = "round", this.context.lineJoin = "round", r = this._charCount = 0; r < a; r++) p = this.style.strokeThickness / 2, 
        g = this.style.strokeThickness / 2 + r * m + o.ascent, 0 < r && (g += y * r), "right" === this.style.align ? p += s - n[r] : "center" === this.style.align && (p += (s - n[r]) / 2), 
        this.autoRound && (p = Math.round(p), g = Math.round(g)), 0 < this.colors.length || 0 < this.strokeColors.length || 0 < this.fontWeights.length || 0 < this.fontStyles.length ? this.updateLine(e[r], p, g) : (this.style.stroke && this.style.strokeThickness && (this.updateShadow(this.style.shadowStroke), 
        0 === i ? this.context.strokeText(e[r], p, g) : this.renderTabLine(e[r], p, g, !1)), 
        this.style.fill && (this.updateShadow(this.style.shadowFill), 0 === i ? this.context.fillText(e[r], p, g) : this.renderTabLine(e[r], p, g, !0)));
        this.updateTexture(), this.dirty = !1;
    }, z.Text.prototype.renderTabLine = function(t, e, i, n) {
        var s = t.split(/(?:\t)/), o = this.style.tabs, a = 0;
        if (Array.isArray(o)) for (var r = 0, h = 0; h < s.length; h++) 0 < h && (r += o[h - 1]), 
        a = e + r, n ? this.context.fillText(s[h], a, i) : this.context.strokeText(s[h], a, i); else for (h = 0; h < s.length; h++) {
            var l = Math.ceil(this.context.measureText(s[h]).width);
            a = this.game.math.snapToCeil(e, o), n ? this.context.fillText(s[h], a, i) : this.context.strokeText(s[h], a, i), 
            e = a + l;
        }
    }, z.Text.prototype.updateShadow = function(t) {
        t ? (this.context.shadowOffsetX = this.style.shadowOffsetX, this.context.shadowOffsetY = this.style.shadowOffsetY, 
        this.context.shadowColor = this.style.shadowColor, this.context.shadowBlur = this.style.shadowBlur) : (this.context.shadowOffsetX = 0, 
        this.context.shadowOffsetY = 0, this.context.shadowColor = 0, this.context.shadowBlur = 0);
    }, z.Text.prototype.measureLine = function(t) {
        for (var e = 0, i = 0; i < t.length; i++) {
            var n = t[i];
            if (0 < this.fontWeights.length || 0 < this.fontStyles.length) {
                var s = this.fontToComponents(this.context.font);
                this.fontStyles[this._charCount] && (s.fontStyle = this.fontStyles[this._charCount]), 
                this.fontWeights[this._charCount] && (s.fontWeight = this.fontWeights[this._charCount]), 
                this.context.font = this.componentsToFont(s);
            }
            this.style.stroke && this.style.strokeThickness && (this.strokeColors[this._charCount] && (this.context.strokeStyle = this.strokeColors[this._charCount]), 
            this.updateShadow(this.style.shadowStroke)), this.style.fill && (this.colors[this._charCount] && (this.context.fillStyle = this.colors[this._charCount]), 
            this.updateShadow(this.style.shadowFill)), e += this.context.measureText(n).width, 
            this._charCount++;
        }
        return Math.ceil(e);
    }, z.Text.prototype.updateLine = function(t, e, i) {
        for (var n = 0; n < t.length; n++) {
            var s = t[n];
            if (0 < this.fontWeights.length || 0 < this.fontStyles.length) {
                var o = this.fontToComponents(this.context.font);
                this.fontStyles[this._charCount] && (o.fontStyle = this.fontStyles[this._charCount]), 
                this.fontWeights[this._charCount] && (o.fontWeight = this.fontWeights[this._charCount]), 
                this.context.font = this.componentsToFont(o);
            }
            this.style.stroke && this.style.strokeThickness && (this.strokeColors[this._charCount] && (this.context.strokeStyle = this.strokeColors[this._charCount]), 
            this.updateShadow(this.style.shadowStroke), this.context.strokeText(s, e, i)), this.style.fill && (this.colors[this._charCount] && (this.context.fillStyle = this.colors[this._charCount]), 
            this.updateShadow(this.style.shadowFill), this.context.fillText(s, e, i)), e += this.context.measureText(s).width, 
            this._charCount++;
        }
    }, z.Text.prototype.clearColors = function() {
        return this.colors = [], this.strokeColors = [], this.dirty = !0, this;
    }, z.Text.prototype.clearFontValues = function() {
        return this.fontStyles = [], this.fontWeights = [], this.dirty = !0, this;
    }, z.Text.prototype.addColor = function(t, e) {
        return this.colors[e] = t, this.dirty = !0, this;
    }, z.Text.prototype.addStrokeColor = function(t, e) {
        return this.strokeColors[e] = t, this.dirty = !0, this;
    }, z.Text.prototype.addFontStyle = function(t, e) {
        return this.fontStyles[e] = t, this.dirty = !0, this;
    }, z.Text.prototype.addFontWeight = function(t, e) {
        return this.fontWeights[e] = t, this.dirty = !0, this;
    }, z.Text.prototype.precalculateWordWrap = function(t) {
        return this.texture.baseTexture.resolution = this._res, this.context.font = this.style.font, 
        this.runWordWrap(t).split(/(?:\r\n|\r|\n)/);
    }, z.Text.prototype.runWordWrap = function(t) {
        return this.useAdvancedWrap ? this.advancedWordWrap(t) : this.basicWordWrap(t);
    }, z.Text.prototype.advancedWordWrap = function(t) {
        for (var e = this.context, i = this.style.wordWrapWidth, n = "", s = t.replace(/ +/gi, " ").split(/\r?\n/gi), o = s.length, a = 0; a < o; a++) {
            var r = s[a], h = "";
            if (r = r.replace(/^ *|\s*$/gi, ""), e.measureText(r).width < i) n += r + "\n"; else {
                for (var l = i, c = r.split(" "), u = 0; u < c.length; u++) {
                    var d = c[u], p = d + " ", g = e.measureText(p).width;
                    if (l < g) {
                        if (0 === u) {
                            for (var m = p; m.length && (m = m.slice(0, -1), !((g = e.measureText(m).width) <= l)); ) ;
                            if (!m.length) throw new Error("This text's wordWrapWidth setting is less than a single character!");
                            var f = d.substr(m.length);
                            c[u] = f, h += m;
                        }
                        var y = c[u].length ? u : u + 1, v = c.slice(y).join(" ").replace(/[ \n]*$/gi, "");
                        s[a + 1] = v + " " + (s[a + 1] || ""), o = s.length;
                        break;
                    }
                    h += p, l -= g;
                }
                n += h.replace(/[ \n]*$/gi, "") + "\n";
            }
        }
        return n = n.replace(/[\s|\n]*$/gi, "");
    }, z.Text.prototype.basicWordWrap = function(t) {
        for (var e = "", i = t.split("\n"), n = 0; n < i.length; n++) {
            for (var s = this.style.wordWrapWidth, o = i[n].split(" "), a = 0; a < o.length; a++) {
                var r = this.context.measureText(o[a]).width, h = r + this.context.measureText(" ").width;
                s < h ? (0 < a && (e += "\n"), e += o[a] + " ", s = this.style.wordWrapWidth - r) : (s -= h, 
                e += o[a] + " ");
            }
            n < i.length - 1 && (e += "\n");
        }
        return e;
    }, z.Text.prototype.updateFont = function(t) {
        var e = this.componentsToFont(t);
        this.style.font !== e && (this.style.font = e, this.dirty = !0, this.parent && this.updateTransform());
    }, z.Text.prototype.fontToComponents = function(t) {
        var e = t.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);
        if (e) {
            var i = e[5].trim();
            return /^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(i) || /['",]/.exec(i) || (i = "'" + i + "'"), 
            {
                font: t,
                fontStyle: e[1] || "normal",
                fontVariant: e[2] || "normal",
                fontWeight: e[3] || "normal",
                fontSize: e[4] || "medium",
                fontFamily: i
            };
        }
        return {
            font: t
        };
    }, z.Text.prototype.componentsToFont = function(t) {
        var e, i = [];
        return (e = t.fontStyle) && "normal" !== e && i.push(e), (e = t.fontVariant) && "normal" !== e && i.push(e), 
        (e = t.fontWeight) && "normal" !== e && i.push(e), (e = t.fontSize) && "medium" !== e && i.push(e), 
        (e = t.fontFamily) && i.push(e), i.length || i.push(t.font), i.join(" ");
    }, z.Text.prototype.setText = function(t, e) {
        return void 0 === e && (e = !1), (t = t.toString() || "") === this._text || (this.text = t, 
        e ? this.updateText() : this.dirty = !0), this;
    }, z.Text.prototype.parseList = function(t) {
        if (!Array.isArray(t)) return this;
        for (var e = "", i = 0; i < t.length; i++) Array.isArray(t[i]) ? (e += t[i].join("\t"), 
        i < t.length - 1 && (e += "\n")) : (e += t[i], i < t.length - 1 && (e += "\t"));
        return this.text = e, this.dirty = !0, this;
    }, z.Text.prototype.setTextBounds = function(t, e, i, n) {
        return void 0 === t ? this.textBounds = null : (this.textBounds ? this.textBounds.setTo(t, e, i, n) : this.textBounds = new z.Rectangle(t, e, i, n), 
        this.style.wordWrapWidth > i && (this.style.wordWrapWidth = i)), this.updateTexture(), 
        this;
    }, z.Text.prototype.updateTexture = function() {
        var t = this.texture.baseTexture, e = this.texture.crop, i = this.texture.frame, n = this.canvas.width, s = this.canvas.height;
        if (t.width = n, t.height = s, e.width = n, e.height = s, i.width = n, i.height = s, 
        this.texture.width = n, this.texture.height = s, this._width = n, this._height = s, 
        this.textBounds) {
            var o = this.textBounds.x, a = this.textBounds.y;
            "right" === this.style.boundsAlignH ? o += this.textBounds.width - this.canvas.width / this.resolution : "center" === this.style.boundsAlignH && (o += this.textBounds.halfWidth - this.canvas.width / this.resolution / 2), 
            "bottom" === this.style.boundsAlignV ? a += this.textBounds.height - this.canvas.height / this.resolution : "middle" === this.style.boundsAlignV && (a += this.textBounds.halfHeight - this.canvas.height / this.resolution / 2), 
            this.pivot.x = -o, this.pivot.y = -a;
        }
        this.renderable = 0 !== n && 0 !== s, this.texture.requiresReTint = !0, this.texture.baseTexture.dirty();
    }, z.Text.prototype._renderWebGL = function(t) {
        this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype._renderWebGL.call(this, t);
    }, z.Text.prototype._renderCanvas = function(t) {
        this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype._renderCanvas.call(this, t);
    }, z.Text.prototype.determineFontProperties = function(t) {
        var e = z.Text.fontPropertiesCache[t], i = this.testString || "|MÉq";
        if (!e) {
            e = {};
            var n = z.Text.fontPropertiesCanvas, s = z.Text.fontPropertiesContext;
            s.font = t;
            var o = Math.ceil(s.measureText(i).width), a = Math.ceil(s.measureText(i).width), r = 2 * a;
            if (a = 1.4 * a | 0, n.width = o, n.height = r, s.fillStyle = "#f00", s.fillRect(0, 0, o, r), 
            s.font = t, s.textBaseline = "alphabetic", s.fillStyle = "#000", s.fillText(i, 0, a), 
            !s.getImageData(0, 0, o, r)) return e.ascent = a, e.descent = a + 6, e.fontSize = e.ascent + e.descent, 
            z.Text.fontPropertiesCache[t] = e;
            var h, l, c = s.getImageData(0, 0, o, r).data, u = c.length, d = 4 * o, p = 0, g = !1;
            for (h = 0; h < a; h++) {
                for (l = 0; l < d; l += 4) if (255 !== c[p + l]) {
                    g = !0;
                    break;
                }
                if (g) break;
                p += d;
            }
            for (e.ascent = a - h, p = u - d, g = !1, h = r; a < h; h--) {
                for (l = 0; l < d; l += 4) if (255 !== c[p + l]) {
                    g = !0;
                    break;
                }
                if (g) break;
                p -= d;
            }
            e.descent = h - a, e.descent += 6, e.fontSize = e.ascent + e.descent, z.Text.fontPropertiesCache[t] = e;
        }
        return e;
    }, z.Text.prototype.getBounds = function(t) {
        return this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype.getBounds.call(this, t);
    }, z.Text.prototype.setCharacterLimit = function(t, e) {
        this.characterLimitSuffix = void 0 === e ? "" : e, this.characterLimitSize = t, 
        this.updateText();
    }, Object.defineProperty(z.Text.prototype, "text", {
        get: function() {
            return this._text;
        },
        set: function(t) {
            t !== this._text && (this._text = t.toString() || "", this.dirty = !0, this.parent && this.updateTransform());
        }
    }), Object.defineProperty(z.Text.prototype, "cssFont", {
        get: function() {
            return this.componentsToFont(this._fontComponents);
        },
        set: function(t) {
            t = t || "bold 20pt Arial", this._fontComponents = this.fontToComponents(t), this.updateFont(this._fontComponents);
        }
    }), Object.defineProperty(z.Text.prototype, "font", {
        get: function() {
            return this._fontComponents.fontFamily;
        },
        set: function(t) {
            t = (t = t || "Arial").trim(), /^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(t) || /['",]/.exec(t) || (t = "'" + t + "'"), 
            this._fontComponents.fontFamily = t, this.updateFont(this._fontComponents);
        }
    }), Object.defineProperty(z.Text.prototype, "fontSize", {
        get: function() {
            var t = this._fontComponents.fontSize;
            return t && /(?:^0$|px$)/.exec(t) ? parseInt(t, 10) : t;
        },
        set: function(t) {
            "number" == typeof (t = t || "0") && (t += "px"), this._fontComponents.fontSize = t, 
            this.updateFont(this._fontComponents);
        }
    }), Object.defineProperty(z.Text.prototype, "fontWeight", {
        get: function() {
            return this._fontComponents.fontWeight || "normal";
        },
        set: function(t) {
            t = t || "normal", this._fontComponents.fontWeight = t, this.updateFont(this._fontComponents);
        }
    }), Object.defineProperty(z.Text.prototype, "fontStyle", {
        get: function() {
            return this._fontComponents.fontStyle || "normal";
        },
        set: function(t) {
            t = t || "normal", this._fontComponents.fontStyle = t, this.updateFont(this._fontComponents);
        }
    }), Object.defineProperty(z.Text.prototype, "fontVariant", {
        get: function() {
            return this._fontComponents.fontVariant || "normal";
        },
        set: function(t) {
            t = t || "normal", this._fontComponents.fontVariant = t, this.updateFont(this._fontComponents);
        }
    }), Object.defineProperty(z.Text.prototype, "fill", {
        get: function() {
            return this.style.fill;
        },
        set: function(t) {
            t !== this.style.fill && (this.style.fill = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "align", {
        get: function() {
            return this.style.align;
        },
        set: function(t) {
            (t = t.toLowerCase()) !== this.style.align && (this.style.align = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "resolution", {
        get: function() {
            return this._res;
        },
        set: function(t) {
            t !== this._res && (this._res = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "tabs", {
        get: function() {
            return this.style.tabs;
        },
        set: function(t) {
            t !== this.style.tabs && (this.style.tabs = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "boundsAlignH", {
        get: function() {
            return this.style.boundsAlignH;
        },
        set: function(t) {
            (t = t.toLowerCase()) !== this.style.boundsAlignH && (this.style.boundsAlignH = t, 
            this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "boundsAlignV", {
        get: function() {
            return this.style.boundsAlignV;
        },
        set: function(t) {
            (t = t.toLowerCase()) !== this.style.boundsAlignV && (this.style.boundsAlignV = t, 
            this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "stroke", {
        get: function() {
            return this.style.stroke;
        },
        set: function(t) {
            t !== this.style.stroke && (this.style.stroke = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "strokeThickness", {
        get: function() {
            return this.style.strokeThickness;
        },
        set: function(t) {
            t !== this.style.strokeThickness && (this.style.strokeThickness = Number(t), this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "wordWrap", {
        get: function() {
            return this.style.wordWrap;
        },
        set: function(t) {
            t !== this.style.wordWrap && (this.style.wordWrap = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "wordWrapWidth", {
        get: function() {
            return this.style.wordWrapWidth;
        },
        set: function(t) {
            t !== this.style.wordWrapWidth && (this.style.wordWrapWidth = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "lineSpacing", {
        get: function() {
            return this._lineSpacing;
        },
        set: function(t) {
            t !== this._lineSpacing && (this._lineSpacing = parseFloat(t), this.dirty = !0, 
            this.parent && this.updateTransform());
        }
    }), Object.defineProperty(z.Text.prototype, "shadowOffsetX", {
        get: function() {
            return this.style.shadowOffsetX;
        },
        set: function(t) {
            t !== this.style.shadowOffsetX && (this.style.shadowOffsetX = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "shadowOffsetY", {
        get: function() {
            return this.style.shadowOffsetY;
        },
        set: function(t) {
            t !== this.style.shadowOffsetY && (this.style.shadowOffsetY = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "shadowColor", {
        get: function() {
            return this.style.shadowColor;
        },
        set: function(t) {
            t !== this.style.shadowColor && (this.style.shadowColor = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "shadowBlur", {
        get: function() {
            return this.style.shadowBlur;
        },
        set: function(t) {
            t !== this.style.shadowBlur && (this.style.shadowBlur = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "shadowStroke", {
        get: function() {
            return this.style.shadowStroke;
        },
        set: function(t) {
            t !== this.style.shadowStroke && (this.style.shadowStroke = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "shadowFill", {
        get: function() {
            return this.style.shadowFill;
        },
        set: function(t) {
            t !== this.style.shadowFill && (this.style.shadowFill = t, this.dirty = !0);
        }
    }), Object.defineProperty(z.Text.prototype, "width", {
        get: function() {
            return this.dirty && (this.updateText(), this.dirty = !1), this.scale.x * (this.texture.frame.width / this.resolution);
        },
        set: function(t) {
            this.scale.x = t / this.texture.frame.width, this._width = t;
        }
    }), Object.defineProperty(z.Text.prototype, "height", {
        get: function() {
            return this.dirty && (this.updateText(), this.dirty = !1), this.scale.y * (this.texture.frame.height / this.resolution);
        },
        set: function(t) {
            this.scale.y = t / this.texture.frame.height, this._height = t;
        }
    }), Object.defineProperty(z.Text.prototype, "testString", {
        get: function() {
            return this._testString;
        },
        set: function(t) {
            this._testString = t, this.updateText();
        }
    }), z.Text.fontPropertiesCache = {}, z.Text.fontPropertiesCanvas = document.createElement("canvas"), 
    z.Text.fontPropertiesContext = z.Text.fontPropertiesCanvas.getContext("2d"), z.BitmapText = function(t, e, i, n, s, o, a) {
        e = e || 0, i = i || 0, n = n || "", s = s || "", o = o || 32, a = a || "left", 
        PIXI.DisplayObjectContainer.call(this), this.type = z.BITMAPTEXT, this.physicsType = z.SPRITE, 
        this.textWidth = 0, this.textHeight = 0, this.anchor = new z.Point(), this._prevAnchor = new z.Point(), 
        this._glyphs = [], this._maxWidth = 0, this._text = s.toString() || "", this._data = t.cache.getBitmapFont(n), 
        this._font = n, this._fontSize = o, this._align = a, this._letterSpacing = 0, this._tint = 16777215, 
        this.updateText(), this.dirty = !1, z.Component.Core.init.call(this, t, e, i, "", null);
    }, z.BitmapText.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), 
    z.BitmapText.prototype.constructor = z.BitmapText, z.Component.Core.install.call(z.BitmapText.prototype, [ "Angle", "AutoCull", "Bounds", "Destroy", "FixedToCamera", "InputEnabled", "InWorld", "LifeSpan", "PhysicsBody", "Reset" ]), 
    z.BitmapText.prototype.preUpdatePhysics = z.Component.PhysicsBody.preUpdate, z.BitmapText.prototype.preUpdateLifeSpan = z.Component.LifeSpan.preUpdate, 
    z.BitmapText.prototype.preUpdateInWorld = z.Component.InWorld.preUpdate, z.BitmapText.prototype.preUpdateCore = z.Component.Core.preUpdate, 
    z.BitmapText.prototype.preUpdate = function() {
        return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore();
    }, z.BitmapText.prototype.postUpdate = function() {
        z.Component.PhysicsBody.postUpdate.call(this), z.Component.FixedToCamera.postUpdate.call(this), 
        this.body && this.body.type === z.Physics.ARCADE && (this.textWidth === this.body.sourceWidth && this.textHeight === this.body.sourceHeight || this.body.setSize(this.textWidth, this.textHeight));
    }, z.BitmapText.prototype.setText = function(t) {
        this.text = t;
    }, z.BitmapText.prototype.scanLine = function(t, e, i) {
        for (var n = 0, s = 0, o = -1, a = 0, r = null, h = 0 < this._maxWidth ? this._maxWidth : null, l = [], c = 0; c < i.length; c++) {
            var u = c === i.length - 1;
            if (/(?:\r\n|\r|\n)/.test(i.charAt(c))) return {
                width: s,
                text: i.substr(0, c),
                end: u,
                chars: l
            };
            var d, p = i.charCodeAt(c), g = t.chars[p];
            void 0 === g && (p = 32, g = t.chars[p]);
            var m = r && g.kerning[r] ? g.kerning[r] : 0;
            if (/(\s)/.test(i.charAt(c)) && (o = c, a = s), d = (m + g.texture.width + g.xOffset) * e, 
            h && h <= s + d && -1 < o) return {
                width: a || s,
                text: i.substr(0, c - (c - o)),
                end: !1,
                chars: l
            };
            s += (g.xAdvance + m + this.letterSpacing) * e, l.push(n + (g.xOffset + m + this.letterSpacing) * e), 
            n += (g.xAdvance + m + this.letterSpacing) * e, r = p;
        }
        return {
            width: s,
            text: i,
            end: u,
            chars: l
        };
    }, z.BitmapText.prototype.cleanText = function(t, e) {
        void 0 === e && (e = "");
        var i = this._data.font;
        if (!i) return "";
        for (var n = t.replace(/\r\n|\n\r|\n|\r/g, "\n").split("\n"), s = 0; s < n.length; s++) {
            for (var o = "", a = n[s], r = 0; r < a.length; r++) o = i.chars[a.charCodeAt(r)] ? o.concat(a[r]) : o.concat(e);
            n[s] = o;
        }
        return n.join("\n");
    }, z.BitmapText.prototype.updateText = function() {
        var t = this._data.font;
        if (t) {
            var e = this.text, i = this._fontSize / t.size, n = [], s = 0;
            this.textWidth = 0;
            do {
                (c = this.scanLine(t, i, e)).y = s, n.push(c), c.width > this.textWidth && (this.textWidth = c.width), 
                s += t.lineHeight * i, e = e.substr(c.text.length + 1);
            } while (!1 === c.end);
            this.textHeight = s;
            for (var o = 0, a = 0, r = this.textWidth * this.anchor.x, h = this.textHeight * this.anchor.y, l = 0; l < n.length; l++) {
                var c = n[l];
                "right" === this._align ? a = this.textWidth - c.width : "center" === this._align && (a = (this.textWidth - c.width) / 2);
                for (var u = 0; u < c.text.length; u++) {
                    var d = c.text.charCodeAt(u), p = t.chars[d];
                    void 0 === p && (d = 32, p = t.chars[d]);
                    var g = this._glyphs[o];
                    g ? g.texture = p.texture : ((g = new PIXI.Sprite(p.texture)).name = c.text[u], 
                    this._glyphs.push(g)), g.position.x = c.chars[u] + a - r, g.position.y = c.y + p.yOffset * i - h, 
                    g.scale.set(i), g.tint = this.tint, g.texture.requiresReTint = !0, g.cachedTint = 16777215, 
                    g.parent || this.addChild(g), o++;
                }
            }
            for (l = o; l < this._glyphs.length; l++) this.removeChild(this._glyphs[l]);
        }
    }, z.BitmapText.prototype.purgeGlyphs = function() {
        for (var t = this._glyphs.length, e = [], i = 0; i < this._glyphs.length; i++) this._glyphs[i].parent !== this ? this._glyphs[i].destroy() : e.push(this._glyphs[i]);
        return this._glyphs = [], this._glyphs = e, this.updateText(), t - e.length;
    }, z.BitmapText.prototype.updateTransform = function() {
        !this.dirty && this.anchor.equals(this._prevAnchor) || (this.updateText(), this.dirty = !1, 
        this._prevAnchor.copyFrom(this.anchor)), PIXI.DisplayObjectContainer.prototype.updateTransform.call(this);
    }, Object.defineProperty(z.BitmapText.prototype, "letterSpacing", {
        get: function() {
            return this._letterSpacing;
        },
        set: function(t) {
            "number" == typeof t && (this._letterSpacing = t, this.updateText());
        }
    }), Object.defineProperty(z.BitmapText.prototype, "align", {
        get: function() {
            return this._align;
        },
        set: function(t) {
            t === this._align || "left" !== t && "center" !== t && "right" !== t || (this._align = t, 
            this.updateText());
        }
    }), Object.defineProperty(z.BitmapText.prototype, "tint", {
        get: function() {
            return this._tint;
        },
        set: function(t) {
            t !== this._tint && (this._tint = t, this.updateText());
        }
    }), Object.defineProperty(z.BitmapText.prototype, "font", {
        get: function() {
            return this._font;
        },
        set: function(t) {
            t !== this._font && (this._font = t.trim(), this._data = this.game.cache.getBitmapFont(this._font), 
            this.updateText());
        }
    }), Object.defineProperty(z.BitmapText.prototype, "fontSize", {
        get: function() {
            return this._fontSize;
        },
        set: function(t) {
            (t = parseInt(t, 10)) !== this._fontSize && 0 < t && (this._fontSize = t, this.updateText());
        }
    }), Object.defineProperty(z.BitmapText.prototype, "text", {
        get: function() {
            return this._text;
        },
        set: function(t) {
            t !== this._text && (this._text = t.toString() || "", this.updateText());
        }
    }), Object.defineProperty(z.BitmapText.prototype, "maxWidth", {
        get: function() {
            return this._maxWidth;
        },
        set: function(t) {
            t !== this._maxWidth && (this._maxWidth = t, this.updateText());
        }
    }), Object.defineProperty(z.BitmapText.prototype, "smoothed", {
        get: function() {
            return !this._data.base.scaleMode;
        },
        set: function(t) {
            this._data.base.scaleMode = t ? 0 : 1, this._data.base.dirty();
        }
    }), z.RetroFont = function(t, e, i, n, s, o, a, r, h, l) {
        if (!t.cache.checkImageKey(e)) return !1;
        null == o && (o = t.cache.getImage(e).width / i), this.characterWidth = i, this.characterHeight = n, 
        this.characterSpacingX = a || 0, this.characterSpacingY = r || 0, this.characterPerRow = o, 
        this.offsetX = h || 0, this.offsetY = l || 0, this.align = "left", this.multiLine = !1, 
        this.autoUpperCase = !0, this.customSpacingX = 0, this.customSpacingY = 0, this.fixedWidth = 0, 
        this.fontSet = t.cache.getImage(e), this._text = "", this.grabData = [], this.frameData = new z.FrameData();
        for (var c = this.offsetX, u = this.offsetY, d = 0, p = 0; p < s.length; p++) {
            var g = this.frameData.addFrame(new z.Frame(p, c, u, this.characterWidth, this.characterHeight));
            this.grabData[s.charCodeAt(p)] = g.index, ++d === this.characterPerRow ? (d = 0, 
            c = this.offsetX, u += this.characterHeight + this.characterSpacingY) : c += this.characterWidth + this.characterSpacingX;
        }
        t.cache.updateFrameData(e, this.frameData), this.stamp = new z.Image(t, 0, 0, e, 0), 
        z.RenderTexture.call(this, t, 100, 100, "", z.scaleModes.NEAREST), this.type = z.RETROFONT;
    }, z.RetroFont.prototype = Object.create(z.RenderTexture.prototype), z.RetroFont.prototype.constructor = z.RetroFont, 
    z.RetroFont.ALIGN_LEFT = "left", z.RetroFont.ALIGN_RIGHT = "right", z.RetroFont.ALIGN_CENTER = "center", 
    z.RetroFont.TEXT_SET1 = " !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~", 
    z.RetroFont.TEXT_SET2 = " !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ", 
    z.RetroFont.TEXT_SET3 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ", z.RetroFont.TEXT_SET4 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789", 
    z.RetroFont.TEXT_SET5 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789", z.RetroFont.TEXT_SET6 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ", 
    z.RetroFont.TEXT_SET7 = "AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39", z.RetroFont.TEXT_SET8 = "0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ", 
    z.RetroFont.TEXT_SET9 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!", z.RetroFont.TEXT_SET10 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ", 
    z.RetroFont.TEXT_SET11 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789", z.RetroFont.prototype.setFixedWidth = function(t, e) {
        void 0 === e && (e = "left"), this.fixedWidth = t, this.align = e;
    }, z.RetroFont.prototype.setText = function(t, e, i, n, s, o) {
        this.multiLine = e || !1, this.customSpacingX = i || 0, this.customSpacingY = n || 0, 
        this.align = s || "left", this.autoUpperCase = !o, 0 < t.length && (this.text = t);
    }, z.RetroFont.prototype.buildRetroFontText = function() {
        var t = 0, e = 0;
        if (this.clear(), this.multiLine) {
            var i = this._text.split("\n");
            0 < this.fixedWidth ? this.resize(this.fixedWidth, i.length * (this.characterHeight + this.customSpacingY) - this.customSpacingY, !0) : this.resize(this.getLongestLine() * (this.characterWidth + this.customSpacingX), i.length * (this.characterHeight + this.customSpacingY) - this.customSpacingY, !0);
            for (var n = 0; n < i.length; n++) t = 0, this.align === z.RetroFont.ALIGN_RIGHT ? t = this.width - i[n].length * (this.characterWidth + this.customSpacingX) : this.align === z.RetroFont.ALIGN_CENTER && (t = this.width / 2 - i[n].length * (this.characterWidth + this.customSpacingX) / 2, 
            t += this.customSpacingX / 2), t < 0 && (t = 0), this.pasteLine(i[n], t, e, this.customSpacingX), 
            e += this.characterHeight + this.customSpacingY;
        } else 0 < this.fixedWidth ? this.resize(this.fixedWidth, this.characterHeight, !0) : this.resize(this._text.length * (this.characterWidth + this.customSpacingX), this.characterHeight, !0), 
        t = 0, this.align === z.RetroFont.ALIGN_RIGHT ? t = this.width - this._text.length * (this.characterWidth + this.customSpacingX) : this.align === z.RetroFont.ALIGN_CENTER && (t = this.width / 2 - this._text.length * (this.characterWidth + this.customSpacingX) / 2, 
        t += this.customSpacingX / 2), t < 0 && (t = 0), this.pasteLine(this._text, t, 0, this.customSpacingX);
        this.requiresReTint = !0;
    }, z.RetroFont.prototype.pasteLine = function(t, e, i, n) {
        for (var s = 0; s < t.length; s++) if (" " === t.charAt(s)) e += this.characterWidth + n; else if (0 <= this.grabData[t.charCodeAt(s)] && (this.stamp.frame = this.grabData[t.charCodeAt(s)], 
        this.renderXY(this.stamp, e, i, !1), (e += this.characterWidth + n) > this.width)) break;
    }, z.RetroFont.prototype.getLongestLine = function() {
        var t = 0;
        if (0 < this._text.length) for (var e = this._text.split("\n"), i = 0; i < e.length; i++) e[i].length > t && (t = e[i].length);
        return t;
    }, z.RetroFont.prototype.removeUnsupportedCharacters = function(t) {
        for (var e = "", i = 0; i < this._text.length; i++) {
            var n = this._text[i], s = n.charCodeAt(0);
            (0 <= this.grabData[s] || !t && "\n" === n) && (e = e.concat(n));
        }
        return e;
    }, z.RetroFont.prototype.updateOffset = function(t, e) {
        if (this.offsetX !== t || this.offsetY !== e) {
            for (var i = t - this.offsetX, n = e - this.offsetY, s = this.game.cache.getFrameData(this.stamp.key).getFrames(), o = s.length; o--; ) s[o].x += i, 
            s[o].y += n;
            this.buildRetroFontText();
        }
    }, Object.defineProperty(z.RetroFont.prototype, "text", {
        get: function() {
            return this._text;
        },
        set: function(t) {
            var e;
            (e = this.autoUpperCase ? t.toUpperCase() : t) !== this._text && (this._text = e, 
            this.removeUnsupportedCharacters(this.multiLine), this.buildRetroFontText());
        }
    }), Object.defineProperty(z.RetroFont.prototype, "smoothed", {
        get: function() {
            return this.stamp.smoothed;
        },
        set: function(t) {
            this.stamp.smoothed = t, this.buildRetroFontText();
        }
    }), z.Rope = function(t, e, i, n, s, o) {
        this.points = o || [], this._hasUpdateAnimation = !1, this._updateAnimationCallback = null, 
        e = e || 0, i = i || 0, n = n || null, s = s || null, this.type = z.ROPE, PIXI.DisplayObjectContainer.call(this), 
        this.texture = z.Cache.DEFAULT, this.uvs = new Float32Array([ 0, 1, 1, 1, 1, 0, 0, 1 ]), 
        this.vertices = new Float32Array([ 0, 0, 100, 0, 100, 100, 0, 100 ]), this.colors = new Float32Array([ 1, 1, 1, 1 ]), 
        this.indices = new Uint16Array([ 0, 1, 2, 3 ]), o && (this.vertices = new Float32Array(4 * o.length), 
        this.uvs = new Float32Array(4 * o.length), this.colors = new Float32Array(2 * o.length), 
        this.indices = new Uint16Array(2 * o.length)), this.dirty = !0, this.canvasPadding = 0, 
        this.drawMode = z.Rope.TRIANGLE_STRIP, z.Component.Core.init.call(this, t, e, i, n, s), 
        this.refresh();
    }, z.Rope.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), z.Rope.prototype.constructor = z.Rope, 
    z.Component.Core.install.call(z.Rope.prototype, [ "Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Delta", "Destroy", "FixedToCamera", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "ScaleMinMax", "Smoothed" ]), 
    z.Rope.prototype.preUpdatePhysics = z.Component.PhysicsBody.preUpdate, z.Rope.prototype.preUpdateLifeSpan = z.Component.LifeSpan.preUpdate, 
    z.Rope.prototype.preUpdateInWorld = z.Component.InWorld.preUpdate, z.Rope.prototype.preUpdateCore = z.Component.Core.preUpdate, 
    z.Rope.TRIANGLE_STRIP = 0, z.Rope.TRIANGLES = 1, z.Rope.prototype.preUpdate = function() {
        return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore();
    }, z.Rope.prototype.update = function() {
        this._hasUpdateAnimation && this.updateAnimation.call(this);
    }, z.Rope.prototype.reset = function(t, e) {
        return z.Component.Reset.prototype.reset.call(this, t, e), this;
    }, z.Rope.prototype.refresh = function() {
        var t = this.points;
        if (!(t.length < 1)) {
            var e = this.uvs, i = this.indices, n = this.colors;
            this.count -= .2, e[0] = 0, e[1] = 0, e[2] = 0, e[3] = 1, n[0] = 1, n[1] = 1, i[0] = 0, 
            i[1] = 1;
            for (var s, o, a = t.length, r = 1; r < a; r++) o = r / (a - 1), e[s = 4 * r] = o, 
            e[s + 1] = 0, e[s + 2] = o, e[s + 3] = 1, n[s = 2 * r] = 1, n[s + 1] = 1, i[s = 2 * r] = s, 
            i[s + 1] = s + 1;
        }
    }, z.Rope.prototype.updateTransform = function() {
        var t = this.points;
        if (!(t.length < 1)) {
            var e, i = t[0], n = {
                x: 0,
                y: 0
            };
            this.count -= .2;
            for (var s, o, a, r, h = this.vertices, l = t.length, c = 0; c < l; c++) s = t[c], 
            o = 4 * c, e = c < t.length - 1 ? t[c + 1] : s, n.y = -(e.x - i.x), n.x = e.y - i.y, 
            1 < 10 * (1 - c / (l - 1)) && 1, a = Math.sqrt(n.x * n.x + n.y * n.y), r = this.texture.height / 2, 
            n.x /= a, n.y /= a, n.x *= r, n.y *= r, h[o] = s.x + n.x, h[o + 1] = s.y + n.y, 
            h[o + 2] = s.x - n.x, h[o + 3] = s.y - n.y, i = s;
            PIXI.DisplayObjectContainer.prototype.updateTransform.call(this);
        }
    }, z.Rope.prototype.setTexture = function(t) {
        this.texture = t;
    }, z.Rope.prototype._renderWebGL = function(t) {
        !this.visible || this.alpha <= 0 || (t.spriteBatch.stop(), this._vertexBuffer || this._initWebGL(t), 
        t.shaderManager.setShader(t.shaderManager.stripShader), this._renderStrip(t), t.spriteBatch.start());
    }, z.Rope.prototype._initWebGL = function(t) {
        var e = t.gl;
        this._vertexBuffer = e.createBuffer(), this._indexBuffer = e.createBuffer(), this._uvBuffer = e.createBuffer(), 
        this._colorBuffer = e.createBuffer(), e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer), 
        e.bufferData(e.ARRAY_BUFFER, this.vertices, e.DYNAMIC_DRAW), e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer), 
        e.bufferData(e.ARRAY_BUFFER, this.uvs, e.STATIC_DRAW), e.bindBuffer(e.ARRAY_BUFFER, this._colorBuffer), 
        e.bufferData(e.ARRAY_BUFFER, this.colors, e.STATIC_DRAW), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer), 
        e.bufferData(e.ELEMENT_ARRAY_BUFFER, this.indices, e.STATIC_DRAW);
    }, z.Rope.prototype._renderStrip = function(t) {
        var e = t.gl, i = t.projection, n = t.offset, s = t.shaderManager.stripShader, o = this.drawMode === z.Rope.TRIANGLE_STRIP ? e.TRIANGLE_STRIP : e.TRIANGLES;
        t.blendModeManager.setBlendMode(this.blendMode), e.uniformMatrix3fv(s.translationMatrix, !1, this.worldTransform.toArray(!0)), 
        e.uniform2f(s.projectionVector, i.x, -i.y), e.uniform2f(s.offsetVector, -n.x, -n.y), 
        e.uniform1f(s.alpha, this.worldAlpha), this.dirty ? (this.dirty = !1, e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer), 
        e.bufferData(e.ARRAY_BUFFER, this.vertices, e.STATIC_DRAW), e.vertexAttribPointer(s.aVertexPosition, 2, e.FLOAT, !1, 0, 0), 
        e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer), e.bufferData(e.ARRAY_BUFFER, this.uvs, e.STATIC_DRAW), 
        e.vertexAttribPointer(s.aTextureCoord, 2, e.FLOAT, !1, 0, 0), e.activeTexture(e.TEXTURE0), 
        this.texture.baseTexture._dirty[e.id] ? t.renderer.updateTexture(this.texture.baseTexture) : e.bindTexture(e.TEXTURE_2D, this.texture.baseTexture._glTextures[e.id]), 
        e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer), e.bufferData(e.ELEMENT_ARRAY_BUFFER, this.indices, e.STATIC_DRAW)) : (e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer), 
        e.bufferSubData(e.ARRAY_BUFFER, 0, this.vertices), e.vertexAttribPointer(s.aVertexPosition, 2, e.FLOAT, !1, 0, 0), 
        e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer), e.vertexAttribPointer(s.aTextureCoord, 2, e.FLOAT, !1, 0, 0), 
        e.activeTexture(e.TEXTURE0), this.texture.baseTexture._dirty[e.id] ? t.renderer.updateTexture(this.texture.baseTexture) : e.bindTexture(e.TEXTURE_2D, this.texture.baseTexture._glTextures[e.id]), 
        e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer)), e.drawElements(o, this.indices.length, e.UNSIGNED_SHORT, 0);
    }, z.Rope.prototype._renderCanvas = function(t) {
        var e = t.context, i = this.worldTransform, n = i.tx * t.resolution + t.shakeX, s = i.ty * t.resolution + t.shakeY;
        t.roundPixels ? e.setTransform(i.a, i.b, i.c, i.d, 0 | n, 0 | s) : e.setTransform(i.a, i.b, i.c, i.d, n, s), 
        this.drawMode === z.Rope.TRIANGLE_STRIP ? this._renderCanvasTriangleStrip(e) : this._renderCanvasTriangles(e);
    }, z.Rope.prototype._renderCanvasTriangleStrip = function(t) {
        var e = this.vertices, i = this.uvs, n = e.length / 2;
        this.count++;
        for (var s = 0; s < n - 2; s++) {
            var o = 2 * s;
            this._renderCanvasDrawTriangle(t, e, i, o, o + 2, o + 4);
        }
    }, z.Rope.prototype._renderCanvasTriangles = function(t) {
        var e = this.vertices, i = this.uvs, n = this.indices, s = n.length;
        this.count++;
        for (var o = 0; o < s; o += 3) {
            var a = 2 * n[o], r = 2 * n[o + 1], h = 2 * n[o + 2];
            this._renderCanvasDrawTriangle(t, e, i, a, r, h);
        }
    }, z.Rope.prototype._renderCanvasDrawTriangle = function(t, e, i, n, s, o) {
        var a = this.texture.baseTexture.source, r = this.texture.width, h = this.texture.height, l = e[n], c = e[s], u = e[o], d = e[n + 1], p = e[s + 1], g = e[o + 1], m = i[n] * r, f = i[s] * r, y = i[o] * r, v = i[n + 1] * h, b = i[s + 1] * h, _ = i[o + 1] * h;
        if (0 < this.canvasPadding) {
            var S = this.canvasPadding / this.worldTransform.a, x = this.canvasPadding / this.worldTransform.d, w = (l + c + u) / 3, A = (d + p + g) / 3, P = l - w, C = d - A, T = Math.sqrt(P * P + C * C);
            l = w + P / T * (T + S), d = A + C / T * (T + x), C = p - A, c = w + (P = c - w) / (T = Math.sqrt(P * P + C * C)) * (T + S), 
            p = A + C / T * (T + x), C = g - A, u = w + (P = u - w) / (T = Math.sqrt(P * P + C * C)) * (T + S), 
            g = A + C / T * (T + x);
        }
        t.save(), t.beginPath(), t.moveTo(l, d), t.lineTo(c, p), t.lineTo(u, g), t.closePath(), 
        t.clip();
        var E = m * b + v * y + f * _ - b * y - v * f - m * _, I = l * b + v * u + c * _ - b * u - v * c - l * _, B = m * c + l * y + f * u - c * y - l * f - m * u, L = m * b * u + v * c * y + l * f * _ - l * b * y - v * f * u - m * c * _, R = d * b + v * g + p * _ - b * g - v * p - d * _, O = m * p + d * y + f * g - p * y - d * f - m * g, M = m * b * g + v * p * y + d * f * _ - d * b * y - v * f * g - m * p * _;
        t.transform(I / E, R / E, B / E, O / E, L / E, M / E), t.drawImage(a, 0, 0), t.restore();
    }, z.Rope.prototype.renderStripFlat = function(t) {
        var e = this.context, i = t.vertices, n = i.length / 2;
        this.count++, e.beginPath();
        for (var s = 1; s < n - 2; s++) {
            var o = 2 * s, a = i[o], r = i[o + 2], h = i[o + 4], l = i[o + 1], c = i[o + 3], u = i[o + 5];
            e.moveTo(a, l), e.lineTo(r, c), e.lineTo(h, u);
        }
        e.fillStyle = "#FF0000", e.fill(), e.closePath();
    }, z.Rope.prototype.getBounds = function(t) {
        for (var e = t || this.worldTransform, i = e.a, n = e.b, s = e.c, o = e.d, a = e.tx, r = e.ty, h = -1 / 0, l = -1 / 0, c = 1 / 0, u = 1 / 0, d = this.vertices, p = 0; p < d.length; p += 2) {
            var g = d[p], m = d[p + 1], f = i * g + s * m + a, y = o * m + n * g + r;
            c = f < c ? f : c, u = y < u ? y : u, h = h < f ? f : h, l = l < y ? y : l;
        }
        if (c === -1 / 0 || l === 1 / 0) return z.EmptyRectangle;
        var v = this._bounds;
        return v.x = c, v.width = h - c, v.y = u, v.height = l - u, this._currentBounds = v;
    }, Object.defineProperty(z.Rope.prototype, "updateAnimation", {
        get: function() {
            return this._updateAnimation;
        },
        set: function(t) {
            t && "function" == typeof t ? (this._hasUpdateAnimation = !0, this._updateAnimation = t) : (this._hasUpdateAnimation = !1, 
            this._updateAnimation = null);
        }
    }), Object.defineProperty(z.Rope.prototype, "segments", {
        get: function() {
            for (var t, e, i, n, s, o, a, r, h = [], l = 0; l < this.points.length; l++) t = 4 * l, 
            e = this.vertices[t] * this.scale.x, i = this.vertices[t + 1] * this.scale.y, n = this.vertices[t + 4] * this.scale.x, 
            s = this.vertices[t + 3] * this.scale.y, o = z.Math.difference(e, n), a = z.Math.difference(i, s), 
            e += this.world.x, i += this.world.y, r = new z.Rectangle(e, i, o, a), h.push(r);
            return h;
        }
    }), z.TileSprite = function(t, e, i, n, s, o, a) {
        e = e || 0, i = i || 0, n = n || 256, s = s || 256, o = o || null, a = a || null, 
        PIXI.Sprite.call(this, new PIXI.Texture(z.Cache.DEFAULT.baseTexture), n, s), this.type = z.TILESPRITE, 
        this.physicsType = z.SPRITE, this._scroll = new z.Point(), this.tileScale = new z.Point(1, 1), 
        this.tileScaleOffset = new z.Point(1, 1), this.tilePosition = new z.Point(), this.textureDebug = !1, 
        this.canvasBuffer = null, this.tilingTexture = null, this.tilePattern = null, this.refreshTexture = !0, 
        this.frameWidth = 0, this.frameHeight = 0, this._width = n, this._height = s, z.Component.Core.init.call(this, t, e, i, o, a);
    }, z.TileSprite.prototype = Object.create(PIXI.Sprite.prototype), z.TileSprite.prototype.constructor = z.TileSprite, 
    z.Component.Core.install.call(z.TileSprite.prototype, [ "Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Destroy", "FixedToCamera", "Health", "InCamera", "InputEnabled", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "Smoothed" ]), 
    z.TileSprite.prototype.preUpdatePhysics = z.Component.PhysicsBody.preUpdate, z.TileSprite.prototype.preUpdateLifeSpan = z.Component.LifeSpan.preUpdate, 
    z.TileSprite.prototype.preUpdateInWorld = z.Component.InWorld.preUpdate, z.TileSprite.prototype.preUpdateCore = z.Component.Core.preUpdate, 
    z.TileSprite.prototype.preUpdate = function() {
        return 0 !== this._scroll.x && (this.tilePosition.x += this._scroll.x * this.game.time.physicsElapsed), 
        0 !== this._scroll.y && (this.tilePosition.y += this._scroll.y * this.game.time.physicsElapsed), 
        !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore();
    }, z.TileSprite.prototype.autoScroll = function(t, e) {
        return this._scroll.set(t, e), this;
    }, z.TileSprite.prototype.stopScroll = function() {
        return this._scroll.set(0, 0), this;
    }, z.TileSprite.prototype.destroy = function(t) {
        z.Component.Destroy.prototype.destroy.call(this, t), PIXI.Sprite.prototype.destroy.call(this), 
        this.canvasBuffer && (this.canvasBuffer.destroy(), this.canvasBuffer = null), this.tileScale = null, 
        this.tileScaleOffset = null, this.tilePosition = null, this.tilingTexture && (this.tilingTexture.destroy(!0), 
        this.tilingTexture = null);
    }, z.TileSprite.prototype.reset = function(t, e) {
        return z.Component.Reset.prototype.reset.call(this, t, e), this.tilePosition.x = 0, 
        this.tilePosition.y = 0, this;
    }, z.TileSprite.prototype.setTexture = function(t) {
        return this.texture !== t && (this.texture = t, this.refreshTexture = !0, this.cachedTint = 16777215), 
        this;
    }, z.TileSprite.prototype._renderWebGL = function(t) {
        if (this.visible && this.renderable && 0 !== this.alpha) {
            if (this._mask && (t.spriteBatch.stop(), t.maskManager.pushMask(this.mask, t), t.spriteBatch.start()), 
            this._filters && (t.spriteBatch.flush(), t.filterManager.pushFilter(this._filterBlock)), 
            this.refreshTexture) {
                if (this.generateTilingTexture(!0, t), !this.tilingTexture) return;
                this.tilingTexture.needsUpdate && (this.tilingTexture.baseTexture.textureIndex = this.texture.baseTexture.textureIndex, 
                t.renderer.updateTexture(this.tilingTexture.baseTexture), this.tilingTexture.needsUpdate = !1);
            }
            t.spriteBatch.renderTilingSprite(this);
            for (var e = 0; e < this.children.length; e++) this.children[e]._renderWebGL(t);
            var i = !1;
            this._filters && (i = !0, t.spriteBatch.stop(), t.filterManager.popFilter()), this._mask && (i || t.spriteBatch.stop(), 
            t.maskManager.popMask(this._mask, t)), i && t.spriteBatch.start();
        }
    }, z.TileSprite.prototype._renderCanvas = function(t) {
        if (this.visible && this.renderable && 0 !== this.alpha) {
            var e = t.context;
            this._mask && t.maskManager.pushMask(this._mask, t), e.globalAlpha = this.worldAlpha;
            var i = this.worldTransform, n = t.resolution, s = i.tx * n + t.shakeX, o = i.ty * n + t.shakeY;
            if (e.setTransform(i.a * n, i.b * n, i.c * n, i.d * n, s, o), 16777215 === this.tint || !this.texture.requiresReTint && this.cachedTint === this.tint || (this.tintedTexture = PIXI.CanvasTinter.getTintedTexture(this, this.tint), 
            this.cachedTint = this.tint, this.texture.requiresReTint = !1, this.refreshTexture = !0), 
            this.refreshTexture) {
                if (this.generateTilingTexture(!1, t), !this.tilingTexture) return;
                this.tilePattern = e.createPattern(this.tilingTexture.baseTexture.source, "repeat");
            }
            var a = t.currentBlendMode;
            this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode, e.globalCompositeOperation = PIXI.blendModesCanvas[t.currentBlendMode]);
            var r = this.tilePosition, h = this.tileScale;
            r.x %= this.tilingTexture.baseTexture.width, r.y %= this.tilingTexture.baseTexture.height, 
            e.scale(h.x, h.y), e.translate(r.x + this.anchor.x * -this._width, r.y + this.anchor.y * -this._height), 
            e.fillStyle = this.tilePattern, s = -r.x, o = -r.y;
            var l = this._width / h.x, c = this._height / h.y;
            t.roundPixels && (s |= 0, o |= 0, l |= 0, c |= 0), e.fillRect(s, o, l, c), e.scale(1 / h.x, 1 / h.y), 
            e.translate(-r.x + this.anchor.x * this._width, -r.y + this.anchor.y * this._height), 
            this._mask && t.maskManager.popMask(t);
            for (var u = 0; u < this.children.length; u++) this.children[u]._renderCanvas(t);
            a !== this.blendMode && (t.currentBlendMode = a, e.globalCompositeOperation = PIXI.blendModesCanvas[a]);
        }
    }, z.TileSprite.prototype.onTextureUpdate = function() {}, z.TileSprite.prototype.generateTilingTexture = function(t) {
        if (this.texture.baseTexture.hasLoaded) {
            var e = this.texture, i = e.frame, n = this._frame.sourceSizeW || this._frame.width, s = this._frame.sourceSizeH || this._frame.height, o = 0, a = 0;
            this._frame.trimmed && (o = this._frame.spriteSourceSizeX, a = this._frame.spriteSourceSizeY), 
            t && (n = z.Math.getNextPowerOfTwo(n), s = z.Math.getNextPowerOfTwo(s)), this.canvasBuffer ? (this.canvasBuffer.resize(n, s), 
            this.tilingTexture.baseTexture.width = n, this.tilingTexture.baseTexture.height = s) : (this.canvasBuffer = new PIXI.CanvasBuffer(n, s), 
            this.tilingTexture = PIXI.Texture.fromCanvas(this.canvasBuffer.canvas), this.tilingTexture.isTiling = !0), 
            this.tilingTexture.needsUpdate = !0, this.textureDebug && (this.canvasBuffer.context.strokeStyle = "#00ff00", 
            this.canvasBuffer.context.strokeRect(0, 0, n, s));
            var r = e.crop.width, h = e.crop.height;
            r === n && h === s || (r = n, h = s);
            var l = this.tintedTexture ? this.tintedTexture : e.baseTexture.source;
            this.canvasBuffer.context.drawImage(l, e.crop.x, e.crop.y, e.crop.width, e.crop.height, o, a, r, h), 
            this.tileScaleOffset.x = i.width / n, this.tileScaleOffset.y = i.height / s, this.refreshTexture = !1, 
            this.tilingTexture.baseTexture._powerOf2 = !0;
        }
    }, z.TileSprite.prototype.getBounds = function() {
        var t = this._width, e = this._height, i = t * (1 - this.anchor.x), n = t * -this.anchor.x, s = e * (1 - this.anchor.y), o = e * -this.anchor.y, a = this.worldTransform, r = a.a, h = a.b, l = a.c, c = a.d, u = a.tx, d = a.ty, p = r * n + l * o + u, g = c * o + h * n + d, m = r * i + l * o + u, f = c * o + h * i + d, y = r * i + l * s + u, v = c * s + h * i + d, b = r * n + l * s + u, _ = c * s + h * n + d, S = -1 / 0, x = -1 / 0, w = 1 / 0, A = 1 / 0;
        w = b < (w = y < (w = m < (w = p < w ? p : w) ? m : w) ? y : w) ? b : w, A = _ < (A = v < (A = f < (A = g < A ? g : A) ? f : A) ? v : A) ? _ : A, 
        S = (S = (S = (S = S < p ? p : S) < m ? m : S) < y ? y : S) < b ? b : S, x = (x = (x = (x = x < g ? g : x) < f ? f : x) < v ? v : x) < _ ? _ : x;
        var P = this._bounds;
        return P.x = w, P.width = S - w, P.y = A, P.height = x - A, this._currentBounds = P;
    }, Object.defineProperty(z.TileSprite.prototype, "width", {
        get: function() {
            return this._width;
        },
        set: function(t) {
            this._width = t;
        }
    }), Object.defineProperty(z.TileSprite.prototype, "height", {
        get: function() {
            return this._height;
        },
        set: function(t) {
            this._height = t;
        }
    }), z.CanvasPool = {
        create: function(t, e, i) {
            var n, s = z.CanvasPool.getFirst();
            if (-1 === s) {
                var o = {
                    parent: t,
                    canvas: document.createElement("canvas")
                };
                z.CanvasPool.pool.push(o), n = o.canvas;
            } else z.CanvasPool.pool[s].parent = t, n = z.CanvasPool.pool[s].canvas;
            return void 0 !== e && (n.width = e, n.height = i), n;
        },
        getFirst: function() {
            for (var t = z.CanvasPool.pool, e = 0; e < t.length; e++) if (!t[e].parent) return e;
            return -1;
        },
        remove: function(t) {
            for (var e = z.CanvasPool.pool, i = 0; i < e.length; i++) e[i].parent === t && (e[i].parent = null, 
            e[i].canvas.width = 1, e[i].canvas.height = 1);
        },
        removeByCanvas: function(t) {
            for (var e = z.CanvasPool.pool, i = 0; i < e.length; i++) e[i].canvas === t && (e[i].parent = null, 
            e[i].canvas.width = 1, e[i].canvas.height = 1);
        },
        getTotal: function() {
            for (var t = z.CanvasPool.pool, e = 0, i = 0; i < t.length; i++) t[i].parent && e++;
            return e;
        },
        getFree: function() {
            for (var t = z.CanvasPool.pool, e = 0, i = 0; i < t.length; i++) t[i].parent || e++;
            return e;
        },
        log: function() {}
    }, z.CanvasPool.pool = [], Object.defineProperty(z.CanvasPool, "length", {
        get: function() {
            return this.pool.length;
        }
    }), z.Device = function() {
        this.deviceReadyAt = 0, this.initialized = !1, this.desktop = !1, this.iOS = !1, 
        this.iOSVersion = 0, this.cocoonJS = !1, this.cocoonJSApp = !1, this.cordova = !1, 
        this.node = !1, this.nodeWebkit = !1, this.electron = !1, this.ejecta = !1, this.crosswalk = !1, 
        this.android = !1, this.chromeOS = !1, this.linux = !1, this.macOS = !1, this.windows = !1, 
        this.windowsPhone = !1, this.canvas = !1, this.canvasBitBltShift = null, this.canHandleAlpha = !1, 
        this.canUseMultiply = !1, this.webGL = !1, this.file = !1, this.fileSystem = !1, 
        this.localStorage = !1, this.worker = !1, this.css3D = !1, this.pointerLock = !1, 
        this.typedArray = !1, this.vibration = !1, this.getUserMedia = !0, this.quirksMode = !1, 
        this.touch = !1, this.mspointer = !1, this.wheelEvent = null, this.arora = !1, this.chrome = !1, 
        this.chromeVersion = 0, this.epiphany = !1, this.firefox = !1, this.firefoxVersion = 0, 
        this.ie = !1, this.ieVersion = 0, this.trident = !1, this.tridentVersion = 0, this.edge = !1, 
        this.mobileSafari = !1, this.midori = !1, this.opera = !1, this.safari = !1, this.safariVersion = 0, 
        this.webApp = !1, this.silk = !1, this.audioData = !1, this.webAudio = !1, this.ogg = !1, 
        this.opus = !1, this.mp3 = !1, this.wav = !1, this.m4a = !1, this.webm = !1, this.dolby = !1, 
        this.oggVideo = !1, this.h264Video = !1, this.mp4Video = !1, this.webmVideo = !1, 
        this.vp9Video = !1, this.hlsVideo = !1, this.iPhone = !1, this.iPhone4 = !1, this.iPad = !1, 
        this.pixelRatio = 0, this.littleEndian = !1, this.LITTLE_ENDIAN = !1, this.support32bit = !1, 
        this.fullscreen = !1, this.requestFullscreen = "", this.cancelFullscreen = "", this.fullscreenKeyboard = !1;
    }, z.Device = new z.Device(), z.Device.onInitialized = new z.Signal(), z.Device.whenReady = function(t, e, i) {
        var n = this._readyCheck;
        if (this.deviceReadyAt || !n) t.call(e, this); else if (n._monitor || i) n._queue = n._queue || [], 
        n._queue.push([ t, e ]); else {
            n._monitor = n.bind(this), n._queue = n._queue || [], n._queue.push([ t, e ]);
            var s = void 0 !== window.cordova, o = navigator.isCocoonJS;
            "complete" === document.readyState || "interactive" === document.readyState ? window.setTimeout(n._monitor, 0) : s && !o ? document.addEventListener("deviceready", n._monitor, !1) : (document.addEventListener("DOMContentLoaded", n._monitor, !1), 
            window.addEventListener("load", n._monitor, !1));
        }
    }, z.Device._readyCheck = function() {
        var t = this._readyCheck;
        if (document.body) {
            if (!this.deviceReadyAt) {
                var e;
                for (this.deviceReadyAt = Date.now(), document.removeEventListener("deviceready", t._monitor), 
                document.removeEventListener("DOMContentLoaded", t._monitor), window.removeEventListener("load", t._monitor), 
                this._initialize(), this.initialized = !0, this.onInitialized.dispatch(this); e = t._queue.shift(); ) {
                    var i = e[0], n = e[1];
                    i.call(n, this);
                }
                this._readyCheck = null, this._initialize = null, this.onInitialized = null;
            }
        } else window.setTimeout(t._monitor, 20);
    }, z.Device._initialize = function() {
        var t, e, i, s = this;
        !function() {
            var t = navigator.userAgent;
            /Playstation Vita/.test(t) ? s.vita = !0 : /Kindle/.test(t) || /\bKF[A-Z][A-Z]+/.test(t) || /Silk.*Mobile Safari/.test(t) ? s.kindle = !0 : /Android/.test(t) ? s.android = !0 : /CrOS/.test(t) ? s.chromeOS = !0 : /iP[ao]d|iPhone/i.test(t) ? (s.iOS = !0, 
            navigator.appVersion.match(/OS (\d+)/), s.iOSVersion = parseInt(RegExp.$1, 10)) : /Linux/.test(t) ? s.linux = !0 : /Mac OS/.test(t) ? s.macOS = !0 : /Windows/.test(t) && (s.windows = !0), 
            (/Windows Phone/i.test(t) || /IEMobile/i.test(t)) && (s.android = !1, s.iOS = !1, 
            s.macOS = !1, s.windows = !0, s.windowsPhone = !0);
            var e = /Silk/.test(t);
            (s.windows || s.macOS || s.linux && !e || s.chromeOS) && (s.desktop = !0), (s.windowsPhone || /Windows NT/i.test(t) && /Touch/i.test(t)) && (s.desktop = !1);
        }(), function() {
            var t = navigator.userAgent;
            if (/Arora/.test(t) ? s.arora = !0 : /Edge\/\d+/.test(t) ? s.edge = !0 : /Chrome\/(\d+)/.test(t) && !s.windowsPhone ? (s.chrome = !0, 
            s.chromeVersion = parseInt(RegExp.$1, 10)) : /Epiphany/.test(t) ? s.epiphany = !0 : /Firefox\D+(\d+)/.test(t) ? (s.firefox = !0, 
            s.firefoxVersion = parseInt(RegExp.$1, 10)) : /AppleWebKit/.test(t) && s.iOS ? s.mobileSafari = !0 : /MSIE (\d+\.\d+);/.test(t) ? (s.ie = !0, 
            s.ieVersion = parseInt(RegExp.$1, 10)) : /Midori/.test(t) ? s.midori = !0 : /Opera/.test(t) ? s.opera = !0 : /Safari\/(\d+)/.test(t) && !s.windowsPhone ? (s.safari = !0, 
            /Version\/(\d+)\./.test(t) && (s.safariVersion = parseInt(RegExp.$1, 10))) : /Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t) && (s.ie = !0, 
            s.trident = !0, s.tridentVersion = parseInt(RegExp.$1, 10), s.ieVersion = parseInt(RegExp.$3, 10)), 
            /Silk/.test(t) && (s.silk = !0), navigator.standalone && (s.webApp = !0), void 0 !== window.cordova && (s.cordova = !0), 
            "undefined" != typeof process && "undefined" != typeof require && (s.node = !0), 
            s.node && "object" == typeof process.versions && (s.nodeWebkit = !!process.versions["node-webkit"], 
            s.electron = !!process.versions.electron), navigator.isCocoonJS && (s.cocoonJS = !0), 
            s.cocoonJS) try {
                s.cocoonJSApp = "undefined" != typeof CocoonJS;
            } catch (t) {
                s.cocoonJSApp = !1;
            }
            void 0 !== window.ejecta && (s.ejecta = !0), /Crosswalk/.test(t) && (s.crosswalk = !0);
        }(), function() {
            s.audioData = !!window.Audio, s.webAudio = !(!window.AudioContext && !window.webkitAudioContext);
            var t = document.createElement("audio");
            try {
                if (t.canPlayType && (t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/, "") && (s.ogg = !0), 
                (t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/, "") || t.canPlayType("audio/opus;").replace(/^no$/, "")) && (s.opus = !0), 
                t.canPlayType("audio/mpeg;").replace(/^no$/, "") && (s.mp3 = !0), t.canPlayType('audio/wav; codecs="1"').replace(/^no$/, "") && (s.wav = !0), 
                (t.canPlayType("audio/x-m4a;") || t.canPlayType("audio/aac;").replace(/^no$/, "")) && (s.m4a = !0), 
                t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/, "") && (s.webm = !0), 
                "" !== t.canPlayType('audio/mp4;codecs="ec-3"'))) if (s.edge) s.dolby = !0; else if (s.safari && 9 <= s.safariVersion && /Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)) {
                    var e = parseInt(RegExp.$1, 10), i = parseInt(RegExp.$2, 10);
                    (10 === e && 11 <= i || 10 < e) && (s.dolby = !0);
                }
            } catch (t) {}
        }(), function() {
            var t = document.createElement("video");
            try {
                t.canPlayType && (t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/, "") && (s.oggVideo = !0), 
                t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/, "") && (s.h264Video = !0, 
                s.mp4Video = !0), t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/, "") && (s.webmVideo = !0), 
                t.canPlayType('video/webm; codecs="vp9"').replace(/^no$/, "") && (s.vp9Video = !0), 
                t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/, "") && (s.hlsVideo = !0));
            } catch (t) {}
        }(), function() {
            var t, e = document.createElement("p"), i = {
                webkitTransform: "-webkit-transform",
                OTransform: "-o-transform",
                msTransform: "-ms-transform",
                MozTransform: "-moz-transform",
                transform: "transform"
            };
            for (var n in document.body.insertBefore(e, null), i) void 0 !== e.style[n] && (e.style[n] = "translate3d(1px,1px,1px)", 
            t = window.getComputedStyle(e).getPropertyValue(i[n]));
            document.body.removeChild(e), s.css3D = void 0 !== t && 0 < t.length && "none" !== t;
        }(), s.pixelRatio = window.devicePixelRatio || 1, s.iPhone = -1 !== navigator.userAgent.toLowerCase().indexOf("iphone"), 
        s.iPhone4 = 2 === s.pixelRatio && s.iPhone, s.iPad = -1 !== navigator.userAgent.toLowerCase().indexOf("ipad"), 
        "undefined" != typeof Int8Array ? s.typedArray = !0 : s.typedArray = !1, "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array && "undefined" != typeof Uint32Array && (s.littleEndian = (t = new ArrayBuffer(4), 
        e = new Uint8Array(t), i = new Uint32Array(t), e[0] = 161, e[1] = 178, e[2] = 195, 
        e[3] = 212, 3569595041 === i[0] || 2712847316 !== i[0] && null), s.LITTLE_ENDIAN = s.littleEndian), 
        s.support32bit = "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8ClampedArray && "undefined" != typeof Int32Array && null !== s.littleEndian && function() {
            if (void 0 === Uint8ClampedArray) return !1;
            var t = z.CanvasPool.create(this, 1, 1).getContext("2d");
            if (!t) return !1;
            var e = t.createImageData(1, 1);
            return z.CanvasPool.remove(this), e.data instanceof Uint8ClampedArray;
        }(), navigator.vibrate = navigator.vibrate || navigator.webkitVibrate || navigator.mozVibrate || navigator.msVibrate, 
        navigator.vibrate && (s.vibration = !0), function() {
            s.canvas = !!window.CanvasRenderingContext2D || s.cocoonJS;
            try {
                s.localStorage = !!localStorage.getItem;
            } catch (t) {
                s.localStorage = !1;
            }
            s.file = !!(window.File && window.FileReader && window.FileList && window.Blob), 
            s.fileSystem = !!window.requestFileSystem, s.webGL = !!window.WebGLRenderingContext, 
            s.worker = !!window.Worker, s.pointerLockElement = ("pointerLockElement" in document ? "pointerLockElement" : "mozPointerLockElement" in document && "mozPointerLockElement") || "webkitPointerLockElement" in document && "webkitPointerLockElement", 
            s.pointerlockchange = ("onpointerlockchange" in document ? "pointerlockchange" : "onmozpointerlockchange" in document && "mozpointerlockchange") || "onwebkitpointerlockchange" in document && "webkitpointerlockchange", 
            s.pointerlockerror = ("onpointerlockerror" in document ? "pointerlockerror" : "onmozpointerlockerror" in document && "mozpointerlockerror") || "onwebkitpointerlockerror" in document && "webkitpointerlockerror", 
            s.pointerLock = !!s.pointerLockElement, s.quirksMode = "CSS1Compat" !== document.compatMode, 
            navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia, 
            window.URL = window.URL || window.webkitURL || window.mozURL || window.msURL, s.getUserMedia = s.getUserMedia && !!navigator.getUserMedia && !!window.URL, 
            s.firefox && s.firefoxVersion < 21 && (s.getUserMedia = !1), !s.iOS && (s.ie || s.firefox || s.chrome) && (s.canvasBitBltShift = !0), 
            (s.safari || s.mobileSafari) && (s.canvasBitBltShift = !1);
        }(), function() {
            var t = z.CanvasPool.create(this, 6, 1), e = t.getContext("2d");
            e.fillStyle = "rgba(10, 20, 30, 0.5)", e.fillRect(0, 0, 1, 1);
            var i = e.getImageData(0, 0, 1, 1);
            if (i) {
                e.putImageData(i, 1, 0);
                var n = e.getImageData(1, 0, 1, 1);
                s.canHandleAlpha = n.data[0] === i.data[0] && n.data[1] === i.data[1] && n.data[2] === i.data[2] && n.data[3] === i.data[3];
            }
            e.globalCompositeOperation = "multiply", s.canUseMultiply = "multiply" === e.globalCompositeOperation, 
            z.CanvasPool.removeByCanvas(t), PIXI.CanvasTinter.tintMethod = s.canUseMultiply ? PIXI.CanvasTinter.tintWithMultiply : PIXI.CanvasTinter.tintWithPerPixel;
        }(), function() {
            for (var t = [ "requestFullscreen", "requestFullScreen", "webkitRequestFullscreen", "webkitRequestFullScreen", "msRequestFullscreen", "msRequestFullScreen", "mozRequestFullScreen", "mozRequestFullscreen" ], e = document.createElement("div"), i = 0; i < t.length; i++) if (e[t[i]]) {
                s.fullscreen = !0, s.requestFullscreen = t[i];
                break;
            }
            var n = [ "cancelFullScreen", "exitFullscreen", "webkitCancelFullScreen", "webkitExitFullscreen", "msCancelFullScreen", "msExitFullscreen", "mozCancelFullScreen", "mozExitFullscreen" ];
            if (s.fullscreen) for (i = 0; i < n.length; i++) if (document[n[i]]) {
                s.cancelFullscreen = n[i];
                break;
            }
            window.Element && Element.ALLOW_KEYBOARD_INPUT && (s.fullscreenKeyboard = !0);
        }(), ("ontouchstart" in document.documentElement || window.navigator.maxTouchPoints && 1 <= window.navigator.maxTouchPoints) && (s.touch = !0), 
        (window.PointerEvent || window.MSPointerEvent || window.navigator.msPointerEnabled || window.navigator.pointerEnabled) && (s.mspointer = !0), 
        s.cocoonJS || ("onwheel" in window || s.ie && "WheelEvent" in window ? s.wheelEvent = "wheel" : "onmousewheel" in window ? s.wheelEvent = "mousewheel" : s.firefox && "MouseScrollEvent" in window && (s.wheelEvent = "DOMMouseScroll"));
    }, z.Device.canPlayAudio = function(t) {
        return !("mp3" !== t || !this.mp3) || (!("ogg" !== t || !this.ogg && !this.opus) || (!("m4a" !== t || !this.m4a) || (!("opus" !== t || !this.opus) || (!("wav" !== t || !this.wav) || (!("webm" !== t || !this.webm) || !("mp4" !== t || !this.dolby))))));
    }, z.Device.canPlayVideo = function(t) {
        return !("webm" !== t || !this.webmVideo && !this.vp9Video) || (!("mp4" !== t || !this.mp4Video && !this.h264Video) || (!("ogg" !== t && "ogv" !== t || !this.oggVideo) || !("mpeg" !== t || !this.hlsVideo)));
    }, z.Device.needsTouchUnlock = function() {
        return !!(!this.cocoonJS && (this.iOS || this.android) || window.PhaserGlobal && window.PhaserGlobal.fakeiOSTouchLock);
    }, z.Device.isAndroidStockBrowser = function() {
        var t = window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);
        return t && t[1] < 537;
    }, z.Canvas = {
        create: function(t, e, i, n, s) {
            e = e || 256, i = i || 256;
            var o = s ? document.createElement("canvas") : z.CanvasPool.create(t, e, i);
            return "string" == typeof n && "" !== n && (o.id = n), o.width = e, o.height = i, 
            o.style.display = "block", o;
        },
        setBackgroundColor: function(t, e) {
            return e = e || "rgb(0,0,0)", t.style.backgroundColor = e, t;
        },
        setTouchAction: function(t, e) {
            return e = e || "none", t.style.msTouchAction = e, t.style["ms-touch-action"] = e, 
            t.style["touch-action"] = e, t;
        },
        setUserSelect: function(t, e) {
            return e = e || "none", t.style["-webkit-touch-callout"] = e, t.style["-webkit-user-select"] = e, 
            t.style["-khtml-user-select"] = e, t.style["-moz-user-select"] = e, t.style["-ms-user-select"] = e, 
            t.style["user-select"] = e, t.style["-webkit-tap-highlight-color"] = "rgba(0, 0, 0, 0)", 
            t;
        },
        addToDOM: function(t, e, i) {
            var n;
            return void 0 === i && (i = !0), e && ("string" == typeof e ? n = document.getElementById(e) : "object" == typeof e && 1 === e.nodeType && (n = e)), 
            n || (n = document.body), i && n.style && (n.style.overflow = "hidden"), n.appendChild(t), 
            t;
        },
        removeFromDOM: function(t) {
            t.parentNode && t.parentNode.removeChild(t);
        },
        setTransform: function(t, e, i, n, s, o, a) {
            return t.setTransform(n, o, a, s, e, i), t;
        },
        setSmoothingEnabled: function(t, e) {
            var i = z.Canvas.getSmoothingPrefix(t);
            return i && (t[i] = e), t;
        },
        getSmoothingPrefix: function(t) {
            var e = [ "i", "webkitI", "msI", "mozI", "oI" ];
            for (var i in e) {
                var n = e[i] + "mageSmoothingEnabled";
                if (n in t) return n;
            }
            return null;
        },
        getSmoothingEnabled: function(t) {
            var e = z.Canvas.getSmoothingPrefix(t);
            if (e) return t[e];
        },
        setImageRenderingCrisp: function(t) {
            for (var e = [ "-webkit-optimize-contrast", "-moz-crisp-edges", "crisp-edges", "pixelated" ], i = 0; i < e.length; i++) t.style["image-rendering"] = e[i];
            return t.style.msInterpolationMode = "nearest-neighbor", t;
        },
        setImageRenderingBicubic: function(t) {
            return t.style["image-rendering"] = "auto", t.style.msInterpolationMode = "bicubic", 
            t;
        }
    }, z.RequestAnimationFrame = function(t, e) {
        void 0 === e && (e = !1), this.game = t, this.isRunning = !1, this.forceSetTimeOut = e;
        for (var i = [ "ms", "moz", "webkit", "o" ], n = 0; n < i.length && !window.requestAnimationFrame; n++) window.requestAnimationFrame = window[i[n] + "RequestAnimationFrame"], 
        window.cancelAnimationFrame = window[i[n] + "CancelAnimationFrame"] || window[i[n] + "CancelRequestAnimationFrame"];
        this._isSetTimeOut = !1, this._onLoop = null, this._timeOutID = null;
    }, z.RequestAnimationFrame.prototype = {
        start: function() {
            this.isRunning = !0;
            var e = this;
            !window.requestAnimationFrame || this.forceSetTimeOut ? (this._isSetTimeOut = !0, 
            this._onLoop = function() {
                return e.updateSetTimeout();
            }, this._timeOutID = window.setTimeout(this._onLoop, 0)) : (this._isSetTimeOut = !1, 
            this._onLoop = function(t) {
                return e.updateRAF(t);
            }, this._timeOutID = window.requestAnimationFrame(this._onLoop));
        },
        updateRAF: function(t) {
            this.isRunning && (this.game.update(Math.floor(t)), this._timeOutID = window.requestAnimationFrame(this._onLoop));
        },
        updateSetTimeout: function() {
            this.isRunning && (this.game.update(Date.now()), this._timeOutID = window.setTimeout(this._onLoop, this.game.time.timeToCall));
        },
        stop: function() {
            this._isSetTimeOut ? clearTimeout(this._timeOutID) : window.cancelAnimationFrame(this._timeOutID), 
            this.isRunning = !1;
        },
        isSetTimeOut: function() {
            return this._isSetTimeOut;
        },
        isRAF: function() {
            return !1 === this._isSetTimeOut;
        }
    }, z.RequestAnimationFrame.prototype.constructor = z.RequestAnimationFrame, z.Math = {
        PI2: 2 * Math.PI,
        HALF_PI: .5 * Math.PI,
        DEG_TO_RAD: Math.PI / 180,
        RAD_TO_DEG: 180 / Math.PI,
        degToRad: function(t) {
            return t * z.Math.DEG_TO_RAD;
        },
        radToDeg: function(t) {
            return t * z.Math.RAD_TO_DEG;
        },
        getNextPowerOfTwo: function(t) {
            if (0 < t && 0 == (t & t - 1)) return t;
            for (var e = 1; e < t; ) e <<= 1;
            return e;
        },
        isPowerOfTwo: function(t, e) {
            return 0 < t && 0 == (t & t - 1) && 0 < e && 0 == (e & e - 1);
        },
        random: function(t, e) {
            if (void 0 === t && (t = 0), void 0 === e && (e = 1), t === e) return t;
            if (e < t) {
                var i = t;
                t = e, e = i;
            }
            return Math.random() * (e - t) + t;
        },
        between: function(t, e) {
            if (void 0 === t && (t = 0), void 0 === e && (e = 1), t === e) return t;
            if (e < t) {
                var i = t;
                t = e, e = i;
            }
            return t = Math.ceil(t), e = Math.floor(e), Math.floor(Math.random() * (e - t + 1)) + t;
        },
        fuzzyEqual: function(t, e, i) {
            return void 0 === i && (i = 1e-4), Math.abs(t - e) < i;
        },
        fuzzyLessThan: function(t, e, i) {
            return void 0 === i && (i = 1e-4), t < e + i;
        },
        fuzzyGreaterThan: function(t, e, i) {
            return void 0 === i && (i = 1e-4), e - i < t;
        },
        fuzzyCeil: function(t, e) {
            return void 0 === e && (e = 1e-4), Math.ceil(t - e);
        },
        fuzzyFloor: function(t, e) {
            return void 0 === e && (e = 1e-4), Math.floor(t + e);
        },
        average: function() {
            for (var t = 0, e = arguments.length, i = 0; i < e; i++) t += +arguments[i];
            return t / e;
        },
        shear: function(t) {
            return t % 1;
        },
        snapTo: function(t, e, i) {
            return void 0 === i && (i = 0), 0 === e ? t : (t -= i, i + (t = e * Math.round(t / e)));
        },
        snapToFloor: function(t, e, i) {
            return void 0 === i && (i = 0), 0 === e ? t : (t -= i, i + (t = e * Math.floor(t / e)));
        },
        snapToCeil: function(t, e, i) {
            return void 0 === i && (i = 0), 0 === e ? t : (t -= i, i + (t = e * Math.ceil(t / e)));
        },
        roundTo: function(t, e, i) {
            void 0 === e && (e = 0), void 0 === i && (i = 10);
            var n = Math.pow(i, -e);
            return Math.round(t * n) / n;
        },
        floorTo: function(t, e, i) {
            void 0 === e && (e = 0), void 0 === i && (i = 10);
            var n = Math.pow(i, -e);
            return Math.floor(t * n) / n;
        },
        ceilTo: function(t, e, i) {
            void 0 === e && (e = 0), void 0 === i && (i = 10);
            var n = Math.pow(i, -e);
            return Math.ceil(t * n) / n;
        },
        trunc: function(t) {
            return isFinite(t) ? t - t % 1 || (t < 0 ? -0 : 0 === t ? t : 0) : t;
        },
        rotateToAngle: function(t, e, i) {
            return void 0 === i && (i = .05), t === e || (Math.abs(e - t) <= i || Math.abs(e - t) >= z.Math.PI2 - i ? t = e : (Math.abs(e - t) > Math.PI && (e < t ? e += z.Math.PI2 : e -= z.Math.PI2), 
            t < e ? t += i : e < t && (t -= i))), t;
        },
        getShortestAngle: function(t, e) {
            var i = e - t;
            return 0 === i ? 0 : i - 360 * Math.floor((i - -180) / 360);
        },
        angleBetween: function(t, e, i, n) {
            return Math.atan2(n - e, i - t);
        },
        angleBetweenY: function(t, e, i, n) {
            return Math.atan2(i - t, n - e);
        },
        angleBetweenPoints: function(t, e) {
            return Math.atan2(e.y - t.y, e.x - t.x);
        },
        angleBetweenPointsY: function(t, e) {
            return Math.atan2(e.x - t.x, e.y - t.y);
        },
        reverseAngle: function(t) {
            return this.normalizeAngle(t + Math.PI, !0);
        },
        normalizeAngle: function(t) {
            return 0 <= (t %= 2 * Math.PI) ? t : t + 2 * Math.PI;
        },
        maxAdd: function(t, e, i) {
            return Math.min(t + e, i);
        },
        minSub: function(t, e, i) {
            return Math.max(t - e, i);
        },
        wrap: function(t, e, i) {
            var n = i - e;
            if (n <= 0) return 0;
            var s = (t - e) % n;
            return s < 0 && (s += n), s + e;
        },
        wrapValue: function(t, e, i) {
            return ((t = Math.abs(t)) + (e = Math.abs(e))) % (i = Math.abs(i));
        },
        isOdd: function(t) {
            return !!(1 & t);
        },
        isEven: function(t) {
            return !(1 & t);
        },
        min: function() {
            if (1 === arguments.length && "object" == typeof arguments[0]) var t = arguments[0]; else t = arguments;
            for (var e = 1, i = 0, n = t.length; e < n; e++) t[e] < t[i] && (i = e);
            return t[i];
        },
        max: function() {
            if (1 === arguments.length && "object" == typeof arguments[0]) var t = arguments[0]; else t = arguments;
            for (var e = 1, i = 0, n = t.length; e < n; e++) t[e] > t[i] && (i = e);
            return t[i];
        },
        minProperty: function(t) {
            if (2 === arguments.length && "object" == typeof arguments[1]) var e = arguments[1]; else e = arguments.slice(1);
            for (var i = 1, n = 0, s = e.length; i < s; i++) e[i][t] < e[n][t] && (n = i);
            return e[n][t];
        },
        maxProperty: function(t) {
            if (2 === arguments.length && "object" == typeof arguments[1]) var e = arguments[1]; else e = arguments.slice(1);
            for (var i = 1, n = 0, s = e.length; i < s; i++) e[i][t] > e[n][t] && (n = i);
            return e[n][t];
        },
        wrapAngle: function(t, e) {
            return e ? this.wrap(t, -Math.PI, Math.PI) : this.wrap(t, -180, 180);
        },
        linearInterpolation: function(t, e) {
            var i = t.length - 1, n = i * e, s = Math.floor(n);
            return e < 0 ? this.linear(t[0], t[1], n) : 1 < e ? this.linear(t[i], t[i - 1], i - n) : this.linear(t[s], t[i < s + 1 ? i : s + 1], n - s);
        },
        bezierInterpolation: function(t, e) {
            for (var i = 0, n = t.length - 1, s = 0; s <= n; s++) i += Math.pow(1 - e, n - s) * Math.pow(e, s) * t[s] * this.bernstein(n, s);
            return i;
        },
        catmullRomInterpolation: function(t, e) {
            var i = t.length - 1, n = i * e, s = Math.floor(n);
            return t[0] === t[i] ? (e < 0 && (s = Math.floor(n = i * (1 + e))), this.catmullRom(t[(s - 1 + i) % i], t[s], t[(s + 1) % i], t[(s + 2) % i], n - s)) : e < 0 ? t[0] - (this.catmullRom(t[0], t[0], t[1], t[1], -n) - t[0]) : 1 < e ? t[i] - (this.catmullRom(t[i], t[i], t[i - 1], t[i - 1], n - i) - t[i]) : this.catmullRom(t[s ? s - 1 : 0], t[s], t[i < s + 1 ? i : s + 1], t[i < s + 2 ? i : s + 2], n - s);
        },
        linear: function(t, e, i) {
            return (e - t) * i + t;
        },
        bernstein: function(t, e) {
            return this.factorial(t) / this.factorial(e) / this.factorial(t - e);
        },
        factorial: function(t) {
            if (0 === t) return 1;
            for (var e = t; --t; ) e *= t;
            return e;
        },
        catmullRom: function(t, e, i, n, s) {
            var o = .5 * (i - t), a = .5 * (n - e), r = s * s;
            return (2 * e - 2 * i + o + a) * (s * r) + (-3 * e + 3 * i - 2 * o - a) * r + o * s + e;
        },
        difference: function(t, e) {
            return Math.abs(t - e);
        },
        roundAwayFromZero: function(t) {
            return 0 < t ? Math.ceil(t) : Math.floor(t);
        },
        sinCosGenerator: function(t, e, i, n) {
            void 0 === e && (e = 1), void 0 === i && (i = 1), void 0 === n && (n = 1);
            for (var s = e, o = i, a = n * Math.PI / t, r = [], h = [], l = 0; l < t; l++) s += (o -= s * a) * a, 
            r[l] = o, h[l] = s;
            return {
                sin: h,
                cos: r,
                length: t
            };
        },
        hypot: function(t, e) {
            return Math.sqrt(t * t + e * e);
        },
        distance: function(t, e, i, n) {
            var s = t - i, o = e - n;
            return Math.sqrt(s * s + o * o);
        },
        distanceSq: function(t, e, i, n) {
            var s = t - i, o = e - n;
            return s * s + o * o;
        },
        distancePow: function(t, e, i, n, s) {
            return void 0 === s && (s = 2), Math.sqrt(Math.pow(i - t, s) + Math.pow(n - e, s));
        },
        clamp: function(t, e, i) {
            return t < e ? e : i < t ? i : t;
        },
        clampBottom: function(t, e) {
            return t < e ? e : t;
        },
        within: function(t, e, i) {
            return Math.abs(t - e) <= i;
        },
        mapLinear: function(t, e, i, n, s) {
            return n + (t - e) * (s - n) / (i - e);
        },
        smoothstep: function(t, e, i) {
            return (t = Math.max(0, Math.min(1, (t - e) / (i - e)))) * t * (3 - 2 * t);
        },
        smootherstep: function(t, e, i) {
            return (t = Math.max(0, Math.min(1, (t - e) / (i - e)))) * t * t * (t * (6 * t - 15) + 10);
        },
        sign: function(t) {
            return t < 0 ? -1 : 0 < t ? 1 : 0;
        },
        percent: function(t, e, i) {
            return void 0 === i && (i = 0), e < t || e < i ? 1 : t < i || t < i ? 0 : (t - i) / e;
        }
    }, z.RandomDataGenerator = function(t) {
        void 0 === t && (t = []), this.c = 1, this.s0 = 0, this.s1 = 0, this.s2 = 0, "string" == typeof t ? this.state(t) : this.sow(t);
    }, z.RandomDataGenerator.prototype = {
        rnd: function() {
            var t = 2091639 * this.s0 + 2.3283064365386963e-10 * this.c;
            return this.c = 0 | t, this.s0 = this.s1, this.s1 = this.s2, this.s2 = t - this.c, 
            this.s2;
        },
        sow: function(t) {
            if (this.s0 = this.hash(" "), this.s1 = this.hash(this.s0), this.s2 = this.hash(this.s1), 
            this.c = 1, t) for (var e = 0; e < t.length && null != t[e]; e++) {
                var i = t[e];
                this.s0 -= this.hash(i), this.s0 += ~~(this.s0 < 0), this.s1 -= this.hash(i), this.s1 += ~~(this.s1 < 0), 
                this.s2 -= this.hash(i), this.s2 += ~~(this.s2 < 0);
            }
        },
        hash: function(t) {
            var e, i, n;
            for (n = 4022871197, t = t.toString(), i = 0; i < t.length; i++) e = .02519603282416938 * (n += t.charCodeAt(i)), 
            e -= n = e >>> 0, n = (e *= n) >>> 0, n += 4294967296 * (e -= n);
            return 2.3283064365386963e-10 * (n >>> 0);
        },
        integer: function() {
            return 4294967296 * this.rnd.apply(this);
        },
        frac: function() {
            return this.rnd.apply(this) + 11102230246251565e-32 * (2097152 * this.rnd.apply(this) | 0);
        },
        real: function() {
            return this.integer() + this.frac();
        },
        integerInRange: function(t, e) {
            return Math.floor(this.realInRange(0, e - t + 1) + t);
        },
        between: function(t, e) {
            return this.integerInRange(t, e);
        },
        realInRange: function(t, e) {
            return this.frac() * (e - t) + t;
        },
        normal: function() {
            return 1 - 2 * this.frac();
        },
        uuid: function() {
            var t = "", e = "";
            for (e = t = ""; t++ < 36; e += ~t % 5 | 3 * t & 4 ? (15 ^ t ? 8 ^ this.frac() * (20 ^ t ? 16 : 4) : 4).toString(16) : "-") ;
            return e;
        },
        pick: function(t) {
            return t[this.integerInRange(0, t.length - 1)];
        },
        sign: function() {
            return this.pick([ -1, 1 ]);
        },
        weightedPick: function(t) {
            return t[~~(Math.pow(this.frac(), 2) * (t.length - 1) + .5)];
        },
        timestamp: function(t, e) {
            return this.realInRange(t || 9466848e5, e || 1577862e6);
        },
        angle: function() {
            return this.integerInRange(-180, 180);
        },
        state: function(t) {
            return "string" == typeof t && t.match(/^!rnd/) && (t = t.split(","), this.c = parseFloat(t[1]), 
            this.s0 = parseFloat(t[2]), this.s1 = parseFloat(t[3]), this.s2 = parseFloat(t[4])), 
            [ "!rnd", this.c, this.s0, this.s1, this.s2 ].join(",");
        }
    }, z.RandomDataGenerator.prototype.constructor = z.RandomDataGenerator, z.QuadTree = function(t, e, i, n, s, o, a) {
        this.maxObjects = 10, this.maxLevels = 4, this.level = 0, this.bounds = {}, this.objects = [], 
        this.nodes = [], this._empty = [], this.reset(t, e, i, n, s, o, a);
    }, z.QuadTree.prototype = {
        reset: function(t, e, i, n, s, o, a) {
            this.maxObjects = s || 10, this.maxLevels = o || 4, this.level = a || 0, this.bounds = {
                x: Math.round(t),
                y: Math.round(e),
                width: i,
                height: n,
                subWidth: Math.floor(i / 2),
                subHeight: Math.floor(n / 2),
                right: Math.round(t) + Math.floor(i / 2),
                bottom: Math.round(e) + Math.floor(n / 2)
            }, this.objects.length = 0, this.nodes.length = 0;
        },
        populate: function(t) {
            t.forEach(this.populateHandler, this, !0);
        },
        populateHandler: function(t) {
            t.body && t.exists && this.insert(t.body);
        },
        split: function() {
            this.nodes[0] = new z.QuadTree(this.bounds.right, this.bounds.y, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), 
            this.nodes[1] = new z.QuadTree(this.bounds.x, this.bounds.y, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), 
            this.nodes[2] = new z.QuadTree(this.bounds.x, this.bounds.bottom, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), 
            this.nodes[3] = new z.QuadTree(this.bounds.right, this.bounds.bottom, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1);
        },
        insert: function(t) {
            var e, i = 0;
            if (null == this.nodes[0] || -1 === (e = this.getIndex(t))) {
                if (this.objects.push(t), this.objects.length > this.maxObjects && this.level < this.maxLevels) for (null == this.nodes[0] && this.split(); i < this.objects.length; ) -1 !== (e = this.getIndex(this.objects[i])) ? this.nodes[e].insert(this.objects.splice(i, 1)[0]) : i++;
            } else this.nodes[e].insert(t);
        },
        getIndex: function(t) {
            var e = -1;
            return t.x < this.bounds.right && t.right < this.bounds.right ? t.y < this.bounds.bottom && t.bottom < this.bounds.bottom ? e = 1 : t.y > this.bounds.bottom && (e = 2) : t.x > this.bounds.right && (t.y < this.bounds.bottom && t.bottom < this.bounds.bottom ? e = 0 : t.y > this.bounds.bottom && (e = 3)), 
            e;
        },
        retrieve: function(t) {
            if (t instanceof z.Rectangle) var e = this.objects, i = this.getIndex(t); else {
                if (!t.body) return this._empty;
                e = this.objects, i = this.getIndex(t.body);
            }
            return this.nodes[0] && (e = -1 !== i ? e.concat(this.nodes[i].retrieve(t)) : (e = (e = (e = e.concat(this.nodes[0].retrieve(t))).concat(this.nodes[1].retrieve(t))).concat(this.nodes[2].retrieve(t))).concat(this.nodes[3].retrieve(t))), 
            e;
        },
        clear: function() {
            this.objects.length = 0;
            for (var t = this.nodes.length; t--; ) this.nodes[t].clear(), this.nodes.splice(t, 1);
            this.nodes.length = 0;
        }
    }, z.QuadTree.prototype.constructor = z.QuadTree, z.Net = function(t) {
        this.game = t;
    }, z.Net.prototype = {
        getHostName: function() {
            return window.location && window.location.hostname ? window.location.hostname : null;
        },
        checkDomainName: function(t) {
            return -1 !== window.location.hostname.indexOf(t);
        },
        updateQueryString: function(t, e, i, n) {
            void 0 === i && (i = !1), void 0 !== n && "" !== n || (n = window.location.href);
            var s = "", o = new RegExp("([?|&])" + t + "=.*?(&|#|$)(.*)", "gi");
            if (o.test(n)) s = null != e ? n.replace(o, "$1" + t + "=" + e + "$2$3") : n.replace(o, "$1$3").replace(/(&|\?)$/, ""); else if (null != e) {
                var a = -1 !== n.indexOf("?") ? "&" : "?", r = n.split("#");
                n = r[0] + a + t + "=" + e, r[1] && (n += "#" + r[1]), s = n;
            } else s = n;
            if (!i) return s;
            window.location.href = s;
        },
        getQueryString: function(t) {
            void 0 === t && (t = "");
            var e = {}, i = location.search.substring(1).split("&");
            for (var n in i) {
                var s = i[n].split("=");
                if (1 < s.length) {
                    if (t && t === this.decodeURI(s[0])) return this.decodeURI(s[1]);
                    e[this.decodeURI(s[0])] = this.decodeURI(s[1]);
                }
            }
            return e;
        },
        decodeURI: function(t) {
            return decodeURIComponent(t.replace(/\+/g, " "));
        }
    }, z.Net.prototype.constructor = z.Net, z.TweenManager = function(t) {
        this.game = t, this.frameBased = !1, this._tweens = [], this._add = [], this.easeMap = {
            Power0: z.Easing.Power0,
            Power1: z.Easing.Power1,
            Power2: z.Easing.Power2,
            Power3: z.Easing.Power3,
            Power4: z.Easing.Power4,
            Linear: z.Easing.Linear.None,
            Quad: z.Easing.Quadratic.Out,
            Cubic: z.Easing.Cubic.Out,
            Quart: z.Easing.Quartic.Out,
            Quint: z.Easing.Quintic.Out,
            Sine: z.Easing.Sinusoidal.Out,
            Expo: z.Easing.Exponential.Out,
            Circ: z.Easing.Circular.Out,
            Elastic: z.Easing.Elastic.Out,
            Back: z.Easing.Back.Out,
            Bounce: z.Easing.Bounce.Out,
            "Quad.easeIn": z.Easing.Quadratic.In,
            "Cubic.easeIn": z.Easing.Cubic.In,
            "Quart.easeIn": z.Easing.Quartic.In,
            "Quint.easeIn": z.Easing.Quintic.In,
            "Sine.easeIn": z.Easing.Sinusoidal.In,
            "Expo.easeIn": z.Easing.Exponential.In,
            "Circ.easeIn": z.Easing.Circular.In,
            "Elastic.easeIn": z.Easing.Elastic.In,
            "Back.easeIn": z.Easing.Back.In,
            "Bounce.easeIn": z.Easing.Bounce.In,
            "Quad.easeOut": z.Easing.Quadratic.Out,
            "Cubic.easeOut": z.Easing.Cubic.Out,
            "Quart.easeOut": z.Easing.Quartic.Out,
            "Quint.easeOut": z.Easing.Quintic.Out,
            "Sine.easeOut": z.Easing.Sinusoidal.Out,
            "Expo.easeOut": z.Easing.Exponential.Out,
            "Circ.easeOut": z.Easing.Circular.Out,
            "Elastic.easeOut": z.Easing.Elastic.Out,
            "Back.easeOut": z.Easing.Back.Out,
            "Bounce.easeOut": z.Easing.Bounce.Out,
            "Quad.easeInOut": z.Easing.Quadratic.InOut,
            "Cubic.easeInOut": z.Easing.Cubic.InOut,
            "Quart.easeInOut": z.Easing.Quartic.InOut,
            "Quint.easeInOut": z.Easing.Quintic.InOut,
            "Sine.easeInOut": z.Easing.Sinusoidal.InOut,
            "Expo.easeInOut": z.Easing.Exponential.InOut,
            "Circ.easeInOut": z.Easing.Circular.InOut,
            "Elastic.easeInOut": z.Easing.Elastic.InOut,
            "Back.easeInOut": z.Easing.Back.InOut,
            "Bounce.easeInOut": z.Easing.Bounce.InOut
        }, this.game.onPause.add(this._pauseAll, this), this.game.onResume.add(this._resumeAll, this);
    }, z.TweenManager.prototype = {
        getAll: function() {
            return this._tweens;
        },
        removeAll: function() {
            for (var t = 0; t < this._tweens.length; t++) this._tweens[t].pendingDelete = !0;
            this._add = [];
        },
        removeFrom: function(t, e) {
            if (void 0 === e && (e = !0), Array.isArray(t)) for (i = 0, n = t.length; i < n; i++) this.removeFrom(t[i]); else if (t.type === z.GROUP && e) for (var i = 0, n = t.children.length; i < n; i++) this.removeFrom(t.children[i]); else {
                for (i = 0, n = this._tweens.length; i < n; i++) t === this._tweens[i].target && this.remove(this._tweens[i]);
                for (i = 0, n = this._add.length; i < n; i++) t === this._add[i].target && this.remove(this._add[i]);
            }
        },
        add: function(t) {
            (t._manager = this)._add.push(t);
        },
        create: function(t) {
            return new z.Tween(t, this.game, this);
        },
        remove: function(t) {
            var e = this._tweens.indexOf(t);
            -1 !== e ? this._tweens[e].pendingDelete = !0 : -1 !== (e = this._add.indexOf(t)) && (this._add[e].pendingDelete = !0);
        },
        update: function() {
            var t = this._add.length, e = this._tweens.length;
            if (0 === e && 0 === t) return !1;
            for (var i = 0; i < e; ) this._tweens[i].update(this.game.time.time) ? i++ : (this._tweens.splice(i, 1), 
            e--);
            return 0 < t && (this._tweens = this._tweens.concat(this._add), this._add.length = 0), 
            !0;
        },
        isTweening: function(e, i) {
            return i || (i = !1), this._tweens.some(function(t) {
                return t.target === e && (!i || t.isRunning && !t.pendingDelete);
            });
        },
        _pauseAll: function() {
            for (var t = this._tweens.length - 1; 0 <= t; t--) this._tweens[t]._pause();
        },
        _resumeAll: function() {
            for (var t = this._tweens.length - 1; 0 <= t; t--) this._tweens[t]._resume();
        },
        pauseAll: function() {
            for (var t = this._tweens.length - 1; 0 <= t; t--) this._tweens[t].pause();
        },
        resumeAll: function() {
            for (var t = this._tweens.length - 1; 0 <= t; t--) this._tweens[t].resume(!0);
        },
        destroy: function() {
            this.game.onPause.remove(this._pauseAll, this), this.game.onResume.remove(this._resumeAll, this), 
            this.game = null, this._add = null, this._tweens = null;
        }
    }, z.TweenManager.prototype.constructor = z.TweenManager, z.Tween = function(t, e, i) {
        this.game = e, this.target = t, this.manager = i, this.timeline = [], this.reverse = !1, 
        this.timeScale = 1, this.repeatCounter = 0, this.pendingDelete = !1, this.onStart = new z.Signal(), 
        this.onLoop = new z.Signal(), this.onRepeat = new z.Signal(), this.onChildComplete = new z.Signal(), 
        this.onComplete = new z.Signal(), this.isRunning = !1, this.current = 0, this.properties = {}, 
        this.chainedTween = null, this.isPaused = !1, this.frameBased = i.frameBased, this._onUpdateCallback = null, 
        this._onUpdateCallbackContext = null, this._pausedTime = 0, this._codePaused = !1, 
        this._hasStarted = !1;
    }, z.Tween.updateColor = function(t) {
        z.Color.updateColor(t.target);
    }, z.Tween.prototype = {
        to: function(t, e, i, n, s, o, a) {
            return (void 0 === e || e <= 0) && (e = 1e3), null == i && (i = z.Easing.Default), 
            void 0 === n && (n = !1), void 0 === s && (s = 0), void 0 === o && (o = 0), void 0 === a && (a = !1), 
            "string" == typeof i && this.manager.easeMap[i] && (i = this.manager.easeMap[i]), 
            this.isRunning || (this.timeline.push(new z.TweenData(this).to(t, e, i, s, o, a)), 
            n && this.start()), this;
        },
        from: function(t, e, i, n, s, o, a) {
            return void 0 === e && (e = 1e3), null == i && (i = z.Easing.Default), void 0 === n && (n = !1), 
            void 0 === s && (s = 0), void 0 === o && (o = 0), void 0 === a && (a = !1), "string" == typeof i && this.manager.easeMap[i] && (i = this.manager.easeMap[i]), 
            this.isRunning || (this.timeline.push(new z.TweenData(this).from(t, e, i, s, o, a)), 
            n && this.start()), this;
        },
        start: function(t) {
            if (void 0 === t && (t = 0), this.pendingDelete) return this;
            if (null === this.game || null === this.target || 0 === this.timeline.length || this.isRunning) return this;
            for (var e = 0; e < this.timeline.length; e++) for (var i in this.timeline[e].vEnd) this.properties[i] = this.target[i] || 0, 
            Array.isArray(this.properties[i]) || (this.properties[i] *= 1);
            for (e = 0; e < this.timeline.length; e++) this.timeline[e].loadValues();
            return this.manager.add(this), this.isRunning = !0, (t < 0 || t > this.timeline.length - 1) && (t = 0), 
            this.current = t, this.timeline[this.current].start(), this;
        },
        stop: function(t) {
            return void 0 === t && (t = !1), this.isRunning = !1, this._onUpdateCallback = null, 
            this._onUpdateCallbackContext = null, t && (this.onComplete.dispatch(this.target, this), 
            this._hasStarted = !1, this.chainedTween && this.chainedTween.start()), this.manager.remove(this), 
            this;
        },
        updateTweenData: function(t, e, i) {
            if (0 === this.timeline.length) return this;
            if (void 0 === i && (i = 0), -1 === i) for (var n = 0; n < this.timeline.length; n++) this.timeline[n][t] = e; else this.timeline[i][t] = e;
            return this;
        },
        delay: function(t, e) {
            return this.updateTweenData("delay", t, e);
        },
        repeat: function(t, e, i) {
            return void 0 === e && (e = 0), this.updateTweenData("repeatCounter", t, i), this.updateTweenData("repeatTotal", t, i), 
            this.updateTweenData("repeatDelay", e, i);
        },
        repeatDelay: function(t, e) {
            return this.updateTweenData("repeatDelay", t, e);
        },
        yoyo: function(t, e, i) {
            return void 0 === e && (e = 0), this.updateTweenData("yoyo", t, i), this.updateTweenData("yoyoDelay", e, i);
        },
        yoyoDelay: function(t, e) {
            return this.updateTweenData("yoyoDelay", t, e);
        },
        easing: function(t, e) {
            return "string" == typeof t && this.manager.easeMap[t] && (t = this.manager.easeMap[t]), 
            this.updateTweenData("easingFunction", t, e);
        },
        interpolation: function(t, e, i) {
            return void 0 === e && (e = z.Math), this.updateTweenData("interpolationFunction", t, i), 
            this.updateTweenData("interpolationContext", e, i);
        },
        repeatAll: function(t) {
            return void 0 === t && (t = 0), this.repeatCounter = t, this;
        },
        chain: function() {
            for (var t = arguments.length; t--; ) 0 < t ? arguments[t - 1].chainedTween = arguments[t] : this.chainedTween = arguments[t];
            return this;
        },
        loop: function(t) {
            return void 0 === t && (t = !0), this.repeatCounter = t ? -1 : 0, this;
        },
        onUpdateCallback: function(t, e) {
            return this._onUpdateCallback = t, this._onUpdateCallbackContext = e, this;
        },
        pause: function() {
            this.isPaused = !0, this._codePaused = !0, this._pausedTime = this.game.time.time;
        },
        _pause: function() {
            this._codePaused || (this.isPaused = !0, this._pausedTime = this.game.time.time);
        },
        resume: function() {
            if (this.isPaused) {
                this.isPaused = !1, this._codePaused = !1;
                for (var t = 0; t < this.timeline.length; t++) this.timeline[t].isRunning || (this.timeline[t].startTime += this.game.time.time - this._pausedTime);
            }
        },
        _resume: function() {
            this._codePaused || this.resume();
        },
        update: function(t) {
            if (this.pendingDelete || !this.target) return !1;
            if (this.isPaused) return !0;
            var e = this.timeline[this.current].update(t);
            if (e === z.TweenData.PENDING) return !0;
            if (e === z.TweenData.RUNNING) return this._hasStarted || (this.onStart.dispatch(this.target, this), 
            this._hasStarted = !0), null !== this._onUpdateCallback && this._onUpdateCallback.call(this._onUpdateCallbackContext, this, this.timeline[this.current].value, this.timeline[this.current]), 
            this.isRunning;
            if (e === z.TweenData.LOOPED) return -1 === this.timeline[this.current].repeatCounter ? this.onLoop.dispatch(this.target, this) : this.onRepeat.dispatch(this.target, this), 
            !0;
            if (e === z.TweenData.COMPLETE) {
                var i = !1;
                return this.reverse ? (this.current--, this.current < 0 && (this.current = this.timeline.length - 1, 
                i = !0)) : (this.current++, this.current === this.timeline.length && (i = !(this.current = 0))), 
                i ? -1 === this.repeatCounter ? (this.timeline[this.current].start(), this.onLoop.dispatch(this.target, this), 
                !0) : 0 < this.repeatCounter ? (this.repeatCounter--, this.timeline[this.current].start(), 
                this.onRepeat.dispatch(this.target, this), !0) : (this.isRunning = !1, this.onComplete.dispatch(this.target, this), 
                this._hasStarted = !1, this.chainedTween && this.chainedTween.start(), !1) : (this.onChildComplete.dispatch(this.target, this), 
                this.timeline[this.current].start(), !0);
            }
        },
        generateData: function(t, e) {
            if (null === this.game || null === this.target) return null;
            void 0 === t && (t = 60), void 0 === e && (e = []);
            for (var i = 0; i < this.timeline.length; i++) for (var n in this.timeline[i].vEnd) this.properties[n] = this.target[n] || 0, 
            Array.isArray(this.properties[n]) || (this.properties[n] *= 1);
            for (i = 0; i < this.timeline.length; i++) this.timeline[i].loadValues();
            for (i = 0; i < this.timeline.length; i++) e = e.concat(this.timeline[i].generateData(t));
            return e;
        }
    }, Object.defineProperty(z.Tween.prototype, "totalDuration", {
        get: function() {
            for (var t = 0, e = 0; e < this.timeline.length; e++) t += this.timeline[e].duration;
            return t;
        }
    }), z.Tween.prototype.constructor = z.Tween, z.TweenData = function(t) {
        this.parent = t, this.game = t.game, this.vStart = {}, this.vStartCache = {}, this.vEnd = {}, 
        this.vEndCache = {}, this.duration = 1e3, this.percent = 0, this.value = 0, this.repeatCounter = 0, 
        this.repeatDelay = 0, this.repeatTotal = 0, this.interpolate = !1, this.yoyo = !1, 
        this.yoyoDelay = 0, this.inReverse = !1, this.delay = 0, this.dt = 0, this.startTime = null, 
        this.easingFunction = z.Easing.Default, this.interpolationFunction = z.Math.linearInterpolation, 
        this.interpolationContext = z.Math, this.isRunning = !1, this.isFrom = !1;
    }, z.TweenData.PENDING = 0, z.TweenData.RUNNING = 1, z.TweenData.LOOPED = 2, z.TweenData.COMPLETE = 3, 
    z.TweenData.prototype = {
        to: function(t, e, i, n, s, o) {
            return this.vEnd = t, this.duration = e, this.easingFunction = i, this.delay = n, 
            this.repeatTotal = s, this.yoyo = o, this.isFrom = !1, this;
        },
        from: function(t, e, i, n, s, o) {
            return this.vEnd = t, this.duration = e, this.easingFunction = i, this.delay = n, 
            this.repeatTotal = s, this.yoyo = o, this.isFrom = !0, this;
        },
        start: function() {
            if (this.startTime = this.game.time.time + this.delay, this.parent.reverse ? this.dt = this.duration : this.dt = 0, 
            0 < this.delay ? this.isRunning = !1 : this.isRunning = !0, this.isFrom) for (var t in this.vStartCache) this.vStart[t] = this.vEndCache[t], 
            this.vEnd[t] = this.vStartCache[t], this.parent.target[t] = this.vStart[t];
            return this.value = 0, this.repeatCounter = this.repeatTotal, this;
        },
        loadValues: function() {
            for (var t in this.parent.properties) {
                if (this.vStart[t] = this.parent.properties[t], Array.isArray(this.vEnd[t])) {
                    if (0 === this.vEnd[t].length) continue;
                    0 === this.percent && (this.vEnd[t] = [ this.vStart[t] ].concat(this.vEnd[t]));
                }
                void 0 !== this.vEnd[t] ? ("string" == typeof this.vEnd[t] && (this.vEnd[t] = this.vStart[t] + parseFloat(this.vEnd[t])), 
                this.parent.properties[t] = this.vEnd[t]) : this.vEnd[t] = this.vStart[t], this.vStartCache[t] = this.vStart[t], 
                this.vEndCache[t] = this.vEnd[t];
            }
            return this;
        },
        update: function(t) {
            if (this.isRunning) {
                if (t < this.startTime) return z.TweenData.RUNNING;
            } else {
                if (!(t >= this.startTime)) return z.TweenData.PENDING;
                this.isRunning = !0;
            }
            var e = this.parent.frameBased ? this.game.time.physicsElapsedMS : this.game.time.elapsedMS;
            for (var i in this.parent.reverse ? (this.dt -= e * this.parent.timeScale, this.dt = Math.max(this.dt, 0)) : (this.dt += e * this.parent.timeScale, 
            this.dt = Math.min(this.dt, this.duration)), this.percent = this.dt / this.duration, 
            this.value = this.easingFunction(this.percent), this.vEnd) {
                var n = this.vStart[i], s = this.vEnd[i];
                Array.isArray(s) ? this.parent.target[i] = this.interpolationFunction.call(this.interpolationContext, s, this.value) : this.parent.target[i] = n + (s - n) * this.value;
            }
            return !this.parent.reverse && 1 === this.percent || this.parent.reverse && 0 === this.percent ? this.repeat() : z.TweenData.RUNNING;
        },
        generateData: function(t) {
            this.parent.reverse ? this.dt = this.duration : this.dt = 0;
            var e = [], i = !1, n = 1 / t * 1e3;
            do {
                this.parent.reverse ? (this.dt -= n, this.dt = Math.max(this.dt, 0)) : (this.dt += n, 
                this.dt = Math.min(this.dt, this.duration)), this.percent = this.dt / this.duration, 
                this.value = this.easingFunction(this.percent);
                var s = {};
                for (var o in this.vEnd) {
                    var a = this.vStart[o], r = this.vEnd[o];
                    Array.isArray(r) ? s[o] = this.interpolationFunction.call(this.interpolationContext, r, this.value) : s[o] = a + (r - a) * this.value;
                }
                e.push(s), (!this.parent.reverse && 1 === this.percent || this.parent.reverse && 0 === this.percent) && (i = !0);
            } while (!i);
            if (this.yoyo) {
                var h = e.slice();
                h.reverse(), e = e.concat(h);
            }
            return e;
        },
        repeat: function() {
            if (this.yoyo) {
                if (this.inReverse && 0 === this.repeatCounter) {
                    for (var t in this.vStartCache) this.vStart[t] = this.vStartCache[t], this.vEnd[t] = this.vEndCache[t];
                    return this.inReverse = !1, z.TweenData.COMPLETE;
                }
                this.inReverse = !this.inReverse;
            } else if (0 === this.repeatCounter) return z.TweenData.COMPLETE;
            if (this.inReverse) for (var t in this.vStartCache) this.vStart[t] = this.vEndCache[t], 
            this.vEnd[t] = this.vStartCache[t]; else {
                for (var t in this.vStartCache) this.vStart[t] = this.vStartCache[t], this.vEnd[t] = this.vEndCache[t];
                0 < this.repeatCounter && this.repeatCounter--;
            }
            return this.startTime = this.game.time.time, this.yoyo && this.inReverse ? this.startTime += this.yoyoDelay : this.inReverse || (this.startTime += this.repeatDelay), 
            this.parent.reverse ? this.dt = this.duration : this.dt = 0, z.TweenData.LOOPED;
        }
    }, z.TweenData.prototype.constructor = z.TweenData, z.Easing = {
        Linear: {
            None: function(t) {
                return t;
            }
        },
        Quadratic: {
            In: function(t) {
                return t * t;
            },
            Out: function(t) {
                return t * (2 - t);
            },
            InOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t : -.5 * (--t * (t - 2) - 1);
            }
        },
        Cubic: {
            In: function(t) {
                return t * t * t;
            },
            Out: function(t) {
                return --t * t * t + 1;
            },
            InOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t : .5 * ((t -= 2) * t * t + 2);
            }
        },
        Quartic: {
            In: function(t) {
                return t * t * t * t;
            },
            Out: function(t) {
                return 1 - --t * t * t * t;
            },
            InOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t * t : -.5 * ((t -= 2) * t * t * t - 2);
            }
        },
        Quintic: {
            In: function(t) {
                return t * t * t * t * t;
            },
            Out: function(t) {
                return --t * t * t * t * t + 1;
            },
            InOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t * t * t : .5 * ((t -= 2) * t * t * t * t + 2);
            }
        },
        Sinusoidal: {
            In: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : 1 - Math.cos(t * Math.PI / 2);
            },
            Out: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : Math.sin(t * Math.PI / 2);
            },
            InOut: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : .5 * (1 - Math.cos(Math.PI * t));
            }
        },
        Exponential: {
            In: function(t) {
                return 0 === t ? 0 : Math.pow(1024, t - 1);
            },
            Out: function(t) {
                return 1 === t ? 1 : 1 - Math.pow(2, -10 * t);
            },
            InOut: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : (t *= 2) < 1 ? .5 * Math.pow(1024, t - 1) : .5 * (2 - Math.pow(2, -10 * (t - 1)));
            }
        },
        Circular: {
            In: function(t) {
                return 1 - Math.sqrt(1 - t * t);
            },
            Out: function(t) {
                return Math.sqrt(1 - --t * t);
            },
            InOut: function(t) {
                return (t *= 2) < 1 ? -.5 * (Math.sqrt(1 - t * t) - 1) : .5 * (Math.sqrt(1 - (t -= 2) * t) + 1);
            }
        },
        Elastic: {
            In: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : (.1, -1 * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - .1) * (2 * Math.PI) / .4));
            },
            Out: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : (.1, 1 * Math.pow(2, -10 * t) * Math.sin((t - .1) * (2 * Math.PI) / .4) + 1);
            },
            InOut: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : (.1, (t *= 2) < 1 ? 1 * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - .1) * (2 * Math.PI) / .4) * -.5 : 1 * Math.pow(2, -10 * (t -= 1)) * Math.sin((t - .1) * (2 * Math.PI) / .4) * .5 + 1);
            }
        },
        Back: {
            In: function(t) {
                return t * t * (2.70158 * t - 1.70158);
            },
            Out: function(t) {
                return --t * t * (2.70158 * t + 1.70158) + 1;
            },
            InOut: function(t) {
                var e = 2.5949095;
                return (t *= 2) < 1 ? t * t * ((e + 1) * t - e) * .5 : .5 * ((t -= 2) * t * ((e + 1) * t + e) + 2);
            }
        },
        Bounce: {
            In: function(t) {
                return 1 - z.Easing.Bounce.Out(1 - t);
            },
            Out: function(t) {
                return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375;
            },
            InOut: function(t) {
                return t < .5 ? .5 * z.Easing.Bounce.In(2 * t) : .5 * z.Easing.Bounce.Out(2 * t - 1) + .5;
            }
        }
    }, z.Easing.Default = z.Easing.Linear.None, z.Easing.Power0 = z.Easing.Linear.None, 
    z.Easing.Power1 = z.Easing.Quadratic.Out, z.Easing.Power2 = z.Easing.Cubic.Out, 
    z.Easing.Power3 = z.Easing.Quartic.Out, z.Easing.Power4 = z.Easing.Quintic.Out, 
    z.Time = function(t) {
        this.game = t, this.time = 0, this.prevTime = 0, this.now = 0, this.elapsed = 0, 
        this.elapsedMS = 0, this.physicsElapsed = 1 / 60, this.physicsElapsedMS = 1 / 60 * 1e3, 
        this.desiredFpsMult = 1 / 60, this._desiredFps = 60, this.suggestedFps = this.desiredFps, 
        this.slowMotion = 1, this.advancedTiming = !1, this.frames = 0, this.updates = 0, 
        this.renders = 0, this.fps = 0, this.ups = 0, this.rps = 0, this.fpsMin = 1e3, this.fpsMax = 0, 
        this.msMin = 1e3, this.msMax = 0, this.pauseDuration = 0, this.timeToCall = 0, this.timeExpected = 0, 
        this.events = new z.Timer(this.game, !1), this._frameCount = 0, this._elapsedAccumulator = 0, 
        this._started = 0, this._timeLastSecond = 0, this._pauseStarted = 0, this._justResumed = !1, 
        this._timers = [];
    }, z.Time.prototype = {
        boot: function() {
            this._started = Date.now(), this.time = Date.now(), this.events.start(), this.timeExpected = this.time;
        },
        add: function(t) {
            return this._timers.push(t), t;
        },
        create: function(t) {
            void 0 === t && (t = !0);
            var e = new z.Timer(this.game, t);
            return this._timers.push(e), e;
        },
        removeAll: function() {
            for (var t = 0; t < this._timers.length; t++) this._timers[t].destroy();
            this._timers = [], this.events.removeAll();
        },
        refresh: function() {
            var t = this.time;
            this.time = Date.now(), this.elapsedMS = this.time - t;
        },
        update: function(t) {
            var e = this.time;
            this.time = Date.now(), this.elapsedMS = this.time - e, this.prevTime = this.now, 
            this.now = t, this.elapsed = this.now - this.prevTime, this.game.raf._isSetTimeOut && (this.timeToCall = Math.floor(Math.max(0, 1e3 / this._desiredFps - (this.timeExpected - t))), 
            this.timeExpected = t + this.timeToCall), this.advancedTiming && this.updateAdvancedTiming(), 
            this.game.paused || (this.events.update(this.time), this._timers.length && this.updateTimers());
        },
        updateTimers: function() {
            for (var t = 0, e = this._timers.length; t < e; ) this._timers[t].update(this.time) ? t++ : (this._timers.splice(t, 1), 
            e--);
        },
        updateAdvancedTiming: function() {
            if (this._frameCount++, this._elapsedAccumulator += this.elapsed, this._frameCount >= 2 * this._desiredFps && (this.suggestedFps = 5 * Math.floor(200 / (this._elapsedAccumulator / this._frameCount)), 
            this._frameCount = 0, this._elapsedAccumulator = 0), this.msMin = Math.min(this.msMin, this.elapsed), 
            this.msMax = Math.max(this.msMax, this.elapsed), this.frames++, this.now > this._timeLastSecond + 1e3) {
                var t = this.now - this._timeLastSecond;
                this.fps = Math.round(1e3 * this.frames / t), this.ups = Math.round(1e3 * this.updates / t), 
                this.rps = Math.round(1e3 * this.renders / t), this.fpsMin = Math.min(this.fpsMin, this.fps), 
                this.fpsMax = Math.max(this.fpsMax, this.fps), this._timeLastSecond = this.now, 
                this.frames = 0, this.updates = 0, this.renders = 0;
            }
        },
        countUpdate: function() {
            this.advancedTiming && this.updates++;
        },
        countRender: function() {
            this.advancedTiming && this.renders++;
        },
        gamePaused: function() {
            this._pauseStarted = Date.now(), this.events.pause();
            for (var t = this._timers.length; t--; ) this._timers[t]._pause();
        },
        gameResumed: function() {
            this.time = Date.now(), this.pauseDuration = this.time - this._pauseStarted, this.events.resume();
            for (var t = this._timers.length; t--; ) this._timers[t]._resume();
        },
        totalElapsedSeconds: function() {
            return .001 * (this.time - this._started);
        },
        elapsedSince: function(t) {
            return this.time - t;
        },
        elapsedSecondsSince: function(t) {
            return .001 * (this.time - t);
        },
        reset: function() {
            this._started = this.time, this.removeAll();
        }
    }, Object.defineProperty(z.Time.prototype, "desiredFps", {
        get: function() {
            return this._desiredFps;
        },
        set: function(t) {
            this._desiredFps = t, this.physicsElapsed = 1 / t, this.physicsElapsedMS = 1e3 * this.physicsElapsed, 
            this.desiredFpsMult = 1 / t;
        }
    }), z.Time.prototype.constructor = z.Time, z.Timer = function(t, e) {
        void 0 === e && (e = !0), this.game = t, this.running = !1, this.autoDestroy = e, 
        this.expired = !1, this.elapsed = 0, this.events = [], this.onComplete = new z.Signal(), 
        this.nextTick = 0, this.timeCap = 1e3, this.paused = !1, this._codePaused = !1, 
        this._started = 0, this._pauseStarted = 0, this._pauseTotal = 0, this._now = Date.now(), 
        this._len = 0, this._marked = 0, this._i = 0, this._diff = 0, this._newTick = 0;
    }, z.Timer.MINUTE = 6e4, z.Timer.SECOND = 1e3, z.Timer.HALF = 500, z.Timer.QUARTER = 250, 
    z.Timer.prototype = {
        create: function(t, e, i, n, s, o) {
            var a = t = Math.round(t);
            0 === this._now ? a += this.game.time.time : a += this._now;
            var r = new z.TimerEvent(this, t, a, i, e, n, s, o);
            return this.events.push(r), this.order(), this.expired = !1, r;
        },
        add: function(t, e, i) {
            return this.create(t, !1, 0, e, i, Array.prototype.slice.call(arguments, 3));
        },
        repeat: function(t, e, i, n) {
            return this.create(t, !1, e, i, n, Array.prototype.slice.call(arguments, 4));
        },
        loop: function(t, e, i) {
            return this.create(t, !0, 0, e, i, Array.prototype.slice.call(arguments, 3));
        },
        start: function(t) {
            if (!this.running) {
                this._started = this.game.time.time + (t || 0), this.running = !0;
                for (var e = 0; e < this.events.length; e++) this.events[e].tick = this.events[e].delay + this._started;
            }
        },
        stop: function(t) {
            this.running = !1, void 0 === t && (t = !0), t && (this.events.length = 0);
        },
        remove: function(t) {
            for (var e = 0; e < this.events.length; e++) if (this.events[e] === t) return this.events[e].pendingDelete = !0;
            return !1;
        },
        order: function() {
            0 < this.events.length && (this.events.sort(this.sortHandler), this.nextTick = this.events[0].tick);
        },
        sortHandler: function(t, e) {
            return t.tick < e.tick ? -1 : t.tick > e.tick ? 1 : 0;
        },
        clearPendingEvents: function() {
            for (this._i = this.events.length; this._i--; ) this.events[this._i].pendingDelete && this.events.splice(this._i, 1);
            this._len = this.events.length, this._i = 0;
        },
        update: function(t) {
            if (this.paused) return !0;
            if (this.elapsed = t - this._now, this._now = t, this.elapsed > this.timeCap && this.adjustEvents(t - this.elapsed), 
            this._marked = 0, this.clearPendingEvents(), this.running && this._now >= this.nextTick && 0 < this._len) {
                for (;this._i < this._len && this.running; ) {
                    var e = this.events[this._i];
                    if (!(this._now >= e.tick) || e.pendingDelete) break;
                    this._newTick = this._now + e.delay - (this._now - e.tick), this._newTick < 0 && (this._newTick = this._now + e.delay), 
                    !0 === e.loop ? e.tick = this._newTick : 0 < e.repeatCount ? (e.repeatCount--, e.tick = this._newTick) : (this._marked++, 
                    e.pendingDelete = !0), e.callback.apply(e.callbackContext, e.args), this._i++;
                }
                this.events.length > this._marked ? this.order() : (this.expired = !0, this.onComplete.dispatch(this));
            }
            return !this.expired || !this.autoDestroy;
        },
        pause: function() {
            this.running && (this._codePaused = !0, this.paused || (this._pauseStarted = this.game.time.time, 
            this.paused = !0));
        },
        _pause: function() {
            !this.paused && this.running && (this._pauseStarted = this.game.time.time, this.paused = !0);
        },
        adjustEvents: function(t) {
            for (var e = 0; e < this.events.length; e++) if (!this.events[e].pendingDelete) {
                var i = this.events[e].tick - t;
                i < 0 && (i = 0), this.events[e].tick = this._now + i;
            }
            var n = this.nextTick - t;
            this.nextTick = n < 0 ? this._now : this._now + n;
        },
        resume: function() {
            if (this.paused) {
                var t = this.game.time.time;
                this._pauseTotal += t - this._now, this._now = t, this.adjustEvents(this._pauseStarted), 
                this.paused = !1, this._codePaused = !1;
            }
        },
        _resume: function() {
            this._codePaused || this.resume();
        },
        removeAll: function() {
            this.onComplete.removeAll(), this.events.length = 0, this._len = 0, this._i = 0;
        },
        destroy: function() {
            this.onComplete.removeAll(), this.running = !1, this.expired = !0, this.events = [], 
            this._len = 0, this._i = 0;
        }
    }, Object.defineProperty(z.Timer.prototype, "next", {
        get: function() {
            return this.nextTick;
        }
    }), Object.defineProperty(z.Timer.prototype, "duration", {
        get: function() {
            return this.running && this.nextTick > this._now ? this.nextTick - this._now : 0;
        }
    }), Object.defineProperty(z.Timer.prototype, "length", {
        get: function() {
            return this.events.length;
        }
    }), Object.defineProperty(z.Timer.prototype, "ms", {
        get: function() {
            return this.running ? this._now - this._started - this._pauseTotal : 0;
        }
    }), Object.defineProperty(z.Timer.prototype, "seconds", {
        get: function() {
            return this.running ? .001 * this.ms : 0;
        }
    }), z.Timer.prototype.constructor = z.Timer, z.TimerEvent = function(t, e, i, n, s, o, a, r) {
        this.timer = t, this.delay = e, this.tick = i, this.repeatCount = n - 1, this.loop = s, 
        this.callback = o, this.callbackContext = a, this.args = r, this.pendingDelete = !1;
    }, z.TimerEvent.prototype.constructor = z.TimerEvent, z.AnimationManager = function(t) {
        this.sprite = t, this.game = t.game, this.currentFrame = null, this.currentAnim = null, 
        this.updateIfVisible = !0, this.isLoaded = !1, this._frameData = null, this._anims = {}, 
        this._outputFrames = [];
    }, z.AnimationManager.prototype = {
        loadFrameData: function(t, e) {
            if (void 0 === t) return !1;
            if (this.isLoaded) for (var i in this._anims) this._anims[i].updateFrameData(t);
            return this._frameData = t, null == e ? this.frame = 0 : "string" == typeof e ? this.frameName = e : this.frame = e, 
            this.isLoaded = !0;
        },
        copyFrameData: function(t, e) {
            if (this._frameData = t.clone(), this.isLoaded) for (var i in this._anims) this._anims[i].updateFrameData(this._frameData);
            return null == e ? this.frame = 0 : "string" == typeof e ? this.frameName = e : this.frame = e, 
            this.isLoaded = !0;
        },
        add: function(t, e, i, n, s) {
            return e = e || [], i = i || 60, void 0 === n && (n = !1), void 0 === s && (s = !(!e || "number" != typeof e[0])), 
            this._outputFrames = [], this._frameData.getFrameIndexes(e, s, this._outputFrames), 
            this._anims[t] = new z.Animation(this.game, this.sprite, t, this._frameData, this._outputFrames, i, n), 
            this.currentAnim = this._anims[t], this.sprite.tilingTexture && (this.sprite.refreshTexture = !0), 
            this._anims[t];
        },
        validateFrames: function(t, e) {
            void 0 === e && (e = !0);
            for (var i = 0; i < t.length; i++) if (!0 === e) {
                if (t[i] > this._frameData.total) return !1;
            } else if (!1 === this._frameData.checkFrameName(t[i])) return !1;
            return !0;
        },
        play: function(t, e, i, n) {
            if (this._anims[t]) return this.currentAnim === this._anims[t] ? !1 === this.currentAnim.isPlaying ? (this.currentAnim.paused = !1, 
            this.currentAnim.play(e, i, n)) : this.currentAnim : (this.currentAnim && this.currentAnim.isPlaying && this.currentAnim.stop(), 
            this.currentAnim = this._anims[t], this.currentAnim.paused = !1, this.currentFrame = this.currentAnim.currentFrame, 
            this.currentAnim.play(e, i, n));
        },
        stop: function(t, e) {
            void 0 === e && (e = !1), !this.currentAnim || "string" == typeof t && t !== this.currentAnim.name || this.currentAnim.stop(e);
        },
        update: function() {
            return !(this.updateIfVisible && !this.sprite.visible) && (!(!this.currentAnim || !this.currentAnim.update()) && (this.currentFrame = this.currentAnim.currentFrame, 
            !0));
        },
        next: function(t) {
            this.currentAnim && (this.currentAnim.next(t), this.currentFrame = this.currentAnim.currentFrame);
        },
        previous: function(t) {
            this.currentAnim && (this.currentAnim.previous(t), this.currentFrame = this.currentAnim.currentFrame);
        },
        getAnimation: function(t) {
            return "string" == typeof t && this._anims[t] ? this._anims[t] : null;
        },
        refreshFrame: function() {},
        destroy: function() {
            var t = null;
            for (var t in this._anims) this._anims.hasOwnProperty(t) && this._anims[t].destroy();
            this._anims = {}, this._outputFrames = [], this._frameData = null, this.currentAnim = null, 
            this.currentFrame = null, this.sprite = null, this.game = null;
        }
    }, z.AnimationManager.prototype.constructor = z.AnimationManager, Object.defineProperty(z.AnimationManager.prototype, "frameData", {
        get: function() {
            return this._frameData;
        }
    }), Object.defineProperty(z.AnimationManager.prototype, "frameTotal", {
        get: function() {
            return this._frameData.total;
        }
    }), Object.defineProperty(z.AnimationManager.prototype, "paused", {
        get: function() {
            return this.currentAnim.isPaused;
        },
        set: function(t) {
            this.currentAnim.paused = t;
        }
    }), Object.defineProperty(z.AnimationManager.prototype, "name", {
        get: function() {
            return this.currentAnim ? this.currentAnim.name : void 0;
        }
    }), Object.defineProperty(z.AnimationManager.prototype, "frame", {
        get: function() {
            return this.currentFrame ? this.currentFrame.index : void 0;
        },
        set: function(t) {
            var e;
            "number" == typeof t && this._frameData && (e = this._frameData.getFrame(t)) && (this.currentFrame = e, 
            this.sprite.setFrame(this.currentFrame));
        }
    }), Object.defineProperty(z.AnimationManager.prototype, "frameName", {
        get: function() {
            return this.currentFrame ? this.currentFrame.name : void 0;
        },
        set: function(t) {
            var e;
            "string" == typeof t && this._frameData && (e = this._frameData.getFrameByName(t)) && (this.currentFrame = e, 
            this._frameIndex = this.currentFrame.index, this.sprite.setFrame(this.currentFrame));
        }
    }), z.Animation = function(t, e, i, n, s, o, a) {
        void 0 === a && (a = !1), this.game = t, this._parent = e, this._frameData = n, 
        this.name = i, this._frames = [], this._frames = this._frames.concat(s), this.delay = 1e3 / o, 
        this.loop = a, this.loopCount = 0, this.killOnComplete = !1, this.isFinished = !1, 
        this.isPlaying = !1, this.isPaused = !1, this._pauseStartTime = 0, this._frameIndex = 0, 
        this._frameDiff = 0, this._frameSkip = 1, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), 
        this.onStart = new z.Signal(), this.onUpdate = null, this.onComplete = new z.Signal(), 
        this.onLoop = new z.Signal(), this.isReversed = !1, this.game.onPause.add(this.onPause, this), 
        this.game.onResume.add(this.onResume, this);
    }, z.Animation.prototype = {
        play: function(t, e, i) {
            return "number" == typeof t && (this.delay = 1e3 / t), "boolean" == typeof e && (this.loop = e), 
            void 0 !== i && (this.killOnComplete = i), this.isPlaying = !0, this.isFinished = !1, 
            this.paused = !1, this.loopCount = 0, this._timeLastFrame = this.game.time.time, 
            this._timeNextFrame = this.game.time.time + this.delay, this._frameIndex = this.isReversed ? this._frames.length - 1 : 0, 
            this.updateCurrentFrame(!1, !0), this._parent.events.onAnimationStart$dispatch(this._parent, this), 
            this.onStart.dispatch(this._parent, this), (this._parent.animations.currentAnim = this)._parent.animations.currentFrame = this.currentFrame, 
            this;
        },
        restart: function() {
            this.isPlaying = !0, this.isFinished = !1, this.paused = !1, this.loopCount = 0, 
            this._timeLastFrame = this.game.time.time, this._timeNextFrame = this.game.time.time + this.delay, 
            this._frameIndex = 0, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), 
            this._parent.setFrame(this.currentFrame), (this._parent.animations.currentAnim = this)._parent.animations.currentFrame = this.currentFrame, 
            this.onStart.dispatch(this._parent, this);
        },
        reverse: function() {
            return this.reversed = !this.reversed, this;
        },
        reverseOnce: function() {
            return this.onComplete.addOnce(this.reverse, this), this.reverse();
        },
        setFrame: function(t, e) {
            var i;
            if (void 0 === e && (e = !1), "string" == typeof t) for (var n = 0; n < this._frames.length; n++) this._frameData.getFrame(this._frames[n]).name === t && (i = n); else if ("number" == typeof t) if (e) i = t; else for (n = 0; n < this._frames.length; n++) this._frames[n] === t && (i = n);
            if (i) {
                var s = this.isReversed ? -1 : 1;
                this._frameIndex = i - s, this._timeNextFrame = this.game.time.time, this.update();
            }
        },
        stop: function(t, e) {
            void 0 === t && (t = !1), void 0 === e && (e = !1), this.isPlaying = !1, this.isFinished = !0, 
            this.paused = !1, t && (this.currentFrame = this._frameData.getFrame(this._frames[0]), 
            this._parent.setFrame(this.currentFrame)), e && (this._parent.events.onAnimationComplete$dispatch(this._parent, this), 
            this.onComplete.dispatch(this._parent, this));
        },
        onPause: function() {
            this.isPlaying && (this._frameDiff = this._timeNextFrame - this.game.time.time);
        },
        onResume: function() {
            this.isPlaying && (this._timeNextFrame = this.game.time.time + this._frameDiff);
        },
        update: function() {
            if (this.isPaused) return !1;
            var t = this.game.time.time, e = t - this._timeNextFrame;
            return !!(this.isPlaying && 0 <= e) && (this._frameSkip = 1, this._frameDiff = e, 
            this._timeLastFrame = t, this._frameDiff > this.delay && (this._frameSkip = Math.floor(this._frameDiff / this.delay), 
            this._frameDiff -= this._frameSkip * this.delay), this._timeNextFrame = t + (this.delay - this._frameDiff), 
            this.isReversed ? this._frameIndex -= this._frameSkip : this._frameIndex += this._frameSkip, 
            !this.isReversed && this._frameIndex >= this._frames.length || this.isReversed && this._frameIndex <= -1 ? this.loop ? (this._frameIndex = Math.abs(this._frameIndex) % this._frames.length, 
            this.isReversed && (this._frameIndex = this._frames.length - 1 - this._frameIndex), 
            this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.currentFrame && this._parent.setFrame(this.currentFrame), 
            this.loopCount++, this._parent.events.onAnimationLoop$dispatch(this._parent, this), 
            this.onLoop.dispatch(this._parent, this), !this.onUpdate || (this.onUpdate.dispatch(this, this.currentFrame), 
            !!this._frameData)) : (this.complete(), !1) : this.updateCurrentFrame(!0));
        },
        updateCurrentFrame: function(t, e) {
            if (void 0 === e && (e = !1), !this._frameData) return !1;
            var i = this.currentFrame.index;
            return this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), 
            this.currentFrame && (e || i !== this.currentFrame.index) && this._parent.setFrame(this.currentFrame), 
            !this.onUpdate || !t || (this.onUpdate.dispatch(this, this.currentFrame), !!this._frameData);
        },
        next: function(t) {
            void 0 === t && (t = 1);
            var e = this._frameIndex + t;
            e >= this._frames.length && (this.loop ? e %= this._frames.length : e = this._frames.length - 1), 
            e !== this._frameIndex && (this._frameIndex = e, this.updateCurrentFrame(!0));
        },
        previous: function(t) {
            void 0 === t && (t = 1);
            var e = this._frameIndex - t;
            e < 0 && (this.loop ? e = this._frames.length + e : e++), e !== this._frameIndex && (this._frameIndex = e, 
            this.updateCurrentFrame(!0));
        },
        updateFrameData: function(t) {
            this._frameData = t, this.currentFrame = this._frameData ? this._frameData.getFrame(this._frames[this._frameIndex % this._frames.length]) : null;
        },
        destroy: function() {
            this._frameData && (this.game.onPause.remove(this.onPause, this), this.game.onResume.remove(this.onResume, this), 
            this.game = null, this._parent = null, this._frames = null, this._frameData = null, 
            this.currentFrame = null, this.isPlaying = !1, this.onStart.dispose(), this.onLoop.dispose(), 
            this.onComplete.dispose(), this.onUpdate && this.onUpdate.dispose());
        },
        complete: function() {
            this._frameIndex = this._frames.length - 1, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), 
            this.updateCurrentFrame(!1), this.isPlaying = !1, this.isFinished = !0, this.paused = !1, 
            this._parent.events.onAnimationComplete$dispatch(this._parent, this), this.onComplete.dispatch(this._parent, this), 
            this.killOnComplete && this._parent.kill();
        }
    }, z.Animation.prototype.constructor = z.Animation, Object.defineProperty(z.Animation.prototype, "paused", {
        get: function() {
            return this.isPaused;
        },
        set: function(t) {
            (this.isPaused = t) ? this._pauseStartTime = this.game.time.time : this.isPlaying && (this._timeNextFrame = this.game.time.time + this.delay);
        }
    }), Object.defineProperty(z.Animation.prototype, "reversed", {
        get: function() {
            return this.isReversed;
        },
        set: function(t) {
            this.isReversed = t;
        }
    }), Object.defineProperty(z.Animation.prototype, "frameTotal", {
        get: function() {
            return this._frames.length;
        }
    }), Object.defineProperty(z.Animation.prototype, "frame", {
        get: function() {
            return null !== this.currentFrame ? this.currentFrame.index : this._frameIndex;
        },
        set: function(t) {
            this.currentFrame = this._frameData.getFrame(this._frames[t]), null !== this.currentFrame && (this._frameIndex = t, 
            this._parent.setFrame(this.currentFrame), this.onUpdate && this.onUpdate.dispatch(this, this.currentFrame));
        }
    }), Object.defineProperty(z.Animation.prototype, "speed", {
        get: function() {
            return 1e3 / this.delay;
        },
        set: function(t) {
            0 < t && (this.delay = 1e3 / t);
        }
    }), Object.defineProperty(z.Animation.prototype, "enableUpdate", {
        get: function() {
            return null !== this.onUpdate;
        },
        set: function(t) {
            t && null === this.onUpdate ? this.onUpdate = new z.Signal() : t || null === this.onUpdate || (this.onUpdate.dispose(), 
            this.onUpdate = null);
        }
    }), z.Animation.generateFrameNames = function(t, e, i, n, s) {
        void 0 === n && (n = "");
        var o = [], a = "";
        if (e < i) for (var r = e; r <= i; r++) a = t + (a = "number" == typeof s ? z.Utils.pad(r.toString(), s, "0", 1) : r.toString()) + n, 
        o.push(a); else for (r = e; i <= r; r--) a = t + (a = "number" == typeof s ? z.Utils.pad(r.toString(), s, "0", 1) : r.toString()) + n, 
        o.push(a);
        return o;
    }, z.Frame = function(t, e, i, n, s, o) {
        this.index = t, this.x = e, this.y = i, this.width = n, this.height = s, 0 === this.width || this.height, 
        this.name = o, this.centerX = Math.floor(n / 2), this.centerY = Math.floor(s / 2), 
        this.distance = z.Math.distance(0, 0, n, s), this.rotated = !1, this.trimmed = !1, 
        this.sourceSizeW = n, this.sourceSizeH = s, this.spriteSourceSizeX = 0, this.spriteSourceSizeY = 0, 
        this.spriteSourceSizeW = 0, this.spriteSourceSizeH = 0, this.right = this.x + this.width, 
        this.bottom = this.y + this.height;
    }, z.Frame.prototype = {
        resize: function(t, e) {
            this.width = t, this.height = e, this.centerX = Math.floor(t / 2), this.centerY = Math.floor(e / 2), 
            this.distance = z.Math.distance(0, 0, t, e), this.sourceSizeW = t, this.sourceSizeH = e, 
            this.right = this.x + t, this.bottom = this.y + e;
        },
        setTrim: function(t, e, i, n, s, o, a) {
            (this.trimmed = t) && (this.sourceSizeW = e, this.sourceSizeH = i, this.centerX = Math.floor(e / 2), 
            this.centerY = Math.floor(i / 2), this.spriteSourceSizeX = n, this.spriteSourceSizeY = s, 
            this.spriteSourceSizeW = o, this.spriteSourceSizeH = a);
        },
        clone: function() {
            var t = new z.Frame(this.index, this.x, this.y, this.width, this.height, this.name);
            for (var e in this) this.hasOwnProperty(e) && (t[e] = this[e]);
            return t;
        },
        getRect: function(t) {
            return void 0 === t ? t = new z.Rectangle(this.x, this.y, this.width, this.height) : t.setTo(this.x, this.y, this.width, this.height), 
            t;
        }
    }, z.Frame.prototype.constructor = z.Frame, z.FrameData = function() {
        this._frames = [], this._frameNames = [];
    }, z.FrameData.prototype = {
        addFrame: function(t) {
            return t.index = this._frames.length, this._frames.push(t), "" !== t.name && (this._frameNames[t.name] = t.index), 
            t;
        },
        getFrame: function(t) {
            return t >= this._frames.length && (t = 0), this._frames[t];
        },
        getFrameByName: function(t) {
            return "number" == typeof this._frameNames[t] ? this._frames[this._frameNames[t]] : null;
        },
        checkFrameName: function(t) {
            return null != this._frameNames[t];
        },
        clone: function() {
            for (var t = new z.FrameData(), e = 0; e < this._frames.length; e++) t._frames.push(this._frames[e].clone());
            for (var i in this._frameNames) this._frameNames.hasOwnProperty(i) && (t._frameNames[i] = this._frameNames[i]);
            return t;
        },
        getFrameRange: function(t, e, i) {
            void 0 === i && (i = []);
            for (var n = t; n <= e; n++) i.push(this._frames[n]);
            return i;
        },
        getFrames: function(t, e, i) {
            if (void 0 === e && (e = !0), void 0 === i && (i = []), void 0 === t || 0 === t.length) for (var n = 0; n < this._frames.length; n++) i.push(this._frames[n]); else for (n = 0; n < t.length; n++) e ? i.push(this.getFrame(t[n])) : i.push(this.getFrameByName(t[n]));
            return i;
        },
        getFrameIndexes: function(t, e, i) {
            if (void 0 === e && (e = !0), void 0 === i && (i = []), void 0 === t || 0 === t.length) for (var n = 0; n < this._frames.length; n++) i.push(this._frames[n].index); else for (n = 0; n < t.length; n++) e && this._frames[t[n]] ? i.push(this._frames[t[n]].index) : this.getFrameByName(t[n]) && i.push(this.getFrameByName(t[n]).index);
            return i;
        },
        destroy: function() {
            this._frames = null, this._frameNames = null;
        }
    }, z.FrameData.prototype.constructor = z.FrameData, Object.defineProperty(z.FrameData.prototype, "total", {
        get: function() {
            return this._frames.length;
        }
    }), z.AnimationParser = {
        spriteSheet: function(t, e, i, n, s, o, a, r) {
            void 0 === s && (s = -1), void 0 === o && (o = 0), void 0 === a && (a = 0), void 0 === r && (r = 0);
            var h = e;
            if ("string" == typeof e ? h = t.cache.getImage(e) : e = h.name, null === h) return null;
            if (i <= 0 || n <= 0) return null;
            var l = h.width, c = h.height;
            if (0 === l || 0 === c) return null;
            if (l < i || c < n) return null;
            var u = Math.floor((l - o) / (i + a)), d = Math.floor((c - o) / (n + a)), p = u * d, g = p, m = p - 1, f = 0, y = m;
            if (p < r || r < -p) return null;
            if (-1 < s && (y = (p = s) - 1), 0 === g) return null;
            if (0 < r ? y = (f = r) + (p = Math.min(p, g - r)) - 1 : r < 0 && (f = (y = m + r) - (p = Math.min(p, g + r)) + 1), 
            f < 0) return null;
            if (m < y) return null;
            for (var v = new z.FrameData(), b = o, _ = o, S = 0, x = 0; x < g && !(y < x); x++) f <= x && v.addFrame(new z.Frame(S++, b, _, i, n, "")), 
            l < (b += i + a) + i && (b = o, _ += n + a);
            return v;
        },
        JSONData: function(t, e) {
            if (e.frames) {
                for (var i, n = new z.FrameData(), s = e.frames, o = 0; o < s.length; o++) i = n.addFrame(new z.Frame(o, s[o].frame.x, s[o].frame.y, s[o].frame.w, s[o].frame.h, s[o].filename)), 
                s[o].trimmed && i.setTrim(s[o].trimmed, s[o].sourceSize.w, s[o].sourceSize.h, s[o].spriteSourceSize.x, s[o].spriteSourceSize.y, s[o].spriteSourceSize.w, s[o].spriteSourceSize.h), 
                s[o].rotated && (i.rotated = !0);
                return n;
            }
        },
        JSONDataPyxel: function(t, e) {
            if ([ "layers", "tilewidth", "tileheight", "tileswide", "tileshigh" ].forEach(function(t) {
                e[t];
            }), 1 === e.layers.length) {
                for (var i = new z.FrameData(), n = e.tileheight, s = e.tilewidth, o = e.layers[0].tiles, a = 0; a < o.length; a++) i.addFrame(new z.Frame(a, o[a].x, o[a].y, s, n, "frame_" + a)).setTrim(!1);
                return i;
            }
        },
        JSONDataHash: function(t, e) {
            if (e.frames) {
                var i, n = new z.FrameData(), s = e.frames, o = 0;
                for (var a in s) i = n.addFrame(new z.Frame(o, s[a].frame.x, s[a].frame.y, s[a].frame.w, s[a].frame.h, a)), 
                s[a].trimmed && i.setTrim(s[a].trimmed, s[a].sourceSize.w, s[a].sourceSize.h, s[a].spriteSourceSize.x, s[a].spriteSourceSize.y, s[a].spriteSourceSize.w, s[a].spriteSourceSize.h), 
                s[a].rotated && (i.rotated = !0), o++;
                return n;
            }
        },
        XMLData: function(t, e) {
            if (e.getElementsByTagName("TextureAtlas")) {
                for (var i, n, s, o, a, r, h, l, c, u, d, p = new z.FrameData(), g = e.getElementsByTagName("SubTexture"), m = 0; m < g.length; m++) n = (s = g[m].attributes).name.value, 
                o = parseInt(s.x.value, 10), a = parseInt(s.y.value, 10), r = parseInt(s.width.value, 10), 
                h = parseInt(s.height.value, 10), c = l = null, s.frameX && (l = Math.abs(parseInt(s.frameX.value, 10)), 
                c = Math.abs(parseInt(s.frameY.value, 10)), u = parseInt(s.frameWidth.value, 10), 
                d = parseInt(s.frameHeight.value, 10)), i = p.addFrame(new z.Frame(m, o, a, r, h, n)), 
                null === l && null === c || i.setTrim(!0, r, h, l, c, u, d);
                return p;
            }
        }
    }, z.Cache = function(t) {
        this.game = t, this.autoResolveURL = !1, this._cache = {
            canvas: {},
            image: {},
            texture: {},
            sound: {},
            video: {},
            text: {},
            json: {},
            xml: {},
            physics: {},
            tilemap: {},
            binary: {},
            bitmapData: {},
            bitmapFont: {},
            shader: {},
            renderTexture: {},
            compressedTexture: {}
        }, this._urlMap = {}, this._urlResolver = new Image(), this._urlTemp = null, this.onSoundUnlock = new z.Signal(), 
        this._cacheMap = [], this._cacheMap[z.Cache.CANVAS] = this._cache.canvas, this._cacheMap[z.Cache.IMAGE] = this._cache.image, 
        this._cacheMap[z.Cache.TEXTURE] = this._cache.texture, this._cacheMap[z.Cache.SOUND] = this._cache.sound, 
        this._cacheMap[z.Cache.TEXT] = this._cache.text, this._cacheMap[z.Cache.PHYSICS] = this._cache.physics, 
        this._cacheMap[z.Cache.TILEMAP] = this._cache.tilemap, this._cacheMap[z.Cache.BINARY] = this._cache.binary, 
        this._cacheMap[z.Cache.BITMAPDATA] = this._cache.bitmapData, this._cacheMap[z.Cache.BITMAPFONT] = this._cache.bitmapFont, 
        this._cacheMap[z.Cache.JSON] = this._cache.json, this._cacheMap[z.Cache.XML] = this._cache.xml, 
        this._cacheMap[z.Cache.VIDEO] = this._cache.video, this._cacheMap[z.Cache.SHADER] = this._cache.shader, 
        this._cacheMap[z.Cache.RENDER_TEXTURE] = this._cache.renderTexture, this._pendingCount = 0, 
        this.onReady = new z.Signal(), this._addImages();
    }, z.Cache.CANVAS = 1, z.Cache.IMAGE = 2, z.Cache.TEXTURE = 3, z.Cache.SOUND = 4, 
    z.Cache.TEXT = 5, z.Cache.PHYSICS = 6, z.Cache.TILEMAP = 7, z.Cache.BINARY = 8, 
    z.Cache.BITMAPDATA = 9, z.Cache.BITMAPFONT = 10, z.Cache.JSON = 11, z.Cache.XML = 12, 
    z.Cache.VIDEO = 13, z.Cache.SHADER = 14, z.Cache.RENDER_TEXTURE = 15, z.Cache.DEFAULT = null, 
    z.Cache.DEFAULT_KEY = "__default", z.Cache.DEFAULT_SRC = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==", 
    z.Cache.MISSING = null, z.Cache.MISSING_KEY = "__missing", z.Cache.MISSING_SRC = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==", 
    z.Cache.READY_TIMEOUT = 1e3, z.Cache.prototype = {
        addCompressedTextureMetaData: function(t, e, i, n) {
            this.checkImageKey(t) && this.removeImage(t);
            var s = i in z.LoaderParser ? z.LoaderParser[i](n) : n, o = {
                key: t,
                url: e,
                data: s,
                base: new PIXI.BaseTexture(s, null, this.game.resolution),
                frame: new z.Frame(0, 0, 0, s.width, s.height, t),
                frameData: new z.FrameData(),
                fileFormat: i
            };
            return o.frameData.addFrame(new z.Frame(0, 0, 0, s.width, s.height, e)), this._cache.image[t] = o, 
            this._resolveURL(e, o), o;
        },
        addCanvas: function(t, e, i) {
            void 0 === i && (i = e.getContext("2d")), this._cache.canvas[t] = {
                canvas: e,
                context: i
            };
        },
        addImage: function(t, e, i) {
            this.checkImageKey(t) && this.removeImage(t), i.complete;
            var n = {
                key: t,
                url: e,
                data: i,
                base: new PIXI.BaseTexture(i, null, this.game.resolution),
                frame: new z.Frame(0, 0, 0, i.width, i.height, t),
                frameData: new z.FrameData()
            };
            return n.frameData.addFrame(new z.Frame(0, 0, 0, i.width, i.height, e)), this._cache.image[t] = n, 
            this._resolveURL(e, n), "__default" === t ? z.Cache.DEFAULT = new PIXI.Texture(n.base) : "__missing" === t && (z.Cache.MISSING = new PIXI.Texture(n.base)), 
            n;
        },
        addImageAsync: function(t, e, i) {
            var n = this, s = new Image();
            s.onload = function() {
                i.call(this, n.addImage(t, null, s)), n._removePending(), s.onload = null;
            }, this._addPending(), s.src = e;
        },
        addDefaultImage: function() {
            this.addImageAsync(z.Cache.DEFAULT_KEY, z.Cache.DEFAULT_SRC, function(t) {
                t.base.skipRender = !0, z.Cache.DEFAULT = new PIXI.Texture(t.base);
            });
        },
        addMissingImage: function() {
            this.addImageAsync(z.Cache.MISSING_KEY, z.Cache.MISSING_SRC, function(t) {
                z.Cache.MISSING = new PIXI.Texture(t.base);
            });
        },
        addSound: function(t, e, i, n, s) {
            void 0 === n && (s = !(n = !0)), void 0 === s && (s = !(n = !1));
            var o = !1;
            s && (o = !0), this._cache.sound[t] = {
                url: e,
                data: i,
                isDecoding: !1,
                decoded: o,
                webAudio: n,
                audioTag: s,
                locked: this.game.sound.touchLocked
            }, this._resolveURL(e, this._cache.sound[t]);
        },
        addText: function(t, e, i) {
            this._cache.text[t] = {
                url: e,
                data: i
            }, this._resolveURL(e, this._cache.text[t]);
        },
        addPhysicsData: function(t, e, i, n) {
            this._cache.physics[t] = {
                url: e,
                data: i,
                format: n
            }, this._resolveURL(e, this._cache.physics[t]);
        },
        addTilemap: function(t, e, i, n) {
            this._cache.tilemap[t] = {
                url: e,
                data: i,
                format: n
            }, this._resolveURL(e, this._cache.tilemap[t]);
        },
        addBinary: function(t, e) {
            this._cache.binary[t] = e;
        },
        addBitmapData: function(t, e, i) {
            return e.key = t, void 0 === i && (i = new z.FrameData()).addFrame(e.textureFrame), 
            this._cache.bitmapData[t] = {
                data: e,
                frameData: i
            }, e;
        },
        addBitmapFont: function(t, e, i, n, s, o, a) {
            var r = {
                url: e,
                data: i,
                font: null,
                base: new PIXI.BaseTexture(i, null, this.game.resolution)
            };
            void 0 === o && (o = 0), void 0 === a && (a = 0), r.font = "json" === s ? z.LoaderParser.jsonBitmapFont(n, r.base, o, a, !1, this.game.resolution) : z.LoaderParser.xmlBitmapFont(n, r.base, o, a, !1, this.game.resolution), 
            this._cache.bitmapFont[t] = r, this._resolveURL(e, r);
        },
        addBitmapFontFromAtlas: function(t, e, i, n, s, o, a) {
            var r = this.getFrameByName(e, i);
            if (r) {
                var h, l = {
                    font: null,
                    base: this.getBaseTexture(e),
                    frame: r
                };
                void 0 === o && (o = 0), void 0 === a && (a = 0), "json" === s ? (h = this.getJSON(n), 
                l.font = z.LoaderParser.jsonBitmapFont(h, l.base, o, a, r, this.game.resolution)) : (h = this.getXML(n), 
                l.font = z.LoaderParser.xmlBitmapFont(h, l.base, o, a, r, this.game.resolution)), 
                this._cache.bitmapFont[t] = l;
            }
        },
        addJSON: function(t, e, i) {
            this._cache.json[t] = {
                url: e,
                data: i
            }, this._resolveURL(e, this._cache.json[t]);
        },
        addXML: function(t, e, i) {
            this._cache.xml[t] = {
                url: e,
                data: i
            }, this._resolveURL(e, this._cache.xml[t]);
        },
        addVideo: function(t, e, i, n) {
            this._cache.video[t] = {
                url: e,
                data: i,
                isBlob: n,
                locked: !0
            }, this._resolveURL(e, this._cache.video[t]);
        },
        addShader: function(t, e, i) {
            this._cache.shader[t] = {
                url: e,
                data: i
            }, this._resolveURL(e, this._cache.shader[t]);
        },
        addRenderTexture: function(t, e) {
            this._cache.renderTexture[t] = {
                texture: e,
                frame: new z.Frame(0, 0, 0, e.width, e.height, "", "")
            };
        },
        addSpriteSheet: function(t, e, i, n, s, o, a, r, h) {
            void 0 === o && (o = -1), void 0 === a && (a = 0), void 0 === r && (r = 0);
            var l = {
                key: t,
                url: e,
                data: i,
                frameWidth: n,
                frameHeight: s,
                margin: a,
                spacing: r,
                base: new PIXI.BaseTexture(i, null, this.game.resolution),
                frameData: z.AnimationParser.spriteSheet(this.game, i, n, s, o, a, r, h)
            };
            this._cache.image[t] = l, this._resolveURL(e, l);
        },
        addTextureAtlas: function(t, e, i, n, s) {
            var o = {
                key: t,
                url: e,
                data: i,
                base: new PIXI.BaseTexture(i, null, this.game.resolution)
            };
            s === z.Loader.TEXTURE_ATLAS_XML_STARLING ? o.frameData = z.AnimationParser.XMLData(this.game, n, t) : s === z.Loader.TEXTURE_ATLAS_JSON_PYXEL ? o.frameData = z.AnimationParser.JSONDataPyxel(this.game, n, t) : Array.isArray(n.frames) ? o.frameData = z.AnimationParser.JSONData(this.game, n, t) : o.frameData = z.AnimationParser.JSONDataHash(this.game, n, t), 
            this._cache.image[t] = o, this._resolveURL(e, o);
        },
        reloadSound: function(t) {
            var e = this, i = this.getSound(t);
            i && (i.data.src = i.url, i.data.addEventListener("canplaythrough", function() {
                return e.reloadSoundComplete(t);
            }, !1), i.data.load());
        },
        reloadSoundComplete: function(t) {
            var e = this.getSound(t);
            e && (e.locked = !1, this.onSoundUnlock.dispatch(t));
        },
        updateSound: function(t, e, i) {
            var n = this.getSound(t);
            n && (n[e] = i);
        },
        decodedSound: function(t, e) {
            var i = this.getSound(t);
            i.data = e, i.decoded = !0, i.isDecoding = !1;
        },
        isSoundDecoded: function(t) {
            var e = this.getItem(t, z.Cache.SOUND, "isSoundDecoded");
            if (e) return e.decoded;
        },
        isSoundReady: function(t) {
            var e = this.getItem(t, z.Cache.SOUND, "isSoundDecoded");
            if (e) return e.decoded && !this.game.sound.touchLocked;
        },
        checkKey: function(t, e) {
            return !!this._cacheMap[t][e];
        },
        checkURL: function(t) {
            return !!this._urlMap[this._resolveURL(t)];
        },
        checkCanvasKey: function(t) {
            return this.checkKey(z.Cache.CANVAS, t);
        },
        checkImageKey: function(t) {
            return this.checkKey(z.Cache.IMAGE, t);
        },
        checkTextureKey: function(t) {
            return this.checkKey(z.Cache.TEXTURE, t);
        },
        checkSoundKey: function(t) {
            return this.checkKey(z.Cache.SOUND, t);
        },
        checkTextKey: function(t) {
            return this.checkKey(z.Cache.TEXT, t);
        },
        checkPhysicsKey: function(t) {
            return this.checkKey(z.Cache.PHYSICS, t);
        },
        checkTilemapKey: function(t) {
            return this.checkKey(z.Cache.TILEMAP, t);
        },
        checkBinaryKey: function(t) {
            return this.checkKey(z.Cache.BINARY, t);
        },
        checkBitmapDataKey: function(t) {
            return this.checkKey(z.Cache.BITMAPDATA, t);
        },
        checkBitmapFontKey: function(t) {
            return this.checkKey(z.Cache.BITMAPFONT, t);
        },
        checkJSONKey: function(t) {
            return this.checkKey(z.Cache.JSON, t);
        },
        checkXMLKey: function(t) {
            return this.checkKey(z.Cache.XML, t);
        },
        checkVideoKey: function(t) {
            return this.checkKey(z.Cache.VIDEO, t);
        },
        checkShaderKey: function(t) {
            return this.checkKey(z.Cache.SHADER, t);
        },
        checkRenderTextureKey: function(t) {
            return this.checkKey(z.Cache.RENDER_TEXTURE, t);
        },
        getItem: function(t, e, i, n) {
            return this.checkKey(e, t) ? void 0 === n ? this._cacheMap[e][t] : this._cacheMap[e][t][n] : null;
        },
        getCanvas: function(t) {
            return this.getItem(t, z.Cache.CANVAS, "getCanvas", "canvas");
        },
        getImage: function(t, e) {
            null == t && (t = "__default"), void 0 === e && (e = !1);
            var i = this.getItem(t, z.Cache.IMAGE, "getImage");
            return null === i && (i = this.getItem("__missing", z.Cache.IMAGE, "getImage")), 
            e ? i : i.data;
        },
        getTextureFrame: function(t) {
            return this.getItem(t, z.Cache.TEXTURE, "getTextureFrame", "frame");
        },
        getSound: function(t) {
            return this.getItem(t, z.Cache.SOUND, "getSound");
        },
        getSoundData: function(t) {
            return this.getItem(t, z.Cache.SOUND, "getSoundData", "data");
        },
        getText: function(t) {
            return this.getItem(t, z.Cache.TEXT, "getText", "data");
        },
        getPhysicsData: function(t, e, i) {
            var n = this.getItem(t, z.Cache.PHYSICS, "getPhysicsData", "data");
            if (null === n || null == e) return n;
            if (n[e]) {
                var s = n[e];
                if (!s || !i) return s;
                for (var o in s) if ((o = s[o]).fixtureKey === i) return o;
            }
            return null;
        },
        getTilemapData: function(t) {
            return this.getItem(t, z.Cache.TILEMAP, "getTilemapData");
        },
        getBinary: function(t) {
            return this.getItem(t, z.Cache.BINARY, "getBinary");
        },
        getBitmapData: function(t) {
            return this.getItem(t, z.Cache.BITMAPDATA, "getBitmapData", "data");
        },
        getBitmapFont: function(t) {
            return this.getItem(t, z.Cache.BITMAPFONT, "getBitmapFont");
        },
        getJSON: function(t, e) {
            var i = this.getItem(t, z.Cache.JSON, "getJSON", "data");
            return i ? e ? z.Utils.extend(!0, Array.isArray(i) ? [] : {}, i) : i : null;
        },
        getXML: function(t) {
            return this.getItem(t, z.Cache.XML, "getXML", "data");
        },
        getVideo: function(t) {
            return this.getItem(t, z.Cache.VIDEO, "getVideo");
        },
        getShader: function(t) {
            return this.getItem(t, z.Cache.SHADER, "getShader", "data");
        },
        getRenderTexture: function(t) {
            return this.getItem(t, z.Cache.RENDER_TEXTURE, "getRenderTexture");
        },
        getBaseTexture: function(t, e) {
            return void 0 === e && (e = z.Cache.IMAGE), this.getItem(t, e, "getBaseTexture", "base");
        },
        getFrame: function(t, e) {
            return void 0 === e && (e = z.Cache.IMAGE), this.getItem(t, e, "getFrame", "frame");
        },
        getFrameCount: function(t, e) {
            var i = this.getFrameData(t, e);
            return i ? i.total : 0;
        },
        getFrameData: function(t, e) {
            return void 0 === e && (e = z.Cache.IMAGE), this.getItem(t, e, "getFrameData", "frameData");
        },
        hasFrameData: function(t, e) {
            return void 0 === e && (e = z.Cache.IMAGE), null !== this.getItem(t, e, "", "frameData");
        },
        updateFrameData: function(t, e, i) {
            void 0 === i && (i = z.Cache.IMAGE), this._cacheMap[i][t] && (this._cacheMap[i][t].frameData = e);
        },
        getFrameByIndex: function(t, e, i) {
            var n = this.getFrameData(t, i);
            return n ? n.getFrame(e) : null;
        },
        getFrameByName: function(t, e, i) {
            var n = this.getFrameData(t, i);
            return n ? n.getFrameByName(e) : null;
        },
        getURL: function(t) {
            return (t = this._resolveURL(t)) ? this._urlMap[t] : null;
        },
        getKeys: function(t) {
            void 0 === t && (t = z.Cache.IMAGE);
            var e = [];
            if (this._cacheMap[t]) for (var i in this._cacheMap[t]) "__default" !== i && "__missing" !== i && e.push(i);
            return e;
        },
        removeCanvas: function(t) {
            delete this._cache.canvas[t];
        },
        removeImage: function(t, e) {
            void 0 === e && (e = !0);
            var i = this.getImage(t, !0);
            e && i.base && i.base.destroy(), delete this._cache.image[t];
        },
        removeSound: function(t) {
            delete this._cache.sound[t];
        },
        removeText: function(t) {
            delete this._cache.text[t];
        },
        removePhysics: function(t) {
            delete this._cache.physics[t];
        },
        removeTilemap: function(t) {
            delete this._cache.tilemap[t];
        },
        removeBinary: function(t) {
            delete this._cache.binary[t];
        },
        removeBitmapData: function(t) {
            delete this._cache.bitmapData[t];
        },
        removeBitmapFont: function(t) {
            delete this._cache.bitmapFont[t];
        },
        removeJSON: function(t) {
            delete this._cache.json[t];
        },
        removeXML: function(t) {
            delete this._cache.xml[t];
        },
        removeVideo: function(t) {
            delete this._cache.video[t];
        },
        removeShader: function(t) {
            delete this._cache.shader[t];
        },
        removeRenderTexture: function(t) {
            delete this._cache.renderTexture[t];
        },
        removeSpriteSheet: function(t) {
            delete this._cache.spriteSheet[t];
        },
        removeTextureAtlas: function(t) {
            delete this._cache.image[t];
        },
        clearGLTextures: function() {
            for (var t in this._cache.image) this._cache.image[t].base._glTextures = [];
        },
        _resolveURL: function(t, e) {
            return this.autoResolveURL ? (this._urlResolver.src = this.game.load.baseURL + t, 
            this._urlTemp = this._urlResolver.src, this._urlResolver.src = "", e && (this._urlMap[this._urlTemp] = e), 
            this._urlTemp) : null;
        },
        destroy: function() {
            for (var t = 0; t < this._cacheMap.length; t++) {
                var e = this._cacheMap[t];
                for (var i in e) "__default" !== i && "__missing" !== i && (this.destroyItem(e[i]), 
                delete e[i]);
            }
            this._urlMap = null, this._urlResolver = null, this._urlTemp = null;
        },
        destroyItem: function(t) {
            t.destroy ? t.destroy() : (t.base && t.base.destroy && t.base.destroy(), t.data && t.data.destroy && t.data.destroy(), 
            t.frameData && t.frameData.destroy && t.frameData.destroy(), t.texture && t.texture.destroy && t.texture.destroy(!0));
        },
        _addImages: function() {
            this._pendingCount = 0, this.addDefaultImage(), this.addMissingImage();
            var t = this;
            z.Cache.READY_TIMEOUT;
            0 < z.Cache.READY_TIMEOUT ? setTimeout(function() {
                t.isReady || t._ready();
            }, z.Cache.READY_TIMEOUT) : this._ready();
        },
        _addPending: function() {
            this._pendingCount += 1;
        },
        _removePending: function() {
            this._pendingCount -= 1, this._checkReady();
        },
        _checkReady: function() {
            this.isReady && this._ready();
        },
        _ready: function() {
            this._pendingCount = 0, this.onReady.dispatch(this);
        }
    }, z.Cache.prototype.constructor = z.Cache, Object.defineProperty(z.Cache.prototype, "isReady", {
        get: function() {
            return this._pendingCount <= 0;
        }
    }), z.Loader = function(t) {
        this.game = t, this.cache = t.cache, this.resetLocked = !1, this.isLoading = !1, 
        this.hasLoaded = !1, this.preloadSprite = null, this.crossOrigin = !1, this.baseURL = "", 
        this.path = "", this.headers = {
            requestedWith: !1,
            json: "application/json",
            xml: "application/xml"
        }, this.onLoadStart = new z.Signal(), this.onBeforeLoadComplete = new z.Signal(), 
        this.onLoadComplete = new z.Signal(), this.onPackComplete = new z.Signal(), this.onFileStart = new z.Signal(), 
        this.onFileComplete = new z.Signal(), this.onFileError = new z.Signal(), this.enableParallel = !0, 
        this.maxParallelDownloads = 4, this._withSyncPointDepth = 0, this._fileList = [], 
        this._flightQueue = [], this._processingHead = 0, this._fileLoadStarted = !1, this._totalPackCount = 0, 
        this._totalFileCount = 0, this._loadedPackCount = 0, this._loadedFileCount = 0;
    }, z.Loader.TEXTURE_ATLAS_JSON_ARRAY = 0, z.Loader.TEXTURE_ATLAS_JSON_HASH = 1, 
    z.Loader.TEXTURE_ATLAS_XML_STARLING = 2, z.Loader.PHYSICS_LIME_CORONA_JSON = 3, 
    z.Loader.PHYSICS_PHASER_JSON = 4, z.Loader.TEXTURE_ATLAS_JSON_PYXEL = 5, z.Loader.prototype = {
        setPreloadSprite: function(t, e) {
            e = e || 0, this.preloadSprite = {
                sprite: t,
                direction: e,
                width: t.width,
                height: t.height,
                rect: null
            }, this.preloadSprite.rect = 0 === e ? new z.Rectangle(0, 0, 1, t.height) : new z.Rectangle(0, 0, t.width, 1), 
            t.crop(this.preloadSprite.rect), t.visible = !0;
        },
        resize: function() {
            this.preloadSprite && this.preloadSprite.height !== this.preloadSprite.sprite.height && (this.preloadSprite.rect.height = this.preloadSprite.sprite.height);
        },
        checkKeyExists: function(t, e) {
            return -1 < this.getAssetIndex(t, e);
        },
        getAssetIndex: function(t, e) {
            for (var i = -1, n = 0; n < this._fileList.length; n++) {
                var s = this._fileList[n];
                if (s.type === t && s.key === e && (i = n, !s.loaded && !s.loading)) break;
            }
            return i;
        },
        getAsset: function(t, e) {
            var i = this.getAssetIndex(t, e);
            return -1 < i && {
                index: i,
                file: this._fileList[i]
            };
        },
        reset: function(t, e) {
            void 0 === e && (e = !1), this.resetLocked || (t && (this.preloadSprite = null), 
            this.isLoading = !1, this._processingHead = 0, this._fileList.length = 0, this._flightQueue.length = 0, 
            this._fileLoadStarted = !1, this._totalFileCount = 0, this._totalPackCount = 0, 
            this._loadedPackCount = 0, this._loadedFileCount = 0, e && (this.onLoadStart.removeAll(), 
            this.onLoadComplete.removeAll(), this.onPackComplete.removeAll(), this.onFileStart.removeAll(), 
            this.onFileComplete.removeAll(), this.onFileError.removeAll()));
        },
        addToFileList: function(t, e, i, n, s, o) {
            if (void 0 === s && (s = !1), void 0 === e || "" === e) return this;
            if (null == i) {
                if (!o) return this;
                i = e + o;
            }
            var a = {
                type: t,
                key: e,
                path: this.path,
                url: i,
                syncPoint: 0 < this._withSyncPointDepth,
                data: null,
                loading: !1,
                loaded: !1,
                error: !1
            };
            if (n) for (var r in n) a[r] = n[r];
            var h = this.getAssetIndex(t, e);
            if (s && -1 < h) {
                var l = this._fileList[h];
                l.loading || l.loaded ? (this._fileList.push(a), this._totalFileCount++) : this._fileList[h] = a;
            } else -1 === h && (this._fileList.push(a), this._totalFileCount++);
            return this;
        },
        replaceInFileList: function(t, e, i, n) {
            return this.addToFileList(t, e, i, n, !0);
        },
        pack: function(t, e, i, n) {
            if (void 0 === e && (e = null), void 0 === i && (i = null), void 0 === n && (n = null), 
            !e && !i) return this;
            var s = {
                type: "packfile",
                key: t,
                url: e,
                path: this.path,
                syncPoint: !0,
                data: null,
                loading: !1,
                loaded: !1,
                error: !1,
                callbackContext: n
            };
            i && ("string" == typeof i && (i = JSON.parse(i)), s.data = i || {}, s.loaded = !0);
            for (var o = 0; o < this._fileList.length + 1; o++) {
                var a = this._fileList[o];
                if (!a || !a.loaded && !a.loading && "packfile" !== a.type) {
                    this._fileList.splice(o, 0, s), this._totalPackCount++;
                    break;
                }
            }
            return this;
        },
        image: function(t, e, i) {
            return "object" == typeof e ? this.texture(t, e, i) : this.addToFileList("image", t, e, void 0, i, ".png");
        },
        imageFromBitmapData: function(t, e, i) {
            return this.image(t, e.canvas.toDataURL("image/png"), i);
        },
        imageFromGrid: function(t, e, i, n, s, o) {
            return this.imageFromBitmapData(t, this.game.create.grid(t, e, i, n, s, o, !1));
        },
        imageFromTexture: function(t, e, i, n, s) {
            return this.imageFromBitmapData(t, this.game.create.texture(t, e, i, n, s, !1));
        },
        texture: function(t, e, i) {
            if (this.game.renderType === z.WEBGL) {
                var n, s = this.game.renderer.extensions.compression;
                for (n in e) if (n.toUpperCase() in s) return this.addToFileList("texture", t, e[n], void 0, i, ".pvr");
            }
            return e.truecolor && this.addToFileList("image", t, e.truecolor, void 0, i, ".png"), 
            this;
        },
        images: function(t, e) {
            if (Array.isArray(e)) for (var i = 0; i < t.length; i++) this.image(t[i], e[i]); else for (i = 0; i < t.length; i++) this.image(t[i]);
            return this;
        },
        text: function(t, e, i) {
            return this.addToFileList("text", t, e, void 0, i, ".txt");
        },
        json: function(t, e, i) {
            return this.addToFileList("json", t, e, void 0, i, ".json");
        },
        shader: function(t, e, i) {
            return this.addToFileList("shader", t, e, void 0, i, ".frag");
        },
        xml: function(t, e, i) {
            return this.addToFileList("xml", t, e, void 0, i, ".xml");
        },
        script: function(t, e, i, n) {
            return void 0 === i && (i = !1), !1 !== i && void 0 === n && (n = this), this.addToFileList("script", t, e, {
                syncPoint: !0,
                callback: i,
                callbackContext: n
            }, !1, ".js");
        },
        binary: function(t, e, i, n) {
            return void 0 === i && (i = !1), !1 !== i && void 0 === n && (n = i), this.addToFileList("binary", t, e, {
                callback: i,
                callbackContext: n
            }, !1, ".bin");
        },
        spritesheet: function(t, e, i, n, s, o, a, r) {
            return void 0 === s && (s = -1), void 0 === o && (o = 0), void 0 === a && (a = 0), 
            void 0 === r && (r = 0), this.addToFileList("spritesheet", t, e, {
                frameWidth: i,
                frameHeight: n,
                frameMax: s,
                margin: o,
                spacing: a,
                skipFrames: r
            }, !1, ".png");
        },
        audio: function(t, e, i) {
            return this.game.sound.noAudio ? this : (void 0 === i && (i = !0), "string" == typeof e && (e = [ e ]), 
            this.addToFileList("audio", t, e, {
                buffer: null,
                autoDecode: i
            }));
        },
        audioSprite: function(t, e, i, n, s) {
            return this.game.sound.noAudio || (void 0 === i && (i = null), void 0 === n && (n = null), 
            void 0 === s && (s = !0), this.audio(t, e, s), i ? this.json(t + "-audioatlas", i) : n && ("string" == typeof n && (n = JSON.parse(n)), 
            this.cache.addJSON(t + "-audioatlas", "", n))), this;
        },
        audiosprite: function(t, e, i, n, s) {
            return this.audioSprite(t, e, i, n, s);
        },
        video: function(t, e, i, n) {
            return void 0 === i && (i = this.game.device.firefox ? "loadeddata" : "canplaythrough"), 
            void 0 === n && (n = !1), "string" == typeof e && (e = [ e ]), this.addToFileList("video", t, e, {
                buffer: null,
                asBlob: n,
                loadEvent: i
            });
        },
        tilemap: function(t, e, i, n) {
            if (void 0 === e && (e = null), void 0 === i && (i = null), void 0 === n && (n = z.Tilemap.CSV), 
            e || i || (e = n === z.Tilemap.CSV ? t + ".csv" : t + ".json"), i) {
                switch (n) {
                  case z.Tilemap.CSV:
                    break;

                  case z.Tilemap.TILED_JSON:
                    "string" == typeof i && (i = JSON.parse(i));
                }
                this.cache.addTilemap(t, null, i, n);
            } else this.addToFileList("tilemap", t, e, {
                format: n
            });
            return this;
        },
        tilemapCSV: function(t, e, i) {
            return this.tilemap(t, e, i, z.Tilemap.CSV);
        },
        tilemapTiledJSON: function(t, e, i) {
            return this.tilemap(t, e, i, z.Tilemap.TILED_JSON);
        },
        physics: function(t, e, i, n) {
            return void 0 === e && (e = null), void 0 === i && (i = null), void 0 === n && (n = z.Physics.LIME_CORONA_JSON), 
            e || i || (e = t + ".json"), i ? ("string" == typeof i && (i = JSON.parse(i)), this.cache.addPhysicsData(t, null, i, n)) : this.addToFileList("physics", t, e, {
                format: n
            }), this;
        },
        bitmapFont: function(t, e, i, n, s, o) {
            if (null == e && (e = t + ".png"), void 0 === i && (i = null), void 0 === n && (n = null), 
            null === i && null === n && (i = t + ".xml"), void 0 === s && (s = 0), void 0 === o && (o = 0), 
            i) this.addToFileList("bitmapfont", t, e, {
                atlasURL: i,
                xSpacing: s,
                ySpacing: o
            }); else if ("string" == typeof n) {
                var a, r;
                try {
                    a = JSON.parse(n);
                } catch (t) {
                    r = this.parseXml(n);
                }
                if (!r && !a) throw new Error("Phaser.Loader. Invalid Bitmap Font atlas given");
                this.addToFileList("bitmapfont", t, e, {
                    atlasURL: null,
                    atlasData: a || r,
                    atlasType: a ? "json" : "xml",
                    xSpacing: s,
                    ySpacing: o
                });
            }
            return this;
        },
        atlasJSONArray: function(t, e, i, n) {
            return this.atlas(t, e, i, n, z.Loader.TEXTURE_ATLAS_JSON_ARRAY);
        },
        atlasJSONHash: function(t, e, i, n) {
            return this.atlas(t, e, i, n, z.Loader.TEXTURE_ATLAS_JSON_HASH);
        },
        atlasXML: function(t, e, i, n) {
            return void 0 === i && (i = null), void 0 === n && (n = null), i || n || (i = t + ".xml"), 
            this.atlas(t, e, i, n, z.Loader.TEXTURE_ATLAS_XML_STARLING);
        },
        atlas: function(t, e, i, n, s) {
            if (null == e && (e = t + ".png"), void 0 === i && (i = null), void 0 === n && (n = null), 
            void 0 === s && (s = z.Loader.TEXTURE_ATLAS_JSON_ARRAY), i || n || (i = s === z.Loader.TEXTURE_ATLAS_XML_STARLING ? t + ".xml" : t + ".json"), 
            i) this.addToFileList("textureatlas", t, e, {
                atlasURL: i,
                format: s
            }); else {
                switch (s) {
                  case z.Loader.TEXTURE_ATLAS_JSON_ARRAY:
                    "string" == typeof n && (n = JSON.parse(n));
                    break;

                  case z.Loader.TEXTURE_ATLAS_XML_STARLING:
                    if ("string" == typeof n) {
                        var o = this.parseXml(n);
                        if (!o) throw new Error("Phaser.Loader. Invalid Texture Atlas XML given");
                        n = o;
                    }
                }
                this.addToFileList("textureatlas", t, e, {
                    atlasURL: null,
                    atlasData: n,
                    format: s
                });
            }
            return this;
        },
        withSyncPoint: function(t, e) {
            this._withSyncPointDepth++;
            try {
                t.call(e || this, this);
            } finally {
                this._withSyncPointDepth--;
            }
            return this;
        },
        addSyncPoint: function(t, e) {
            var i = this.getAsset(t, e);
            return i && (i.file.syncPoint = !0), this;
        },
        removeFile: function(t, e) {
            var i = this.getAsset(t, e);
            i && (i.loaded || i.loading || this._fileList.splice(i.index, 1));
        },
        removeAll: function() {
            this._fileList.length = 0, this._flightQueue.length = 0;
        },
        start: function() {
            this.isLoading || (this.hasLoaded = !1, this.isLoading = !0, this.updateProgress(), 
            this.processLoadQueue());
        },
        processLoadQueue: function() {
            if (this.isLoading) {
                for (var t = 0; t < this._flightQueue.length; t++) {
                    ((n = this._flightQueue[t]).loaded || n.error) && (this._flightQueue.splice(t, 1), 
                    t--, n.loading = !1, n.requestUrl = null, n.requestObject = null, n.error && this.onFileError.dispatch(n.key, n), 
                    "packfile" !== n.type ? (this._loadedFileCount++, this.onFileComplete.dispatch(this.progress, n.key, !n.error, this._loadedFileCount, this._totalFileCount)) : "packfile" === n.type && n.error && (this._loadedPackCount++, 
                    this.onPackComplete.dispatch(n.key, !n.error, this._loadedPackCount, this._totalPackCount)));
                }
                var e = !1, i = this.enableParallel ? Math.max(1, this.maxParallelDownloads) : 1;
                for (t = this._processingHead; t < this._fileList.length; t++) {
                    var n;
                    if ("packfile" === (n = this._fileList[t]).type && !n.error && n.loaded && t === this._processingHead && (this.processPack(n), 
                    this._loadedPackCount++, this.onPackComplete.dispatch(n.key, !n.error, this._loadedPackCount, this._totalPackCount)), 
                    n.loaded || n.error ? t === this._processingHead && (this._processingHead = t + 1) : !n.loading && this._flightQueue.length < i && ("packfile" !== n.type || n.data ? e || (this._fileLoadStarted || (this._fileLoadStarted = !0, 
                    this.onLoadStart.dispatch()), this._flightQueue.push(n), n.loading = !0, this.onFileStart.dispatch(this.progress, n.key, n.url), 
                    this.loadFile(n)) : (this._flightQueue.push(n), n.loading = !0, this.loadFile(n))), 
                    !n.loaded && n.syncPoint && (e = !0), this._flightQueue.length >= i || e && this._loadedPackCount === this._totalPackCount) break;
                }
                if (this.updateProgress(), this._processingHead >= this._fileList.length) this.finishedLoading(); else if (!this._flightQueue.length) {
                    var s = this;
                    setTimeout(function() {
                        s.finishedLoading(!0);
                    }, 2e3);
                }
            } else this.finishedLoading(!0);
        },
        finishedLoading: function(t) {
            this.hasLoaded || (this.hasLoaded = !0, this.isLoading = !1, t || this._fileLoadStarted || (this._fileLoadStarted = !0, 
            this.onLoadStart.dispatch()), this.game.state.loadUpdate(), this.onBeforeLoadComplete.dispatch(), 
            this.reset(), this.onLoadComplete.dispatch(), this.game.state && this.game.state.loadComplete());
        },
        asyncComplete: function(t, e) {
            void 0 === e && (e = ""), t.loaded = !0, t.error = !!e, e && (t.errorMessage = e), 
            this.processLoadQueue();
        },
        processPack: function(t) {
            var e = t.data[t.key];
            if (e) for (var i = 0; i < e.length; i++) {
                var n = e[i];
                switch (n.type) {
                  case "image":
                    this.image(n.key, n.url, n.overwrite);
                    break;

                  case "text":
                    this.text(n.key, n.url, n.overwrite);
                    break;

                  case "json":
                    this.json(n.key, n.url, n.overwrite);
                    break;

                  case "xml":
                    this.xml(n.key, n.url, n.overwrite);
                    break;

                  case "script":
                    this.script(n.key, n.url, n.callback, t.callbackContext || this);
                    break;

                  case "binary":
                    this.binary(n.key, n.url, n.callback, t.callbackContext || this);
                    break;

                  case "spritesheet":
                    this.spritesheet(n.key, n.url, n.frameWidth, n.frameHeight, n.frameMax, n.margin, n.spacing, n.skipFrames);
                    break;

                  case "video":
                    this.video(n.key, n.urls);
                    break;

                  case "audio":
                    this.audio(n.key, n.urls, n.autoDecode);
                    break;

                  case "audiosprite":
                    this.audiosprite(n.key, n.urls, n.jsonURL, n.jsonData, n.autoDecode);
                    break;

                  case "tilemap":
                    this.tilemap(n.key, n.url, n.data, z.Tilemap[n.format]);
                    break;

                  case "physics":
                    this.physics(n.key, n.url, n.data, z.Loader[n.format]);
                    break;

                  case "bitmapFont":
                    this.bitmapFont(n.key, n.textureURL, n.atlasURL, n.atlasData, n.xSpacing, n.ySpacing);
                    break;

                  case "atlasJSONArray":
                    this.atlasJSONArray(n.key, n.textureURL, n.atlasURL, n.atlasData);
                    break;

                  case "atlasJSONHash":
                    this.atlasJSONHash(n.key, n.textureURL, n.atlasURL, n.atlasData);
                    break;

                  case "atlasXML":
                    this.atlasXML(n.key, n.textureURL, n.atlasURL, n.atlasData);
                    break;

                  case "atlas":
                    this.atlas(n.key, n.textureURL, n.atlasURL, n.atlasData, z.Loader[n.format]);
                    break;

                  case "shader":
                    this.shader(n.key, n.url, n.overwrite);
                }
            }
        },
        transformUrl: function(t, e) {
            return !!t && (t.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/) ? t : this.baseURL + e.path + t);
        },
        loadFile: function(t) {
            switch (t.type) {
              case "packfile":
                this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.fileComplete);
                break;

              case "image":
              case "spritesheet":
              case "textureatlas":
              case "bitmapfont":
                this.loadImageTag(t);
                break;

              case "audio":
                t.url = this.getAudioURL(t.url), t.url ? this.game.sound.usingWebAudio ? this.xhrLoad(t, this.transformUrl(t.url, t), "arraybuffer", this.fileComplete) : this.game.sound.usingAudioTag && this.loadAudioTag(t) : this.fileError(t, null, "No supported audio URL specified or device does not have audio playback support");
                break;

              case "video":
                t.url = this.getVideoURL(t.url), t.url ? t.asBlob ? this.xhrLoad(t, this.transformUrl(t.url, t), "blob", this.fileComplete) : this.loadVideoTag(t) : this.fileError(t, null, "No supported video URL specified or device does not have video playback support");
                break;

              case "json":
                this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.jsonLoadComplete);
                break;

              case "xml":
                this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.xmlLoadComplete);
                break;

              case "tilemap":
                t.format === z.Tilemap.TILED_JSON ? this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.jsonLoadComplete) : t.format === z.Tilemap.CSV ? this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.csvLoadComplete) : this.asyncComplete(t, "invalid Tilemap format: " + t.format);
                break;

              case "text":
              case "script":
              case "shader":
              case "physics":
                this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.fileComplete);
                break;

              case "texture":
                "truecolor" === t.key.split("_").pop() ? this.loadImageTag(t) : this.xhrLoad(t, this.transformUrl(t.url, t), "arraybuffer", this.fileComplete);
                break;

              case "binary":
                this.xhrLoad(t, this.transformUrl(t.url, t), "arraybuffer", this.fileComplete);
            }
        },
        loadImageTag: function(t) {
            var e = this;
            t.data = new Image(), t.data.name = t.key, this.crossOrigin && (t.data.crossOrigin = this.crossOrigin), 
            t.data.onload = function() {
                t.data.onload && (t.data.onload = null, t.data.onerror = null, e.fileComplete(t));
            }, t.data.onerror = function() {
                t.data.onload && (t.data.onload = null, t.data.onerror = null, e.fileError(t));
            }, t.data.src = this.transformUrl(t.url, t), !this.game.device.firefox && t.data.complete && t.data.width && t.data.height && (t.data.onload = null, 
            t.data.onerror = null, this.fileComplete(t));
        },
        loadVideoTag: function(t) {
            var e = this;
            t.data = document.createElement("video"), t.data.name = t.key, t.data.controls = !1, 
            t.data.autoplay = !1, t.data.playsInline = !0;
            var i = function() {
                t.data.removeEventListener(t.loadEvent, i, !1), t.data.onerror = null, t.data.canplay = !0, 
                z.GAMES[e.game.id].load.fileComplete(t);
            };
            t.data.onerror = function() {
                t.data.removeEventListener(t.loadEvent, i, !1), t.data.onerror = null, t.data.canplay = !1, 
                e.fileError(t);
            }, t.data.addEventListener(t.loadEvent, i, !1), t.data.src = this.transformUrl(t.url, t), 
            t.data.load();
        },
        loadAudioTag: function(t) {
            var e = this;
            if (this.game.sound.touchLocked) t.data = new Audio(), t.data.name = t.key, t.data.preload = "auto", 
            t.data.src = this.transformUrl(t.url, t), this.fileComplete(t); else {
                t.data = new Audio(), t.data.name = t.key;
                var i = function() {
                    t.data.removeEventListener("canplaythrough", i, !1), t.data.onerror = null, e.fileComplete(t);
                };
                t.data.onerror = function() {
                    t.data.removeEventListener("canplaythrough", i, !1), t.data.onerror = null, e.fileError(t);
                }, t.data.preload = "auto", t.data.src = this.transformUrl(t.url, t), t.data.addEventListener("canplaythrough", i, !1), 
                t.data.load();
            }
        },
        xhrLoad: function(e, t, i, n, s) {
            var o = new XMLHttpRequest();
            o.open("GET", t, !0), o.responseType = i, !1 !== this.headers.requestedWith && o.setRequestHeader("X-Requested-With", this.headers.requestedWith), 
            this.headers[e.type] && o.setRequestHeader("Accept", this.headers[e.type]), s = s || this.fileError;
            var a = this;
            o.onload = function() {
                try {
                    return 4 === o.readyState && 400 <= o.status && o.status <= 599 ? s.call(a, e, o) : n.call(a, e, o);
                } catch (t) {
                    a.hasLoaded ? window.console : a.asyncComplete(e, t.message || "Exception");
                }
            }, o.onerror = function() {
                try {
                    return s.call(a, e, o);
                } catch (t) {
                    a.hasLoaded ? window.console : a.asyncComplete(e, t.message || "Exception");
                }
            }, e.requestObject = o, e.requestUrl = t, o.send();
        },
        getVideoURL: function(t) {
            for (var e = 0; e < t.length; e++) {
                var i, n = t[e];
                if (n.uri) {
                    if (i = n.type, n = n.uri, this.game.device.canPlayVideo(i)) return n;
                } else {
                    if (0 === n.indexOf("blob:") || 0 === n.indexOf("data:")) return n;
                    if (0 <= n.indexOf("?") && (n = n.substr(0, n.indexOf("?"))), i = n.substr((Math.max(0, n.lastIndexOf(".")) || 1 / 0) + 1).toLowerCase(), 
                    this.game.device.canPlayVideo(i)) return t[e];
                }
            }
            return null;
        },
        getAudioURL: function(t) {
            if (this.game.sound.noAudio) return null;
            for (var e = 0; e < t.length; e++) {
                var i, n = t[e];
                if (n.uri) {
                    if (i = n.type, n = n.uri, this.game.device.canPlayAudio(i)) return n;
                } else {
                    if (0 === n.indexOf("blob:") || 0 === n.indexOf("data:")) return n;
                    if (0 <= n.indexOf("?") && (n = n.substr(0, n.indexOf("?"))), i = n.substr((Math.max(0, n.lastIndexOf(".")) || 1 / 0) + 1).toLowerCase(), 
                    this.game.device.canPlayAudio(i)) return t[e];
                }
            }
            return null;
        },
        fileError: function(t, e, i) {
            var n = "error loading asset from URL " + (t.requestUrl || this.transformUrl(t.url, t));
            !i && e && (i = e.status), i && (n = n + " (" + i + ")"), this.asyncComplete(t, n);
        },
        fileComplete: function(e, t) {
            var i = !0;
            switch (e.type) {
              case "packfile":
                var n = JSON.parse(t.responseText);
                e.data = n || {};
                break;

              case "texture":
                var s = /\.([^.]+)$/.exec(e.url.split("?", 1)[0])[1].toLowerCase();
                null !== e.data ? this.cache.addCompressedTextureMetaData(e.key, e.url, s, e.data) : this.cache.addCompressedTextureMetaData(e.key, e.url, s, t.response);
                break;

              case "image":
                this.cache.addImage(e.key, e.url, e.data);
                break;

              case "spritesheet":
                this.cache.addSpriteSheet(e.key, e.url, e.data, e.frameWidth, e.frameHeight, e.frameMax, e.margin, e.spacing, e.skipFrames);
                break;

              case "textureatlas":
                if (null == e.atlasURL) this.cache.addTextureAtlas(e.key, e.url, e.data, e.atlasData, e.format); else if (i = !1, 
                e.format === z.Loader.TEXTURE_ATLAS_JSON_ARRAY || e.format === z.Loader.TEXTURE_ATLAS_JSON_HASH || e.format === z.Loader.TEXTURE_ATLAS_JSON_PYXEL) this.xhrLoad(e, this.transformUrl(e.atlasURL, e), "text", this.jsonLoadComplete); else {
                    if (e.format !== z.Loader.TEXTURE_ATLAS_XML_STARLING) throw new Error("Phaser.Loader. Invalid Texture Atlas format: " + e.format);
                    this.xhrLoad(e, this.transformUrl(e.atlasURL, e), "text", this.xmlLoadComplete);
                }
                break;

              case "bitmapfont":
                e.atlasURL ? (i = !1, this.xhrLoad(e, this.transformUrl(e.atlasURL, e), "text", function(t, e) {
                    var i;
                    try {
                        i = JSON.parse(e.responseText);
                    } catch (t) {}
                    i ? (t.atlasType = "json", this.jsonLoadComplete(t, e)) : (t.atlasType = "xml", 
                    this.xmlLoadComplete(t, e));
                })) : this.cache.addBitmapFont(e.key, e.url, e.data, e.atlasData, e.atlasType, e.xSpacing, e.ySpacing);
                break;

              case "video":
                if (e.asBlob) try {
                    e.data = t.response;
                } catch (t) {
                    throw new Error("Phaser.Loader. Unable to parse video file as Blob: " + e.key);
                }
                this.cache.addVideo(e.key, e.url, e.data, e.asBlob);
                break;

              case "audio":
                this.game.sound.usingWebAudio ? (e.data = t.response, this.cache.addSound(e.key, e.url, e.data, !0, !1), 
                e.autoDecode && this.game.sound.decode(e.key)) : this.cache.addSound(e.key, e.url, e.data, !1, !0);
                break;

              case "text":
                e.data = t.responseText, this.cache.addText(e.key, e.url, e.data);
                break;

              case "shader":
                e.data = t.responseText, this.cache.addShader(e.key, e.url, e.data);
                break;

              case "physics":
                n = JSON.parse(t.responseText);
                this.cache.addPhysicsData(e.key, e.url, n, e.format);
                break;

              case "script":
                e.data = document.createElement("script"), e.data.language = "javascript", e.data.type = "text/javascript", 
                e.data.defer = !1, e.data.text = t.responseText, document.head.appendChild(e.data), 
                e.callback && (e.data = e.callback.call(e.callbackContext, e.key, t.responseText));
                break;

              case "binary":
                e.callback ? e.data = e.callback.call(e.callbackContext, e.key, t.response) : e.data = t.response, 
                this.cache.addBinary(e.key, e.data);
            }
            i && this.asyncComplete(e);
        },
        jsonLoadComplete: function(t, e) {
            var i = JSON.parse(e.responseText);
            "tilemap" === t.type ? this.cache.addTilemap(t.key, t.url, i, t.format) : "bitmapfont" === t.type ? this.cache.addBitmapFont(t.key, t.url, t.data, i, t.atlasType, t.xSpacing, t.ySpacing) : "json" === t.type ? this.cache.addJSON(t.key, t.url, i) : this.cache.addTextureAtlas(t.key, t.url, t.data, i, t.format), 
            this.asyncComplete(t);
        },
        csvLoadComplete: function(t, e) {
            var i = e.responseText;
            this.cache.addTilemap(t.key, t.url, i, t.format), this.asyncComplete(t);
        },
        xmlLoadComplete: function(t, e) {
            var i = e.responseText, n = this.parseXml(i);
            if (n) "bitmapfont" === t.type ? this.cache.addBitmapFont(t.key, t.url, t.data, n, t.atlasType, t.xSpacing, t.ySpacing) : "textureatlas" === t.type ? this.cache.addTextureAtlas(t.key, t.url, t.data, n, t.format) : "xml" === t.type && this.cache.addXML(t.key, t.url, n), 
            this.asyncComplete(t); else {
                e.responseType || e.contentType;
                this.asyncComplete(t, "invalid XML");
            }
        },
        parseXml: function(t) {
            var e;
            try {
                if (window.DOMParser) e = new DOMParser().parseFromString(t, "text/xml"); else (e = new ActiveXObject("Microsoft.XMLDOM")).async = "false", 
                e.loadXML(t);
            } catch (t) {
                e = null;
            }
            return e && e.documentElement && !e.getElementsByTagName("parsererror").length ? e : null;
        },
        updateProgress: function() {
            this.preloadSprite && (0 === this.preloadSprite.direction ? this.preloadSprite.rect.width = Math.floor(this.preloadSprite.width / 100 * this.progress) : this.preloadSprite.rect.height = Math.floor(this.preloadSprite.height / 100 * this.progress), 
            this.preloadSprite.sprite ? this.preloadSprite.sprite.updateCrop() : this.preloadSprite = null);
        },
        totalLoadedFiles: function() {
            return this._loadedFileCount;
        },
        totalQueuedFiles: function() {
            return this._totalFileCount - this._loadedFileCount;
        },
        totalLoadedPacks: function() {
            return this._totalPackCount;
        },
        totalQueuedPacks: function() {
            return this._totalPackCount - this._loadedPackCount;
        }
    }, Object.defineProperty(z.Loader.prototype, "progressFloat", {
        get: function() {
            var t = this._loadedFileCount / this._totalFileCount * 100;
            return z.Math.clamp(t || 0, 0, 100);
        }
    }), Object.defineProperty(z.Loader.prototype, "progress", {
        get: function() {
            return Math.round(this.progressFloat);
        }
    }), z.Loader.prototype.constructor = z.Loader, z.LoaderParser = {
        bitmapFont: function(t, e, i, n, s, o) {
            return this.xmlBitmapFont(t, e, i, n, s, o);
        },
        xmlBitmapFont: function(t, e, i, n, s, o) {
            null == o && (o = 1);
            var a = {}, r = t.getElementsByTagName("info")[0], h = t.getElementsByTagName("common")[0];
            a.font = r.getAttribute("face"), a.size = parseInt(r.getAttribute("size"), 10), 
            a.lineHeight = parseInt(h.getAttribute("lineHeight"), 10) + n, a.chars = {};
            for (var l = t.getElementsByTagName("char"), c = s ? s.x : 0, u = s ? s.y : 0, d = 0; d < l.length; d++) {
                var p = parseInt(l[d].getAttribute("id"), 10), g = a.chars[p] = {
                    x: parseInt(l[d].getAttribute("x"), 10),
                    y: parseInt(l[d].getAttribute("y"), 10),
                    width: parseInt(l[d].getAttribute("width"), 10),
                    height: parseInt(l[d].getAttribute("height"), 10),
                    xOffset: parseInt(l[d].getAttribute("xoffset"), 10) / o,
                    yOffset: parseInt(l[d].getAttribute("yoffset"), 10) / o,
                    xAdvance: (parseInt(l[d].getAttribute("xadvance"), 10) + i) / o,
                    kerning: {}
                };
                if (s && s.trimmed) {
                    if (g.x + g.width > s.spriteSourceSizeX + s.spriteSourceSizeW && (g.width -= g.x + g.width - s.spriteSourceSizeX - s.spriteSourceSizeW), 
                    g.y + g.height > s.spriteSourceSizeY + s.spriteSourceSizeH && (g.height -= g.y + g.height - s.spriteSourceSizeY - s.spriteSourceSizeH), 
                    g.x < s.spriteSourceSizeX) {
                        var m = s.spriteSourceSizeX - g.x;
                        g.x = 0, g.width -= m, g.xOffset += m;
                    }
                    if (g.y < s.spriteSourceSizeY) {
                        m = s.spriteSourceSizeY - g.y;
                        g.y = 0, g.height -= m, g.yOffset += m;
                    }
                }
                g.x += c, g.y += u;
            }
            var f = t.getElementsByTagName("kerning");
            for (d = 0; d < f.length; d++) {
                var y = parseInt(f[d].getAttribute("first"), 10), v = parseInt(f[d].getAttribute("second"), 10), b = parseInt(f[d].getAttribute("amount"), 10) / o;
                a.chars[v] && (a.chars[v].kerning[y] = b);
            }
            return this.finalizeBitmapFont(e, a);
        },
        jsonBitmapFont: function(t, e, s, i, o, a) {
            null == a && (a = 1);
            var r = {
                font: t.font.info._face,
                size: parseInt(t.font.info._size, 10),
                lineHeight: parseInt(t.font.common._lineHeight, 10) + i,
                chars: {}
            }, h = o ? o.x : 0, l = o ? o.y : 0;
            return t.font.chars.char.forEach(function(t) {
                var e = parseInt(t._id, 10), i = r.chars[e] = {
                    x: parseInt(t._x, 10),
                    y: parseInt(t._y, 10),
                    width: parseInt(t._width, 10),
                    height: parseInt(t._height, 10),
                    xOffset: parseInt(t._xoffset, 10) / a,
                    yOffset: parseInt(t._yoffset, 10) / a,
                    xAdvance: (parseInt(t._xadvance, 10) + s) / a,
                    kerning: {}
                };
                if (o && o.trimmed) {
                    if (i.x + i.width > o.spriteSourceSizeX + o.spriteSourceSizeW && (i.width -= i.x + i.width - o.spriteSourceSizeX - o.spriteSourceSizeW), 
                    i.y + i.height > o.spriteSourceSizeY + o.spriteSourceSizeH && (i.height -= i.y + i.height - o.spriteSourceSizeY - o.spriteSourceSizeH), 
                    i.x < o.spriteSourceSizeX) {
                        var n = o.spriteSourceSizeX - i.x;
                        i.x = 0, i.width -= n, i.xOffset += n;
                    }
                    if (i.y < o.spriteSourceSizeY) {
                        n = o.spriteSourceSizeY - i.y;
                        i.y = 0, i.height -= n, i.yOffset += n;
                    }
                }
                i.x += h, i.y += l;
            }), t.font.kernings && t.font.kernings.kerning && t.font.kernings.kerning.forEach(function(t) {
                r.chars[t._second] && (r.chars[t._second].kerning[t._first] = parseInt(t._amount, 10) / a);
            }), this.finalizeBitmapFont(e, r);
        },
        finalizeBitmapFont: function(i, n) {
            return Object.keys(n.chars).forEach(function(t) {
                var e = n.chars[t];
                e.texture = new PIXI.Texture(i, new z.Rectangle(e.x, e.y, e.width, e.height));
            }), n;
        },
        pvr: function(t) {
            var e, i = new Uint32Array(t.slice(0, 52)), n = new Uint8Array(t), s = null, o = i[3] << 32 | i[2], a = 0;
            if (55727696 === i[0] && 0 <= [ 0, 1, 2, 3, 6, 7, 9, 11 ].indexOf(o)) {
                switch (0 <= o && o <= 3 ? e = "PVRTC" : 7 <= o && o <= 11 ? e = "S3TC" : 6 === o && (e = "ETC1"), 
                o) {
                  case 0:
                    a = 35841;
                    break;

                  case 1:
                    a = 35843;
                    break;

                  case 2:
                    a = 35840;
                    break;

                  case 3:
                    a = 35842;
                    break;

                  case 6:
                    a = 36196;
                    break;

                  case 7:
                    a = 33777;
                    break;

                  case 9:
                    a = 33778;
                    break;

                  case 11:
                    a = 33779;
                    break;

                  default:
                    a = -1;
                }
                s = {
                    complete: !0,
                    fileFormat: "PVR",
                    compressionAlgorithm: e,
                    flags: i[1],
                    pixelFormat: o,
                    colorSpace: i[4],
                    channelType: i[5],
                    height: i[6],
                    width: i[7],
                    depth: i[8],
                    numberOfSurfaces: i[9],
                    numberOfFaces: i[10],
                    numberOfMipmaps: i[11],
                    metaDataSize: i[12],
                    textureData: n.subarray(52 + i[12], n.byteLength),
                    glExtensionFormat: a
                };
            }
            return s;
        },
        dds: function(t) {
            var e = new Uint8Array(t), i = new Uint32Array(t), n = null;
            return 68 === e[0] && 68 === e[1] && 83 === e[2] && 32 === e[3] && ("DX10" === (n = {
                complete: !0,
                fileFormat: "DDS",
                compressionAlgorithm: "S3TC",
                size: i[1],
                flags: i[2],
                height: i[3],
                width: i[4],
                pitch: i[5],
                depth: i[6],
                mipmapCount: i[7],
                formatSize: i[19],
                formatFlag: i[19],
                formatFourCC: [ String.fromCharCode(e[84]), String.fromCharCode(e[85]), String.fromCharCode(e[86]), String.fromCharCode(e[87]) ].join(""),
                formatBitCount: i[21],
                formatRBitMask: i[22],
                formatGBitMask: i[23],
                formatBBitMask: i[24],
                formatABitMask: i[25],
                caps1: i[26],
                caps2: i[27],
                caps3: i[28],
                caps4: i[29],
                reserved2: i[30],
                DXGIFormat: null,
                resourceDimension: null,
                miscFlag: null,
                arraySize: null,
                textureData: e.subarray(i[1] + 4, e.byteLength)
            }).formatFourCC ? (n.DXGIFormat = i[31], n.resourceDimension = i[32], n.miscFlag = i[33], 
            n.arraySize = i[34], n.miscFlag = i[35]) : "DXT5" === n.formatFourCC ? n.glExtensionFormat = 33779 : "DXT3" === n.formatFourCC && (n.glExtensionFormat = 33778)), 
            n;
        },
        ktx: function(t) {
            var e = new Uint8Array(t), i = new Uint32Array(t), n = null, s = 16 + i[15] / 4 | 0, o = i[s], a = i[7], r = 0;
            if (171 === e[0] && 75 === e[1] && 84 === e[2] && 88 === e[3] && 32 === e[4] && 49 === e[5] && 49 === e[6] && 187 === e[7] && 13 === e[8] && 10 === e[9] && 26 === e[10] && 10 === e[11] && 0 <= [ 36196, 35840, 35841, 35842, 35843, 33776, 33777, 33778, 33779 ].indexOf(a)) {
                switch (a) {
                  case 36196:
                    r = "ETC1";
                    break;

                  case 35840:
                  case 35841:
                  case 35842:
                  case 35843:
                    r = "PVRTC";
                    break;

                  case 33776:
                  case 33777:
                  case 33778:
                  case 33779:
                    r = "S3TC";
                }
                n = {
                    complete: !0,
                    fileFormat: "KTX",
                    compressionAlgorithm: r,
                    endianness: i[3],
                    glType: i[4],
                    glTypeSize: i[5],
                    glFormat: i[6],
                    glInternalFormat: i[7],
                    glBaseInternalFormat: i[8],
                    width: i[9],
                    height: i[10],
                    pixelDepth: i[11],
                    numberOfArrayElements: i[12],
                    numberOfFaces: i[13],
                    numberOfMipmapLevels: i[14],
                    bytesOfKeyValueData: i[15],
                    keyAndValueByteSize: i[16],
                    imageSize: o,
                    textureData: e.subarray(4 * (s + 1), o + 100)
                };
            }
            return n;
        },
        pkm: function(t) {
            var e = new Uint8Array(t), i = null;
            return 80 === e[0] && 75 === e[1] && 77 === e[2] && 32 === e[3] && (i = {
                complete: !0,
                fileFormat: "PKM",
                compressionAlgorithm: "ETC1",
                format: 65535 & (e[6] << 8 | e[7]),
                width: 65535 & (e[8] << 8 | e[9]),
                height: 65535 & (e[10] << 8 | e[11]),
                originalWidth: 65535 & (e[12] << 8 | e[13]),
                originalHeight: 65535 & (e[14] << 8 | e[15]),
                textureData: e.subarray(16, e.length)
            }), i;
        }
    }, z.AudioSprite = function(t, e) {
        for (var i in this.game = t, this.key = e, this.config = this.game.cache.getJSON(e + "-audioatlas"), 
        this.autoplayKey = null, this.autoplay = !1, this.sounds = {}, this.config.spritemap) {
            var n = this.config.spritemap[i], s = this.game.add.sound(this.key);
            s.addMarker(i, n.start, n.end - n.start, null, n.loop), this.sounds[i] = s;
        }
        this.config.autoplay && (this.autoplayKey = this.config.autoplay, this.play(this.autoplayKey), 
        this.autoplay = this.sounds[this.autoplayKey]);
    }, z.AudioSprite.prototype = {
        play: function(t, e) {
            return void 0 === e && (e = 1), this.sounds[t].play(t, null, e);
        },
        stop: function(t) {
            if (t) this.sounds[t].stop(); else for (var e in this.sounds) this.sounds[e].stop();
        },
        get: function(t) {
            return this.sounds[t];
        }
    }, z.AudioSprite.prototype.constructor = z.AudioSprite, z.Sound = function(t, e, i, n, s) {
        void 0 === i && (i = 1), void 0 === n && (n = !1), void 0 === s && (s = t.sound.connectToMaster), 
        this.game = t, this.name = e, this.key = e, this.loop = n, this.markers = {}, this.context = null, 
        this.autoplay = !1, this.totalDuration = 0, this.startTime = 0, this.currentTime = 0, 
        this.duration = 0, this.durationMS = 0, this.position = 0, this.stopTime = 0, this.paused = !1, 
        this.pausedPosition = 0, this.pausedTime = 0, this.isPlaying = !1, this.currentMarker = "", 
        this.fadeTween = null, this.pendingPlayback = !1, this.override = !1, this.allowMultiple = !1, 
        this.playOnce = !1, this.usingWebAudio = this.game.sound.usingWebAudio, this.usingAudioTag = this.game.sound.usingAudioTag, 
        this.externalNode = null, this.masterGainNode = null, this.gainNode = null, this._sound = null, 
        this._globalVolume = 1, this._markedToDelete = !1, this._pendingStart = !1, this._removeFromSoundManager = !1, 
        this._sourceId = 0, this.usingWebAudio ? (this.context = this.game.sound.context, 
        this.masterGainNode = this.game.sound.masterGain, void 0 === this.context.createGain ? this.gainNode = this.context.createGainNode() : this.gainNode = this.context.createGain(), 
        this.gainNode.gain.value = i, s && this.gainNode.connect(this.masterGainNode)) : this.usingAudioTag && (this.game.cache.getSound(e) && this.game.cache.isSoundReady(e) ? (this._sound = this.game.cache.getSoundData(e), 
        this.totalDuration = 0, this._sound.duration && (this.totalDuration = this._sound.duration)) : this.game.cache.onSoundUnlock.add(this.soundHasUnlocked, this)), 
        this.onDecoded = new z.Signal(), this.onPlay = new z.Signal(), this.onPause = new z.Signal(), 
        this.onResume = new z.Signal(), this.onLoop = new z.Signal(), this.onStop = new z.Signal(), 
        this.onMute = new z.Signal(), this.onMarkerComplete = new z.Signal(), this.onFadeComplete = new z.Signal(), 
        this._volume = i, this._buffer = null, this._muted = !1, this._tempMarker = 0, this._tempPosition = 0, 
        this._tempVolume = 0, this._tempPause = 0, this._muteVolume = 0, this._tempLoop = 0, 
        this._paused = !1, this._onDecodedEventDispatched = !1;
    }, z.Sound.prototype = {
        soundHasUnlocked: function(t) {
            t === this.key && (this._sound = this.game.cache.getSoundData(this.key), this.totalDuration = this._sound.duration);
        },
        addMarker: function(t, e, i, n, s) {
            null == i && (i = 1), null == n && (n = 1), void 0 === s && (s = !1), this.markers[t] = {
                name: t,
                start: e,
                stop: e + i,
                volume: n,
                duration: i,
                durationMS: 1e3 * i,
                loop: s
            };
        },
        removeMarker: function(t) {
            delete this.markers[t];
        },
        onEndedHandler: function() {
            this._removeOnEndedHandler(), this.isPlaying = !1, this.currentTime = this.durationMS, 
            this.stop(), this.playOnce && (this._markedToDelete = !0, this._removeFromSoundManager = !0), 
            this._markedToDelete && (this._disconnectSource(), this._removeFromSoundManager ? this.game.sound.remove(this) : (this.markers = {}, 
            this.context = null, this._buffer = null, this.externalNode = null, this.onDecoded.dispose(), 
            this.onPlay.dispose(), this.onPause.dispose(), this.onResume.dispose(), this.onLoop.dispose(), 
            this.onStop.dispose(), this.onMute.dispose(), this.onMarkerComplete.dispose()));
        },
        update: function() {
            if (this.game.cache.checkSoundKey(this.key)) {
                this.isDecoded && !this._onDecodedEventDispatched && (this.onDecoded.dispatch(this), 
                this._onDecodedEventDispatched = !0), this.pendingPlayback && this.game.cache.isSoundReady(this.key) && (this.pendingPlayback = !1, 
                this.play(this._tempMarker, this._tempPosition, this._tempVolume, this._tempLoop));
                var t = this.game.time.time;
                if (this.isPlaying) {
                    if (this._pendingStart) {
                        var e = this._sound.currentTime;
                        if (!(e > ((this.paused ? this._tempPause : 0) || this.position || 0))) return;
                        this._pendingStart = !1, this.startTime = t - 1e3 * e, this.stopTime = this.startTime + this.durationMS;
                    }
                    this.currentTime = t - this.startTime, this.currentTime >= this.durationMS && (this.usingWebAudio ? this.loop ? (this.onLoop.dispatch(this), 
                    this.isPlaying = !1, "" === this.currentMarker ? (this.currentTime = 0, this.startTime = t, 
                    this.isPlaying = !0) : (this.onMarkerComplete.dispatch(this.currentMarker, this), 
                    this.play(this.currentMarker, 0, this.volume, !0, !0))) : "" !== this.currentMarker && this.stop() : this.loop ? (this.onLoop.dispatch(this), 
                    "" === this.currentMarker && (this.currentTime = 0, this.startTime = t), this.isPlaying = !1, 
                    this.play(this.currentMarker, 0, this.volume, !0, !0)) : this.stop());
                }
            } else this.destroy();
        },
        loopFull: function(t) {
            return this.play(null, 0, t, !0);
        },
        play: function(t, e, i, n, s) {
            if (void 0 !== t && !1 !== t && null !== t || (t = ""), void 0 === s && (s = !0), 
            this.isPlaying && !this.allowMultiple && !s && !this.override) return this;
            if (this._sound && this.isPlaying && !this.allowMultiple && (this.override || s) && (this.usingWebAudio ? this._stopSourceAndDisconnect() : this.usingAudioTag && (this._sound.pause(), 
            this._sound.currentTime = 0), this.isPlaying = !1), "" === t && 0 < Object.keys(this.markers).length) return this;
            if ("" !== t) {
                if (!this.markers[t]) return this;
                this.currentMarker = t, this.position = this.markers[t].start, this.volume = this.markers[t].volume, 
                this.loop = this.markers[t].loop, this.duration = this.markers[t].duration, this.durationMS = this.markers[t].durationMS, 
                void 0 !== i && (this.volume = i), void 0 !== n && (this.loop = n), this._tempMarker = t, 
                this._tempPosition = this.position, this._tempVolume = this.volume, this._tempLoop = this.loop;
            } else e = e || 0, void 0 === i && (i = this._volume), void 0 === n && (n = this.loop), 
            this.position = Math.max(0, e), this.volume = i, this.loop = n, this.duration = 0, 
            this.durationMS = 0, this._tempMarker = t, this._tempPosition = e, this._tempVolume = i, 
            this._tempLoop = n;
            return this.usingWebAudio ? this.game.cache.isSoundDecoded(this.key) ? (this._createSourceAndConnect(), 
            this.loop && "" === t && (this._sound.loop = !0), this.loop || "" !== t || this._addOnEndedHandler(), 
            this.totalDuration = this._sound.buffer.duration, 0 === this.duration && (this.duration = this.totalDuration, 
            this.durationMS = Math.ceil(1e3 * this.totalDuration)), this.loop && "" === t ? this._startSource(0, 0) : this._startSource(0, this.position, this.duration), 
            this.isPlaying = !0, this.paused = !1, this.startTime = this.game.time.time, this.currentTime = 0, 
            this.stopTime = this.startTime + this.durationMS, this.onPlay.dispatch(this)) : (this.pendingPlayback = !0, 
            this.game.cache.getSound(this.key) && !1 === this.game.cache.getSound(this.key).isDecoding && this.game.sound.decode(this.key, this)) : this.game.cache.getSound(this.key) && this.game.cache.getSound(this.key).locked ? (this.game.cache.reloadSound(this.key), 
            this.pendingPlayback = !0) : this._sound && (this.game.device.cocoonJS || 4 === this._sound.readyState) ? (this._sound.play(), 
            this._sound.loop = this.loop, this.totalDuration = this._sound.duration, 0 === this.duration && (this.duration = this.totalDuration, 
            this.durationMS = 1e3 * this.totalDuration), this._globalVolume = this.game.sound.volume, 
            this._sound.currentTime = this.position, this._sound.muted = this._muted, this._muted || this.game.sound.mute ? this._sound.volume = 0 : this._sound.volume = this._volume * this._globalVolume, 
            this._pendingStart = !0, this.isPlaying = !0, this.paused = !1, this._tempPause = 0, 
            this.startTime = this.game.time.time, this.currentTime = 0, this.stopTime = this.startTime + this.durationMS, 
            this.onPlay.dispatch(this)) : this.pendingPlayback = !0, this.playOnce && (this.loop, 
            this._markedToDelete = !0, this._removeFromSoundManager = !0), this;
        },
        restart: function(t, e, i, n) {
            t = t || "", e = e || 0, i = i || 1, void 0 === n && (n = !1), this.play(t, e, i, n, !0);
        },
        pause: function() {
            this.isPlaying && (this.paused = !0, this.pausedPosition = this.currentTime, this.pausedTime = this.game.time.time, 
            this._tempPause = this._sound.currentTime, this.onPause.dispatch(this), this.stop());
        },
        resume: function() {
            if (this.paused) {
                if (this.usingWebAudio) {
                    var t = Math.max(0, this.position + this.pausedPosition / 1e3);
                    this._createSourceAndConnect(), "" === this.currentMarker && (this.loop ? this._sound.loop = !0 : this._addOnEndedHandler());
                    var e = this.duration - this.pausedPosition / 1e3;
                    this.loop && "" === this.currentMarker ? this._startSource(0, t) : this._startSource(0, t, e);
                } else this._pendingStart = !0, this._sound.currentTime = this._tempPause, this._tempPause = 0, 
                this._sound.play();
                this.isPlaying = !0, this.paused = !1, this.startTime += this.game.time.time - this.pausedTime, 
                this.onResume.dispatch(this);
            }
        },
        stop: function() {
            if (this.isPlaying && this._sound && (this.usingWebAudio ? this._stopSourceAndDisconnect() : this.usingAudioTag && (this._sound.pause(), 
            this._sound.currentTime = 0)), this.pendingPlayback = !1, this.isPlaying = !1, !this.paused) {
                var t = this.currentMarker;
                "" !== this.currentMarker && this.onMarkerComplete.dispatch(this.currentMarker, this), 
                this.currentMarker = "", null !== this.fadeTween && this.fadeTween.stop(), this.onStop.dispatch(this, t);
            }
        },
        fadeIn: function(t, e, i) {
            void 0 === e && (e = !1), void 0 === i && (i = this.currentMarker), this.paused || (this.play(i, 0, 0, e), 
            this.fadeTo(t, 1));
        },
        fadeOut: function(t) {
            this.fadeTo(t, 0);
        },
        fadeTo: function(t, e) {
            this.isPlaying && !this.paused && e !== this.volume && (void 0 === t && (t = 1e3), 
            void 0 !== e && (this.fadeTween = this.game.add.tween(this).to({
                volume: e
            }, t, z.Easing.Linear.None, !0), this.fadeTween.onComplete.add(this.fadeComplete, this)));
        },
        fadeComplete: function() {
            this.onFadeComplete.dispatch(this, this.volume), 0 === this.volume && this.stop();
        },
        updateGlobalVolume: function(t) {
            this.usingAudioTag && this._sound && (this._globalVolume = t, this._sound.volume = this._globalVolume * this._volume);
        },
        destroy: function(t) {
            void 0 === t && (t = !0), this._markedToDelete = !0, this._removeFromSoundManager = t, 
            this.stop(), t ? this.game.sound.remove(this) : (this.markers = {}, this.context = null, 
            this._buffer = null, this.externalNode = null, this.onDecoded.dispose(), this.onPlay.dispose(), 
            this.onPause.dispose(), this.onResume.dispose(), this.onLoop.dispose(), this.onStop.dispose(), 
            this.onMute.dispose(), this.onMarkerComplete.dispose());
        },
        _createSourceAndConnect: function() {
            this._sound = this.context.createBufferSource(), this._sound.connect(this.externalNode || this.gainNode), 
            this._buffer = this.game.cache.getSoundData(this.key), this._sound.buffer = this._buffer, 
            this._sourceId++;
        },
        _disconnectSource: function() {
            this._sound.disconnect(this.externalNode || this.gainNode);
        },
        _startSource: function(t, e, i) {
            void 0 === i ? this._sound.start(t || 0, e || 0) : this._sound.start(t || 0, e || 0, i);
        },
        _stopSourceAndDisconnect: function() {
            this._removeOnEndedHandler();
            try {
                this._sound.stop(0);
            } catch (t) {}
            this._disconnectSource(), this._sound = null;
        },
        _addOnEndedHandler: function() {
            this._sound.onended = this.onEndedHandler.bind(this);
        },
        _removeOnEndedHandler: function() {
            this._sound.onended = null;
        }
    }, z.Sound.prototype.constructor = z.Sound, Object.defineProperty(z.Sound.prototype, "isDecoding", {
        get: function() {
            return this.game.cache.getSound(this.key).isDecoding;
        }
    }), Object.defineProperty(z.Sound.prototype, "isDecoded", {
        get: function() {
            return this.game.cache.isSoundDecoded(this.key);
        }
    }), Object.defineProperty(z.Sound.prototype, "mute", {
        get: function() {
            return this._muted || this.game.sound.mute;
        },
        set: function(t) {
            (t = t || !1) !== this._muted && (t ? (this._muted = !0, this._muteVolume = this._tempVolume, 
            this.usingWebAudio ? this.gainNode.gain.value = 0 : this.usingAudioTag && this._sound && (this._sound.volume = 0)) : (this._muted = !1, 
            this.usingWebAudio ? this.gainNode.gain.value = this._muteVolume : this.usingAudioTag && this._sound && (this._sound.volume = this._muteVolume)), 
            this.onMute.dispatch(this));
        }
    }), Object.defineProperty(z.Sound.prototype, "volume", {
        get: function() {
            return this._volume;
        },
        set: function(t) {
            this.usingAudioTag && (t = this.game.math.clamp(t, 0, 1)), this._muted ? this._muteVolume = t : (this._tempVolume = t, 
            this._volume = t, this.usingWebAudio ? this.gainNode.gain.value = t : this.usingAudioTag && this._sound && (this._sound.volume = this._globalVolume * t));
        }
    }), Object.defineProperty(z.Sound.prototype, "sourceId", {
        get: function() {
            return this._sound ? this._sourceId : null;
        }
    }), z.SoundManager = function(t) {
        this.game = t, this.onSoundDecode = new z.Signal(), this.onVolumeChange = new z.Signal(), 
        this.onMute = new z.Signal(), this.onUnMute = new z.Signal(), this.onTouchUnlock = new z.Signal(), 
        this.context = null, this.baseLatency = null, this.usingWebAudio = !1, this.usingAudioTag = !1, 
        this.noAudio = !1, this.connectToMaster = !0, this.touchLocked = !1, this.channels = 32, 
        this.muteOnPause = !0, this._codeMuted = !1, this._muted = !1, this._unlockSource = null, 
        this._volume = 1, this._sounds = [], this._watchList = new z.ArraySet(), this._watching = !1, 
        this._watchCallback = null, this._watchContext = null, this._resumeWebAudioOnClick = this._resumeWebAudioOnClick.bind(this);
    }, z.SoundManager.prototype = {
        boot: function() {
            var t = this.game.device, e = window.PhaserGlobal;
            if (t.iOS && !1 === t.webAudio && (this.channels = 1), e) {
                if (!0 === e.disableAudio) return this.noAudio = !0, void (this.touchLocked = !1);
                if (!0 === e.disableWebAudio) return this.usingAudioTag = !0, void (this.touchLocked = !1);
            }
            if (e && e.audioContext) this.context = e.audioContext; else {
                var i = window.AudioContext || window.webkitAudioContext;
                if (i) try {
                    this.context = new i();
                } catch (t) {
                    this.context = null, this.usingWebAudio = !1, this.touchLocked = !1;
                }
            }
            if (null === this.context) {
                if (void 0 === window.Audio) return void (this.noAudio = !0);
                this.usingAudioTag = !0;
            } else this.usingWebAudio = !0, this.baseLatency = this.context.baseLatency || 256 / (this.context.sampleRate || 44100), 
            void 0 === this.context.createGain ? this.masterGain = this.context.createGainNode() : this.masterGain = this.context.createGain(), 
            this.masterGain.gain.value = 1, this.masterGain.connect(this.context.destination), 
            "suspended" === this.context.state && this.game.canvas.addEventListener("click", this._resumeWebAudioOnClick);
            this.noAudio || t.needsTouchUnlock() && this.setTouchLock(), this.usingWebAudio && t.chrome && t.chromeVersion;
        },
        setTouchLock: function() {
            this.noAudio || window.PhaserGlobal && !0 === window.PhaserGlobal.disableAudio || (this.game.input.addTouchLockCallback(this.unlock, this, !0), 
            this.touchLocked = !0);
        },
        setTouchUnlock: function() {
            this.touchLocked = !1, this._unlockSource = null, this.onTouchUnlock.dispatch();
        },
        resumeWebAudio: function() {
            if (this.usingWebAudio && "suspended" === this.context.state) return this.context.resume();
        },
        unlock: function() {
            if (this.noAudio || !this.touchLocked || null !== this._unlockSource) return !0;
            if (this.usingAudioTag) this.setTouchUnlock(); else if (this.usingWebAudio) {
                var t = this.context.createBuffer(1, 1, 22050);
                this._unlockSource = this.context.createBufferSource(), this._unlockSource.buffer = t, 
                this._unlockSource.connect(this.context.destination);
                var e = this;
                this._unlockSource.onended = function() {
                    e.setTouchUnlock(), e.resumeWebAudio();
                }, void 0 === this._unlockSource.start ? this._unlockSource.noteOn(0) : this._unlockSource.start(0), 
                this.resumeWebAudio();
            }
            return !0;
        },
        stopAll: function() {
            if (!this.noAudio) for (var t = 0; t < this._sounds.length; t++) this._sounds[t] && this._sounds[t].stop();
        },
        pauseAll: function() {
            if (!this.noAudio) for (var t = 0; t < this._sounds.length; t++) this._sounds[t] && this._sounds[t].pause();
        },
        resumeAll: function() {
            if (!this.noAudio) for (var t = 0; t < this._sounds.length; t++) this._sounds[t] && this._sounds[t].resume();
        },
        decode: function(e, i) {
            i = i || null;
            var t = this.game.cache.getSoundData(e);
            if (t && !1 === this.game.cache.isSoundDecoded(e)) {
                this.game.cache.updateSound(e, "isDecoding", !0);
                var n = this;
                try {
                    this.context.decodeAudioData(t, function(t) {
                        t && (n.game.cache.decodedSound(e, t), n.onSoundDecode.dispatch(e, i));
                    });
                } catch (t) {}
            }
        },
        setDecodedCallback: function(t, e, i) {
            "string" == typeof t && (t = [ t ]), this._watchList.reset();
            for (var n = 0; n < t.length; n++) t[n] instanceof z.Sound ? this.game.cache.isSoundDecoded(t[n].key) || this._watchList.add(t[n].key) : this.game.cache.isSoundDecoded(t[n]) || this._watchList.add(t[n]);
            0 === this._watchList.total ? (this._watching = !1, e.call(i)) : (this._watching = !0, 
            this._watchCallback = e, this._watchContext = i);
        },
        update: function() {
            if (!this.noAudio) {
                for (var t = 0; t < this._sounds.length; t++) this._sounds[t].update();
                if (this._watching) {
                    for (var e = this._watchList.first; e; ) this.game.cache.isSoundDecoded(e) && this._watchList.remove(e), 
                    e = this._watchList.next;
                    0 === this._watchList.total && (this._watching = !1, this._watchCallback.call(this._watchContext));
                }
            }
        },
        add: function(t, e, i, n) {
            void 0 === e && (e = 1), void 0 === i && (i = !1), void 0 === n && (n = this.connectToMaster);
            var s = new z.Sound(this.game, t, e, i, n);
            return this._sounds.push(s), s;
        },
        addSprite: function(t) {
            return new z.AudioSprite(this.game, t);
        },
        remove: function(t) {
            for (var e = this._sounds.length; e--; ) if (this._sounds[e] === t) return this._sounds[e].destroy(!1), 
            this._sounds.splice(e, 1), !0;
            return !1;
        },
        removeAll: function() {
            this.stopAll();
            for (var t = 0; t < this._sounds.length; t++) this._sounds[t] && this._sounds[t].destroy();
            this._sounds.length = 0;
        },
        removeByKey: function(t) {
            for (var e = this._sounds.length, i = 0; e--; ) this._sounds[e].key === t && (this._sounds[e].destroy(!1), 
            this._sounds.splice(e, 1), i++);
            return i;
        },
        play: function(t, e, i) {
            if (!this.noAudio) {
                var n = this.add(t, e, i);
                return n.play(), n;
            }
        },
        setMute: function() {
            if (!this._muted) {
                this._muted = !0, this.usingWebAudio && (this._muteVolume = this.masterGain.gain.value, 
                this.masterGain.gain.value = 0);
                for (var t = 0; t < this._sounds.length; t++) this._sounds[t].usingAudioTag && (this._sounds[t].mute = !0);
                this.onMute.dispatch();
            }
        },
        unsetMute: function() {
            if (this._muted && !this._codeMuted) {
                this._muted = !1, this.usingWebAudio && (this.masterGain.gain.value = this._muteVolume);
                for (var t = 0; t < this._sounds.length; t++) this._sounds[t].usingAudioTag && (this._sounds[t].mute = !1);
                this.onUnMute.dispatch();
            }
        },
        destroy: function() {
            this.removeAll(), this.onSoundDecode.dispose(), this.game.canvas.removeEventListener("click", this._resumeWebAudioOnClick), 
            this.context && (window.PhaserGlobal ? window.PhaserGlobal.audioContext = this.context : this.context.close && this.context.close());
        },
        _resumeWebAudioOnClick: function() {
            this.resumeWebAudio(), this.game.canvas.removeEventListener("click", this._resumeWebAudioOnClick);
        }
    }, z.SoundManager.prototype.constructor = z.SoundManager, Object.defineProperty(z.SoundManager.prototype, "mute", {
        get: function() {
            return this._muted;
        },
        set: function(t) {
            if (t = t || !1) {
                if (this._muted) return;
                this._codeMuted = !0, this.setMute();
            } else {
                if (!this._muted) return;
                this._codeMuted = !1, this.unsetMute();
            }
        }
    }), Object.defineProperty(z.SoundManager.prototype, "volume", {
        get: function() {
            return this._volume;
        },
        set: function(t) {
            if (t < 0 ? t = 0 : 1 < t && (t = 1), this._volume !== t) {
                if (this._volume = t, this.usingWebAudio) this.masterGain.gain.value = t; else for (var e = 0; e < this._sounds.length; e++) this._sounds[e].usingAudioTag && this._sounds[e].updateGlobalVolume(t);
                this.onVolumeChange.dispatch(t);
            }
        }
    }), z.ScaleManager = function(t, e, i) {
        this.game = t, this.dom = z.DOM, this.grid = null, this.width = 0, this.height = 0, 
        this.minWidth = null, this.maxWidth = null, this.minHeight = null, this.maxHeight = null, 
        this.offset = new z.Point(), this.forceLandscape = !1, this.forcePortrait = !1, 
        this.incorrectOrientation = !1, this._pageAlignHorizontally = !1, this._pageAlignVertically = !1, 
        this.onOrientationChange = new z.Signal(), this.enterIncorrectOrientation = new z.Signal(), 
        this.leaveIncorrectOrientation = new z.Signal(), this.hasPhaserSetFullScreen = !1, 
        this.fullScreenTarget = null, this._createdFullScreenTarget = null, this.onFullScreenInit = new z.Signal(), 
        this.onFullScreenChange = new z.Signal(), this.onFullScreenError = new z.Signal(), 
        this.screenOrientation = this.dom.getScreenOrientation(), this.scaleFactor = new z.Point(1, 1), 
        this.scaleFactorInversed = new z.Point(1, 1), this.margin = {
            left: 0,
            top: 0,
            right: 0,
            bottom: 0,
            x: 0,
            y: 0
        }, this.bounds = new z.Rectangle(), this.aspectRatio = 0, this.sourceAspectRatio = 0, 
        this.event = null, this.windowConstraints = {
            right: "layout",
            bottom: ""
        }, this.compatibility = {
            supportsFullScreen: !1,
            orientationFallback: null,
            noMargins: !1,
            scrollTo: null,
            forceMinimumDocumentHeight: !1,
            canExpandParent: !0,
            clickTrampoline: ""
        }, this._scaleMode = z.ScaleManager.NO_SCALE, this._fullScreenScaleMode = z.ScaleManager.NO_SCALE, 
        this.parentIsWindow = !1, this.parentNode = null, this.parentScaleFactor = new z.Point(1, 1), 
        this.trackParentInterval = 2e3, this.onSizeChange = new z.Signal(), this.onResize = null, 
        this.onResizeContext = null, this._pendingScaleMode = null, this._fullScreenRestore = null, 
        this._gameSize = new z.Rectangle(), this._userScaleFactor = new z.Point(1, 1), this._userScaleTrim = new z.Point(0, 0), 
        this._lastUpdate = 0, this._updateThrottle = 0, this._updateThrottleReset = 100, 
        this._parentBounds = new z.Rectangle(), this._tempBounds = new z.Rectangle(), this._lastReportedCanvasSize = new z.Rectangle(), 
        this._lastReportedGameSize = new z.Rectangle(), this._booted = !1, t.config && this.parseConfig(t.config), 
        this.setupScale(e, i);
    }, z.ScaleManager.EXACT_FIT = 0, z.ScaleManager.NO_SCALE = 1, z.ScaleManager.SHOW_ALL = 2, 
    z.ScaleManager.RESIZE = 3, z.ScaleManager.USER_SCALE = 4, z.ScaleManager.MODES = [ "EXACT_FIT", "NO_SCALE", "SHOW_ALL", "RESIZE", "USER_SCALE" ], 
    z.ScaleManager.prototype = {
        boot: function() {
            var t = this.compatibility;
            t.supportsFullScreen = this.game.device.fullscreen && !this.game.device.cocoonJS, 
            this.game.device.iPad || this.game.device.webApp || this.game.device.desktop || (this.game.device.android && !this.game.device.chrome ? t.scrollTo = new z.Point(0, 1) : t.scrollTo = new z.Point(0, 0)), 
            this.game.device.desktop ? (t.orientationFallback = "screen", t.clickTrampoline = "when-not-mouse") : (t.orientationFallback = "", 
            t.clickTrampoline = "");
            var e = this;
            this._orientationChange = function(t) {
                return e.orientationChange(t);
            }, this._windowResize = function(t) {
                return e.windowResize(t);
            }, window.addEventListener("orientationchange", this._orientationChange, !1), window.addEventListener("resize", this._windowResize, !1), 
            this.compatibility.supportsFullScreen && (this._fullScreenChange = function(t) {
                return e.fullScreenChange(t);
            }, this._fullScreenError = function(t) {
                return e.fullScreenError(t);
            }, document.addEventListener("webkitfullscreenchange", this._fullScreenChange, !1), 
            document.addEventListener("mozfullscreenchange", this._fullScreenChange, !1), document.addEventListener("MSFullscreenChange", this._fullScreenChange, !1), 
            document.addEventListener("fullscreenchange", this._fullScreenChange, !1), document.addEventListener("webkitfullscreenerror", this._fullScreenError, !1), 
            document.addEventListener("mozfullscreenerror", this._fullScreenError, !1), document.addEventListener("MSFullscreenError", this._fullScreenError, !1), 
            document.addEventListener("fullscreenerror", this._fullScreenError, !1)), this.game.onResume.add(this._gameResumed, this), 
            this.dom.getOffset(this.game.canvas, this.offset), this.bounds.setTo(this.offset.x, this.offset.y, this.width, this.height), 
            this.setGameSize(this.game.width, this.game.height), this.screenOrientation = this.dom.getScreenOrientation(this.compatibility.orientationFallback), 
            z.FlexGrid && (this.grid = new z.FlexGrid(this, this.width, this.height)), this._booted = !0, 
            null !== this._pendingScaleMode && (this.scaleMode = this._pendingScaleMode, this._pendingScaleMode = null);
        },
        parseConfig: function(t) {
            void 0 !== t.scaleMode && (this._booted ? this.scaleMode = t.scaleMode : this._pendingScaleMode = t.scaleMode), 
            void 0 !== t.fullScreenScaleMode && (this.fullScreenScaleMode = t.fullScreenScaleMode), 
            t.fullScreenTarget && (this.fullScreenTarget = t.fullScreenTarget), this.pageAlignHorizontally = t.alignH || !1, 
            this.pageAlignVertically = t.alignV || !1, t.scaleH && t.scaleV && this.setUserScale(t.scaleH, t.scaleV, t.trimH, t.trimV);
        },
        setupScale: function(t, e) {
            var i, n = new z.Rectangle();
            "" !== this.game.parent && ("string" == typeof this.game.parent ? i = document.getElementById(this.game.parent) : this.game.parent && 1 === this.game.parent.nodeType && (i = this.game.parent)), 
            i ? (this.parentNode = i, this.parentIsWindow = !1, this.getParentBounds(this._parentBounds, this.parentNode), 
            n.width = this._parentBounds.width, n.height = this._parentBounds.height, this.offset.set(this._parentBounds.x, this._parentBounds.y)) : (this.parentNode = null, 
            this.parentIsWindow = !0, n.width = this.dom.visualBounds.width, n.height = this.dom.visualBounds.height, 
            this.offset.set(0, 0));
            var s = 0, o = 0;
            "number" == typeof t ? s = t : (this.parentScaleFactor.x = parseInt(t, 10) / 100, 
            s = n.width * this.parentScaleFactor.x), "number" == typeof e ? o = e : (this.parentScaleFactor.y = parseInt(e, 10) / 100, 
            o = n.height * this.parentScaleFactor.y), s = Math.floor(s), o = Math.floor(o), 
            this._gameSize.setTo(0, 0, s, o), this.updateDimensions(s, o, !1);
        },
        _gameResumed: function() {
            this.queueUpdate(!0);
        },
        setGameSize: function(t, e) {
            this._gameSize.setTo(0, 0, t, e), this.currentScaleMode !== z.ScaleManager.RESIZE && this.updateDimensions(t, e, !0), 
            this.queueUpdate(!0);
        },
        setUserScale: function(t, e, i, n, s, o) {
            this._userScaleFactor.setTo(t, e), this._userScaleTrim.setTo(0 | i, 0 | n), void 0 === s && (s = !0), 
            void 0 === o && (o = !0), s && this.queueUpdate(o);
        },
        setResizeCallback: function(t, e) {
            this.onResize = t, this.onResizeContext = e;
        },
        signalSizeChange: function() {
            if (!z.Rectangle.sameDimensions(this, this._lastReportedCanvasSize) || !z.Rectangle.sameDimensions(this.game, this._lastReportedGameSize)) {
                var t = this.width, e = this.height;
                this._lastReportedCanvasSize.setTo(0, 0, t, e), this._lastReportedGameSize.setTo(0, 0, this.game.width, this.game.height), 
                this.grid && this.grid.onResize(t, e), this.onSizeChange.dispatch(this, t, e), this.currentScaleMode === z.ScaleManager.RESIZE && (this.game.state.resize(t, e), 
                this.game.load.resize(t, e));
            }
        },
        setMinMax: function(t, e, i, n) {
            this.minWidth = t, this.minHeight = e, void 0 !== i && (this.maxWidth = i), void 0 !== n && (this.maxHeight = n);
        },
        preUpdate: function() {
            if (!(this.game.time.time < this._lastUpdate + this._updateThrottle)) {
                var t = this._updateThrottle;
                this._updateThrottleReset = 400 <= t ? 0 : 100, this.dom.getOffset(this.game.canvas, this.offset);
                var e = this._parentBounds.width, i = this._parentBounds.height, n = this.getParentBounds(this._parentBounds), s = n.width !== e || n.height !== i, o = this.updateOrientationState();
                (s || o) && (this.onResize && this.onResize.call(this.onResizeContext, this, n), 
                this.updateLayout(), this.signalSizeChange());
                var a = 2 * this._updateThrottle;
                this._updateThrottle < t && (a = Math.min(t, this._updateThrottleReset)), this._updateThrottle = z.Math.clamp(a, 25, this.trackParentInterval), 
                this._lastUpdate = this.game.time.time;
            }
        },
        pauseUpdate: function() {
            this.preUpdate(), this._updateThrottle = this.trackParentInterval;
        },
        updateDimensions: function(t, e, i) {
            this.width = t * this.parentScaleFactor.x, this.height = e * this.parentScaleFactor.y, 
            this.game.width = this.width, this.game.height = this.height, this.sourceAspectRatio = this.width / this.height, 
            this.updateScalingAndBounds(), i && (this.game.renderer.resize(this.width, this.height), 
            this.game.camera.setSize(this.width, this.height), this.game.world.resize(this.width, this.height));
        },
        updateScalingAndBounds: function() {
            this.scaleFactor.x = this.game.width / this.width, this.scaleFactor.y = this.game.height / this.height, 
            this.scaleFactorInversed.x = this.width / this.game.width, this.scaleFactorInversed.y = this.height / this.game.height, 
            this.aspectRatio = this.width / this.height, this.game.canvas && this.dom.getOffset(this.game.canvas, this.offset), 
            this.bounds.setTo(this.offset.x, this.offset.y, this.width, this.height), this.game.input && this.game.input.scale && this.game.input.scale.setTo(this.scaleFactor.x, this.scaleFactor.y);
        },
        forceOrientation: function(t, e) {
            void 0 === e && (e = !1), !0 === t && !0 === e || (this.forceLandscape = t, this.forcePortrait = e, 
            this.queueUpdate(!0));
        },
        classifyOrientation: function(t) {
            return "portrait-primary" === t || "portrait-secondary" === t ? "portrait" : "landscape-primary" === t || "landscape-secondary" === t ? "landscape" : null;
        },
        updateOrientationState: function() {
            var t = this.screenOrientation, e = this.incorrectOrientation;
            this.screenOrientation = this.dom.getScreenOrientation(this.compatibility.orientationFallback), 
            this.incorrectOrientation = this.forceLandscape && !this.isLandscape || this.forcePortrait && !this.isPortrait;
            var i = t !== this.screenOrientation, n = e !== this.incorrectOrientation;
            return n && (this.incorrectOrientation ? this.enterIncorrectOrientation.dispatch() : this.leaveIncorrectOrientation.dispatch()), 
            (i || n) && this.onOrientationChange.dispatch(this, t, e), i || n;
        },
        orientationChange: function(t) {
            this.event = t, this.queueUpdate(!0);
        },
        windowResize: function(t) {
            this.event = t, this.queueUpdate(!0);
        },
        scrollTop: function() {
            var t = this.compatibility.scrollTo;
            t && window.scrollTo(t.x, t.y);
        },
        refresh: function() {
            this.scrollTop(), this.queueUpdate(!0);
        },
        updateLayout: function() {
            var t = this.currentScaleMode;
            if (t !== z.ScaleManager.RESIZE) {
                if (this.scrollTop(), this.compatibility.forceMinimumDocumentHeight && (document.documentElement.style.minHeight = window.innerHeight + "px"), 
                this.incorrectOrientation ? this.setMaximum() : t === z.ScaleManager.EXACT_FIT ? this.setExactFit() : t === z.ScaleManager.SHOW_ALL ? (!this.isFullScreen && this.boundingParent && this.compatibility.canExpandParent && (this.setShowAll(!0), 
                this.resetCanvas()), this.setShowAll()) : t === z.ScaleManager.NO_SCALE ? (this.width = this.game.width, 
                this.height = this.game.height) : t === z.ScaleManager.USER_SCALE && (this.width = this.game.width * this._userScaleFactor.x - this._userScaleTrim.x, 
                this.height = this.game.height * this._userScaleFactor.y - this._userScaleTrim.y), 
                !this.compatibility.canExpandParent && (t === z.ScaleManager.SHOW_ALL || t === z.ScaleManager.USER_SCALE)) {
                    var e = this.getParentBounds(this._tempBounds);
                    this.width = Math.min(this.width, e.width), this.height = Math.min(this.height, e.height);
                }
                this.width = 0 | this.width, this.height = 0 | this.height, this.reflowCanvas();
            } else this.reflowGame();
        },
        getParentBounds: function(t, e) {
            var i = t || new z.Rectangle(), n = e || this.boundingParent, s = this.dom.visualBounds, o = this.dom.layoutBounds;
            if (n) {
                var a = n.getBoundingClientRect(), r = n.offsetParent ? n.offsetParent.getBoundingClientRect() : n.getBoundingClientRect();
                i.setTo(a.left - r.left, a.top - r.top, a.width, a.height);
                var h = this.windowConstraints;
                if (h.right) {
                    var l = "layout" === h.right ? o : s;
                    i.right = Math.min(i.right, l.width);
                }
                if (h.bottom) {
                    l = "layout" === h.bottom ? o : s;
                    i.bottom = Math.min(i.bottom, l.height);
                }
            } else i.setTo(0, 0, s.width, s.height);
            return i.setTo(Math.round(i.x), Math.round(i.y), Math.round(i.width), Math.round(i.height)), 
            i;
        },
        align: function(t, e) {
            null != t && (this.pageAlignHorizontally = t), null != e && (this.pageAlignVertically = e);
        },
        alignCanvas: function(t, e) {
            var i = this.getParentBounds(this._tempBounds), n = this.game.canvas, s = this.margin;
            if (t) {
                s.left = s.right = 0;
                var o = n.getBoundingClientRect();
                if (this.width < i.width && !this.incorrectOrientation) {
                    var a = o.left - i.x, r = i.width / 2 - this.width / 2, h = (r = Math.max(r, 0)) - a;
                    s.left = Math.round(h);
                }
                n.style.marginLeft = s.left + "px", 0 !== s.left && (s.right = -(i.width - o.width - s.left), 
                n.style.marginRight = s.right + "px");
            }
            if (e) {
                s.top = s.bottom = 0;
                o = n.getBoundingClientRect();
                if (this.height < i.height && !this.incorrectOrientation) {
                    a = o.top - i.y, r = i.height / 2 - this.height / 2, h = (r = Math.max(r, 0)) - a;
                    s.top = Math.round(h);
                }
                n.style.marginTop = s.top + "px", 0 !== s.top && (s.bottom = -(i.height - o.height - s.top), 
                n.style.marginBottom = s.bottom + "px");
            }
            s.x = s.left, s.y = s.top;
        },
        reflowGame: function() {
            this.resetCanvas("", "");
            var t = this.getParentBounds(this._tempBounds);
            this.updateDimensions(t.width, t.height, !0);
        },
        reflowCanvas: function() {
            this.incorrectOrientation || (this.width = z.Math.clamp(this.width, this.minWidth || 0, this.maxWidth || this.width), 
            this.height = z.Math.clamp(this.height, this.minHeight || 0, this.maxHeight || this.height)), 
            this.resetCanvas(), this.compatibility.noMargins || (this.isFullScreen && this._createdFullScreenTarget ? this.alignCanvas(!0, !0) : this.alignCanvas(this.pageAlignHorizontally, this.pageAlignVertically)), 
            this.updateScalingAndBounds();
        },
        resetCanvas: function(t, e) {
            void 0 === t && (t = this.width + "px"), void 0 === e && (e = this.height + "px");
            var i = this.game.canvas;
            this.compatibility.noMargins || (i.style.marginLeft = "", i.style.marginTop = "", 
            i.style.marginRight = "", i.style.marginBottom = ""), i.style.width = t, i.style.height = e;
        },
        queueUpdate: function(t) {
            t && (this._parentBounds.width = 0, this._parentBounds.height = 0), this._updateThrottle = this._updateThrottleReset;
        },
        reset: function(t) {
            t && this.grid && this.grid.reset();
        },
        setMaximum: function() {
            this.width = this.dom.visualBounds.width, this.height = this.dom.visualBounds.height;
        },
        setShowAll: function(t) {
            var e, i = this.getParentBounds(this._tempBounds), n = i.width, s = i.height;
            e = t ? Math.max(s / this.game.height, n / this.game.width) : Math.min(s / this.game.height, n / this.game.width), 
            this.width = Math.round(this.game.width * e), this.height = Math.round(this.game.height * e);
        },
        setExactFit: function() {
            var t = this.getParentBounds(this._tempBounds);
            this.width = t.width, this.height = t.height, this.isFullScreen || (this.maxWidth && (this.width = Math.min(this.width, this.maxWidth)), 
            this.maxHeight && (this.height = Math.min(this.height, this.maxHeight)));
        },
        createFullScreenTarget: function() {
            var t = document.createElement("div");
            return t.style.margin = "0", t.style.padding = "0", t.style.background = "#000", 
            t;
        },
        startFullScreen: function(t, e, i) {
            if (this.isFullScreen) return !1;
            if (this.compatibility.supportsFullScreen) {
                if ("when-not-mouse" === this.compatibility.clickTrampoline) {
                    var n = this.game.input;
                    if (n.activePointer && n.activePointer !== n.mousePointer && (e || !1 !== e)) return void n.activePointer.addClickTrampoline("startFullScreen", this.startFullScreen, this, [ t, !1 ]);
                }
                void 0 !== t && this.game.renderType === z.CANVAS && (this.game.stage.smoothed = t);
                var s = this.fullScreenTarget;
                s || (this.cleanupCreatedTarget(), this._createdFullScreenTarget = this.createFullScreenTarget(), 
                s = this._createdFullScreenTarget);
                var o = {
                    targetElement: s
                };
                if (this.hasPhaserSetFullScreen = !0, this.onFullScreenInit.dispatch(this, o), this._createdFullScreenTarget) {
                    var a = this.game.canvas;
                    a.parentNode.insertBefore(s, a), s.appendChild(a);
                }
                return void 0 === i && (i = {
                    navigationUI: "hide"
                }), this.game.device.fullscreenKeyboard ? s[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT) : s[this.game.device.requestFullscreen](i), 
                !0;
            }
            var r = this;
            setTimeout(function() {
                r.fullScreenError();
            }, 10);
        },
        stopFullScreen: function() {
            return !(!this.isFullScreen || !this.compatibility.supportsFullScreen) && (this.hasPhaserSetFullScreen = !1, 
            document[this.game.device.cancelFullscreen](), !0);
        },
        cleanupCreatedTarget: function() {
            var t = this._createdFullScreenTarget;
            if (t && t.parentNode) {
                var e = t.parentNode;
                e.insertBefore(this.game.canvas, t), e.removeChild(t);
            }
            this._createdFullScreenTarget = null;
        },
        prepScreenMode: function(t) {
            var e = !!this._createdFullScreenTarget, i = this._createdFullScreenTarget || this.fullScreenTarget;
            t ? (e || this.fullScreenScaleMode === z.ScaleManager.EXACT_FIT) && i !== this.game.canvas && (this._fullScreenRestore = {
                targetWidth: i.style.width,
                targetHeight: i.style.height
            }, i.style.width = "100%", i.style.height = "100%") : (this._fullScreenRestore && (i.style.width = this._fullScreenRestore.targetWidth, 
            i.style.height = this._fullScreenRestore.targetHeight, this._fullScreenRestore = null), 
            this.updateDimensions(this._gameSize.width, this._gameSize.height, !0), this.resetCanvas());
        },
        fullScreenChange: function(t) {
            this.event = t, this.isFullScreen ? this.prepScreenMode(!0) : (this.prepScreenMode(!1), 
            this.cleanupCreatedTarget()), this.updateLayout(), this.queueUpdate(!0), this.onFullScreenChange.dispatch(this, this.width, this.height);
        },
        fullScreenError: function(t) {
            this.event = t, this.cleanupCreatedTarget(), this.onFullScreenError.dispatch(this);
        },
        scaleSprite: function(t, e, i, n) {
            if (void 0 === e && (e = this.width), void 0 === i && (i = this.height), void 0 === n && (n = !1), 
            !t || !t.scale) return t;
            if (t.scale.x = 1, t.scale.y = 1, t.width <= 0 || t.height <= 0 || e <= 0 || i <= 0) return t;
            var s = e, o = t.height * e / t.width, a = t.width * i / t.height, r = i, h = e < a;
            return (h = h ? n : !n) ? (t.width = Math.floor(s), t.height = Math.floor(o)) : (t.width = Math.floor(a), 
            t.height = Math.floor(r)), t;
        },
        destroy: function() {
            this.game.onResume.remove(this._gameResumed, this), window.removeEventListener("orientationchange", this._orientationChange, !1), 
            window.removeEventListener("resize", this._windowResize, !1), this.compatibility.supportsFullScreen && (document.removeEventListener("webkitfullscreenchange", this._fullScreenChange, !1), 
            document.removeEventListener("mozfullscreenchange", this._fullScreenChange, !1), 
            document.removeEventListener("MSFullscreenChange", this._fullScreenChange, !1), 
            document.removeEventListener("fullscreenchange", this._fullScreenChange, !1), document.removeEventListener("webkitfullscreenerror", this._fullScreenError, !1), 
            document.removeEventListener("mozfullscreenerror", this._fullScreenError, !1), document.removeEventListener("MSFullscreenError", this._fullScreenError, !1), 
            document.removeEventListener("fullscreenerror", this._fullScreenError, !1));
        }
    }, z.ScaleManager.prototype.constructor = z.ScaleManager, Object.defineProperty(z.ScaleManager.prototype, "boundingParent", {
        get: function() {
            return this.parentIsWindow || this.isFullScreen && this.hasPhaserSetFullScreen && !this._createdFullScreenTarget ? null : this.game.canvas && this.game.canvas.parentNode || null;
        }
    }), Object.defineProperty(z.ScaleManager.prototype, "scaleMode", {
        get: function() {
            return this._scaleMode;
        },
        set: function(t) {
            return t !== this._scaleMode && (this.isFullScreen || (this.updateDimensions(this._gameSize.width, this._gameSize.height, !0), 
            this.queueUpdate(!0)), this._scaleMode = t), this._scaleMode;
        }
    }), Object.defineProperty(z.ScaleManager.prototype, "fullScreenScaleMode", {
        get: function() {
            return this._fullScreenScaleMode;
        },
        set: function(t) {
            return t !== this._fullScreenScaleMode && (this.isFullScreen ? (this.prepScreenMode(!1), 
            this._fullScreenScaleMode = t, this.prepScreenMode(!0), this.queueUpdate(!0)) : this._fullScreenScaleMode = t), 
            this._fullScreenScaleMode;
        }
    }), Object.defineProperty(z.ScaleManager.prototype, "currentScaleMode", {
        get: function() {
            return this.isFullScreen ? this._fullScreenScaleMode : this._scaleMode;
        }
    }), Object.defineProperty(z.ScaleManager.prototype, "pageAlignHorizontally", {
        get: function() {
            return this._pageAlignHorizontally;
        },
        set: function(t) {
            t !== this._pageAlignHorizontally && (this._pageAlignHorizontally = t, this.queueUpdate(!0));
        }
    }), Object.defineProperty(z.ScaleManager.prototype, "pageAlignVertically", {
        get: function() {
            return this._pageAlignVertically;
        },
        set: function(t) {
            t !== this._pageAlignVertically && (this._pageAlignVertically = t, this.queueUpdate(!0));
        }
    }), Object.defineProperty(z.ScaleManager.prototype, "isFullScreen", {
        get: function() {
            return !!(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement);
        }
    }), Object.defineProperty(z.ScaleManager.prototype, "isPortrait", {
        get: function() {
            return "portrait" === this.classifyOrientation(this.screenOrientation);
        }
    }), Object.defineProperty(z.ScaleManager.prototype, "isLandscape", {
        get: function() {
            return "landscape" === this.classifyOrientation(this.screenOrientation);
        }
    }), Object.defineProperty(z.ScaleManager.prototype, "isGamePortrait", {
        get: function() {
            return this.height > this.width;
        }
    }), Object.defineProperty(z.ScaleManager.prototype, "isGameLandscape", {
        get: function() {
            return this.width > this.height;
        }
    }), z.Utils.Debug = function(t) {
        this.game = t, this.sprite = null, this.bmd = null, this.canvas = null, this.context = null, 
        this.font = "14px monospace", this.columnWidth = 100, this.lineHeight = 16, this.lineWidth = 1, 
        this.renderShadow = !0, this.currentColor = null, this.currentX = 0, this.currentY = 0, 
        this.currentAlpha = 1, this.dirty = !1, this.isDisabled = !1, this._line = null, 
        this._rect = null;
    }, z.Utils.Debug.GEOM_AUTO = 0, z.Utils.Debug.GEOM_RECTANGLE = 1, z.Utils.Debug.GEOM_CIRCLE = 2, 
    z.Utils.Debug.GEOM_POINT = 3, z.Utils.Debug.GEOM_LINE = 4, z.Utils.Debug.GEOM_ELLIPSE = 5, 
    z.Utils.Debug.prototype = {
        boot: function() {
            this.game.renderType === z.CANVAS ? this.context = this.game.context : (this.bmd = new z.BitmapData(this.game, "__DEBUG", this.game.width, this.game.height, !0), 
            this.sprite = this.game.make.image(0, 0, this.bmd), this.game.stage.addChild(this.sprite), 
            this.game.scale.onSizeChange.add(this.resize, this), this.canvas = z.CanvasPool.create(this, this.game.width, this.game.height), 
            this.context = this.canvas.getContext("2d")), this._line = new z.Line(), this._rect = new z.Rectangle();
        },
        resize: function() {
            this.bmd.resize(this.game.width, this.game.height), this.canvas.width = this.game.width, 
            this.canvas.height = this.game.height;
        },
        preUpdate: function() {
            this.dirty && this.sprite && (this.bmd.clear(), this.bmd.draw(this.canvas, 0, 0), 
            this.context.clearRect(0, 0, this.game.width, this.game.height), this.dirty = !1);
        },
        reset: function() {
            this.context && this.context.clearRect(0, 0, this.game.width, this.game.height), 
            this.sprite && this.bmd.clear();
        },
        start: function(t, e, i, n) {
            "number" != typeof t && (t = 0), "number" != typeof e && (e = 0), i = i || "rgb(255,255,255)", 
            void 0 === n && (n = 0), this.currentX = t, this.currentY = e, this.currentColor = i, 
            this.columnWidth = n, this.dirty = !0, this.context.save(), this.context.setTransform(1, 0, 0, 1, 0, 0), 
            this.context.strokeStyle = i, this.context.fillStyle = i, this.context.font = this.font, 
            this.context.globalAlpha = this.currentAlpha;
        },
        stop: function() {
            this.context.restore();
        },
        line: function() {
            for (var t = this.currentX, e = 0; e < arguments.length; e++) this.renderShadow && (this.context.fillStyle = "rgb(0,0,0)", 
            this.context.fillText(arguments[e], t + 1, this.currentY + 1), this.context.fillStyle = this.currentColor), 
            this.context.fillText(arguments[e], t, this.currentY), t += this.columnWidth;
            this.currentY += this.lineHeight;
        },
        sound: function(t, e, i) {
            var n = this.game.sound;
            this.start(t, e, i), n.noAudio ? this.line("Audio is disabled") : (this.line("Volume: " + n.volume.toFixed(2) + (n.mute ? " (Mute)" : "")), 
            this.line("Mute on pause: " + n.muteOnPause), this.line("Using: " + (n.usingWebAudio ? "Web Audio - " + n.context.state : "Audio Tag")), 
            this.line("Touch locked: " + n.touchLocked), this.line("Sounds: " + n._sounds.length)), 
            this.stop();
        },
        soundInfo: function(t, e, i, n) {
            this.start(e, i, n), this.line("Sound: " + t.key + "  Touch locked: " + t.game.sound.touchLocked), 
            this.line("Is Ready?: " + this.game.cache.isSoundReady(t.key) + "  Pending Playback: " + t.pendingPlayback), 
            this.line("Decoded: " + t.isDecoded + "  Decoding: " + t.isDecoding), this.line("Playing: " + t.isPlaying + "  Loop: " + t.loop), 
            this.line("Time: " + (t.currentTime / 1e3).toFixed(3) + "s  Total: " + t.totalDuration.toFixed(3) + "s"), 
            this.line("Volume: " + t.volume.toFixed(2) + (t.mute ? " (Mute)" : "")), this.line("Using: " + (t.usingWebAudio ? "Web Audio" : "Audio Tag") + "  " + (t.usingWebAudio ? "Source: " + (t.sourceId || "none") : "")), 
            "" !== t.currentMarker && (this.line("Marker: " + t.currentMarker + "  Duration: " + t.duration.toFixed(3) + "s (" + t.durationMS + "ms)"), 
            this.line("Start: " + t.markers[t.currentMarker].start + "  Stop: " + t.markers[t.currentMarker].stop), 
            this.line("Position: " + t.position)), this.stop();
        },
        camera: function(t, e, i) {
            var n = t.deadzone, s = t.target, o = t.view;
            n && (this._rect.setTo(o.x + n.x, o.y + n.y, n.width, n.height), this.rectangle(this._rect, e, i)), 
            s && (this._line.setTo(o.centerX, o.centerY, s.x, s.y), this.geom(this._line, e, i), 
            this.geom(s, e, !1, 3));
        },
        cameraInfo: function(t, e, i, n) {
            var s = t.bounds, o = t.deadzone, a = t.target, r = t.view;
            this.start(e, i, n), this.line("Camera (" + t.width + " x " + t.height + ")"), this.line("x: " + t.x + " y: " + t.y), 
            this.line("Bounds: " + (s ? "x: " + s.x + " y: " + s.y + " w: " + s.width + " h: " + s.height : "none")), 
            this.line("View: x: " + r.x + " y: " + r.y + " w: " + r.width + " h: " + r.height), 
            this.line("Center: x: " + t.centerX + " y: " + t.centerY), this.line("Deadzone: " + (o ? "x: " + o.x + " y: " + o.y + " w: " + o.width + " h: " + o.height : o)), 
            this.line("Total in view: " + t.totalInView), this.line("At limit: x: " + t.atLimit.x + " y: " + t.atLimit.y), 
            this.line("Target: " + (a ? a.name || a : "none")), this.stop();
        },
        timer: function(t, e, i, n) {
            this.start(e, i, n), this.line("Timer (running: " + t.running + " expired: " + t.expired + ")"), 
            this.line("Next Tick: " + t.next + " Duration: " + t.duration), this.line("Paused: " + t.paused + " Length: " + t.length), 
            this.stop();
        },
        pointer: function(t, e, i, n, s, o) {
            if (null != t && (void 0 === e && (e = !1), i = i || "rgba(0,255,0,0.5)", n = n || "rgba(255,255,0,0.5)", 
            o = o || "rgba(255,0,0,0.5)", !0 !== e || !0 !== t.isUp)) {
                this.start(t.x, t.y - 150, s), this.context.beginPath(), this.context.arc(t.x, t.y, t.circle.radius, 0, 2 * Math.PI), 
                t.active ? this.context.fillStyle = t.isDown ? i : n : this.context.fillStyle = o, 
                this.context.fill(), this.context.closePath(), this.context.beginPath(), this.context.moveTo(t.positionDown.x, t.positionDown.y), 
                this.context.lineTo(t.position.x, t.position.y), this.context.lineWidth = 2, this.context.stroke(), 
                this.context.closePath();
                var a = t.movementX, r = t.movementY;
                (a || r) && (this.context.beginPath(), this.context.moveTo(a + t.position.x, r + t.position.y), 
                this.context.lineTo(t.position.x, t.position.y), this.context.lineWidth = 2, this.context.stroke(), 
                this.context.closePath()), this.line("ID: " + t.id + " Active: " + t.active), this.line("World X: " + t.worldX.toFixed(1) + " World Y: " + t.worldY.toFixed(1)), 
                this.line("Screen X: " + t.x.toFixed(1) + " Screen Y: " + t.y.toFixed(1) + " In: " + t.withinGame), 
                this.line("Movement: X: " + a + " Y: " + r), this.line("Duration: " + t.duration + " ms"), 
                this.line("is Down: " + t.isDown + " is Up: " + t.isUp), t.isMouse && this.line("Buttons: " + this._pointerButtonIcon(t.leftButton) + " " + this._pointerButtonIcon(t.middleButton) + " " + this._pointerButtonIcon(t.rightButton)), 
                this.stop();
            }
        },
        _pointerButtonIcon: function(t) {
            return t.isDown ? "x" : t.isUp ? "o" : "-";
        },
        spriteInputInfo: function(t, e, i, n) {
            this.start(e, i, n), this.line("Sprite Input: (" + t.width + " x " + t.height + ")"), 
            this.line("x: " + t.input.pointerX().toFixed(1) + " y: " + t.input.pointerY().toFixed(1)), 
            this.line("over: " + t.input.pointerOver() + " duration: " + t.input.overDuration().toFixed(0)), 
            this.line("down: " + t.input.pointerDown() + " duration: " + t.input.downDuration().toFixed(0)), 
            this.line("just over: " + t.input.justOver() + " just out: " + t.input.justOut()), 
            this.stop();
        },
        key: function(t, e, i, n) {
            this.start(e, i, n, 150), this.line("Key:", t.keyCode, "isDown:", t.isDown), this.line("justDown:", t.justDown, "justUp:", t.justUp), 
            this.line("Time Down:", t.timeDown.toFixed(0), "duration:", t.duration.toFixed(0)), 
            this.stop();
        },
        inputInfo: function(t, e, i, n) {
            var s = this.game.input;
            if (void 0 === n && (n = !0), this.start(t, e, i), this.line("Input"), this.line("X: " + s.x + " Y: " + s.y), 
            this.line("World X: " + s.worldX + " World Y: " + s.worldY), this.line("Scale X: " + s.scale.x.toFixed(2) + " Scale Y: " + s.scale.x.toFixed(2)), 
            this.line("Screen X: " + s.activePointer.screenX.toFixed(1) + " Screen Y: " + s.activePointer.screenY.toFixed(1)), 
            n) {
                this.line("Sources:"), this.line("  " + this._inputHandler(s.mouse, "mouse")), this.line("  " + this._inputHandler(s.mspointer, "mspointer")), 
                this.line("  " + this._inputHandler(s.touch, "touch"));
                var o = s.pointers, a = s.mousePointer, r = z.PointerModes;
                this.line("Pointers: (Max: " + s.maxPointers + ")"), this.line("  " + (a.isDown ? "x" : "o") + " " + r[a.pointerMode] + " " + a.identifier);
                for (var h = 0; h < o.length; h++) {
                    var l = o[h];
                    this.line("  " + (l.active ? "+" : "-") + " " + r[l.pointerMode] + " " + l.identifier);
                }
                this.stop();
            } else this.stop();
        },
        _inputHandler: function(t, e) {
            return this._inputHandlerStatusIcon(t) + " " + e + " " + this._inputHandlerCaptureIcon(t);
        },
        _inputHandlerStatusIcon: function(t) {
            return t.active ? t.enabled ? "+" : "-" : " ";
        },
        _inputHandlerCaptureIcon: function(t) {
            return t.active && (t.capture || t.preventDefault) ? "*" : " ";
        },
        spriteBounds: function(t, e, i) {
            var n = t.getBounds();
            n.x += this.game.camera.x, n.y += this.game.camera.y, this.rectangle(n, e, i);
        },
        ropeSegments: function(t, e, i) {
            var n = t.segments, s = this;
            n.forEach(function(t) {
                s.rectangle(t, e, i);
            }, this);
        },
        spriteInfo: function(t, e, i, n) {
            this.start(e, i, n), this.line("Sprite: " + (t.name || "") + " (" + t.width + " x " + t.height + ") anchor: " + t.anchor.x + " x " + t.anchor.y), 
            this.line("x: " + t.x.toFixed(1) + " y: " + t.y.toFixed(1)), this.line("angle: " + t.angle.toFixed(1) + " rotation: " + t.rotation.toFixed(1)), 
            this.line("visible: " + t.visible + " in camera: " + t.inCamera), this.line("bounds x: " + t._bounds.x.toFixed(1) + " y: " + t._bounds.y.toFixed(1) + " w: " + t._bounds.width.toFixed(1) + " h: " + t._bounds.height.toFixed(1)), 
            this.line("parent: " + (t.parent ? t.parent.name || "(DisplayObject)" : "(none)")), 
            this.stop();
        },
        spriteCoords: function(t, e, i, n) {
            this.start(e, i, n, 100), t.name && this.line(t.name), this.line("x:", t.x.toFixed(2), "y:", t.y.toFixed(2)), 
            this.line("pos x:", t.position.x.toFixed(2), "pos y:", t.position.y.toFixed(2)), 
            this.line("world x:", t.world.x.toFixed(2), "world y:", t.world.y.toFixed(2)), this.stop();
        },
        lineInfo: function(t, e, i, n) {
            this.start(e, i, n, 80), this.line("start.x:", t.start.x.toFixed(2), "start.y:", t.start.y.toFixed(2)), 
            this.line("end.x:", t.end.x.toFixed(2), "end.y:", t.end.y.toFixed(2)), this.line("length:", t.length.toFixed(2), "angle:", t.angle), 
            this.stop();
        },
        pixel: function(t, e, i, n) {
            n = n || 2, this.start(), this.context.fillStyle = i, this.context.fillRect(t, e, n, n), 
            this.stop();
        },
        geom: function(t, e, i, n) {
            void 0 === i && (i = !0), void 0 === n && (n = 0), e = e || "rgba(0,255,0,0.4)", 
            this.start(), this.context.fillStyle = e, this.context.strokeStyle = e, this.context.lineWidth = this.lineWidth;
            var s = z.Utils.Debug;
            n === s.GEOM_RECTANGLE || t instanceof z.Rectangle ? i ? this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height) : this.context.strokeRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height) : n === s.GEOM_CIRCLE || t instanceof z.Circle ? (this.context.beginPath(), 
            this.context.arc(t.x - this.game.camera.x, t.y - this.game.camera.y, t.radius, 0, 2 * Math.PI, !1), 
            this.context.closePath(), i ? this.context.fill() : this.context.stroke()) : n === s.GEOM_POINT || t instanceof z.Point ? this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, 4, 4) : n === s.GEOM_LINE || t instanceof z.Line ? (this.context.beginPath(), 
            this.context.moveTo(t.start.x + .5 - this.game.camera.x, t.start.y + .5 - this.game.camera.y), 
            this.context.lineTo(t.end.x + .5 - this.game.camera.x, t.end.y + .5 - this.game.camera.y), 
            this.context.closePath(), this.context.stroke()) : (n === s.GEOM_ELLIPSE || t instanceof z.Ellipse) && (this.context.beginPath(), 
            this.context.ellipse(t.centerX - this.game.camera.x, t.centerY - this.game.camera.y, t.width / 2, t.height / 2, 0, 2 * Math.PI, !1), 
            this.context.closePath(), i ? this.context.fill() : this.context.stroke()), this.stop();
        },
        rectangle: function(t, e, i) {
            void 0 === i && (i = !0), e = e || "rgba(0, 255, 0, 0.4)", this.start(), i ? (this.context.fillStyle = e, 
            this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height)) : (this.context.lineWidth = this.lineWidth, 
            this.context.strokeStyle = e, this.context.strokeRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height)), 
            this.stop();
        },
        text: function(t, e, i, n, s) {
            n = n || "rgb(255,255,255)", s = s || this.font, this.start(), this.context.font = s, 
            this.renderShadow && (this.context.fillStyle = "rgb(0,0,0)", this.context.fillText(t, e + 1, i + 1)), 
            this.context.fillStyle = n, this.context.fillText(t, e, i), this.stop();
        },
        quadTree: function(t, e) {
            e = e || "rgba(255,0,0,0.3)", this.start();
            var i = t.bounds;
            if (0 === t.nodes.length) {
                this.context.strokeStyle = e, this.context.strokeRect(i.x, i.y, i.width, i.height), 
                this.text("size: " + t.objects.length, i.x + 4, i.y + 16, "rgb(0,200,0)", "12px Courier"), 
                this.context.strokeStyle = "rgb(0,255,0)";
                for (var n = 0; n < t.objects.length; n++) this.context.strokeRect(t.objects[n].x, t.objects[n].y, t.objects[n].width, t.objects[n].height);
            } else for (n = 0; n < t.nodes.length; n++) this.quadTree(t.nodes[n]);
            this.stop();
        },
        body: function(t, e, i) {
            t.body && (this.start(), t.body.type === z.Physics.ARCADE ? z.Physics.Arcade.Body.render(this.context, t.body, e, i, this.lineWidth) : t.body.type === z.Physics.NINJA ? z.Physics.Ninja.Body.render(this.context, t.body, e, i) : t.body.type === z.Physics.BOX2D && z.Physics.Box2D.renderBody(this.context, t.body, e), 
            this.stop());
        },
        bodyInfo: function(t, e, i, n) {
            t.body && (this.start(e, i, n, 210), t.body.type === z.Physics.ARCADE ? z.Physics.Arcade.Body.renderBodyInfo(this, t.body) : t.body.type === z.Physics.BOX2D && this.game.physics.box2d.renderBodyInfo(this, t.body), 
            this.stop());
        },
        box2dWorld: function() {
            this.start(), this.context.translate(-this.game.camera.view.x, -this.game.camera.view.y, 0), 
            this.game.physics.box2d.renderDebugDraw(this.context), this.stop();
        },
        box2dBody: function(t, e) {
            this.start(), z.Physics.Box2D.renderBody(this.context, t, e), this.stop();
        },
        displayList: function(t) {
            if (void 0 === t && (t = this.game.world), t.hasOwnProperty("renderOrderID"), t.children && 0 < t.children.length) for (var e = 0; e < t.children.length; e++) this.game.debug.displayList(t.children[e]);
        },
        renderer: function(t, e, i) {
            var n = this.game.renderer, s = n.renderSession;
            if (this.start(t, e, i), this.line((n.gl ? "WebGL" : "Canvas") + " Renderer (" + n.width + " x " + n.height + ")"), 
            this.line("autoResize: " + n.autoResize), this.line("clearBeforeRender: " + n.clearBeforeRender), 
            this.line("resolution: " + n.resolution), this.line("transparent: " + n.transparent), 
            this.line("renderSession:"), n.gl) {
                this.line("  currentBatchedTextures: (" + n.currentBatchedTextures.length + ")");
                for (var o = 0; o < n.currentBatchedTextures.length; o++) this.line("    " + n.currentBatchedTextures[o]);
                this.line("  drawCount: " + s.drawCount), this.line("  maxTextures: " + n.maxTextures), 
                this.line("  maxTextureSize: " + n.maxTextureSize), this.line("  maxTextureAvailableSpace: " + s.maxTextureAvailableSpace), 
                this.line("  roundPixels: " + s.roundPixels);
            } else this.line("  roundPixels: " + s.roundPixels), this.line("  scaleMode: " + (0 === s.scaleMode ? "LINEAR" : 1 === s.scaleMode ? "NEAREST" : s.scaleMode));
            this.stop();
        },
        canvasPool: function(t, e, i, n) {
            var s = z.CanvasPool;
            this.start(t, e, i, n || 100), this.line("Canvas Pool"), this.line("Used:", s.getTotal()), 
            this.line("Free:", s.getFree()), this.line("Total:", s.length), this.stop();
        },
        physicsGroup: function(t, e, i, n) {
            t.forEach(this.body, this, n, e, i);
        },
        phaser: function(t, e, i) {
            this.text("Phaser v" + z.VERSION + " " + (this.game.renderType === z.WEBGL ? "WebGL" : "Canvas") + " " + (this.game.device.webAudio ? "WebAudio" : "HTML Audio"), t, e, i, this.font);
        },
        scale: function(t, e, i) {
            this.start(t, e, i);
            var n = this.game.scale, s = n.scaleFactorInversed, o = n._parentBounds;
            t = " x ";
            this.line("Game: " + this.game.width + t + this.game.height), this.line("Canvas: " + n.width + t + n.height + " (" + s.x.toFixed(2) + t + s.y.toFixed(2) + ") [" + n.aspectRatio.toFixed(2) + "]"), 
            this.line("Mode: " + z.ScaleManager.MODES[n.currentScaleMode] + (n.currentScaleMode === z.ScaleManager.USER_SCALE ? " (" + n._userScaleFactor.x + t + n._userScaleFactor.y + ")" : "")), 
            this.line("Parent: " + (n.parentIsWindow ? "window" : n.parentNode) + (o.empty ? "" : " (" + o.width + t + o.height + ")")), 
            this.line("Screen: " + n.classifyOrientation(n.screenOrientation) + (n.incorrectOrientation ? " (incorrect)" : "")), 
            this.stop();
        },
        loader: function(t, e, i, n) {
            var s = z.Utils.pad;
            this.start(e, i, n), t.hasLoaded ? this.line("Complete" + (t.resetLocked ? " [locked]" : "")) : t.isLoading ? this.line("Loading") : this.line("Not started"), 
            t.hasLoaded && !t.resetLocked || (this.line("Progress: " + s(t.progress, 3) + "%"), 
            this.line("Files: " + t._loadedFileCount + " of " + t._totalFileCount), this.line("Packs: " + t._loadedPackCount + " of " + t._loadedPackCount)), 
            this.stop();
        },
        device: function(t, e, i) {
            var n = this.game.device;
            this.start(t, e, i), this.line("Device"), this.line("Pointer Events: " + n.mspointer), 
            this.line("Touch: " + n.touch), this.line("Web Audio: " + n.webAudio), this.line("WebGL: " + n.webGL), 
            this.stop();
        },
        destroy: function() {
            z.CanvasPool.remove(this);
        }
    }, z.Utils.Debug.prototype.constructor = z.Utils.Debug, z.DOM = {
        getOffset: function(t, e) {
            e = e || new z.Point();
            var i = t.getBoundingClientRect(), n = z.DOM.scrollY, s = z.DOM.scrollX, o = document.documentElement.clientTop, a = document.documentElement.clientLeft;
            return e.x = i.left + s - a, e.y = i.top + n - o, e;
        },
        getBounds: function(t, e) {
            return void 0 === e && (e = 0), !(!(t = t && !t.nodeType ? t[0] : t) || 1 !== t.nodeType) && this.calibrate(t.getBoundingClientRect(), e);
        },
        calibrate: function(t, e) {
            e = +e || 0;
            var i = {
                width: 0,
                height: 0,
                left: 0,
                right: 0,
                top: 0,
                bottom: 0
            };
            return i.width = (i.right = t.right + e) - (i.left = t.left - e), i.height = (i.bottom = t.bottom + e) - (i.top = t.top - e), 
            i;
        },
        getAspectRatio: function(t) {
            var e = (t = null == t ? this.visualBounds : 1 === t.nodeType ? this.getBounds(t) : t).width, i = t.height;
            return "function" == typeof e && (e = e.call(t)), "function" == typeof i && (i = i.call(t)), 
            e / i;
        },
        inLayoutViewport: function(t, e) {
            var i = this.getBounds(t, e);
            return !!i && 0 <= i.bottom && 0 <= i.right && i.top <= this.layoutBounds.width && i.left <= this.layoutBounds.height;
        },
        getScreenOrientation: function(t) {
            var e = window.screen, i = e.orientation || e.mozOrientation || e.msOrientation;
            if (i && "string" == typeof i.type) return i.type;
            if ("string" == typeof i) return i;
            var n = "portrait-primary", s = "landscape-primary";
            if ("screen" === t) return e.height > e.width ? n : s;
            if ("viewport" === t) return this.visualBounds.height > this.visualBounds.width ? n : s;
            if ("window.orientation" === t && "number" == typeof window.orientation) return 0 === window.orientation || 180 === window.orientation ? n : s;
            if (window.matchMedia) {
                if (window.matchMedia("(orientation: portrait)").matches) return n;
                if (window.matchMedia("(orientation: landscape)").matches) return s;
            }
            return this.visualBounds.height > this.visualBounds.width ? n : s;
        },
        visualBounds: new z.Rectangle(),
        layoutBounds: new z.Rectangle(),
        documentBounds: new z.Rectangle()
    }, z.Device.whenReady(function(t) {
        var e = window && "pageXOffset" in window ? function() {
            return window.pageXOffset;
        } : function() {
            return document.documentElement.scrollLeft;
        }, i = window && "pageYOffset" in window ? function() {
            return window.pageYOffset;
        } : function() {
            return document.documentElement.scrollTop;
        };
        if (Object.defineProperty(z.DOM, "scrollX", {
            get: e
        }), Object.defineProperty(z.DOM, "scrollY", {
            get: i
        }), Object.defineProperty(z.DOM.visualBounds, "x", {
            get: e
        }), Object.defineProperty(z.DOM.visualBounds, "y", {
            get: i
        }), Object.defineProperty(z.DOM.layoutBounds, "x", {
            value: 0
        }), Object.defineProperty(z.DOM.layoutBounds, "y", {
            value: 0
        }), t.desktop && document.documentElement.clientWidth <= window.innerWidth && document.documentElement.clientHeight <= window.innerHeight) {
            var n = function() {
                return Math.max(window.innerWidth, document.documentElement.clientWidth);
            }, s = function() {
                return Math.max(window.innerHeight, document.documentElement.clientHeight);
            };
            Object.defineProperty(z.DOM.visualBounds, "width", {
                get: n
            }), Object.defineProperty(z.DOM.visualBounds, "height", {
                get: s
            }), Object.defineProperty(z.DOM.layoutBounds, "width", {
                get: n
            }), Object.defineProperty(z.DOM.layoutBounds, "height", {
                get: s
            });
        } else Object.defineProperty(z.DOM.visualBounds, "width", {
            get: function() {
                return window.innerWidth;
            }
        }), Object.defineProperty(z.DOM.visualBounds, "height", {
            get: function() {
                return window.innerHeight;
            }
        }), Object.defineProperty(z.DOM.layoutBounds, "width", {
            get: function() {
                var t = document.documentElement.clientWidth, e = window.innerWidth;
                return t < e ? e : t;
            }
        }), Object.defineProperty(z.DOM.layoutBounds, "height", {
            get: function() {
                var t = document.documentElement.clientHeight, e = window.innerHeight;
                return t < e ? e : t;
            }
        });
        Object.defineProperty(z.DOM.documentBounds, "x", {
            value: 0
        }), Object.defineProperty(z.DOM.documentBounds, "y", {
            value: 0
        }), Object.defineProperty(z.DOM.documentBounds, "width", {
            get: function() {
                var t = document.documentElement;
                return Math.max(t.clientWidth, t.offsetWidth, t.scrollWidth);
            }
        }), Object.defineProperty(z.DOM.documentBounds, "height", {
            get: function() {
                var t = document.documentElement;
                return Math.max(t.clientHeight, t.offsetHeight, t.scrollHeight);
            }
        });
    }, null, !0), z.ArraySet = function(t) {
        this.position = 0, this.list = t || [];
    }, z.ArraySet.prototype = {
        add: function(t) {
            return this.exists(t) || this.list.push(t), t;
        },
        getIndex: function(t) {
            return this.list.indexOf(t);
        },
        getByKey: function(t, e) {
            for (var i = this.list.length; i--; ) if (this.list[i][t] === e) return this.list[i];
            return null;
        },
        exists: function(t) {
            return -1 < this.list.indexOf(t);
        },
        reset: function() {
            this.list.length = 0;
        },
        remove: function(t) {
            var e = this.list.indexOf(t);
            if (-1 < e) return this.list.splice(e, 1), t;
        },
        setAll: function(t, e) {
            for (var i = this.list.length; i--; ) this.list[i] && (this.list[i][t] = e);
        },
        callAll: function(t) {
            for (var e = Array.prototype.slice.call(arguments, 1), i = this.list.length; i--; ) this.list[i] && this.list[i][t] && this.list[i][t].apply(this.list[i], e);
        },
        removeAll: function(t) {
            void 0 === t && (t = !1);
            for (var e = this.list.length; e--; ) if (this.list[e]) {
                var i = this.remove(this.list[e]);
                t && i.destroy();
            }
            this.position = 0, this.list = [];
        }
    }, Object.defineProperty(z.ArraySet.prototype, "total", {
        get: function() {
            return this.list.length;
        }
    }), Object.defineProperty(z.ArraySet.prototype, "first", {
        get: function() {
            return (this.position = 0) < this.list.length ? this.list[0] : null;
        }
    }), Object.defineProperty(z.ArraySet.prototype, "next", {
        get: function() {
            return this.position < this.list.length ? (this.position++, this.list[this.position]) : null;
        }
    }), z.ArraySet.prototype.constructor = z.ArraySet, z.ArrayUtils = {
        getRandomItem: function(t, e, i) {
            if (null === t) return null;
            void 0 === e && (e = 0), void 0 === i && (i = t.length);
            var n = e + Math.floor(Math.random() * i);
            return void 0 === t[n] ? null : t[n];
        },
        removeRandomItem: function(t, e, i) {
            if (null == t) return null;
            void 0 === e && (e = 0), void 0 === i && (i = t.length);
            var n = e + Math.floor(Math.random() * i);
            if (n < t.length) {
                var s = t.splice(n, 1);
                return void 0 === s[0] ? null : s[0];
            }
            return null;
        },
        remove: function(t, e, i) {
            var n = t.length;
            if (!(n <= e || 0 === i)) {
                null == i && (i = 1);
                for (var s = n - i, o = e; o < s; ++o) t[o] = t[o + i];
                t.length = s;
            }
        },
        shuffle: function(t) {
            for (var e = t.length - 1; 0 < e; e--) {
                var i = Math.floor(Math.random() * (e + 1)), n = t[e];
                t[e] = t[i], t[i] = n;
            }
            return t;
        },
        transposeMatrix: function(t) {
            for (var e = t.length, i = t[0].length, n = new Array(i), s = 0; s < i; s++) {
                n[s] = new Array(e);
                for (var o = e - 1; -1 < o; o--) n[s][o] = t[o][s];
            }
            return n;
        },
        rotateMatrix: function(t, e) {
            if ("string" != typeof e && (e = (e % 360 + 360) % 360), 90 === e || -270 === e || "rotateLeft" === e) t = (t = z.ArrayUtils.transposeMatrix(t)).reverse(); else if (-90 === e || 270 === e || "rotateRight" === e) t = t.reverse(), 
            t = z.ArrayUtils.transposeMatrix(t); else if (180 === Math.abs(e) || "rotate180" === e) {
                for (var i = 0; i < t.length; i++) t[i].reverse();
                t = t.reverse();
            }
            return t;
        },
        findClosest: function(t, e) {
            if (!e.length) return NaN;
            if (1 === e.length || t < e[0]) return e[0];
            for (var i = 1; e[i] < t; ) i++;
            var n = e[i - 1], s = i < e.length ? e[i] : Number.POSITIVE_INFINITY;
            return s - t <= t - n ? s : n;
        },
        rotateRight: function(t) {
            var e = t.pop();
            return t.unshift(e), e;
        },
        rotateLeft: function(t) {
            var e = t.shift();
            return t.push(e), e;
        },
        numberArray: function(t, e) {
            null == e && (e = t, t = 0);
            for (var i = [], n = t; n <= e; n++) i.push(n);
            return i;
        },
        numberArrayStep: function(t, e, i) {
            null == t && (t = 0), null == e && (e = t, t = 0), void 0 === i && (i = 1);
            for (var n = [], s = Math.max(z.Math.roundAwayFromZero((e - t) / (i || 1)), 0), o = 0; o < s; o++) n.push(t), 
            t += i;
            return n;
        }
    }, z.LinkedList = function() {
        this.next = null, this.prev = null, this.first = null, this.last = null, this.total = 0;
    }, z.LinkedList.prototype = {
        add: function(t) {
            return 0 === this.total && null === this.first && null === this.last ? (this.first = t, 
            this.last = t, ((this.next = t).prev = this).total++) : ((this.last.next = t).prev = this.last, 
            this.last = t, this.total++), t;
        },
        reset: function() {
            this.first = null, this.last = null, this.next = null, this.prev = null, this.total = 0;
        },
        remove: function(t) {
            if (1 === this.total) return this.reset(), void (t.next = t.prev = null);
            t === this.first ? this.first = this.first.next : t === this.last && (this.last = this.last.prev), 
            t.prev && (t.prev.next = t.next), t.next && (t.next.prev = t.prev), t.next = t.prev = null, 
            null === this.first && (this.last = null), this.total--;
        },
        callAll: function(t) {
            if (this.first && this.last) for (var e = this.first; e && e[t] && e[t].call(e), 
            (e = e.next) !== this.last.next; ) ;
        }
    }, z.LinkedList.prototype.constructor = z.LinkedList, z.Create = function(t) {
        this.game = t, this.bmd = null, this.canvas = null, this.ctx = null, this.palettes = [ {
            0: "#000",
            1: "#9D9D9D",
            2: "#FFF",
            3: "#BE2633",
            4: "#E06F8B",
            5: "#493C2B",
            6: "#A46422",
            7: "#EB8931",
            8: "#F7E26B",
            9: "#2F484E",
            A: "#44891A",
            B: "#A3CE27",
            C: "#1B2632",
            D: "#005784",
            E: "#31A2F2",
            F: "#B2DCEF"
        }, {
            0: "#000",
            1: "#191028",
            2: "#46af45",
            3: "#a1d685",
            4: "#453e78",
            5: "#7664fe",
            6: "#833129",
            7: "#9ec2e8",
            8: "#dc534b",
            9: "#e18d79",
            A: "#d6b97b",
            B: "#e9d8a1",
            C: "#216c4b",
            D: "#d365c8",
            E: "#afaab9",
            F: "#f5f4eb"
        }, {
            0: "#000",
            1: "#2234d1",
            2: "#0c7e45",
            3: "#44aacc",
            4: "#8a3622",
            5: "#5c2e78",
            6: "#aa5c3d",
            7: "#b5b5b5",
            8: "#5e606e",
            9: "#4c81fb",
            A: "#6cd947",
            B: "#7be2f9",
            C: "#eb8a60",
            D: "#e23d69",
            E: "#ffd93f",
            F: "#fff"
        }, {
            0: "#000",
            1: "#fff",
            2: "#8b4131",
            3: "#7bbdc5",
            4: "#8b41ac",
            5: "#6aac41",
            6: "#3931a4",
            7: "#d5de73",
            8: "#945a20",
            9: "#5a4100",
            A: "#bd736a",
            B: "#525252",
            C: "#838383",
            D: "#acee8b",
            E: "#7b73de",
            F: "#acacac"
        }, {
            0: "#000",
            1: "#191028",
            2: "#46af45",
            3: "#a1d685",
            4: "#453e78",
            5: "#7664fe",
            6: "#833129",
            7: "#9ec2e8",
            8: "#dc534b",
            9: "#e18d79",
            A: "#d6b97b",
            B: "#e9d8a1",
            C: "#216c4b",
            D: "#d365c8",
            E: "#afaab9",
            F: "#fff"
        } ];
    }, z.Create.PALETTE_ARNE = 0, z.Create.PALETTE_JMP = 1, z.Create.PALETTE_CGA = 2, 
    z.Create.PALETTE_C64 = 3, z.Create.PALETTE_JAPANESE_MACHINE = 4, z.Create.prototype = {
        texture: function(t, e, i, n, s, o, a, r) {
            void 0 === i && (i = 8), void 0 === n && (n = i), void 0 === s && (s = 0), void 0 === o && (o = !0);
            var h = e[0].length * i, l = e.length * n;
            null === this.bmd && (this.bmd = this.game.make.bitmapData(), this.canvas = this.bmd.canvas, 
            this.ctx = this.bmd.context), this.bmd.resize(h, l), this.bmd.clear();
            for (var c = 0; c < e.length; c++) for (var u = e[c], d = 0; d < u.length; d++) {
                var p = u[d];
                "." !== p && " " !== p && (this.ctx.fillStyle = this.palettes[s][p], this.ctx.fillRect(d * i, c * n, i, n));
            }
            return o ? this.bmd.generateTexture(t, a, r) : this.copy();
        },
        grid: function(t, e, i, n, s, o, a, r, h) {
            void 0 === a && (a = !0), null === this.bmd && (this.bmd = this.game.make.bitmapData(), 
            this.canvas = this.bmd.canvas, this.ctx = this.bmd.context), this.bmd.resize(e, i), 
            this.ctx.fillStyle = o;
            for (var l = 0; l < i; l += s) this.ctx.fillRect(0, l, e, 1);
            for (var c = 0; c < e; c += n) this.ctx.fillRect(c, 0, 1, i);
            return a ? this.bmd.generateTexture(t, r, h) : this.copy();
        },
        copy: function(t, e, i, n, s, o, a) {
            return null == t && (t = this.game.make.bitmapData()), t.resize(this.bmd.width, this.bmd.height), 
            t.draw(this.bmd, e, i, n, s, o, a);
        }
    }, z.Create.prototype.constructor = z.Create, z.FlexGrid = function(t, e, i) {
        this.game = t.game, this.manager = t, this.width = e, this.height = i, this.boundsCustom = new z.Rectangle(0, 0, e, i), 
        this.boundsFluid = new z.Rectangle(0, 0, e, i), this.boundsFull = new z.Rectangle(0, 0, e, i), 
        this.boundsNone = new z.Rectangle(0, 0, e, i), this.positionCustom = new z.Point(0, 0), 
        this.positionFluid = new z.Point(0, 0), this.positionFull = new z.Point(0, 0), this.positionNone = new z.Point(0, 0), 
        this.scaleCustom = new z.Point(1, 1), this.scaleFluid = new z.Point(1, 1), this.scaleFluidInversed = new z.Point(1, 1), 
        this.scaleFull = new z.Point(1, 1), this.scaleNone = new z.Point(1, 1), this.customWidth = 0, 
        this.customHeight = 0, this.customOffsetX = 0, this.customOffsetY = 0, this.ratioH = e / i, 
        this.ratioV = i / e, this.multiplier = 0, this.layers = [];
    }, z.FlexGrid.prototype = {
        setSize: function(t, e) {
            this.width = t, this.height = e, this.ratioH = t / e, this.ratioV = e / t, this.scaleNone = new z.Point(1, 1), 
            this.boundsNone.width = this.width, this.boundsNone.height = this.height, this.refresh();
        },
        createCustomLayer: function(t, e, i, n) {
            void 0 === n && (n = !0), this.customWidth = t, this.customHeight = e, this.boundsCustom.width = t, 
            this.boundsCustom.height = e;
            var s = new z.FlexLayer(this, this.positionCustom, this.boundsCustom, this.scaleCustom);
            return n && this.game.world.add(s), this.layers.push(s), i && s.addMultiple(i), 
            s;
        },
        createFluidLayer: function(t, e) {
            void 0 === e && (e = !0);
            var i = new z.FlexLayer(this, this.positionFluid, this.boundsFluid, this.scaleFluid);
            return e && this.game.world.add(i), this.layers.push(i), t && i.addMultiple(t), 
            i;
        },
        createFullLayer: function(t) {
            var e = new z.FlexLayer(this, this.positionFull, this.boundsFull, this.scaleFluid);
            return this.game.world.add(e), this.layers.push(e), void 0 !== t && e.addMultiple(t), 
            e;
        },
        createFixedLayer: function(t) {
            var e = new z.FlexLayer(this, this.positionNone, this.boundsNone, this.scaleNone);
            return this.game.world.add(e), this.layers.push(e), void 0 !== t && e.addMultiple(t), 
            e;
        },
        reset: function() {
            for (var t = this.layers.length; t--; ) this.layers[t].persist || (this.layers[t].position = null, 
            this.layers[t].scale = null, this.layers.slice(t, 1));
        },
        onResize: function(t, e) {
            this.ratioH = t / e, this.ratioV = e / t, this.refresh(t, e);
        },
        refresh: function() {
            this.multiplier = Math.min(this.manager.height / this.height, this.manager.width / this.width), 
            this.boundsFluid.width = Math.round(this.width * this.multiplier), this.boundsFluid.height = Math.round(this.height * this.multiplier), 
            this.scaleFluid.set(this.boundsFluid.width / this.width, this.boundsFluid.height / this.height), 
            this.scaleFluidInversed.set(this.width / this.boundsFluid.width, this.height / this.boundsFluid.height), 
            this.scaleFull.set(this.boundsFull.width / this.width, this.boundsFull.height / this.height), 
            this.boundsFull.width = Math.round(this.manager.width * this.scaleFluidInversed.x), 
            this.boundsFull.height = Math.round(this.manager.height * this.scaleFluidInversed.y), 
            this.boundsFluid.centerOn(this.manager.bounds.centerX, this.manager.bounds.centerY), 
            this.boundsNone.centerOn(this.manager.bounds.centerX, this.manager.bounds.centerY), 
            this.positionFluid.set(this.boundsFluid.x, this.boundsFluid.y), this.positionNone.set(this.boundsNone.x, this.boundsNone.y);
        },
        fitSprite: function(t) {
            this.manager.scaleSprite(t), t.x = this.manager.bounds.centerX, t.y = this.manager.bounds.centerY;
        },
        debug: function() {
            this.game.debug.text(this.boundsFluid.width + " x " + this.boundsFluid.height, this.boundsFluid.x + 4, this.boundsFluid.y + 16), 
            this.game.debug.geom(this.boundsFluid, "rgba(255,0,0,0.9", !1);
        }
    }, z.FlexGrid.prototype.constructor = z.FlexGrid, z.FlexLayer = function(t, e, i, n) {
        z.Group.call(this, t.game, null, "__flexLayer" + t.game.rnd.uuid(), !1), this.manager = t.manager, 
        this.grid = t, this.persist = !1, this.position = e, this.bounds = i, this.scale = n, 
        this.topLeft = i.topLeft, this.topMiddle = new z.Point(i.halfWidth, 0), this.topRight = i.topRight, 
        this.bottomLeft = i.bottomLeft, this.bottomMiddle = new z.Point(i.halfWidth, i.bottom), 
        this.bottomRight = i.bottomRight;
    }, z.FlexLayer.prototype = Object.create(z.Group.prototype), z.FlexLayer.prototype.constructor = z.FlexLayer, 
    z.FlexLayer.prototype.resize = function() {}, z.FlexLayer.prototype.debug = function() {
        this.game.debug.text(this.bounds.width + " x " + this.bounds.height, this.bounds.x + 4, this.bounds.y + 16), 
        this.game.debug.geom(this.bounds, "rgba(0,0,255,0.9", !1), this.game.debug.geom(this.topLeft, "rgba(255,255,255,0.9"), 
        this.game.debug.geom(this.topMiddle, "rgba(255,255,255,0.9"), this.game.debug.geom(this.topRight, "rgba(255,255,255,0.9");
    }, z.Color = {
        RED: 16711680,
        ORANGE: 16750848,
        YELLOW: 16776960,
        GREEN: 65280,
        AQUA: 65535,
        BLUE: 255,
        VIOLET: 16711935,
        WHITE: 16777215,
        BLACK: 0,
        GRAY: 6710886,
        packPixel: function(t, e, i, n) {
            return z.Device.LITTLE_ENDIAN ? (n << 24 | i << 16 | e << 8 | t) >>> 0 : (t << 24 | e << 16 | i << 8 | n) >>> 0;
        },
        unpackPixel: function(t, e, i, n) {
            return null == e && (e = z.Color.createColor()), null == i && (i = !1), null == n && (n = !1), 
            z.Device.LITTLE_ENDIAN ? (e.a = (4278190080 & t) >>> 24, e.b = (16711680 & t) >>> 16, 
            e.g = (65280 & t) >>> 8, e.r = 255 & t) : (e.r = (4278190080 & t) >>> 24, e.g = (16711680 & t) >>> 16, 
            e.b = (65280 & t) >>> 8, e.a = 255 & t), e.color = t, e.rgba = "rgba(" + e.r + "," + e.g + "," + e.b + "," + e.a / 255 + ")", 
            i && z.Color.RGBtoHSL(e.r, e.g, e.b, e), n && z.Color.RGBtoHSV(e.r, e.g, e.b, e), 
            e;
        },
        fromRGBA: function(t, e) {
            return e || (e = z.Color.createColor()), e.r = (4278190080 & t) >>> 24, e.g = (16711680 & t) >>> 16, 
            e.b = (65280 & t) >>> 8, e.a = 255 & t, e.rgba = "rgba(" + e.r + "," + e.g + "," + e.b + "," + e.a + ")", 
            e;
        },
        toRGBA: function(t, e, i, n) {
            return t << 24 | e << 16 | i << 8 | n;
        },
        toABGR: function(t, e, i, n) {
            return (n << 24 | i << 16 | e << 8 | t) >>> 0;
        },
        hexToRGBArray: function(t) {
            return [ (t >> 16 & 255) / 255, (t >> 8 & 255) / 255, (255 & t) / 255 ];
        },
        RGBArrayToHex: function(t) {
            return (255 * t[0] << 16) + (255 * t[1] << 8) + 255 * t[2];
        },
        RGBtoHSL: function(t, e, i, n) {
            n || (n = z.Color.createColor(t, e, i, 1)), t /= 255, e /= 255, i /= 255;
            var s = Math.min(t, e, i), o = Math.max(t, e, i);
            if (n.h = 0, n.s = 0, n.l = (o + s) / 2, o !== s) {
                var a = o - s;
                n.s = .5 < n.l ? a / (2 - o - s) : a / (o + s), o === t ? n.h = (e - i) / a + (e < i ? 6 : 0) : o === e ? n.h = (i - t) / a + 2 : o === i && (n.h = (t - e) / a + 4), 
                n.h /= 6;
            }
            return n;
        },
        HSLtoRGB: function(t, e, i, n) {
            if (n ? (n.r = i, n.g = i, n.b = i) : n = z.Color.createColor(i, i, i), 0 !== e) {
                var s = i < .5 ? i * (1 + e) : i + e - i * e, o = 2 * i - s;
                n.r = z.Color.hueToColor(o, s, t + 1 / 3), n.g = z.Color.hueToColor(o, s, t), n.b = z.Color.hueToColor(o, s, t - 1 / 3);
            }
            return n.r = Math.floor(255 * n.r | 0), n.g = Math.floor(255 * n.g | 0), n.b = Math.floor(255 * n.b | 0), 
            z.Color.updateColor(n), n;
        },
        RGBtoHSV: function(t, e, i, n) {
            n || (n = z.Color.createColor(t, e, i, 255)), t /= 255, e /= 255, i /= 255;
            var s = Math.min(t, e, i), o = Math.max(t, e, i), a = o - s;
            return n.h = 0, n.s = 0 === o ? 0 : a / o, (n.v = o) !== s && (o === t ? n.h = (e - i) / a + (e < i ? 6 : 0) : o === e ? n.h = (i - t) / a + 2 : o === i && (n.h = (t - e) / a + 4), 
            n.h /= 6), n;
        },
        HSVtoRGB: function(t, e, i, n) {
            var s, o, a;
            void 0 === n && (n = z.Color.createColor(0, 0, 0, 1, t, e, 0, i));
            var r = Math.floor(6 * t), h = 6 * t - r, l = i * (1 - e), c = i * (1 - h * e), u = i * (1 - (1 - h) * e);
            switch (r % 6) {
              case 0:
                s = i, o = u, a = l;
                break;

              case 1:
                s = c, o = i, a = l;
                break;

              case 2:
                s = l, o = i, a = u;
                break;

              case 3:
                s = l, o = c, a = i;
                break;

              case 4:
                s = u, o = l, a = i;
                break;

              case 5:
                s = i, o = l, a = c;
            }
            return n.r = Math.floor(255 * s), n.g = Math.floor(255 * o), n.b = Math.floor(255 * a), 
            z.Color.updateColor(n), n;
        },
        hueToColor: function(t, e, i) {
            return i < 0 && (i += 1), 1 < i && (i -= 1), i < 1 / 6 ? t + 6 * (e - t) * i : i < .5 ? e : i < 2 / 3 ? t + (e - t) * (2 / 3 - i) * 6 : t;
        },
        createColor: function(t, e, i, n, s, o, a, r) {
            var h = {
                r: t || 0,
                g: e || 0,
                b: i || 0,
                a: n || 1,
                h: s || 0,
                s: o || 0,
                l: a || 0,
                v: r || 0,
                color: 0,
                color32: 0,
                rgba: ""
            };
            return z.Color.updateColor(h);
        },
        updateColor: function(t) {
            return t.rgba = "rgba(" + t.r.toFixed() + "," + t.g.toFixed() + "," + t.b.toFixed() + "," + t.a.toString() + ")", 
            t.color = z.Color.getColor(t.r, t.g, t.b), t.color32 = z.Color.getColor32(255 * t.a, t.r, t.g, t.b), 
            t;
        },
        getColor32: function(t, e, i, n) {
            return t << 24 | e << 16 | i << 8 | n;
        },
        getColor: function(t, e, i) {
            return t << 16 | e << 8 | i;
        },
        RGBtoString: function(t, e, i, n, s) {
            return void 0 === n && (n = 255), void 0 === s && (s = "#"), "#" === s ? "#" + ((1 << 24) + (t << 16) + (e << 8) + i).toString(16).slice(1) : "0x" + z.Color.componentToHex(n) + z.Color.componentToHex(t) + z.Color.componentToHex(e) + z.Color.componentToHex(i);
        },
        hexToRGB: function(t) {
            var e = z.Color.hexToColor(t);
            if (e) return z.Color.getColor32(e.a, e.r, e.g, e.b);
        },
        hexToColor: function(t, e) {
            t = t.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i, function(t, e, i, n) {
                return e + e + i + i + n + n;
            });
            var i = /^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);
            if (i) {
                var n = parseInt(i[1], 16), s = parseInt(i[2], 16), o = parseInt(i[3], 16);
                e ? (e.r = n, e.g = s, e.b = o) : e = z.Color.createColor(n, s, o);
            }
            return e;
        },
        webToColor: function(t, e) {
            e || (e = z.Color.createColor());
            var i = /^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(t);
            return i && (e.r = ~~Number(i[1]), e.g = ~~Number(i[2]), e.b = ~~Number(i[3]), e.a = void 0 !== i[4] ? Number(i[4]) : 1, 
            z.Color.updateColor(e)), e;
        },
        valueToColor: function(t, e) {
            if (e || (e = z.Color.createColor()), "string" == typeof t) return 0 === t.indexOf("rgb") ? z.Color.webToColor(t, e) : (e.a = 1, 
            z.Color.hexToColor(t, e));
            if ("number" == typeof t) {
                var i = z.Color.getRGB(t);
                return e.r = i.r, e.g = i.g, e.b = i.b, e.a = i.a / 255, e;
            }
            return e;
        },
        componentToHex: function(t) {
            var e = t.toString(16);
            return 1 === e.length ? "0" + e : e;
        },
        HSVColorWheel: function(t, e) {
            void 0 === t && (t = 1), void 0 === e && (e = 1);
            for (var i = [], n = 0; n <= 359; n++) i.push(z.Color.HSVtoRGB(n / 359, t, e));
            return i;
        },
        HSLColorWheel: function(t, e) {
            void 0 === t && (t = .5), void 0 === e && (e = .5);
            for (var i = [], n = 0; n <= 359; n++) i.push(z.Color.HSLtoRGB(n / 359, t, e));
            return i;
        },
        interpolateColor: function(t, e, i, n, s, o) {
            void 0 === s && (s = 255), void 0 === o && (o = 0);
            var a = z.Color.getRGB(t), r = z.Color.getRGB(e);
            if (0 === o) var h = (r.red - a.red) * n / i + a.red, l = (r.green - a.green) * n / i + a.green, c = (r.blue - a.blue) * n / i + a.blue;
            if (1 === o) {
                var u, d = z.Color.RGBtoHSV(a.r, a.g, a.b), p = z.Color.RGBtoHSV(r.r, r.g, r.b), g = p.h - d.h;
                if (d.h > p.h) {
                    var m = p.h;
                    p.h = d.h, d.h = m, g = -g, n = i - n;
                }
                .5 < g && (d.h = d.h + 1, u = ((p.h - d.h) * n / i + d.h) % 1), g <= .5 && (u = (p.h - d.h) * n / i + d.h);
                var f = (p.s - d.s) * n / i + d.s, y = (p.v - d.v) * n / i + d.v, v = z.Color.HSVtoRGB(u, f, y, v);
                h = v.r, l = v.g, c = v.b;
            }
            return z.Color.getColor32(s, h, l, c);
        },
        interpolateColorWithRGB: function(t, e, i, n, s, o) {
            var a = z.Color.getRGB(t), r = (e - a.red) * o / s + a.red, h = (i - a.green) * o / s + a.green, l = (n - a.blue) * o / s + a.blue;
            return z.Color.getColor(r, h, l);
        },
        interpolateRGB: function(t, e, i, n, s, o, a, r) {
            var h = (n - t) * r / a + t, l = (s - e) * r / a + e, c = (o - i) * r / a + i;
            return z.Color.getColor(h, l, c);
        },
        linear: function(t, e, i) {
            return this.interpolateColor(t, e, 1, i);
        },
        linearInterpolation: function(t, e) {
            var i = z.Math.linear(0, t.length - 1, e), n = t[Math.floor(i)], s = t[Math.ceil(i)];
            return this.linear(n, s, i % 1);
        },
        getRandomColor: function(t, e, i) {
            if (void 0 === t && (t = 0), void 0 === e && (e = 255), void 0 === i && (i = 255), 
            255 < e || e < t) return z.Color.getColor(255, 255, 255);
            var n = t + Math.round(Math.random() * (e - t)), s = t + Math.round(Math.random() * (e - t)), o = t + Math.round(Math.random() * (e - t));
            return z.Color.getColor32(i, n, s, o);
        },
        getRGB: function(t) {
            return 16777215 < t ? {
                alpha: t >>> 24,
                red: t >> 16 & 255,
                green: t >> 8 & 255,
                blue: 255 & t,
                a: t >>> 24,
                r: t >> 16 & 255,
                g: t >> 8 & 255,
                b: 255 & t
            } : {
                alpha: 255,
                red: t >> 16 & 255,
                green: t >> 8 & 255,
                blue: 255 & t,
                a: 255,
                r: t >> 16 & 255,
                g: t >> 8 & 255,
                b: 255 & t
            };
        },
        getWebRGB: function(t) {
            if ("object" == typeof t) return "rgba(" + t.r.toString() + "," + t.g.toString() + "," + t.b.toString() + "," + (t.a / 255).toString() + ")";
            var e = z.Color.getRGB(t);
            return "rgba(" + e.r.toString() + "," + e.g.toString() + "," + e.b.toString() + "," + (e.a / 255).toString() + ")";
        },
        getAlpha: function(t) {
            return t >>> 24;
        },
        getAlphaFloat: function(t) {
            return (t >>> 24) / 255;
        },
        getRed: function(t) {
            return t >> 16 & 255;
        },
        getGreen: function(t) {
            return t >> 8 & 255;
        },
        getBlue: function(t) {
            return 255 & t;
        },
        blendNormal: function(t) {
            return t;
        },
        blendLighten: function(t, e) {
            return t < e ? e : t;
        },
        blendDarken: function(t, e) {
            return t < e ? t : e;
        },
        blendMultiply: function(t, e) {
            return t * e / 255;
        },
        blendAverage: function(t, e) {
            return (t + e) / 2;
        },
        blendAdd: function(t, e) {
            return Math.min(255, t + e);
        },
        blendSubtract: function(t, e) {
            return Math.max(0, t + e - 255);
        },
        blendDifference: function(t, e) {
            return Math.abs(t - e);
        },
        blendNegation: function(t, e) {
            return 255 - Math.abs(255 - t - e);
        },
        blendScreen: function(t, e) {
            return 255 - ((255 - t) * (255 - e) >> 8);
        },
        blendExclusion: function(t, e) {
            return t + e - 2 * t * e / 255;
        },
        blendOverlay: function(t, e) {
            return e < 128 ? 2 * t * e / 255 : 255 - 2 * (255 - t) * (255 - e) / 255;
        },
        blendSoftLight: function(t, e) {
            return e < 128 ? 2 * (64 + (t >> 1)) * (e / 255) : 255 - 2 * (255 - (64 + (t >> 1))) * (255 - e) / 255;
        },
        blendHardLight: function(t, e) {
            return z.Color.blendOverlay(e, t);
        },
        blendColorDodge: function(t, e) {
            return 255 === e ? e : Math.min(255, (t << 8) / (255 - e));
        },
        blendColorBurn: function(t, e) {
            return 0 === e ? e : Math.max(0, 255 - (255 - t << 8) / e);
        },
        blendLinearDodge: function(t, e) {
            return z.Color.blendAdd(t, e);
        },
        blendLinearBurn: function(t, e) {
            return z.Color.blendSubtract(t, e);
        },
        blendLinearLight: function(t, e) {
            return e < 128 ? z.Color.blendLinearBurn(t, 2 * e) : z.Color.blendLinearDodge(t, 2 * (e - 128));
        },
        blendVividLight: function(t, e) {
            return e < 128 ? z.Color.blendColorBurn(t, 2 * e) : z.Color.blendColorDodge(t, 2 * (e - 128));
        },
        blendPinLight: function(t, e) {
            return e < 128 ? z.Color.blendDarken(t, 2 * e) : z.Color.blendLighten(t, 2 * (e - 128));
        },
        blendHardMix: function(t, e) {
            return z.Color.blendVividLight(t, e) < 128 ? 0 : 255;
        },
        blendReflect: function(t, e) {
            return 255 === e ? e : Math.min(255, t * t / (255 - e));
        },
        blendGlow: function(t, e) {
            return z.Color.blendReflect(e, t);
        },
        blendPhoenix: function(t, e) {
            return Math.min(t, e) - Math.max(t, e) + 255;
        }
    }, z.Physics = function(t, e) {
        e = e || {}, this.game = t, this.config = e, this.arcade = null, this.p2 = null, 
        this.ninja = null, this.box2d = null, this.chipmunk = null, this.matter = null, 
        this.parseConfig();
    }, z.Physics.ARCADE = 0, z.Physics.P2JS = 1, z.Physics.NINJA = 2, z.Physics.BOX2D = 3, 
    z.Physics.CHIPMUNK = 4, z.Physics.MATTERJS = 5, z.Physics.prototype = {
        parseConfig: function() {
            this.config.hasOwnProperty("arcade") && !0 !== this.config.arcade || !z.Physics.hasOwnProperty("Arcade") || (this.arcade = new z.Physics.Arcade(this.game)), 
            this.config.hasOwnProperty("ninja") && !0 === this.config.ninja && z.Physics.hasOwnProperty("Ninja") && (this.ninja = new z.Physics.Ninja(this.game)), 
            this.config.hasOwnProperty("p2") && !0 === this.config.p2 && z.Physics.hasOwnProperty("P2") && (this.p2 = new z.Physics.P2(this.game, this.config)), 
            this.config.hasOwnProperty("box2d") && !0 === this.config.box2d && z.Physics.hasOwnProperty("BOX2D") && (this.box2d = new z.Physics.Box2D(this.game, this.config)), 
            this.config.hasOwnProperty("matter") && !0 === this.config.matter && z.Physics.hasOwnProperty("Matter") && (this.matter = new z.Physics.Matter(this.game, this.config));
        },
        startSystem: function(t) {
            t === z.Physics.ARCADE ? this.arcade = new z.Physics.Arcade(this.game) : t === z.Physics.P2JS ? null === this.p2 ? this.p2 = new z.Physics.P2(this.game, this.config) : this.p2.reset() : t === z.Physics.NINJA ? this.ninja = new z.Physics.Ninja(this.game) : t === z.Physics.BOX2D ? null === this.box2d ? this.box2d = new z.Physics.Box2D(this.game, this.config) : this.box2d.reset() : t === z.Physics.MATTERJS && (null === this.matter ? this.matter = new z.Physics.Matter(this.game, this.config) : this.matter.reset());
        },
        enable: function(t, e, i) {
            void 0 === e && (e = z.Physics.ARCADE), void 0 === i && (i = !1), e === z.Physics.ARCADE ? this.arcade.enable(t) : e === z.Physics.P2JS && this.p2 ? this.p2.enable(t, i) : e === z.Physics.NINJA && this.ninja ? this.ninja.enableAABB(t) : e === z.Physics.BOX2D && this.box2d ? this.box2d.enable(t) : e === z.Physics.MATTERJS && this.matter && this.matter.enable(t);
        },
        preUpdate: function() {
            this.p2 && this.p2.preUpdate(), this.box2d && this.box2d.preUpdate(), this.matter && this.matter.preUpdate();
        },
        update: function() {
            this.p2 && this.p2.update(), this.box2d && this.box2d.update(), this.matter && this.matter.update();
        },
        setBoundsToWorld: function() {
            this.arcade && this.arcade.setBoundsToWorld(), this.ninja && this.ninja.setBoundsToWorld(), 
            this.p2 && this.p2.setBoundsToWorld(), this.box2d && this.box2d.setBoundsToWorld(), 
            this.matter && this.matter.setBoundsToWorld();
        },
        clear: function() {
            this.p2 && this.p2.clear(), this.box2d && this.box2d.clear(), this.matter && this.matter.clear();
        },
        reset: function() {
            this.p2 && this.p2.reset(), this.box2d && this.box2d.reset(), this.matter && this.matter.reset();
        },
        destroy: function() {
            this.p2 && this.p2.destroy(), this.box2d && this.box2d.destroy(), this.matter && this.matter.destroy(), 
            this.arcade = null, this.ninja = null, this.p2 = null, this.box2d = null, this.matter = null;
        }
    }, z.Physics.prototype.constructor = z.Physics, z.Physics.Arcade = function(t) {
        this.game = t, this.gravity = new z.Point(), this.bounds = new z.Rectangle(0, 0, t.world.width, t.world.height), 
        this.checkCollision = {
            up: !0,
            down: !0,
            left: !0,
            right: !0
        }, this.maxObjects = 10, this.maxLevels = 4, this.OVERLAP_BIAS = 4, this.forceX = !1, 
        this.sortDirection = z.Physics.Arcade.LEFT_RIGHT, this.skipQuadTree = !0, this.isPaused = !1, 
        this.quadTree = new z.QuadTree(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, this.maxObjects, this.maxLevels), 
        this._total = 0, this.setBoundsToWorld();
    }, z.Physics.Arcade.prototype.constructor = z.Physics.Arcade, z.Physics.Arcade.SORT_NONE = 0, 
    z.Physics.Arcade.LEFT_RIGHT = 1, z.Physics.Arcade.RIGHT_LEFT = 2, z.Physics.Arcade.TOP_BOTTOM = 3, 
    z.Physics.Arcade.BOTTOM_TOP = 4, z.Physics.Arcade.prototype = {
        setBounds: function(t, e, i, n) {
            this.bounds.setTo(t, e, i, n);
        },
        setBoundsToWorld: function() {
            this.bounds.copyFrom(this.game.world.bounds);
        },
        enable: function(t, e) {
            void 0 === e && (e = !0);
            var i = 1;
            if (Array.isArray(t)) for (i = t.length; i--; ) t[i] instanceof z.Group ? this.enable(t[i].children, e) : (this.enableBody(t[i]), 
            e && t[i].hasOwnProperty("children") && 0 < t[i].children.length && this.enable(t[i], !0)); else t instanceof z.Group ? this.enable(t.children, e) : (this.enableBody(t), 
            e && t.hasOwnProperty("children") && 0 < t.children.length && this.enable(t.children, !0));
        },
        enableBody: function(t) {
            t.hasOwnProperty("body") && null === t.body && (t.body = new z.Physics.Arcade.Body(t), 
            t.parent && t.parent instanceof z.Group && t.parent.addToHash(t));
        },
        updateMotion: function(t) {
            if (t.allowRotation) {
                var e = this.computeVelocity(0, t, t.angularVelocity, t.angularAcceleration, t.angularDrag, t.maxAngular) - t.angularVelocity;
                t.angularVelocity += e, t.rotation += t.angularVelocity * this.game.time.physicsElapsed;
            }
            t.velocity.x = this.computeVelocity(1, t, t.velocity.x, t.acceleration.x, t.drag.x, t.maxVelocity.x), 
            t.velocity.y = this.computeVelocity(2, t, t.velocity.y, t.acceleration.y, t.drag.y, t.maxVelocity.y);
        },
        computeVelocity: function(t, e, i, n, s, o) {
            return void 0 === o && (o = 1e4), 1 === t && e.allowGravity ? i += (this.gravity.x + e.gravity.x) * this.game.time.physicsElapsed : 2 === t && e.allowGravity && (i += (this.gravity.y + e.gravity.y) * this.game.time.physicsElapsed), 
            n ? i += n * this.game.time.physicsElapsed : s && e.allowDrag && (0 < i - (s *= this.game.time.physicsElapsed) ? i -= s : i + s < 0 ? i += s : i = 0), 
            o < i ? i = o : i < -o && (i = -o), i;
        },
        overlap: function(t, e, i, n, s) {
            return i = i || null, n = n || null, s = s || i, this._total = 0, this.collideObjects(t, e, i, n, s, !0), 
            0 < this._total;
        },
        collide: function(t, e, i, n, s) {
            return i = i || null, n = n || null, s = s || i, this._total = 0, this.collideObjects(t, e, i, n, s, !1), 
            0 < this._total;
        },
        sortLeftRight: function(t, e) {
            return t.body && e.body ? t.body.x - e.body.x : 0;
        },
        sortRightLeft: function(t, e) {
            return t.body && e.body ? e.body.x - t.body.x : 0;
        },
        sortTopBottom: function(t, e) {
            return t.body && e.body ? t.body.y - e.body.y : 0;
        },
        sortBottomTop: function(t, e) {
            return t.body && e.body ? e.body.y - t.body.y : 0;
        },
        sort: function(t, e) {
            null !== t.physicsSortDirection ? e = t.physicsSortDirection : void 0 === e && (e = this.sortDirection), 
            e === z.Physics.Arcade.LEFT_RIGHT ? t.hash.sort(this.sortLeftRight) : e === z.Physics.Arcade.RIGHT_LEFT ? t.hash.sort(this.sortRightLeft) : e === z.Physics.Arcade.TOP_BOTTOM ? t.hash.sort(this.sortTopBottom) : e === z.Physics.Arcade.BOTTOM_TOP && t.hash.sort(this.sortBottomTop);
        },
        collideObjects: function(t, e, i, n, s, o) {
            if (!Array.isArray(t) && Array.isArray(e)) for (var a = 0; a < e.length; a++) e[a] && this.collideHandler(t, e[a], i, n, s, o); else if (Array.isArray(t) && !Array.isArray(e)) for (a = 0; a < t.length; a++) t[a] && this.collideHandler(t[a], e, i, n, s, o); else if (Array.isArray(t) && Array.isArray(e)) {
                for (a = 0; a < t.length; a++) if (t[a]) for (var r = 0; r < e.length; r++) e[r] && this.collideHandler(t[a], e[r], i, n, s, o);
            } else this.collideHandler(t, e, i, n, s, o);
        },
        collideHandler: function(t, e, i, n, s, o) {
            if (void 0 === e && t.physicsType === z.GROUP) return this.sort(t), void this.collideGroupVsSelf(t, i, n, s, o);
            t && e && t.exists && e.exists && (this.sortDirection !== z.Physics.Arcade.SORT_NONE && (t.physicsType === z.GROUP && this.sort(t), 
            e.physicsType === z.GROUP && this.sort(e)), t.physicsType === z.SPRITE ? e.physicsType === z.SPRITE ? this.collideSpriteVsSprite(t, e, i, n, s, o) : e.physicsType === z.GROUP ? this.collideSpriteVsGroup(t, e, i, n, s, o) : e.physicsType === z.TILEMAPLAYER && this.collideSpriteVsTilemapLayer(t, e, i, n, s, o) : t.physicsType === z.GROUP ? e.physicsType === z.SPRITE ? this.collideSpriteVsGroup(e, t, i, n, s, o) : e.physicsType === z.GROUP ? this.collideGroupVsGroup(t, e, i, n, s, o) : e.physicsType === z.TILEMAPLAYER && this.collideGroupVsTilemapLayer(t, e, i, n, s, o) : t.physicsType === z.TILEMAPLAYER && (e.physicsType === z.SPRITE ? this.collideSpriteVsTilemapLayer(e, t, i, n, s, o) : e.physicsType === z.GROUP && this.collideGroupVsTilemapLayer(e, t, i, n, s, o)));
        },
        collideSpriteVsSprite: function(t, e, i, n, s, o) {
            return !(!t.body || !e.body) && (this.separate(t.body, e.body, n, s, o) && (i && i.call(s, t, e), 
            this._total++), !0);
        },
        collideSpriteVsGroup: function(t, e, i, n, s, o) {
            if (0 !== e.length && t.body) if (this.skipQuadTree || t.body.skipQuadTree) for (var a = {}, r = 0; r < e.hash.length; r++) {
                var h = e.hash[r];
                if (h && h.exists && h.body) {
                    if (a = h.body.getBounds(a), this.sortDirection === z.Physics.Arcade.LEFT_RIGHT) {
                        if (t.body.right < a.x) break;
                        if (a.right < t.body.x) continue;
                    } else if (this.sortDirection === z.Physics.Arcade.RIGHT_LEFT) {
                        if (t.body.x > a.right) break;
                        if (a.x > t.body.right) continue;
                    } else if (this.sortDirection === z.Physics.Arcade.TOP_BOTTOM) {
                        if (t.body.bottom < a.y) break;
                        if (a.bottom < t.body.y) continue;
                    } else if (this.sortDirection === z.Physics.Arcade.BOTTOM_TOP) {
                        if (t.body.y > a.bottom) break;
                        if (a.y > t.body.bottom) continue;
                    }
                    this.collideSpriteVsSprite(t, h, i, n, s, o);
                }
            } else {
                this.quadTree.clear(), this.quadTree.reset(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, this.maxObjects, this.maxLevels), 
                this.quadTree.populate(e);
                var l = this.quadTree.retrieve(t);
                for (r = 0; r < l.length; r++) this.separate(t.body, l[r], n, s, o) && (i && i.call(s, t, l[r].sprite), 
                this._total++);
            }
        },
        collideGroupVsSelf: function(t, e, i, n, s) {
            if (0 !== t.length) for (var o = 0; o < t.hash.length; o++) {
                var a = {}, r = t.hash[o];
                if (r && r.exists && r.body) {
                    a = r.body.getBounds(a);
                    for (var h = o + 1; h < t.hash.length; h++) {
                        var l = {}, c = t.hash[h];
                        if (c && c.exists && c.body) {
                            if (l = c.body.getBounds(l), this.sortDirection === z.Physics.Arcade.LEFT_RIGHT) {
                                if (a.right < l.x) break;
                                if (l.right < a.x) continue;
                            } else if (this.sortDirection === z.Physics.Arcade.RIGHT_LEFT) {
                                if (a.x > l.right) continue;
                                if (l.x > a.right) break;
                            } else if (this.sortDirection === z.Physics.Arcade.TOP_BOTTOM) {
                                if (a.bottom < l.y) continue;
                                if (l.bottom < a.y) break;
                            } else if (this.sortDirection === z.Physics.Arcade.BOTTOM_TOP) {
                                if (a.y > l.bottom) continue;
                                if (l.y > r.body.bottom) break;
                            }
                            this.collideSpriteVsSprite(r, c, e, i, n, s);
                        }
                    }
                }
            }
        },
        collideGroupVsGroup: function(t, e, i, n, s, o) {
            if (0 !== t.length && 0 !== e.length) for (var a = 0; a < t.children.length; a++) t.children[a].exists && (t.children[a].physicsType === z.GROUP ? this.collideGroupVsGroup(t.children[a], e, i, n, s, o) : this.collideSpriteVsGroup(t.children[a], e, i, n, s, o));
        },
        separate: function(t, e, i, n, s) {
            if (!t.enable || !e.enable || t.checkCollision.none || e.checkCollision.none || !this.intersects(t, e)) return !1;
            if (i && !1 === i.call(n, t.sprite, e.sprite)) return !1;
            if (t.isCircle && e.isCircle) return this.separateCircle(t, e, s);
            if (t.isCircle !== e.isCircle) {
                var o = t.isCircle ? e : t, a = t.isCircle ? t : e, r = o.x, h = o.y, l = o.right, c = o.bottom, u = a.center;
                if ((u.y < h || u.y > c) && (u.x < r || u.x > l)) return this.separateCircle(t, e, s);
            }
            var d = !1, p = !1;
            this.forceX || Math.abs(this.gravity.y + t.gravity.y) < Math.abs(this.gravity.x + t.gravity.x) ? (d = this.separateX(t, e, s), 
            this.intersects(t, e) && (p = this.separateY(t, e, s))) : (p = this.separateY(t, e, s), 
            this.intersects(t, e) && (d = this.separateX(t, e, s)));
            var g = d || p;
            return g && (s ? (t.onOverlap && t.onOverlap.dispatch(t.sprite, e.sprite), e.onOverlap && e.onOverlap.dispatch(e.sprite, t.sprite)) : (t.onCollide && t.onCollide.dispatch(t.sprite, e.sprite), 
            e.onCollide && e.onCollide.dispatch(e.sprite, t.sprite))), g;
        },
        intersects: function(t, e) {
            return t !== e && (t.isCircle ? e.isCircle ? z.Math.distance(t.center.x, t.center.y, e.center.x, e.center.y) <= t.halfWidth + e.halfWidth : this.circleBodyIntersects(t, e) : e.isCircle ? this.circleBodyIntersects(e, t) : !(t.right <= e.position.x) && (!(t.bottom <= e.position.y) && (!(t.position.x >= e.right) && !(t.position.y >= e.bottom))));
        },
        circleBodyIntersects: function(t, e) {
            var i = z.Math.clamp(t.center.x, e.left, e.right), n = z.Math.clamp(t.center.y, e.top, e.bottom);
            return (t.center.x - i) * (t.center.x - i) + (t.center.y - n) * (t.center.y - n) <= t.halfWidth * t.halfWidth;
        },
        separateCircle: function(t, e, i) {
            this.getOverlapX(t, e), this.getOverlapY(t, e);
            var n = e.center.x - t.center.x, s = e.center.y - t.center.y, o = Math.atan2(s, n), a = 0;
            if (t.isCircle !== e.isCircle) {
                var r = {
                    x: e.isCircle ? t.position.x : e.position.x,
                    y: e.isCircle ? t.position.y : e.position.y,
                    right: e.isCircle ? t.right : e.right,
                    bottom: e.isCircle ? t.bottom : e.bottom
                }, h = {
                    x: t.isCircle ? t.center.x : e.center.x,
                    y: t.isCircle ? t.center.y : e.center.y,
                    radius: t.isCircle ? t.halfWidth : e.halfWidth
                };
                h.y < r.y ? h.x < r.x ? a = z.Math.distance(h.x, h.y, r.x, r.y) - h.radius : r.right < h.x && (a = z.Math.distance(h.x, h.y, r.right, r.y) - h.radius) : r.bottom < h.y && (h.x < r.x ? a = z.Math.distance(h.x, h.y, r.x, r.bottom) - h.radius : r.right < h.x && (a = z.Math.distance(h.x, h.y, r.right, r.bottom) - h.radius)), 
                a *= -1;
            } else a = t.halfWidth + e.halfWidth - z.Math.distance(t.center.x, t.center.y, e.center.x, e.center.y);
            if (i || 0 === a || t.immovable && e.immovable || t.customSeparateX || e.customSeparateX) return 0 !== a && (t.onOverlap && t.onOverlap.dispatch(t.sprite, e.sprite), 
            e.onOverlap && e.onOverlap.dispatch(e.sprite, t.sprite)), 0 !== a;
            var l = t.velocity.x * Math.cos(o) + t.velocity.y * Math.sin(o), c = -t.velocity.x * Math.sin(o) + t.velocity.y * Math.cos(o), u = e.velocity.x * Math.cos(o) + e.velocity.y * Math.sin(o), d = -e.velocity.x * Math.sin(o) + e.velocity.y * Math.cos(o), p = ((t.mass - e.mass) * l + 2 * e.mass * u) / (t.mass + e.mass), g = (2 * t.mass * l + (e.mass - t.mass) * u) / (t.mass + e.mass);
            return t.immovable || (t.velocity.x = (p * Math.cos(o) - c * Math.sin(o)) * t.bounce.x, 
            t.velocity.y = (c * Math.cos(o) + p * Math.sin(o)) * t.bounce.y), e.immovable || (e.velocity.x = (g * Math.cos(o) - d * Math.sin(o)) * e.bounce.x, 
            e.velocity.y = (d * Math.cos(o) + g * Math.sin(o)) * e.bounce.y), Math.abs(o) < Math.PI / 2 ? 0 < t.velocity.x && !t.immovable && e.velocity.x > t.velocity.x ? t.velocity.x *= -1 : e.velocity.x < 0 && !e.immovable && t.velocity.x < e.velocity.x ? e.velocity.x *= -1 : 0 < t.velocity.y && !t.immovable && e.velocity.y > t.velocity.y ? t.velocity.y *= -1 : e.velocity.y < 0 && !e.immovable && t.velocity.y < e.velocity.y && (e.velocity.y *= -1) : Math.abs(o) > Math.PI / 2 && (t.velocity.x < 0 && !t.immovable && e.velocity.x < t.velocity.x ? t.velocity.x *= -1 : 0 < e.velocity.x && !e.immovable && t.velocity.x > e.velocity.x ? e.velocity.x *= -1 : t.velocity.y < 0 && !t.immovable && e.velocity.y < t.velocity.y ? t.velocity.y *= -1 : 0 < e.velocity.y && !e.immovable && t.velocity.x > e.velocity.y && (e.velocity.y *= -1)), 
            t.immovable || (t.x += t.velocity.x * this.game.time.physicsElapsed - a * Math.cos(o), 
            t.y += t.velocity.y * this.game.time.physicsElapsed - a * Math.sin(o)), e.immovable || (e.x += e.velocity.x * this.game.time.physicsElapsed + a * Math.cos(o), 
            e.y += e.velocity.y * this.game.time.physicsElapsed + a * Math.sin(o)), t.onCollide && t.onCollide.dispatch(t.sprite, e.sprite), 
            e.onCollide && e.onCollide.dispatch(e.sprite, t.sprite), !0;
        },
        getOverlapX: function(t, e, i) {
            var n = 0, s = t.deltaAbsX() + e.deltaAbsX() + this.OVERLAP_BIAS;
            return 0 === t.deltaX() && 0 === e.deltaX() ? (t.embedded = !0, e.embedded = !0) : t.deltaX() > e.deltaX() ? s < (n = t.right - e.x) && !i || !1 === t.checkCollision.right || !1 === e.checkCollision.left ? n = 0 : (t.touching.none = !1, 
            t.touching.right = !0, e.touching.none = !1, e.touching.left = !0) : t.deltaX() < e.deltaX() && (s < -(n = t.x - e.width - e.x) && !i || !1 === t.checkCollision.left || !1 === e.checkCollision.right ? n = 0 : (t.touching.none = !1, 
            t.touching.left = !0, e.touching.none = !1, e.touching.right = !0)), t.overlapX = n, 
            e.overlapX = n;
        },
        getOverlapY: function(t, e, i) {
            var n = 0, s = t.deltaAbsY() + e.deltaAbsY() + this.OVERLAP_BIAS;
            return 0 === t.deltaY() && 0 === e.deltaY() ? (t.embedded = !0, e.embedded = !0) : t.deltaY() > e.deltaY() ? s < (n = t.bottom - e.y) && !i || !1 === t.checkCollision.down || !1 === e.checkCollision.up ? n = 0 : (t.touching.none = !1, 
            t.touching.down = !0, e.touching.none = !1, e.touching.up = !0) : t.deltaY() < e.deltaY() && (s < -(n = t.y - e.bottom) && !i || !1 === t.checkCollision.up || !1 === e.checkCollision.down ? n = 0 : (t.touching.none = !1, 
            t.touching.up = !0, e.touching.none = !1, e.touching.down = !0)), t.overlapY = n, 
            e.overlapY = n;
        },
        separateX: function(t, e, i) {
            var n = this.getOverlapX(t, e, i);
            if (i || 0 === n || t.immovable && e.immovable || t.customSeparateX || e.customSeparateX) return 0 !== n || t.embedded && e.embedded;
            var s = t.velocity.x, o = e.velocity.x;
            if (t.immovable || e.immovable) t.immovable ? (e.x += n, e.velocity.x = s - o * e.bounce.x, 
            t.moves && (e.y += (t.y - t.prev.y) * t.friction.y)) : (t.x -= n, t.velocity.x = o - s * t.bounce.x, 
            e.moves && (t.y += (e.y - e.prev.y) * e.friction.y)); else {
                n *= .5, t.x -= n, e.x += n;
                var a = Math.sqrt(o * o * e.mass / t.mass) * (0 < o ? 1 : -1), r = Math.sqrt(s * s * t.mass / e.mass) * (0 < s ? 1 : -1), h = .5 * (a + r);
                a -= h, r -= h, t.velocity.x = h + a * t.bounce.x, e.velocity.x = h + r * e.bounce.x;
            }
            return !0;
        },
        separateY: function(t, e, i) {
            var n = this.getOverlapY(t, e, i);
            if (i || 0 === n || t.immovable && e.immovable || t.customSeparateY || e.customSeparateY) return 0 !== n || t.embedded && e.embedded;
            var s = t.velocity.y, o = e.velocity.y;
            if (t.immovable || e.immovable) t.immovable ? (e.y += n, e.velocity.y = s - o * e.bounce.y, 
            t.moves && (e.x += (t.x - t.prev.x) * t.friction.x)) : (t.y -= n, t.velocity.y = o - s * t.bounce.y, 
            e.moves && (t.x += (e.x - e.prev.x) * e.friction.x)); else {
                n *= .5, t.y -= n, e.y += n;
                var a = Math.sqrt(o * o * e.mass / t.mass) * (0 < o ? 1 : -1), r = Math.sqrt(s * s * t.mass / e.mass) * (0 < s ? 1 : -1), h = .5 * (a + r);
                a -= h, r -= h, t.velocity.y = h + a * t.bounce.y, e.velocity.y = h + r * e.bounce.y;
            }
            return !0;
        },
        getObjectsUnderPointer: function(t, e, i, n) {
            if (0 !== e.length && t.exists) return this.getObjectsAtLocation(t.x, t.y, e, i, n, t);
        },
        getObjectsAtLocation: function(t, e, i, n, s, o) {
            this.quadTree.clear(), this.quadTree.reset(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, this.maxObjects, this.maxLevels), 
            this.quadTree.populate(i);
            for (var a = new z.Rectangle(t, e, 1, 1), r = [], h = this.quadTree.retrieve(a), l = 0; l < h.length; l++) h[l].hitTest(t, e) && (n && n.call(s, o, h[l].sprite), 
            r.push(h[l].sprite));
            return r;
        },
        moveToObject: function(t, e, i, n) {
            void 0 === i && (i = 60), void 0 === n && (n = 0);
            var s = z.Point.angle(e, t);
            return 0 < n && (i = this.distanceBetween(t, e) / (n / 1e3)), t.body.velocity.setToPolar(s, i), 
            s;
        },
        moveToPointer: function(t, e, i, n) {
            void 0 === e && (e = 60), i = i || this.game.input.activePointer, void 0 === n && (n = 0);
            var s = this.angleToPointer(t, i);
            return 0 < n && (e = this.distanceToPointer(t, i) / (n / 1e3)), t.body.velocity.setToPolar(s, e), 
            s;
        },
        moveToXY: function(t, e, i, n, s) {
            void 0 === n && (n = 60), void 0 === s && (s = 0);
            var o = Math.atan2(i - t.y, e - t.x);
            return 0 < s && (n = this.distanceToXY(t, e, i) / (s / 1e3)), t.body.velocity.setToPolar(o, n), 
            o;
        },
        velocityFromAngle: function(t, e, i) {
            return void 0 === e && (e = 60), (i = i || new z.Point()).setToPolar(t, e, !0);
        },
        velocityFromRotation: function(t, e, i) {
            return void 0 === e && (e = 60), (i = i || new z.Point()).setToPolar(t, e);
        },
        accelerationFromRotation: function(t, e, i) {
            return void 0 === e && (e = 60), (i = i || new z.Point()).setToPolar(t, e);
        },
        accelerateToObject: function(t, e, i, n, s) {
            void 0 === i && (i = 60), void 0 === n && (n = 1e3), void 0 === s && (s = 1e3);
            var o = this.angleBetween(t, e);
            return t.body.acceleration.setToPolar(o, i), t.body.maxVelocity.setTo(n, s), o;
        },
        accelerateToPointer: function(t, e, i, n, s) {
            void 0 === i && (i = 60), void 0 === e && (e = this.game.input.activePointer), void 0 === n && (n = 1e3), 
            void 0 === s && (s = 1e3);
            var o = this.angleToPointer(t, e);
            return t.body.acceleration.setToPolar(o, i), t.body.maxVelocity.setTo(n, s), o;
        },
        accelerateToXY: function(t, e, i, n, s, o) {
            void 0 === n && (n = 60), void 0 === s && (s = 1e3), void 0 === o && (o = 1e3);
            var a = this.angleToXY(t, e, i);
            return t.body.acceleration.setTo(a, n), t.body.maxVelocity.setTo(s, o), a;
        },
        distanceBetween: function(t, e, i, n) {
            var s, o;
            return void 0 === i && (i = !1), n ? (s = t.centerX - e.centerX, o = t.centerY - e.centerY) : i ? (s = t.world.x - e.world.x, 
            o = t.world.y - e.world.y) : (s = t.x - e.x, o = t.y - e.y), Math.sqrt(s * s + o * o);
        },
        distanceToXY: function(t, e, i, n) {
            void 0 === n && (n = !1);
            var s = n ? t.world.x - e : t.x - e, o = n ? t.world.y - i : t.y - i;
            return Math.sqrt(s * s + o * o);
        },
        distanceToPointer: function(t, e, i) {
            void 0 === e && (e = this.game.input.activePointer), void 0 === i && (i = !1);
            var n = i ? t.world.x - e.worldX : t.x - e.worldX, s = i ? t.world.y - e.worldY : t.y - e.worldY;
            return Math.sqrt(n * n + s * s);
        },
        closest: function(t, e, i, n) {
            for (var s = 1 / 0, o = null, a = 0, r = e.length; a < r; a++) {
                var h = e[a], l = this.distanceBetween(t, h, i, n);
                l < s && (o = h, s = l);
            }
            return o;
        },
        farthest: function(t, e, i, n) {
            for (var s = -1, o = null, a = 0, r = e.length; a < r; a++) {
                var h = e[a], l = this.distanceBetween(t, h, i, n);
                s < l && (o = h, s = l);
            }
            return o;
        },
        angleBetween: function(t, e, i) {
            return void 0 === i && (i = !1), i ? z.Point.angle(e.world, t.world) : z.Point.angle(e, t);
        },
        angleBetweenCenters: function(t, e) {
            var i = e.centerX - t.centerX, n = e.centerY - t.centerY;
            return Math.atan2(n, i);
        },
        angleToXY: function(t, e, i, n) {
            return void 0 === n && (n = !1), n ? Math.atan2(i - t.world.y, e - t.world.x) : Math.atan2(i - t.y, e - t.x);
        },
        angleToPointer: function(t, e, i) {
            return void 0 === e && (e = this.game.input.activePointer), void 0 === i && (i = !1), 
            i ? Math.atan2(e.worldY - t.world.y, e.worldX - t.world.x) : Math.atan2(e.worldY - t.y, e.worldX - t.x);
        },
        worldAngleToPointer: function(t, e) {
            return this.angleToPointer(t, e, !0);
        }
    }, z.Physics.Arcade.Body = function(t) {
        this.sprite = t, this.game = t.game, this.type = z.Physics.ARCADE, this.enable = !0, 
        this.isCircle = !1, this.radius = 0, this.offset = new z.Point(), this.position = new z.Point(t.x, t.y), 
        this.prev = new z.Point(this.position.x, this.position.y), this.allowRotation = !0, 
        this.rotation = t.angle, this.preRotation = t.angle, this.width = t.width, this.height = t.height, 
        this.sourceWidth = t.width, this.sourceHeight = t.height, t.texture && (this.sourceWidth = t.texture.frame.width, 
        this.sourceHeight = t.texture.frame.height), this.halfWidth = Math.abs(t.width / 2), 
        this.halfHeight = Math.abs(t.height / 2), this.center = new z.Point(t.x + this.halfWidth, t.y + this.halfHeight), 
        this.velocity = new z.Point(), this.newVelocity = new z.Point(), this.deltaMax = new z.Point(), 
        this.acceleration = new z.Point(), this.allowDrag = !0, this.drag = new z.Point(), 
        this.allowGravity = !0, this.gravity = new z.Point(), this.bounce = new z.Point(), 
        this.worldBounce = null, this.onWorldBounds = null, this.onCollide = null, this.onOverlap = null, 
        this.maxVelocity = new z.Point(1e4, 1e4), this.friction = new z.Point(1, 0), this.angularVelocity = 0, 
        this.angularAcceleration = 0, this.angularDrag = 0, this.maxAngular = 1e3, this.mass = 1, 
        this.angle = 0, this.speed = 0, this.facing = z.NONE, this.immovable = !1, this.moves = !0, 
        this.customSeparateX = !1, this.customSeparateY = !1, this.overlapX = 0, this.overlapY = 0, 
        this.overlapR = 0, this.embedded = !1, this.collideWorldBounds = !1, this.checkCollision = {
            none: !1,
            up: !0,
            down: !0,
            left: !0,
            right: !0
        }, this.touching = {
            none: !0,
            up: !1,
            down: !1,
            left: !1,
            right: !1
        }, this.wasTouching = {
            none: !0,
            up: !1,
            down: !1,
            left: !1,
            right: !1
        }, this.blocked = {
            none: !0,
            up: !1,
            down: !1,
            left: !1,
            right: !1
        }, this.tilePadding = new z.Point(), this.dirty = !1, this.skipQuadTree = !1, this.syncBounds = !1, 
        this.isMoving = !1, this.stopVelocityOnCollide = !0, this.moveTimer = 0, this.moveDistance = 0, 
        this.moveDuration = 0, this.moveTarget = null, this.moveEnd = null, this.onMoveComplete = new z.Signal(), 
        this.movementCallback = null, this.movementCallbackContext = null, this._reset = !0, 
        this._sx = t.scale.x, this._sy = t.scale.y, this._dx = 0, this._dy = 0;
    }, z.Physics.Arcade.Body.prototype = {
        updateBounds: function() {
            if (this.syncBounds) {
                var t = this.sprite.getBounds();
                t.ceilAll(), t.width === this.width && t.height === this.height || (this.width = t.width, 
                this.height = t.height, this._reset = !0);
            } else {
                var e = Math.abs(this.sprite.scale.x), i = Math.abs(this.sprite.scale.y);
                e === this._sx && i === this._sy || (this.width = this.sourceWidth * e, this.height = this.sourceHeight * i, 
                this._sx = e, this._sy = i, this._reset = !0);
            }
            this._reset && (this.halfWidth = Math.floor(this.width / 2), this.halfHeight = Math.floor(this.height / 2), 
            this.updateCenter());
        },
        updateCenter: function() {
            this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight);
        },
        preUpdate: function() {
            this.enable && !this.game.physics.arcade.isPaused && (this.dirty = !0, this.wasTouching.none = this.touching.none, 
            this.wasTouching.up = this.touching.up, this.wasTouching.down = this.touching.down, 
            this.wasTouching.left = this.touching.left, this.wasTouching.right = this.touching.right, 
            this.touching.none = !0, this.touching.up = !1, this.touching.down = !1, this.touching.left = !1, 
            this.touching.right = !1, this.blocked.none = !0, this.blocked.up = !1, this.blocked.down = !1, 
            this.blocked.left = !1, this.blocked.right = !1, this.overlapR = 0, this.overlapX = 0, 
            this.overlapY = 0, this.embedded = !1, this.updateBounds(), this.position.x = this.sprite.world.x - this.sprite.anchor.x * this.sprite.width + this.sprite.scale.x * this.offset.x, 
            this.position.x -= this.sprite.scale.x < 0 ? this.width : 0, this.position.y = this.sprite.world.y - this.sprite.anchor.y * this.sprite.height + this.sprite.scale.y * this.offset.y, 
            this.position.y -= this.sprite.scale.y < 0 ? this.height : 0, this.updateCenter(), 
            this.rotation = this.sprite.angle, this.preRotation = this.rotation, (this._reset || this.sprite.fresh) && (this.prev.x = this.position.x, 
            this.prev.y = this.position.y), this.moves && (this.game.physics.arcade.updateMotion(this), 
            this.newVelocity.set(this.velocity.x * this.game.time.physicsElapsed, this.velocity.y * this.game.time.physicsElapsed), 
            this.position.x += this.newVelocity.x, this.position.y += this.newVelocity.y, this.updateCenter(), 
            this.position.x === this.prev.x && this.position.y === this.prev.y || (this.angle = this.velocity.atan()), 
            this.speed = Math.sqrt(this.velocity.x * this.velocity.x + this.velocity.y * this.velocity.y), 
            this.collideWorldBounds && this.checkWorldBounds() && this.onWorldBounds && this.onWorldBounds.dispatch(this.sprite, this.blocked.up, this.blocked.down, this.blocked.left, this.blocked.right)), 
            this._dx = this.deltaX(), this._dy = this.deltaY(), this._reset = !1);
        },
        updateMovement: function() {
            var t = 0, e = 0 !== this.overlapX || 0 !== this.overlapY;
            if (0 < this.moveDuration ? (this.moveTimer += this.game.time.elapsedMS, t = this.moveTimer / this.moveDuration) : (this.moveTarget.end.set(this.position.x, this.position.y), 
            t = this.moveTarget.length / this.moveDistance), this.movementCallback) var i = this.movementCallback.call(this.movementCallbackContext, this, this.velocity, t);
            return !(e || 1 <= t || void 0 !== i && !0 !== i) || (this.stopMovement(1 <= t || this.stopVelocityOnCollide && e), 
            !1);
        },
        stopMovement: function(t) {
            this.isMoving && (this.isMoving = !1, t && this.velocity.set(0), this.onMoveComplete.dispatch(this.sprite, 0 !== this.overlapX || 0 !== this.overlapY));
        },
        postUpdate: function() {
            this.enable && this.dirty && (this.isMoving && this.updateMovement(), this.dirty = !1, 
            this.deltaX() < 0 ? this.facing = z.LEFT : 0 < this.deltaX() && (this.facing = z.RIGHT), 
            this.deltaY() < 0 ? this.facing = z.UP : 0 < this.deltaY() && (this.facing = z.DOWN), 
            this.moves && (this._dx = this.deltaX(), this._dy = this.deltaY(), 0 !== this.deltaMax.x && 0 !== this._dx && (this._dx < 0 && this._dx < -this.deltaMax.x ? this._dx = -this.deltaMax.x : 0 < this._dx && this._dx > this.deltaMax.x && (this._dx = this.deltaMax.x)), 
            0 !== this.deltaMax.y && 0 !== this._dy && (this._dy < 0 && this._dy < -this.deltaMax.y ? this._dy = -this.deltaMax.y : 0 < this._dy && this._dy > this.deltaMax.y && (this._dy = this.deltaMax.y)), 
            this.sprite.position.x += this._dx, this.sprite.position.y += this._dy, this._reset = !0), 
            this.updateCenter(), this.allowRotation && (this.sprite.angle += this.deltaZ()), 
            this.prev.x = this.position.x, this.prev.y = this.position.y);
        },
        checkWorldBounds: function() {
            var t = this.position, e = this.game.physics.arcade.bounds, i = this.game.physics.arcade.checkCollision, n = this.worldBounce ? -this.worldBounce.x : -this.bounce.x, s = this.worldBounce ? -this.worldBounce.y : -this.bounce.y;
            return t.x < e.x && i.left ? (t.x = e.x, this.velocity.x *= n, this.blocked.left = !0, 
            this.blocked.none = !1) : this.right > e.right && i.right && (t.x = e.right - this.width, 
            this.velocity.x *= n, this.blocked.right = !0, this.blocked.none = !1), t.y < e.y && i.up ? (t.y = e.y, 
            this.velocity.y *= s, this.blocked.up = !0, this.blocked.none = !1) : this.bottom > e.bottom && i.down && (t.y = e.bottom - this.height, 
            this.velocity.y *= s, this.blocked.down = !0, this.blocked.none = !1), !this.blocked.none;
        },
        moveFrom: function(t, e, i) {
            return void 0 === e && (e = this.speed), 0 !== e && (void 0 === i ? (n = this.angle, 
            i = this.game.math.radToDeg(n)) : n = this.game.math.degToRad(i), this.moveTimer = 0, 
            this.moveDuration = t, 0 === i || 180 === i ? this.velocity.set(Math.cos(n) * e, 0) : 90 === i || 270 === i ? this.velocity.set(0, Math.sin(n) * e) : this.velocity.setToPolar(n, e), 
            this.isMoving = !0);
            var n;
        },
        moveTo: function(t, e, i) {
            var n, s = e / (t / 1e3);
            return 0 !== s && (void 0 === i ? (n = this.angle, i = this.game.math.radToDeg(n)) : n = this.game.math.degToRad(i), 
            e = Math.abs(e), this.moveDuration = 0, this.moveDistance = e, null === this.moveTarget && (this.moveTarget = new z.Line(), 
            this.moveEnd = new z.Point()), this.moveTarget.fromAngle(this.x, this.y, n, e), 
            this.moveEnd.set(this.moveTarget.end.x, this.moveTarget.end.y), this.moveTarget.setTo(this.x, this.y, this.x, this.y), 
            0 === i || 180 === i ? this.velocity.set(Math.cos(n) * s, 0) : 90 === i || 270 === i ? this.velocity.set(0, Math.sin(n) * s) : this.velocity.setToPolar(n, s), 
            this.isMoving = !0);
        },
        setSize: function(t, e, i, n) {
            void 0 === i && (i = this.offset.x), void 0 === n && (n = this.offset.y), this.sourceWidth = t, 
            this.sourceHeight = e, this.width = this.sourceWidth * this._sx, this.height = this.sourceHeight * this._sy, 
            this.halfWidth = Math.floor(this.width / 2), this.halfHeight = Math.floor(this.height / 2), 
            this.offset.setTo(i, n), this.updateCenter(), this.isCircle = !1, this.radius = 0;
        },
        setCircle: function(t, e, i) {
            void 0 === e && (e = this.offset.x), void 0 === i && (i = this.offset.y), 0 < t ? (this.isCircle = !0, 
            this.radius = t, this.sourceWidth = 2 * t, this.sourceHeight = 2 * t, this.width = this.sourceWidth * this._sx, 
            this.height = this.sourceHeight * this._sy, this.halfWidth = Math.floor(this.width / 2), 
            this.halfHeight = Math.floor(this.height / 2), this.offset.setTo(e, i), this.updateCenter()) : this.isCircle = !1;
        },
        reset: function(t, e) {
            this.stop(), this.position.x = t - this.sprite.anchor.x * this.sprite.width + this.sprite.scale.x * this.offset.x, 
            this.position.x -= this.sprite.scale.x < 0 ? this.width : 0, this.position.y = e - this.sprite.anchor.y * this.sprite.height + this.sprite.scale.y * this.offset.y, 
            this.position.y -= this.sprite.scale.y < 0 ? this.height : 0, this.prev.x = this.position.x, 
            this.prev.y = this.position.y, this.rotation = this.sprite.angle, this.preRotation = this.rotation, 
            this.updateBounds(), this.updateCenter();
        },
        stop: function() {
            this.velocity.set(0), this.acceleration.set(0), this.speed = 0, this.angularVelocity = 0, 
            this.angularAcceleration = 0;
        },
        getBounds: function(t) {
            return t.x = this.x, t.y = this.y, t.right = this.right, t.bottom = this.bottom, 
            t;
        },
        hitTest: function(t, e) {
            return this.isCircle ? z.Circle.contains(this, t, e) : z.Rectangle.contains(this, t, e);
        },
        onFloor: function() {
            return this.blocked.down;
        },
        onCeiling: function() {
            return this.blocked.up;
        },
        onWall: function() {
            return this.blocked.left || this.blocked.right;
        },
        deltaAbsX: function() {
            return 0 < this.deltaX() ? this.deltaX() : -this.deltaX();
        },
        deltaAbsY: function() {
            return 0 < this.deltaY() ? this.deltaY() : -this.deltaY();
        },
        deltaX: function() {
            return this.position.x - this.prev.x;
        },
        deltaY: function() {
            return this.position.y - this.prev.y;
        },
        deltaZ: function() {
            return this.rotation - this.preRotation;
        },
        destroy: function() {
            this.sprite.parent && this.sprite.parent instanceof z.Group && this.sprite.parent.removeFromHash(this.sprite), 
            this.sprite.body = null, this.sprite = null;
        }
    }, Object.defineProperty(z.Physics.Arcade.Body.prototype, "left", {
        get: function() {
            return this.position.x;
        }
    }), Object.defineProperty(z.Physics.Arcade.Body.prototype, "right", {
        get: function() {
            return this.position.x + this.width;
        }
    }), Object.defineProperty(z.Physics.Arcade.Body.prototype, "top", {
        get: function() {
            return this.position.y;
        }
    }), Object.defineProperty(z.Physics.Arcade.Body.prototype, "bottom", {
        get: function() {
            return this.position.y + this.height;
        }
    }), Object.defineProperty(z.Physics.Arcade.Body.prototype, "x", {
        get: function() {
            return this.position.x;
        },
        set: function(t) {
            this.position.x = t;
        }
    }), Object.defineProperty(z.Physics.Arcade.Body.prototype, "y", {
        get: function() {
            return this.position.y;
        },
        set: function(t) {
            this.position.y = t;
        }
    }), z.Physics.Arcade.Body.render = function(t, e, i, n, s) {
        void 0 === n && (n = !0), i = i || "rgba(0,255,0,0.4)", t.fillStyle = i, t.strokeStyle = i, 
        t.lineWidth = s || 1, e.isCircle ? (t.beginPath(), t.arc(e.center.x - e.game.camera.x, e.center.y - e.game.camera.y, e.halfWidth, 0, 2 * Math.PI), 
        n ? t.fill() : t.stroke()) : n ? t.fillRect(e.position.x - e.game.camera.x, e.position.y - e.game.camera.y, e.width, e.height) : t.strokeRect(e.position.x - e.game.camera.x, e.position.y - e.game.camera.y, e.width, e.height);
    }, z.Physics.Arcade.Body.renderBodyInfo = function(t, e) {
        t.line("x: " + e.x.toFixed(2), "y: " + e.y.toFixed(2), "width: " + e.width, "height: " + e.height), 
        t.line("velocity x: " + e.velocity.x.toFixed(2), "y: " + e.velocity.y.toFixed(2), "deltaX: " + e._dx.toFixed(2), "deltaY: " + e._dy.toFixed(2)), 
        t.line("acceleration x: " + e.acceleration.x.toFixed(2), "y: " + e.acceleration.y.toFixed(2), "speed: " + e.speed.toFixed(2), "angle: " + e.angle.toFixed(2)), 
        t.line("gravity x: " + e.gravity.x, "y: " + e.gravity.y, "bounce x: " + e.bounce.x.toFixed(2), "y: " + e.bounce.y.toFixed(2)), 
        t.line("touching left: " + e.touching.left, "right: " + e.touching.right, "up: " + e.touching.up, "down: " + e.touching.down), 
        t.line("blocked left: " + e.blocked.left, "right: " + e.blocked.right, "up: " + e.blocked.up, "down: " + e.blocked.down);
    }, z.Physics.Arcade.Body.prototype.constructor = z.Physics.Arcade.Body, z.Physics.Arcade.TilemapCollision = function() {}, 
    z.Physics.Arcade.TilemapCollision.prototype = {
        TILE_BIAS: 16,
        collideSpriteVsTilemapLayer: function(t, e, i, n, s, o) {
            if (t.body) {
                var a = e.getTiles(t.body.position.x - t.body.tilePadding.x - e.getTileOffsetX(), t.body.position.y - t.body.tilePadding.y - e.getTileOffsetY(), t.body.width + t.body.tilePadding.x, t.body.height + t.body.tilePadding.y, !1, !1);
                if (0 !== a.length) for (var r = 0; r < a.length; r++) n ? n.call(s, t, a[r]) && this.separateTile(r, t.body, a[r], e, o) && (this._total++, 
                i && i.call(s, t, a[r])) : this.separateTile(r, t.body, a[r], e, o) && (this._total++, 
                i && i.call(s, t, a[r]));
            }
        },
        collideGroupVsTilemapLayer: function(t, e, i, n, s, o) {
            if (0 !== t.length) for (var a = 0; a < t.children.length; a++) t.children[a].exists && this.collideSpriteVsTilemapLayer(t.children[a], e, i, n, s, o);
        },
        separateTile: function(t, e, i, n, s) {
            if (!e.enable) return !1;
            var o = n.getTileOffsetX(), a = n.getTileOffsetY();
            if (!i.intersects(e.position.x - o, e.position.y - a, e.right - o, e.bottom - a)) return !1;
            if (s) return !0;
            if (i.collisionCallback && !i.collisionCallback.call(i.collisionCallbackContext, e.sprite, i)) return !1;
            if (void 0 !== i.layer.callbacks && i.layer.callbacks[i.index] && !i.layer.callbacks[i.index].callback.call(i.layer.callbacks[i.index].callbackContext, e.sprite, i)) return !1;
            if (!(i.faceLeft || i.faceRight || i.faceTop || i.faceBottom)) return !1;
            var r = 0, h = 0, l = 0, c = 1;
            if (e.deltaAbsX() > e.deltaAbsY() ? l = -1 : e.deltaAbsX() < e.deltaAbsY() && (c = -1), 
            0 !== e.deltaX() && 0 !== e.deltaY() && (i.faceLeft || i.faceRight) && (i.faceTop || i.faceBottom) && (l = Math.min(Math.abs(e.position.x - o - i.right), Math.abs(e.right - o - i.left)), 
            c = Math.min(Math.abs(e.position.y - a - i.bottom), Math.abs(e.bottom - a - i.top))), 
            l < c) {
                if ((i.faceLeft || i.faceRight) && 0 !== (r = this.tileCheckX(e, i, n)) && !i.intersects(e.position.x - o, e.position.y - a, e.right - o, e.bottom - a)) return !0;
                (i.faceTop || i.faceBottom) && (h = this.tileCheckY(e, i, n));
            } else {
                if ((i.faceTop || i.faceBottom) && 0 !== (h = this.tileCheckY(e, i, n)) && !i.intersects(e.position.x - o, e.position.y - a, e.right - o, e.bottom - a)) return !0;
                (i.faceLeft || i.faceRight) && (r = this.tileCheckX(e, i, n));
            }
            return 0 !== r || 0 !== h;
        },
        tileCheckX: function(t, e, i) {
            var n = 0, s = i.getTileOffsetX();
            return t.deltaX() < 0 && !t.blocked.left && e.collideRight && t.checkCollision.left ? e.faceRight && t.x - s < e.right && (n = t.x - s - e.right) < -this.TILE_BIAS && (n = 0) : 0 < t.deltaX() && !t.blocked.right && e.collideLeft && t.checkCollision.right && e.faceLeft && t.right - s > e.left && (n = t.right - s - e.left) > this.TILE_BIAS && (n = 0), 
            0 !== n && (t.customSeparateX ? t.overlapX = n : this.processTileSeparationX(t, n)), 
            n;
        },
        tileCheckY: function(t, e, i) {
            var n = 0, s = i.getTileOffsetY();
            return t.deltaY() < 0 && !t.blocked.up && e.collideDown && t.checkCollision.up ? e.faceBottom && t.y - s < e.bottom && (n = t.y - s - e.bottom) < -this.TILE_BIAS && (n = 0) : 0 < t.deltaY() && !t.blocked.down && e.collideUp && t.checkCollision.down && e.faceTop && t.bottom - s > e.top && (n = t.bottom - s - e.top) > this.TILE_BIAS && (n = 0), 
            0 !== n && (t.customSeparateY ? t.overlapY = n : this.processTileSeparationY(t, n)), 
            n;
        },
        processTileSeparationX: function(t, e) {
            e < 0 ? (t.blocked.left = !0, t.blocked.none = !1) : 0 < e && (t.blocked.right = !0, 
            t.blocked.none = !1), t.position.x -= e, 0 === t.bounce.x ? t.velocity.x = 0 : t.velocity.x = -t.velocity.x * t.bounce.x;
        },
        processTileSeparationY: function(t, e) {
            e < 0 ? (t.blocked.up = !0, t.blocked.none = !1) : 0 < e && (t.blocked.down = !0, 
            t.blocked.none = !1), t.position.y -= e, 0 === t.bounce.y ? t.velocity.y = 0 : t.velocity.y = -t.velocity.y * t.bounce.y;
        }
    }, z.Utils.mixinPrototype(z.Physics.Arcade.prototype, z.Physics.Arcade.TilemapCollision.prototype), 
    p2.Body.prototype.parent = null, p2.Spring.prototype.parent = null, z.Physics.P2 = function(t, e) {
        this.game = t, void 0 === e ? e = {
            gravity: [ 0, 0 ],
            broadphase: new p2.SAPBroadphase()
        } : (e.hasOwnProperty("gravity") || (e.gravity = [ 0, 0 ]), e.hasOwnProperty("broadphase") || (e.broadphase = new p2.SAPBroadphase())), 
        this.config = e, this.world = new p2.World(this.config), this.frameRate = 1 / 60, 
        this.useElapsedTime = !1, this.paused = !1, this.materials = [], this.gravity = new z.Physics.P2.InversePointProxy(this, this.world.gravity), 
        this.walls = {
            left: null,
            right: null,
            top: null,
            bottom: null
        }, this.onBodyAdded = new z.Signal(), this.onBodyRemoved = new z.Signal(), this.onSpringAdded = new z.Signal(), 
        this.onSpringRemoved = new z.Signal(), this.onConstraintAdded = new z.Signal(), 
        this.onConstraintRemoved = new z.Signal(), this.onContactMaterialAdded = new z.Signal(), 
        this.onContactMaterialRemoved = new z.Signal(), this.postBroadphaseCallback = null, 
        this.callbackContext = null, this.onBeginContact = new z.Signal(), this.onEndContact = new z.Signal(), 
        e.hasOwnProperty("mpx") && e.hasOwnProperty("pxm") && e.hasOwnProperty("mpxi") && e.hasOwnProperty("pxmi") && (this.mpx = e.mpx, 
        this.mpxi = e.mpxi, this.pxm = e.pxm, this.pxmi = e.pxmi), this.world.on("beginContact", this.beginContactHandler, this), 
        this.world.on("endContact", this.endContactHandler, this), this.collisionGroups = [], 
        this.nothingCollisionGroup = new z.Physics.P2.CollisionGroup(1), this.boundsCollisionGroup = new z.Physics.P2.CollisionGroup(2), 
        this.everythingCollisionGroup = new z.Physics.P2.CollisionGroup(2147483648), this.boundsCollidesWith = [], 
        this._toRemove = [], this._collisionGroupID = 2, this._boundsLeft = !0, this._boundsRight = !0, 
        this._boundsTop = !0, this._boundsBottom = !0, this._boundsOwnGroup = !1, this.setBoundsToWorld(!0, !0, !0, !0, !1);
    }, z.Physics.P2.prototype = {
        removeBodyNextStep: function(t) {
            this._toRemove.push(t);
        },
        preUpdate: function() {
            for (var t = this._toRemove.length; t--; ) this.removeBody(this._toRemove[t]);
            this._toRemove.length = 0;
        },
        enable: function(t, e, i) {
            void 0 === e && (e = !1), void 0 === i && (i = !0);
            var n = 1;
            if (Array.isArray(t)) for (n = t.length; n--; ) t[n] instanceof z.Group ? this.enable(t[n].children, e, i) : (this.enableBody(t[n], e), 
            i && t[n].hasOwnProperty("children") && 0 < t[n].children.length && this.enable(t[n], e, !0)); else t instanceof z.Group ? this.enable(t.children, e, i) : (this.enableBody(t, e), 
            i && t.hasOwnProperty("children") && 0 < t.children.length && this.enable(t.children, e, !0));
        },
        enableBody: function(t, e) {
            t.hasOwnProperty("body") && null === t.body && (t.body = new z.Physics.P2.Body(this.game, t, t.x, t.y, 1), 
            t.body.debug = e, void 0 !== t.anchor && t.anchor.set(.5));
        },
        setImpactEvents: function(t) {
            t ? this.world.on("impact", this.impactHandler, this) : this.world.off("impact", this.impactHandler, this);
        },
        setPostBroadphaseCallback: function(t, e) {
            this.postBroadphaseCallback = t, this.callbackContext = e, null !== t ? this.world.on("postBroadphase", this.postBroadphaseHandler, this) : this.world.off("postBroadphase", this.postBroadphaseHandler, this);
        },
        postBroadphaseHandler: function(t) {
            if (this.postBroadphaseCallback && 0 !== t.pairs.length) for (var e = t.pairs.length - 2; 0 <= e; e -= 2) t.pairs[e].parent && t.pairs[e + 1].parent && !this.postBroadphaseCallback.call(this.callbackContext, t.pairs[e].parent, t.pairs[e + 1].parent) && t.pairs.splice(e, 2);
        },
        impactHandler: function(t) {
            if (t.bodyA.parent && t.bodyB.parent) {
                var e = t.bodyA.parent, i = t.bodyB.parent;
                e._bodyCallbacks[t.bodyB.id] && e._bodyCallbacks[t.bodyB.id].call(e._bodyCallbackContext[t.bodyB.id], e, i, t.shapeA, t.shapeB), 
                i._bodyCallbacks[t.bodyA.id] && i._bodyCallbacks[t.bodyA.id].call(i._bodyCallbackContext[t.bodyA.id], i, e, t.shapeB, t.shapeA), 
                e._groupCallbacks[t.shapeB.collisionGroup] && e._groupCallbacks[t.shapeB.collisionGroup].call(e._groupCallbackContext[t.shapeB.collisionGroup], e, i, t.shapeA, t.shapeB), 
                i._groupCallbacks[t.shapeA.collisionGroup] && i._groupCallbacks[t.shapeA.collisionGroup].call(i._groupCallbackContext[t.shapeA.collisionGroup], i, e, t.shapeB, t.shapeA);
            }
        },
        beginContactHandler: function(t) {
            t.bodyA && t.bodyB && (this.onBeginContact.dispatch(t.bodyA, t.bodyB, t.shapeA, t.shapeB, t.contactEquations), 
            t.bodyA.parent && t.bodyA.parent.onBeginContact.dispatch(t.bodyB.parent, t.bodyB, t.shapeA, t.shapeB, t.contactEquations), 
            t.bodyB.parent && t.bodyB.parent.onBeginContact.dispatch(t.bodyA.parent, t.bodyA, t.shapeB, t.shapeA, t.contactEquations));
        },
        endContactHandler: function(t) {
            t.bodyA && t.bodyB && (this.onEndContact.dispatch(t.bodyA, t.bodyB, t.shapeA, t.shapeB), 
            t.bodyA.parent && t.bodyA.parent.onEndContact.dispatch(t.bodyB.parent, t.bodyB, t.shapeA, t.shapeB), 
            t.bodyB.parent && t.bodyB.parent.onEndContact.dispatch(t.bodyA.parent, t.bodyA, t.shapeB, t.shapeA));
        },
        setBoundsToWorld: function(t, e, i, n, s) {
            this.setBounds(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, t, e, i, n, s);
        },
        setWorldMaterial: function(t, e, i, n, s) {
            void 0 === e && (e = !0), void 0 === i && (i = !0), void 0 === n && (n = !0), void 0 === s && (s = !0), 
            e && this.walls.left && (this.walls.left.shapes[0].material = t), i && this.walls.right && (this.walls.right.shapes[0].material = t), 
            n && this.walls.top && (this.walls.top.shapes[0].material = t), s && this.walls.bottom && (this.walls.bottom.shapes[0].material = t);
        },
        updateBoundsCollisionGroup: function(t) {
            void 0 === t && (t = !0);
            var e = t ? this.boundsCollisionGroup.mask : this.everythingCollisionGroup.mask;
            this.walls.left && (this.walls.left.shapes[0].collisionGroup = e), this.walls.right && (this.walls.right.shapes[0].collisionGroup = e), 
            this.walls.top && (this.walls.top.shapes[0].collisionGroup = e), this.walls.bottom && (this.walls.bottom.shapes[0].collisionGroup = e), 
            this._boundsOwnGroup = t;
        },
        setBounds: function(t, e, i, n, s, o, a, r, h) {
            void 0 === s && (s = this._boundsLeft), void 0 === o && (o = this._boundsRight), 
            void 0 === a && (a = this._boundsTop), void 0 === r && (r = this._boundsBottom), 
            void 0 === h && (h = this._boundsOwnGroup), this.setupWall(s, "left", t, e, 1.5707963267948966, h), 
            this.setupWall(o, "right", t + i, e, -1.5707963267948966, h), this.setupWall(a, "top", t, e, -3.141592653589793, h), 
            this.setupWall(r, "bottom", t, e + n, 0, h), this._boundsLeft = s, this._boundsRight = o, 
            this._boundsTop = a, this._boundsBottom = r, this._boundsOwnGroup = h;
        },
        setupWall: function(t, e, i, n, s, o) {
            t ? (this.walls[e] ? this.walls[e].position = [ this.pxmi(i), this.pxmi(n) ] : (this.walls[e] = new p2.Body({
                mass: 0,
                position: [ this.pxmi(i), this.pxmi(n) ],
                angle: s
            }), this.walls[e].addShape(new p2.Plane()), this.world.addBody(this.walls[e])), 
            o && (this.walls[e].shapes[0].collisionGroup = this.boundsCollisionGroup.mask)) : this.walls[e] && (this.world.removeBody(this.walls[e]), 
            this.walls[e] = null);
        },
        pause: function() {
            this.paused = !0;
        },
        resume: function() {
            this.paused = !1;
        },
        update: function() {
            this.paused || (this.useElapsedTime ? this.world.step(this.game.time.physicsElapsed) : this.world.step(this.frameRate));
        },
        reset: function() {
            this.world.on("beginContact", this.beginContactHandler, this), this.world.on("endContact", this.endContactHandler, this), 
            this.nothingCollisionGroup = new z.Physics.P2.CollisionGroup(1), this.boundsCollisionGroup = new z.Physics.P2.CollisionGroup(2), 
            this.everythingCollisionGroup = new z.Physics.P2.CollisionGroup(2147483648), this._collisionGroupID = 2, 
            this.setBoundsToWorld(!0, !0, !0, !0, !1);
        },
        clear: function() {
            this.world.time = 0, this.world.fixedStepTime = 0, this.world.solver && this.world.solver.equations.length && this.world.solver.removeAllEquations();
            for (var t = this.world.constraints, e = t.length - 1; 0 <= e; e--) this.world.removeConstraint(t[e]);
            var i = this.world.bodies;
            for (e = i.length - 1; 0 <= e; e--) this.world.removeBody(i[e]);
            var n = this.world.springs;
            for (e = n.length - 1; 0 <= e; e--) this.world.removeSpring(n[e]);
            var s = this.world.contactMaterials;
            for (e = s.length - 1; 0 <= e; e--) this.world.removeContactMaterial(s[e]);
            this.world.off("beginContact", this.beginContactHandler, this), this.world.off("endContact", this.endContactHandler, this), 
            this.postBroadphaseCallback = null, this.callbackContext = null, this.impactCallback = null, 
            this.collisionGroups = [], this._toRemove = [], this.boundsCollidesWith = [], this.walls = {
                left: null,
                right: null,
                top: null,
                bottom: null
            };
        },
        destroy: function() {
            this.clear(), this.game = null;
        },
        addBody: function(t) {
            return !t.data.world && (this.world.addBody(t.data), this.onBodyAdded.dispatch(t), 
            !0);
        },
        removeBody: function(t) {
            return t.data.world === this.world && (this.world.removeBody(t.data), this.onBodyRemoved.dispatch(t)), 
            t;
        },
        addSpring: function(t) {
            return t instanceof z.Physics.P2.Spring || t instanceof z.Physics.P2.RotationalSpring ? this.world.addSpring(t.data) : this.world.addSpring(t), 
            this.onSpringAdded.dispatch(t), t;
        },
        removeSpring: function(t) {
            return t instanceof z.Physics.P2.Spring || t instanceof z.Physics.P2.RotationalSpring ? this.world.removeSpring(t.data) : this.world.removeSpring(t), 
            this.onSpringRemoved.dispatch(t), t;
        },
        createDistanceConstraint: function(t, e, i, n, s, o) {
            if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addConstraint(new z.Physics.P2.DistanceConstraint(this, t, e, i, n, s, o));
        },
        createGearConstraint: function(t, e, i, n) {
            if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addConstraint(new z.Physics.P2.GearConstraint(this, t, e, i, n));
        },
        createRevoluteConstraint: function(t, e, i, n, s, o) {
            if (t = this.getBody(t), i = this.getBody(i), t && i) return this.addConstraint(new z.Physics.P2.RevoluteConstraint(this, t, e, i, n, s, o));
        },
        createLockConstraint: function(t, e, i, n, s) {
            if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addConstraint(new z.Physics.P2.LockConstraint(this, t, e, i, n, s));
        },
        createPrismaticConstraint: function(t, e, i, n, s, o, a) {
            if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addConstraint(new z.Physics.P2.PrismaticConstraint(this, t, e, i, n, s, o, a));
        },
        addConstraint: function(t) {
            return this.world.addConstraint(t), this.onConstraintAdded.dispatch(t), t;
        },
        removeConstraint: function(t) {
            return this.world.removeConstraint(t), this.onConstraintRemoved.dispatch(t), t;
        },
        addContactMaterial: function(t) {
            return this.world.addContactMaterial(t), this.onContactMaterialAdded.dispatch(t), 
            t;
        },
        removeContactMaterial: function(t) {
            return this.world.removeContactMaterial(t), this.onContactMaterialRemoved.dispatch(t), 
            t;
        },
        getContactMaterial: function(t, e) {
            return this.world.getContactMaterial(t, e);
        },
        setMaterial: function(t, e) {
            for (var i = e.length; i--; ) e[i].setMaterial(t);
        },
        createMaterial: function(t, e) {
            t = t || "";
            var i = new z.Physics.P2.Material(t);
            return this.materials.push(i), void 0 !== e && e.setMaterial(i), i;
        },
        createContactMaterial: function(t, e, i) {
            void 0 === t && (t = this.createMaterial()), void 0 === e && (e = this.createMaterial());
            var n = new z.Physics.P2.ContactMaterial(t, e, i);
            return this.addContactMaterial(n);
        },
        getBodies: function() {
            for (var t = [], e = this.world.bodies.length; e--; ) t.push(this.world.bodies[e].parent);
            return t;
        },
        getBody: function(t) {
            return t instanceof p2.Body ? t : t instanceof z.Physics.P2.Body ? t.data : t.body && t.body.type === z.Physics.P2JS ? t.body.data : null;
        },
        getSprings: function() {
            for (var t = [], e = this.world.springs.length; e--; ) t.push(this.world.springs[e].parent);
            return t;
        },
        getConstraints: function() {
            for (var t = [], e = this.world.constraints.length; e--; ) t.push(this.world.constraints[e]);
            return t;
        },
        hitTest: function(t, e, i, n) {
            void 0 === e && (e = this.world.bodies), void 0 === i && (i = 5), void 0 === n && (n = !1);
            for (var s = [ this.pxmi(t.x), this.pxmi(t.y) ], o = [], a = e.length; a--; ) e[a] instanceof z.Physics.P2.Body && (!n || e[a].data.type !== p2.Body.STATIC) ? o.push(e[a].data) : e[a] instanceof p2.Body && e[a].parent && (!n || e[a].type !== p2.Body.STATIC) ? o.push(e[a]) : e[a] instanceof z.Sprite && e[a].hasOwnProperty("body") && (!n || e[a].body.data.type !== p2.Body.STATIC) && o.push(e[a].body.data);
            return this.world.hitTest(s, o, i);
        },
        toJSON: function() {
            return this.world.toJSON();
        },
        createCollisionGroup: function(t) {
            var e = Math.pow(2, this._collisionGroupID);
            this.walls.left && (this.walls.left.shapes[0].collisionMask = this.walls.left.shapes[0].collisionMask | e), 
            this.walls.right && (this.walls.right.shapes[0].collisionMask = this.walls.right.shapes[0].collisionMask | e), 
            this.walls.top && (this.walls.top.shapes[0].collisionMask = this.walls.top.shapes[0].collisionMask | e), 
            this.walls.bottom && (this.walls.bottom.shapes[0].collisionMask = this.walls.bottom.shapes[0].collisionMask | e), 
            this._collisionGroupID++;
            var i = new z.Physics.P2.CollisionGroup(e);
            return this.collisionGroups.push(i), t && this.setCollisionGroup(t, i), i;
        },
        setCollisionGroup: function(t, e) {
            if (t instanceof z.Group) for (var i = 0; i < t.total; i++) t.children[i].body && t.children[i].body.type === z.Physics.P2JS && t.children[i].body.setCollisionGroup(e); else t.body.setCollisionGroup(e);
        },
        createSpring: function(t, e, i, n, s, o, a, r, h) {
            if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addSpring(new z.Physics.P2.Spring(this, t, e, i, n, s, o, a, r, h));
        },
        createRotationalSpring: function(t, e, i, n, s) {
            if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addSpring(new z.Physics.P2.RotationalSpring(this, t, e, i, n, s));
        },
        createBody: function(t, e, i, n, s, o) {
            void 0 === n && (n = !1);
            var a = new z.Physics.P2.Body(this.game, null, t, e, i);
            if (o && !a.addPolygon(s, o)) return !1;
            return n && this.world.addBody(a.data), a;
        },
        createParticle: function(t, e, i, n, s, o) {
            void 0 === n && (n = !1);
            var a = new z.Physics.P2.Body(this.game, null, t, e, i);
            if (o && !a.addPolygon(s, o)) return !1;
            return n && this.world.addBody(a.data), a;
        },
        convertCollisionObjects: function(t, e, i) {
            void 0 === i && (i = !0);
            for (var n = [], s = 0, o = t.collision[e].length; s < o; s++) {
                var a = t.collision[e][s], r = a.polyline || a.polygon;
                if (r) var h = this.createBody(a.x, a.y, 0, i, {}, r); else if (a.rectangle) {
                    (h = this.createBody(a.x, a.y, 0, i)).addRectangle(a.width, a.height, a.width / 2, a.height / 2);
                }
                h && n.push(h);
            }
            return n;
        },
        clearTilemapLayerBodies: function(t, e) {
            e = t.getLayer(e);
            for (var i = t.layers[e].bodies.length; i--; ) t.layers[e].bodies[i].destroy();
            t.layers[e].bodies.length = 0;
        },
        convertTilemap: function(t, e, i, n) {
            e = t.getLayer(e), void 0 === i && (i = !0), void 0 === n && (n = !0), this.clearTilemapLayerBodies(t, e);
            for (var s = 0, o = 0, a = 0, r = 0, h = t.layers[e].height; r < h; r++) for (var l = s = 0, c = t.layers[e].width; l < c; l++) {
                var u = t.layers[e].data[r][l];
                if (u && -1 < u.index && u.collides) if (n) {
                    var d = t.getTileRight(e, l, r);
                    if (0 === s && (o = u.x * u.width, a = u.y * u.height, s = u.width), d && d.collides) s += u.width; else (p = this.createBody(o, a, 0, !1)).addRectangle(s, u.height, s / 2, u.height / 2, 0), 
                    i && this.addBody(p), t.layers[e].bodies.push(p), s = 0;
                } else {
                    var p;
                    (p = this.createBody(u.x * u.width, u.y * u.height, 0, !1)).addRectangle(u.width, u.height, u.width / 2, u.height / 2, 0), 
                    i && this.addBody(p), t.layers[e].bodies.push(p);
                }
            }
            return t.layers[e].bodies;
        },
        mpx: function(t) {
            return 20 * t;
        },
        pxm: function(t) {
            return .05 * t;
        },
        mpxi: function(t) {
            return -20 * t;
        },
        pxmi: function(t) {
            return -.05 * t;
        }
    }, Object.defineProperty(z.Physics.P2.prototype, "friction", {
        get: function() {
            return this.world.defaultContactMaterial.friction;
        },
        set: function(t) {
            this.world.defaultContactMaterial.friction = t;
        }
    }), Object.defineProperty(z.Physics.P2.prototype, "restitution", {
        get: function() {
            return this.world.defaultContactMaterial.restitution;
        },
        set: function(t) {
            this.world.defaultContactMaterial.restitution = t;
        }
    }), Object.defineProperty(z.Physics.P2.prototype, "contactMaterial", {
        get: function() {
            return this.world.defaultContactMaterial;
        },
        set: function(t) {
            this.world.defaultContactMaterial = t;
        }
    }), Object.defineProperty(z.Physics.P2.prototype, "applySpringForces", {
        get: function() {
            return this.world.applySpringForces;
        },
        set: function(t) {
            this.world.applySpringForces = t;
        }
    }), Object.defineProperty(z.Physics.P2.prototype, "applyDamping", {
        get: function() {
            return this.world.applyDamping;
        },
        set: function(t) {
            this.world.applyDamping = t;
        }
    }), Object.defineProperty(z.Physics.P2.prototype, "applyGravity", {
        get: function() {
            return this.world.applyGravity;
        },
        set: function(t) {
            this.world.applyGravity = t;
        }
    }), Object.defineProperty(z.Physics.P2.prototype, "solveConstraints", {
        get: function() {
            return this.world.solveConstraints;
        },
        set: function(t) {
            this.world.solveConstraints = t;
        }
    }), Object.defineProperty(z.Physics.P2.prototype, "time", {
        get: function() {
            return this.world.time;
        }
    }), Object.defineProperty(z.Physics.P2.prototype, "emitImpactEvent", {
        get: function() {
            return this.world.emitImpactEvent;
        },
        set: function(t) {
            this.world.emitImpactEvent = t;
        }
    }), Object.defineProperty(z.Physics.P2.prototype, "sleepMode", {
        get: function() {
            return this.world.sleepMode;
        },
        set: function(t) {
            this.world.sleepMode = t;
        }
    }), Object.defineProperty(z.Physics.P2.prototype, "total", {
        get: function() {
            return this.world.bodies.length;
        }
    }), z.Physics.P2.FixtureList = function(t) {
        Array.isArray(t) || (t = [ t ]), this.rawList = t, this.init(), this.parse(this.rawList);
    }, z.Physics.P2.FixtureList.prototype = {
        init: function() {
            this.namedFixtures = {}, this.groupedFixtures = [], this.allFixtures = [];
        },
        setCategory: function(e, t) {
            this.getFixtures(t).forEach(function(t) {
                t.collisionGroup = e;
            });
        },
        setMask: function(e, t) {
            this.getFixtures(t).forEach(function(t) {
                t.collisionMask = e;
            });
        },
        setSensor: function(e, t) {
            this.getFixtures(t).forEach(function(t) {
                t.sensor = e;
            });
        },
        setMaterial: function(e, t) {
            this.getFixtures(t).forEach(function(t) {
                t.material = e;
            });
        },
        getFixtures: function(t) {
            var e = [];
            if (t) {
                t instanceof Array || (t = [ t ]);
                var i = this;
                return t.forEach(function(t) {
                    i.namedFixtures[t] && e.push(i.namedFixtures[t]);
                }), this.flatten(e);
            }
            return this.allFixtures;
        },
        getFixtureByKey: function(t) {
            return this.namedFixtures[t];
        },
        getGroup: function(t) {
            return this.groupedFixtures[t];
        },
        parse: function() {
            var t, e, i, n;
            for (t in n = [], i = this.rawList) e = i[t], isNaN(t - 0) ? this.namedFixtures[t] = this.flatten(e) : (this.groupedFixtures[t] = this.groupedFixtures[t] || [], 
            this.groupedFixtures[t] = this.groupedFixtures[t].concat(e)), n.push(this.allFixtures = this.flatten(this.groupedFixtures));
        },
        flatten: function(t) {
            var e, i;
            return e = [], i = arguments.callee, t.forEach(function(t) {
                return Array.prototype.push.apply(e, Array.isArray(t) ? i(t) : [ t ]);
            }), e;
        }
    }, z.Physics.P2.PointProxy = function(t, e) {
        this.world = t, this.destination = e;
    }, z.Physics.P2.PointProxy.prototype.constructor = z.Physics.P2.PointProxy, Object.defineProperty(z.Physics.P2.PointProxy.prototype, "x", {
        get: function() {
            return this.world.mpx(this.destination[0]);
        },
        set: function(t) {
            this.destination[0] = this.world.pxm(t);
        }
    }), Object.defineProperty(z.Physics.P2.PointProxy.prototype, "y", {
        get: function() {
            return this.world.mpx(this.destination[1]);
        },
        set: function(t) {
            this.destination[1] = this.world.pxm(t);
        }
    }), Object.defineProperty(z.Physics.P2.PointProxy.prototype, "mx", {
        get: function() {
            return this.destination[0];
        },
        set: function(t) {
            this.destination[0] = t;
        }
    }), Object.defineProperty(z.Physics.P2.PointProxy.prototype, "my", {
        get: function() {
            return this.destination[1];
        },
        set: function(t) {
            this.destination[1] = t;
        }
    }), z.Physics.P2.InversePointProxy = function(t, e) {
        this.world = t, this.destination = e;
    }, z.Physics.P2.InversePointProxy.prototype.constructor = z.Physics.P2.InversePointProxy, 
    Object.defineProperty(z.Physics.P2.InversePointProxy.prototype, "x", {
        get: function() {
            return this.world.mpxi(this.destination[0]);
        },
        set: function(t) {
            this.destination[0] = this.world.pxmi(t);
        }
    }), Object.defineProperty(z.Physics.P2.InversePointProxy.prototype, "y", {
        get: function() {
            return this.world.mpxi(this.destination[1]);
        },
        set: function(t) {
            this.destination[1] = this.world.pxmi(t);
        }
    }), Object.defineProperty(z.Physics.P2.InversePointProxy.prototype, "mx", {
        get: function() {
            return this.destination[0];
        },
        set: function(t) {
            this.destination[0] = -t;
        }
    }), Object.defineProperty(z.Physics.P2.InversePointProxy.prototype, "my", {
        get: function() {
            return this.destination[1];
        },
        set: function(t) {
            this.destination[1] = -t;
        }
    }), z.Physics.P2.Body = function(t, e, i, n, s) {
        e = e || null, i = i || 0, n = n || 0, void 0 === s && (s = 1), this.game = t, this.world = t.physics.p2, 
        this.sprite = e, this.type = z.Physics.P2JS, this.offset = new z.Point(), this.data = new p2.Body({
            position: [ this.world.pxmi(i), this.world.pxmi(n) ],
            mass: s
        }), (this.data.parent = this).velocity = new z.Physics.P2.InversePointProxy(this.world, this.data.velocity), 
        this.force = new z.Physics.P2.InversePointProxy(this.world, this.data.force), this.gravity = new z.Point(), 
        this.onBeginContact = new z.Signal(), this.onEndContact = new z.Signal(), this.collidesWith = [], 
        this.removeNextStep = !1, this.debugBody = null, this.dirty = !1, this._collideWorldBounds = !0, 
        this._bodyCallbacks = {}, this._bodyCallbackContext = {}, this._groupCallbacks = {}, 
        this._groupCallbackContext = {}, this._reset = !1, e && (this.setRectangleFromSprite(e), 
        e.exists && this.game.physics.p2.addBody(this));
    }, z.Physics.P2.Body.prototype = {
        createBodyCallback: function(t, e, i) {
            var n = -1;
            t.id ? n = t.id : t.body && (n = t.body.id), -1 < n && (null === e ? (delete this._bodyCallbacks[n], 
            delete this._bodyCallbackContext[n]) : (this._bodyCallbacks[n] = e, this._bodyCallbackContext[n] = i));
        },
        createGroupCallback: function(t, e, i) {
            null === e ? (delete this._groupCallbacks[t.mask], delete this._groupCallbackContext[t.mask]) : (this._groupCallbacks[t.mask] = e, 
            this._groupCallbackContext[t.mask] = i);
        },
        getCollisionMask: function() {
            var t = 0;
            this._collideWorldBounds && (t = this.game.physics.p2.boundsCollisionGroup.mask);
            for (var e = 0; e < this.collidesWith.length; e++) t |= this.collidesWith[e].mask;
            return t;
        },
        updateCollisionMask: function(t) {
            var e = this.getCollisionMask();
            if (void 0 === t) for (var i = this.data.shapes.length - 1; 0 <= i; i--) this.data.shapes[i].collisionMask = e; else t.collisionMask = e;
        },
        setCollisionGroup: function(t, e) {
            var i = this.getCollisionMask();
            if (void 0 === e) for (var n = this.data.shapes.length - 1; 0 <= n; n--) this.data.shapes[n].collisionGroup = t.mask, 
            this.data.shapes[n].collisionMask = i; else e.collisionGroup = t.mask, e.collisionMask = i;
        },
        clearCollision: function(t, e, i) {
            if (void 0 === t && (t = !0), void 0 === e && (e = !0), void 0 === i) for (var n = this.data.shapes.length - 1; 0 <= n; n--) t && (this.data.shapes[n].collisionGroup = null), 
            e && (this.data.shapes[n].collisionMask = null); else t && (i.collisionGroup = null), 
            e && (i.collisionMask = null);
            t && (this.collidesWith.length = 0);
        },
        removeCollisionGroup: function(t, e, i) {
            var n;
            if (void 0 === e && (e = !0), Array.isArray(t)) for (var s = 0; s < t.length; s++) -1 < (n = this.collidesWith.indexOf(t[s])) && (this.collidesWith.splice(n, 1), 
            e && (delete this._groupCallbacks[t.mask], delete this._groupCallbackContext[t.mask])); else -1 < (n = this.collidesWith.indexOf(t)) && (this.collidesWith.splice(n, 1), 
            e && (delete this._groupCallbacks[t.mask], delete this._groupCallbackContext[t.mask]));
            var o = this.getCollisionMask();
            if (void 0 === i) for (s = this.data.shapes.length - 1; 0 <= s; s--) this.data.shapes[s].collisionMask = o; else i.collisionMask = o;
        },
        collides: function(t, e, i, n) {
            if (Array.isArray(t)) for (var s = 0; s < t.length; s++) -1 === this.collidesWith.indexOf(t[s]) && (this.collidesWith.push(t[s]), 
            e && this.createGroupCallback(t[s], e, i)); else -1 === this.collidesWith.indexOf(t) && (this.collidesWith.push(t), 
            e && this.createGroupCallback(t, e, i));
            var o = this.getCollisionMask();
            if (void 0 === n) for (s = this.data.shapes.length - 1; 0 <= s; s--) this.data.shapes[s].collisionMask = o; else n.collisionMask = o;
        },
        adjustCenterOfMass: function() {
            this.data.adjustCenterOfMass(), this.shapeChanged();
        },
        getVelocityAtPoint: function(t, e) {
            return this.data.getVelocityAtPoint(t, e);
        },
        applyDamping: function(t) {
            this.data.applyDamping(t);
        },
        applyImpulse: function(t, e, i) {
            this.data.applyImpulse(t, [ this.world.pxmi(e), this.world.pxmi(i) ]);
        },
        applyImpulseLocal: function(t, e, i) {
            this.data.applyImpulseLocal(t, [ this.world.pxmi(e), this.world.pxmi(i) ]);
        },
        applyForce: function(t, e, i) {
            this.data.applyForce(t, [ this.world.pxmi(e), this.world.pxmi(i) ]);
        },
        setZeroForce: function() {
            this.data.setZeroForce();
        },
        setZeroRotation: function() {
            this.data.angularVelocity = 0;
        },
        setZeroVelocity: function() {
            this.data.velocity[0] = 0, this.data.velocity[1] = 0;
        },
        setZeroDamping: function() {
            this.data.damping = 0, this.data.angularDamping = 0;
        },
        toLocalFrame: function(t, e) {
            return this.data.toLocalFrame(t, e);
        },
        toWorldFrame: function(t, e) {
            return this.data.toWorldFrame(t, e);
        },
        rotateLeft: function(t) {
            this.data.angularVelocity = this.world.pxm(-t);
        },
        rotateRight: function(t) {
            this.data.angularVelocity = this.world.pxm(t);
        },
        moveForward: function(t) {
            var e = this.world.pxmi(-t), i = this.data.angle + Math.PI / 2;
            this.data.velocity[0] = e * Math.cos(i), this.data.velocity[1] = e * Math.sin(i);
        },
        moveBackward: function(t) {
            var e = this.world.pxmi(-t), i = this.data.angle + Math.PI / 2;
            this.data.velocity[0] = -e * Math.cos(i), this.data.velocity[1] = -e * Math.sin(i);
        },
        thrust: function(t) {
            var e = this.world.pxmi(-t), i = this.data.angle + Math.PI / 2;
            this.data.force[0] += e * Math.cos(i), this.data.force[1] += e * Math.sin(i);
        },
        thrustLeft: function(t) {
            var e = this.world.pxmi(-t), i = this.data.angle;
            this.data.force[0] += e * Math.cos(i), this.data.force[1] += e * Math.sin(i);
        },
        thrustRight: function(t) {
            var e = this.world.pxmi(-t), i = this.data.angle;
            this.data.force[0] -= e * Math.cos(i), this.data.force[1] -= e * Math.sin(i);
        },
        reverse: function(t) {
            var e = this.world.pxmi(-t), i = this.data.angle + Math.PI / 2;
            this.data.force[0] -= e * Math.cos(i), this.data.force[1] -= e * Math.sin(i);
        },
        moveLeft: function(t) {
            this.data.velocity[0] = this.world.pxmi(-t);
        },
        moveRight: function(t) {
            this.data.velocity[0] = this.world.pxmi(t);
        },
        moveUp: function(t) {
            this.data.velocity[1] = this.world.pxmi(-t);
        },
        moveDown: function(t) {
            this.data.velocity[1] = this.world.pxmi(t);
        },
        preUpdate: function() {
            this.dirty = !0, this.removeNextStep && (this.removeFromWorld(), this.removeNextStep = !1);
        },
        postUpdate: function() {
            this.sprite.x = this.world.mpxi(this.data.position[0]) + this.offset.x, this.sprite.y = this.world.mpxi(this.data.position[1]) + this.offset.y, 
            this.fixedRotation || (this.sprite.rotation = this.data.angle), this.debugBody && this.debugBody.updateSpriteTransform(), 
            this.dirty = !1;
        },
        reset: function(t, e, i, n) {
            void 0 === i && (i = !1), void 0 === n && (n = !1), this.setZeroForce(), this.setZeroVelocity(), 
            this.setZeroRotation(), i && this.setZeroDamping(), n && (this.mass = 1), this.x = t, 
            this.y = e;
        },
        addToWorld: function() {
            if (this.game.physics.p2._toRemove) for (var t = 0; t < this.game.physics.p2._toRemove.length; t++) this.game.physics.p2._toRemove[t] === this && this.game.physics.p2._toRemove.splice(t, 1);
            this.data.world !== this.game.physics.p2.world && this.game.physics.p2.addBody(this);
        },
        removeFromWorld: function() {
            this.data.world === this.game.physics.p2.world && this.game.physics.p2.removeBodyNextStep(this);
        },
        destroy: function() {
            this.removeFromWorld(), this.clearShapes(), this._bodyCallbacks = {}, this._bodyCallbackContext = {}, 
            this._groupCallbacks = {}, this._groupCallbackContext = {}, this.debugBody && this.debugBody.destroy(!0, !0), 
            this.debugBody = null, this.sprite && (this.sprite.body = null, this.sprite = null);
        },
        clearShapes: function() {
            for (var t = this.data.shapes.length; t--; ) this.data.removeShape(this.data.shapes[t]);
            this.shapeChanged();
        },
        addShape: function(t, e, i, n) {
            return void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
            this.data.addShape(t, [ this.world.pxmi(e), this.world.pxmi(i) ], n), this.shapeChanged(), 
            t;
        },
        addCircle: function(t, e, i, n) {
            var s = new p2.Circle({
                radius: this.world.pxm(t)
            });
            return this.addShape(s, e, i, n);
        },
        addRectangle: function(t, e, i, n, s) {
            var o = new p2.Box({
                width: this.world.pxm(t),
                height: this.world.pxm(e)
            });
            return this.addShape(o, i, n, s);
        },
        addPlane: function(t, e, i) {
            var n = new p2.Plane();
            return this.addShape(n, t, e, i);
        },
        addParticle: function(t, e, i) {
            var n = new p2.Particle();
            return this.addShape(n, t, e, i);
        },
        addLine: function(t, e, i, n) {
            var s = new p2.Line({
                length: this.world.pxm(t)
            });
            return this.addShape(s, e, i, n);
        },
        addCapsule: function(t, e, i, n, s) {
            var o = new p2.Capsule({
                length: this.world.pxm(t),
                radius: this.world.pxm(e)
            });
            return this.addShape(o, i, n, s);
        },
        addPolygon: function(t, e) {
            t = t || {}, Array.isArray(e) || (e = Array.prototype.slice.call(arguments, 1));
            var i = [];
            if (1 === e.length && Array.isArray(e[0])) i = e[0].slice(0); else if (Array.isArray(e[0])) i = e.slice(); else if ("number" == typeof e[0]) for (var n = 0, s = e.length; n < s; n += 2) i.push([ e[n], e[n + 1] ]);
            var o = i.length - 1;
            i[o][0] === i[0][0] && i[o][1] === i[0][1] && i.pop();
            for (var a = 0; a < i.length; a++) i[a][0] = this.world.pxmi(i[a][0]), i[a][1] = this.world.pxmi(i[a][1]);
            var r = this.data.fromPolygon(i, t);
            return this.shapeChanged(), r;
        },
        removeShape: function(t) {
            var e = this.data.removeShape(t);
            return this.shapeChanged(), e;
        },
        setCircle: function(t, e, i, n) {
            return this.clearShapes(), this.addCircle(t, e, i, n);
        },
        setRectangle: function(t, e, i, n, s) {
            return void 0 === t && (t = 16), void 0 === e && (e = 16), this.clearShapes(), this.addRectangle(t, e, i, n, s);
        },
        setRectangleFromSprite: function(t) {
            return void 0 === t && (t = this.sprite), this.clearShapes(), this.addRectangle(t.width, t.height, 0, 0, t.rotation);
        },
        setMaterial: function(t, e) {
            if (void 0 === e) for (var i = this.data.shapes.length - 1; 0 <= i; i--) this.data.shapes[i].material = t; else e.material = t;
        },
        shapeChanged: function() {
            this.debugBody && this.debugBody.draw();
        },
        addPhaserPolygon: function(t, e) {
            for (var i = this.game.cache.getPhysicsData(t, e), n = [], s = 0; s < i.length; s++) {
                var o = i[s], a = this.addFixture(o);
                n[o.filter.group] = n[o.filter.group] || [], n[o.filter.group] = n[o.filter.group].concat(a), 
                o.fixtureKey && (n[o.fixtureKey] = a);
            }
            return this.data.aabbNeedsUpdate = !0, this.shapeChanged(), n;
        },
        addFixture: function(t) {
            var e = [];
            if (t.circle) {
                (l = new p2.Circle({
                    radius: this.world.pxm(t.circle.radius)
                })).collisionGroup = t.filter.categoryBits, l.collisionMask = t.filter.maskBits, 
                l.sensor = t.isSensor;
                var i = p2.vec2.create();
                i[0] = this.world.pxmi(t.circle.position[0] - this.sprite.width / 2), i[1] = this.world.pxmi(t.circle.position[1] - this.sprite.height / 2), 
                this.data.addShape(l, i), e.push(l);
            } else for (var n = t.polygons, s = p2.vec2.create(), o = 0; o < n.length; o++) {
                for (var a = n[o], r = [], h = 0; h < a.length; h += 2) r.push([ this.world.pxmi(a[h]), this.world.pxmi(a[h + 1]) ]);
                for (var l = new p2.Convex({
                    vertices: r
                }), c = 0; c !== l.vertices.length; c++) {
                    var u = l.vertices[c];
                    p2.vec2.sub(u, u, l.centerOfMass);
                }
                p2.vec2.scale(s, l.centerOfMass, 1), s[0] -= this.world.pxmi(this.sprite.width / 2), 
                s[1] -= this.world.pxmi(this.sprite.height / 2), l.updateTriangles(), l.updateCenterOfMass(), 
                l.updateBoundingRadius(), l.collisionGroup = t.filter.categoryBits, l.collisionMask = t.filter.maskBits, 
                l.sensor = t.isSensor, this.data.addShape(l, s), e.push(l);
            }
            return e;
        },
        loadPolygon: function(t, e, i) {
            if (null === t) var n = e; else n = this.game.cache.getPhysicsData(t, e);
            "number" != typeof i && (i = 1);
            for (var s = p2.vec2.create(), o = 0; o < n.length; o++) {
                for (var a = [], r = 0; r < n[o].shape.length; r += 2) a.push([ this.world.pxmi(n[o].shape[r] * i), this.world.pxmi(n[o].shape[r + 1] * i) ]);
                for (var h = new p2.Convex({
                    vertices: a
                }), l = 0; l !== h.vertices.length; l++) {
                    var c = h.vertices[l];
                    p2.vec2.sub(c, c, h.centerOfMass);
                }
                p2.vec2.scale(s, h.centerOfMass, 1), s[0] -= this.world.pxmi(this.sprite.width / 2), 
                s[1] -= this.world.pxmi(this.sprite.height / 2), h.updateTriangles(), h.updateCenterOfMass(), 
                h.updateBoundingRadius(), this.data.addShape(h, s);
            }
            return this.data.aabbNeedsUpdate = !0, this.shapeChanged(), !0;
        }
    }, z.Physics.P2.Body.prototype.constructor = z.Physics.P2.Body, z.Physics.P2.Body.DYNAMIC = 1, 
    z.Physics.P2.Body.STATIC = 2, z.Physics.P2.Body.KINEMATIC = 4, Object.defineProperty(z.Physics.P2.Body.prototype, "static", {
        get: function() {
            return this.data.type === z.Physics.P2.Body.STATIC;
        },
        set: function(t) {
            t && this.data.type !== z.Physics.P2.Body.STATIC ? (this.data.type = z.Physics.P2.Body.STATIC, 
            this.mass = 0) : t || this.data.type !== z.Physics.P2.Body.STATIC || (this.data.type = z.Physics.P2.Body.DYNAMIC, 
            this.mass = 1);
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "dynamic", {
        get: function() {
            return this.data.type === z.Physics.P2.Body.DYNAMIC;
        },
        set: function(t) {
            t && this.data.type !== z.Physics.P2.Body.DYNAMIC ? (this.data.type = z.Physics.P2.Body.DYNAMIC, 
            this.mass = 1) : t || this.data.type !== z.Physics.P2.Body.DYNAMIC || (this.data.type = z.Physics.P2.Body.STATIC, 
            this.mass = 0);
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "kinematic", {
        get: function() {
            return this.data.type === z.Physics.P2.Body.KINEMATIC;
        },
        set: function(t) {
            t && this.data.type !== z.Physics.P2.Body.KINEMATIC ? (this.data.type = z.Physics.P2.Body.KINEMATIC, 
            this.mass = 4) : t || this.data.type !== z.Physics.P2.Body.KINEMATIC || (this.data.type = z.Physics.P2.Body.STATIC, 
            this.mass = 0);
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "allowSleep", {
        get: function() {
            return this.data.allowSleep;
        },
        set: function(t) {
            t !== this.data.allowSleep && (this.data.allowSleep = t);
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "angle", {
        get: function() {
            return z.Math.wrapAngle(z.Math.radToDeg(this.data.angle));
        },
        set: function(t) {
            this.data.angle = z.Math.degToRad(z.Math.wrapAngle(t));
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "angularDamping", {
        get: function() {
            return this.data.angularDamping;
        },
        set: function(t) {
            this.data.angularDamping = t;
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "angularForce", {
        get: function() {
            return this.data.angularForce;
        },
        set: function(t) {
            this.data.angularForce = t;
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "angularVelocity", {
        get: function() {
            return this.data.angularVelocity;
        },
        set: function(t) {
            this.data.angularVelocity = t;
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "damping", {
        get: function() {
            return this.data.damping;
        },
        set: function(t) {
            this.data.damping = t;
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "fixedRotation", {
        get: function() {
            return this.data.fixedRotation;
        },
        set: function(t) {
            t !== this.data.fixedRotation && (this.data.fixedRotation = t);
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "inertia", {
        get: function() {
            return this.data.inertia;
        },
        set: function(t) {
            this.data.inertia = t;
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "mass", {
        get: function() {
            return this.data.mass;
        },
        set: function(t) {
            t !== this.data.mass && (this.data.mass = t, this.data.updateMassProperties());
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "motionState", {
        get: function() {
            return this.data.type;
        },
        set: function(t) {
            t !== this.data.type && (this.data.type = t);
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "rotation", {
        get: function() {
            return this.data.angle;
        },
        set: function(t) {
            this.data.angle = t;
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "sleepSpeedLimit", {
        get: function() {
            return this.data.sleepSpeedLimit;
        },
        set: function(t) {
            this.data.sleepSpeedLimit = t;
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "x", {
        get: function() {
            return this.world.mpxi(this.data.position[0]);
        },
        set: function(t) {
            this.data.position[0] = this.world.pxmi(t);
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "y", {
        get: function() {
            return this.world.mpxi(this.data.position[1]);
        },
        set: function(t) {
            this.data.position[1] = this.world.pxmi(t);
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "id", {
        get: function() {
            return this.data.id;
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "debug", {
        get: function() {
            return null !== this.debugBody;
        },
        set: function(t) {
            t && !this.debugBody ? this.debugBody = new z.Physics.P2.BodyDebug(this.game, this.data) : !t && this.debugBody && (this.debugBody.destroy(), 
            this.debugBody = null);
        }
    }), Object.defineProperty(z.Physics.P2.Body.prototype, "collideWorldBounds", {
        get: function() {
            return this._collideWorldBounds;
        },
        set: function(t) {
            t && !this._collideWorldBounds ? (this._collideWorldBounds = !0, this.updateCollisionMask()) : !t && this._collideWorldBounds && (this._collideWorldBounds = !1, 
            this.updateCollisionMask());
        }
    }), z.Physics.P2.BodyDebug = function(t, e, i) {
        z.Group.call(this, t);
        var n = {
            pixelsPerLengthUnit: t.physics.p2.mpx(1),
            debugPolygons: !1,
            lineWidth: 1,
            alpha: .5
        };
        this.settings = Object.assign(n, i), this.ppu = this.settings.pixelsPerLengthUnit, 
        this.ppu = -1 * this.ppu, this.body = e, this.canvas = new z.Graphics(t), this.canvas.alpha = this.settings.alpha, 
        this.add(this.canvas), this.draw(), this.updateSpriteTransform();
    }, z.Physics.P2.BodyDebug.prototype = Object.create(z.Group.prototype), z.Physics.P2.BodyDebug.prototype.constructor = z.Physics.P2.BodyDebug, 
    Object.assign(z.Physics.P2.BodyDebug.prototype, {
        updateSpriteTransform: function() {
            this.position.x = this.body.position[0] * this.ppu, this.position.y = this.body.position[1] * this.ppu, 
            this.rotation = this.body.angle;
        },
        draw: function() {
            var t, e, i, n, s, o, a, r, h, l, c, u, d, p, g;
            if (r = this.body, (l = this.canvas).clear(), i = parseInt(this.randomPastelHex(), 16), 
            o = 16711680, a = this.lineWidth, r instanceof p2.Body && r.shapes.length) {
                var m = r.shapes.length;
                for (n = 0; n !== m; ) {
                    if (h = (e = r.shapes[n]).position || 0, t = e.angle || 0, e instanceof p2.Circle) this.drawCircle(l, h[0] * this.ppu, h[1] * this.ppu, t, e.radius * this.ppu, i, a); else if (e instanceof p2.Capsule) this.drawCapsule(l, h[0] * this.ppu, h[1] * this.ppu, t, e.length * this.ppu, e.radius * this.ppu, o, i, a); else if (e instanceof p2.Plane) this.drawPlane(l, h[0] * this.ppu, -h[1] * this.ppu, i, o, 5 * a, 10 * a, 10 * a, 100 * this.ppu, t); else if (e instanceof p2.Line) this.drawLine(l, e.length * this.ppu, o, a); else if (e instanceof p2.Box) this.drawRectangle(l, h[0] * this.ppu, h[1] * this.ppu, t, e.width * this.ppu, e.height * this.ppu, o, i, a); else if (e instanceof p2.Convex) {
                        for (u = [], d = p2.vec2.create(), s = p = 0, g = e.vertices.length; 0 <= g ? p < g : g < p; s = 0 <= g ? ++p : --p) c = e.vertices[s], 
                        p2.vec2.rotate(d, c, t), u.push([ (d[0] + h[0]) * this.ppu, -(d[1] + h[1]) * this.ppu ]);
                        this.drawConvex(l, u, e.triangles, o, i, a, this.settings.debugPolygons, [ h[0] * this.ppu, -h[1] * this.ppu ]);
                    }
                    n++;
                }
            }
        },
        drawRectangle: function(t, e, i, n, s, o, a, r, h) {
            void 0 === h && (h = 1), void 0 === a && (a = 0), t.lineStyle(h, a, 1), t.beginFill(r), 
            t.drawRect(e - s / 2, i - o / 2, s, o);
        },
        drawCircle: function(t, e, i, n, s, o, a) {
            void 0 === a && (a = 1), void 0 === o && (o = 16777215), t.lineStyle(a, 0, 1), t.beginFill(o, 1), 
            t.drawCircle(e, i, 2 * -s), t.endFill(), t.moveTo(e, i), t.lineTo(e + s * Math.cos(-n), i + s * Math.sin(-n));
        },
        drawLine: function(t, e, i, n) {
            void 0 === n && (n = 1), void 0 === i && (i = 0), t.lineStyle(5 * n, i, 1), t.moveTo(-e / 2, 0), 
            t.lineTo(e / 2, 0);
        },
        drawConvex: function(t, e, i, n, s, o, a, r) {
            var h, l, c, u, d, p, g, m, f, y, v;
            if (void 0 === o && (o = 1), void 0 === n && (n = 0), a) {
                for (h = [ 16711680, 65280, 255 ], l = 0; l !== e.length + 1; ) u = e[l % e.length], 
                d = e[(l + 1) % e.length], g = u[0], y = u[1], m = d[0], v = d[1], t.lineStyle(o, h[l % h.length], 1), 
                t.moveTo(g, -y), t.lineTo(m, -v), t.drawCircle(g, -y, 2 * o), l++;
                return t.lineStyle(o, 0, 1), t.drawCircle(r[0], r[1], 2 * o);
            }
            for (t.lineStyle(o, n, 1), t.beginFill(s), l = 0; l !== e.length; ) p = (c = e[l])[0], 
            f = c[1], 0 === l ? t.moveTo(p, -f) : t.lineTo(p, -f), l++;
            if (t.endFill(), 2 < e.length) return t.moveTo(e[e.length - 1][0], -e[e.length - 1][1]), 
            t.lineTo(e[0][0], -e[0][1]);
        },
        drawPath: function(t, e, i, n, s) {
            var o, a, r, h, l, c, u, d, p, g, m;
            for (void 0 === s && (s = 1), void 0 === i && (i = 0), t.lineStyle(s, i, 1), "number" == typeof n && t.beginFill(n), 
            r = a = null, o = 0; o < e.length; ) g = (p = e[o])[0], m = p[1], g === a && m === r || (0 === o ? t.moveTo(g, m) : (h = a, 
            l = r, c = g, u = m, d = e[(o + 1) % e.length][0], 0 !== (c - h) * (e[(o + 1) % e.length][1] - l) - (d - h) * (u - l) && t.lineTo(g, m)), 
            a = g, r = m), o++;
            "number" == typeof n && t.endFill(), 2 < e.length && "number" == typeof n && (t.moveTo(e[e.length - 1][0], e[e.length - 1][1]), 
            t.lineTo(e[0][0], e[0][1]));
        },
        drawPlane: function(t, e, i, n, s, o, a, r, h, l) {
            var c, u;
            void 0 === o && (o = 1), void 0 === n && (n = 16777215), t.lineStyle(o, s, 11), 
            t.beginFill(n), t.moveTo(e, -i), c = e + Math.cos(l) * this.game.width, u = i + Math.sin(l) * this.game.height, 
            t.lineTo(c, -u), t.moveTo(e, -i), c = e + Math.cos(l) * -this.game.width, u = i + Math.sin(l) * -this.game.height, 
            t.lineTo(c, -u);
        },
        drawCapsule: function(t, e, i, n, s, o, a, r, h) {
            void 0 === h && (h = 1), void 0 === a && (a = 0), t.lineStyle(h, a, 1);
            var l = Math.cos(n), c = Math.sin(n);
            t.beginFill(r, 1), t.drawCircle(-s / 2 * l + e, -s / 2 * c + i, 2 * -o), t.drawCircle(s / 2 * l + e, s / 2 * c + i, 2 * -o), 
            t.endFill(), t.lineStyle(h, a, 0), t.beginFill(r, 1), t.moveTo(-s / 2 * l + o * c + e, -s / 2 * c + o * l + i), 
            t.lineTo(s / 2 * l + o * c + e, s / 2 * c + o * l + i), t.lineTo(s / 2 * l - o * c + e, s / 2 * c - o * l + i), 
            t.lineTo(-s / 2 * l - o * c + e, -s / 2 * c - o * l + i), t.endFill(), t.lineStyle(h, a, 1), 
            t.moveTo(-s / 2 * l + o * c + e, -s / 2 * c + o * l + i), t.lineTo(s / 2 * l + o * c + e, s / 2 * c + o * l + i), 
            t.moveTo(-s / 2 * l - o * c + e, -s / 2 * c - o * l + i), t.lineTo(s / 2 * l - o * c + e, s / 2 * c - o * l + i);
        },
        randomPastelHex: function() {
            var t, e, i, n;
            return i = [ 255, 255, 255 ], n = Math.floor(256 * Math.random()), e = Math.floor(256 * Math.random()), 
            t = Math.floor(256 * Math.random()), n = Math.floor((n + 3 * i[0]) / 4), e = Math.floor((e + 3 * i[1]) / 4), 
            t = Math.floor((t + 3 * i[2]) / 4), this.rgbToHex(n, e, t);
        },
        rgbToHex: function(t, e, i) {
            return this.componentToHex(t) + this.componentToHex(e) + this.componentToHex(i);
        },
        componentToHex: function(t) {
            var e;
            return 2 === (e = t.toString(16)).length ? e : e + "0";
        }
    }), z.Physics.P2.Spring = function(t, e, i, n, s, o, a, r, h, l) {
        this.game = t.game, void 0 === n && (n = 1), void 0 === s && (s = 100), void 0 === o && (o = 1);
        var c = {
            restLength: n = (this.world = t).pxm(n),
            stiffness: s,
            damping: o
        };
        null != a && (c.worldAnchorA = [ t.pxm(a[0]), t.pxm(a[1]) ]), null != r && (c.worldAnchorB = [ t.pxm(r[0]), t.pxm(r[1]) ]), 
        null != h && (c.localAnchorA = [ t.pxm(h[0]), t.pxm(h[1]) ]), null != l && (c.localAnchorB = [ t.pxm(l[0]), t.pxm(l[1]) ]), 
        this.data = new p2.LinearSpring(e, i, c), this.data.parent = this;
    }, z.Physics.P2.Spring.prototype.constructor = z.Physics.P2.Spring, z.Physics.P2.RotationalSpring = function(t, e, i, n, s, o) {
        this.game = t.game, this.world = t, void 0 === n && (n = null), void 0 === s && (s = 100), 
        void 0 === o && (o = 1), n && (n = t.pxm(n));
        var a = {
            restAngle: n,
            stiffness: s,
            damping: o
        };
        this.data = new p2.RotationalSpring(e, i, a), this.data.parent = this;
    }, z.Physics.P2.Spring.prototype.constructor = z.Physics.P2.Spring, z.Physics.P2.Material = function(t) {
        this.name = t, p2.Material.call(this);
    }, z.Physics.P2.Material.prototype = Object.create(p2.Material.prototype), z.Physics.P2.Material.prototype.constructor = z.Physics.P2.Material, 
    z.Physics.P2.ContactMaterial = function(t, e, i) {
        p2.ContactMaterial.call(this, t, e, i);
    }, z.Physics.P2.ContactMaterial.prototype = Object.create(p2.ContactMaterial.prototype), 
    z.Physics.P2.ContactMaterial.prototype.constructor = z.Physics.P2.ContactMaterial, 
    z.Physics.P2.CollisionGroup = function(t) {
        this.mask = t;
    }, z.Physics.P2.DistanceConstraint = function(t, e, i, n, s, o, a) {
        void 0 === n && (n = 100), void 0 === s && (s = [ 0, 0 ]), void 0 === o && (o = [ 0, 0 ]), 
        void 0 === a && (a = Number.MAX_VALUE), this.game = t.game;
        var r = {
            distance: n = (this.world = t).pxm(n),
            localAnchorA: s = [ t.pxmi(s[0]), t.pxmi(s[1]) ],
            localAnchorB: o = [ t.pxmi(o[0]), t.pxmi(o[1]) ],
            maxForce: a
        };
        p2.DistanceConstraint.call(this, e, i, r);
    }, z.Physics.P2.DistanceConstraint.prototype = Object.create(p2.DistanceConstraint.prototype), 
    z.Physics.P2.DistanceConstraint.prototype.constructor = z.Physics.P2.DistanceConstraint, 
    z.Physics.P2.GearConstraint = function(t, e, i, n, s) {
        void 0 === n && (n = 0), void 0 === s && (s = 1), this.game = t.game, this.world = t;
        var o = {
            angle: n,
            ratio: s
        };
        p2.GearConstraint.call(this, e, i, o);
    }, z.Physics.P2.GearConstraint.prototype = Object.create(p2.GearConstraint.prototype), 
    z.Physics.P2.GearConstraint.prototype.constructor = z.Physics.P2.GearConstraint, 
    z.Physics.P2.LockConstraint = function(t, e, i, n, s, o) {
        void 0 === n && (n = [ 0, 0 ]), void 0 === s && (s = 0), void 0 === o && (o = Number.MAX_VALUE), 
        this.game = t.game;
        var a = {
            localOffsetB: n = [ (this.world = t).pxm(n[0]), t.pxm(n[1]) ],
            localAngleB: s,
            maxForce: o
        };
        p2.LockConstraint.call(this, e, i, a);
    }, z.Physics.P2.LockConstraint.prototype = Object.create(p2.LockConstraint.prototype), 
    z.Physics.P2.LockConstraint.prototype.constructor = z.Physics.P2.LockConstraint, 
    z.Physics.P2.PrismaticConstraint = function(t, e, i, n, s, o, a, r) {
        void 0 === n && (n = !0), void 0 === s && (s = [ 0, 0 ]), void 0 === o && (o = [ 0, 0 ]), 
        void 0 === a && (a = [ 0, 0 ]), void 0 === r && (r = Number.MAX_VALUE), this.game = t.game;
        var h = {
            localAnchorA: s = [ (this.world = t).pxmi(s[0]), t.pxmi(s[1]) ],
            localAnchorB: o = [ t.pxmi(o[0]), t.pxmi(o[1]) ],
            localAxisA: a,
            maxForce: r,
            disableRotationalLock: !n
        };
        p2.PrismaticConstraint.call(this, e, i, h);
    }, z.Physics.P2.PrismaticConstraint.prototype = Object.create(p2.PrismaticConstraint.prototype), 
    z.Physics.P2.PrismaticConstraint.prototype.constructor = z.Physics.P2.PrismaticConstraint, 
    z.Physics.P2.RevoluteConstraint = function(t, e, i, n, s, o, a) {
        void 0 === o && (o = Number.MAX_VALUE), void 0 === a && (a = null), this.game = t.game, 
        i = [ (this.world = t).pxmi(i[0]), t.pxmi(i[1]) ], s = [ t.pxmi(s[0]), t.pxmi(s[1]) ], 
        a && (a = [ t.pxmi(a[0]), t.pxmi(a[1]) ]);
        var r = {
            worldPivot: a,
            localPivotA: i,
            localPivotB: s,
            maxForce: o
        };
        p2.RevoluteConstraint.call(this, e, n, r);
    }, z.Physics.P2.RevoluteConstraint.prototype = Object.create(p2.RevoluteConstraint.prototype), 
    z.Physics.P2.RevoluteConstraint.prototype.constructor = z.Physics.P2.RevoluteConstraint, 
    z.ImageCollection = function(t, e, i, n, s, o, a) {
        (void 0 === i || i <= 0) && (i = 32), (void 0 === n || n <= 0) && (n = 32), void 0 === s && (s = 0), 
        void 0 === o && (o = 0), this.name = t, this.firstgid = 0 | e, this.imageWidth = 0 | i, 
        this.imageHeight = 0 | n, this.imageMargin = 0 | s, this.imageSpacing = 0 | o, this.properties = a || {}, 
        this.images = [], this.total = 0;
    }, z.ImageCollection.prototype = {
        containsImageIndex: function(t) {
            return t >= this.firstgid && t < this.firstgid + this.total;
        },
        addImage: function(t, e) {
            this.images.push({
                gid: t,
                image: e
            }), this.total++;
        }
    }, z.ImageCollection.prototype.constructor = z.ImageCollection, z.Tile = function(t, e, i, n, s, o) {
        this.layer = t, this.index = e, this.x = i, this.y = n, this.rotation = 0, this.flipped = !1, 
        this.worldX = i * s, this.worldY = n * o, this.width = s, this.height = o, this.centerX = Math.abs(s / 2), 
        this.centerY = Math.abs(o / 2), this.alpha = 1, this.properties = {}, this.scanned = !1, 
        this.faceTop = !1, this.faceBottom = !1, this.faceLeft = !1, this.faceRight = !1, 
        this.collideLeft = !1, this.collideRight = !1, this.collideUp = !1, this.collideDown = !1, 
        this.collisionCallback = null, (this.collisionCallbackContext = this).debug = !1;
    }, z.Tile.prototype = {
        containsPoint: function(t, e) {
            return !(t < this.worldX || e < this.worldY || t > this.right || e > this.bottom);
        },
        intersects: function(t, e, i, n) {
            return !(i <= this.worldX) && (!(n <= this.worldY) && (!(t >= this.worldX + this.width) && !(e >= this.worldY + this.height)));
        },
        setCollisionCallback: function(t, e) {
            this.collisionCallback = t, this.collisionCallbackContext = e;
        },
        destroy: function() {
            this.collisionCallback = null, this.collisionCallbackContext = null, this.properties = null;
        },
        setCollision: function(t, e, i, n) {
            this.collideLeft = t, this.collideRight = e, this.collideUp = i, this.collideDown = n, 
            this.faceLeft = t, this.faceRight = e, this.faceTop = i, this.faceBottom = n;
        },
        resetCollision: function() {
            this.collideLeft = !1, this.collideRight = !1, this.collideUp = !1, this.collideDown = !1, 
            this.faceTop = !1, this.faceBottom = !1, this.faceLeft = !1, this.faceRight = !1;
        },
        isInteresting: function(t, e) {
            return t && e ? this.collideLeft || this.collideRight || this.collideUp || this.collideDown || this.faceTop || this.faceBottom || this.faceLeft || this.faceRight || this.collisionCallback : t ? this.collideLeft || this.collideRight || this.collideUp || this.collideDown : !!e && (this.faceTop || this.faceBottom || this.faceLeft || this.faceRight);
        },
        copy: function(t) {
            this.index = t.index, this.alpha = t.alpha, this.properties = t.properties, this.collideUp = t.collideUp, 
            this.collideDown = t.collideDown, this.collideLeft = t.collideLeft, this.collideRight = t.collideRight, 
            this.collisionCallback = t.collisionCallback, this.collisionCallbackContext = t.collisionCallbackContext;
        }
    }, z.Tile.prototype.constructor = z.Tile, Object.defineProperty(z.Tile.prototype, "collides", {
        get: function() {
            return this.collideLeft || this.collideRight || this.collideUp || this.collideDown;
        }
    }), Object.defineProperty(z.Tile.prototype, "canCollide", {
        get: function() {
            return this.collideLeft || this.collideRight || this.collideUp || this.collideDown || this.collisionCallback;
        }
    }), Object.defineProperty(z.Tile.prototype, "left", {
        get: function() {
            return this.worldX;
        }
    }), Object.defineProperty(z.Tile.prototype, "right", {
        get: function() {
            return this.worldX + this.width;
        }
    }), Object.defineProperty(z.Tile.prototype, "top", {
        get: function() {
            return this.worldY;
        }
    }), Object.defineProperty(z.Tile.prototype, "bottom", {
        get: function() {
            return this.worldY + this.height;
        }
    }), z.Tilemap = function(t, e, i, n, s, o) {
        this.game = t, this.key = e;
        var a = z.TilemapParser.parse(this.game, e, i, n, s, o);
        null !== a && (this.width = a.width, this.height = a.height, this.tileWidth = a.tileWidth, 
        this.tileHeight = a.tileHeight, this.orientation = a.orientation, this.format = a.format, 
        this.version = a.version, this.properties = a.properties, this.widthInPixels = a.widthInPixels, 
        this.heightInPixels = a.heightInPixels, this.layers = a.layers, this.tilesets = a.tilesets, 
        this.imagecollections = a.imagecollections, this.tiles = a.tiles, this.objects = a.objects, 
        this.collideIndexes = [], this.collision = a.collision, this.images = a.images, 
        this.enableDebug = !1, this.currentLayer = 0, this.debugMap = [], this._results = [], 
        this._tempA = 0, this._tempB = 0);
    }, z.Tilemap.CSV = 0, z.Tilemap.TILED_JSON = 1, z.Tilemap.NORTH = 0, z.Tilemap.EAST = 1, 
    z.Tilemap.SOUTH = 2, z.Tilemap.WEST = 3, z.Tilemap.prototype = {
        create: function(t, e, i, n, s, o) {
            return void 0 === o && (o = this.game.world), this.width = e, this.height = i, this.setTileSize(n, s), 
            this.layers.length = 0, this.createBlankLayer(t, e, i, n, s, o);
        },
        setTileSize: function(t, e) {
            this.tileWidth = t, this.tileHeight = e, this.widthInPixels = this.width * t, this.heightInPixels = this.height * e;
        },
        addTilesetImage: function(t, e, i, n, s, o, a) {
            if (void 0 === t) return null;
            void 0 === i && (i = this.tileWidth), void 0 === n && (n = this.tileHeight), void 0 === s && (s = 0), 
            void 0 === o && (o = 0), void 0 === a && (a = 0), 0 === i && (i = 32), 0 === n && (n = 32);
            var r = null;
            if (null == e && (e = t), e instanceof z.BitmapData) r = e.canvas; else {
                if (!this.game.cache.checkImageKey(e)) return null;
                r = this.game.cache.getImage(e);
            }
            var h = this.getTilesetIndex(t);
            if (null === h && this.format === z.Tilemap.TILED_JSON) return null;
            if (this.tilesets[h]) return this.tilesets[h].setImage(r), this.tilesets[h];
            var l = new z.Tileset(t, a, i, n, s, o, {});
            l.setImage(r), this.tilesets.push(l);
            for (var c = this.tilesets.length - 1, u = s, d = s, p = 0, g = 0, m = 0, f = a; f < a + l.total && (this.tiles[f] = [ u, d, c ], 
            u += i + o, ++p !== l.total) && (++g !== l.columns || (u = s, d += n + o, g = 0, 
            ++m !== l.rows)); f++) ;
            return l;
        },
        createFromObjects: function(t, e, i, n, s, o, a, r, h, l) {
            if (void 0 === s && (s = !0), void 0 === o && (o = !1), void 0 === a && (a = this.game.world), 
            void 0 === r && (r = z.Sprite), void 0 === h && (h = !0), void 0 === l && (l = !0), 
            this.objects[t]) for (var c = 0; c < this.objects[t].length; c++) {
                var u = !1, d = this.objects[t][c];
                if (void 0 !== d.gid && "number" == typeof e && d.gid === e ? u = !0 : void 0 !== d.id && "number" == typeof e && d.id === e ? u = !0 : void 0 !== d.name && "string" == typeof e && d.name === e && (u = !0), 
                u) {
                    var p = new r(this.game, parseFloat(d.x), parseFloat(d.y), i, n);
                    for (var g in p.name = d.name, p.autoCull = o, p.exists = s, p.visible = d.visible, 
                    l && (d.width && (p.width = d.width), d.height && (p.height = d.height)), d.rotation && (p.angle = d.rotation), 
                    h && (p.y -= p.height), a.add(p), d.properties) a.set(p, g, d.properties[g], !1, !1, 0, !0);
                }
            }
        },
        createFromTiles: function(t, e, i, n, s, o) {
            "number" == typeof t && (t = [ t ]), null == e ? e = [] : "number" == typeof e && (e = [ e ]), 
            n = this.getLayer(n), void 0 === s && (s = this.game.world), void 0 === o && (o = {}), 
            void 0 === o.customClass && (o.customClass = z.Sprite), void 0 === o.adjustY && (o.adjustY = !0);
            var a = this.layers[n].width, r = this.layers[n].height;
            if (this.copy(0, 0, a, r, n), this._results.length < 2) return 0;
            for (var h, l = 0, c = 1, u = this._results.length; c < u; c++) if (-1 !== t.indexOf(this._results[c].index)) {
                for (var d in h = new o.customClass(this.game, this._results[c].worldX, this._results[c].worldY, i), 
                o) h[d] = o[d];
                s.add(h), l++;
            }
            if (1 === e.length) for (c = 0; c < t.length; c++) this.replace(t[c], e[0], 0, 0, a, r, n); else if (1 < e.length) for (c = 0; c < t.length; c++) this.replace(t[c], e[c], 0, 0, a, r, n);
            return l;
        },
        createLayer: function(t, e, i, n) {
            void 0 === e && (e = this.game.width), void 0 === i && (i = this.game.height), void 0 === n && (n = this.game.world);
            var s = t;
            if ("string" == typeof t && (s = this.getLayerIndex(t)), !(null === s || s > this.layers.length)) {
                void 0 === e || e <= 0 ? e = Math.min(this.game.width, this.layers[s].widthInPixels) : e > this.game.width && (e = this.game.width), 
                void 0 === i || i <= 0 ? i = Math.min(this.game.height, this.layers[s].heightInPixels) : i > this.game.height && (i = this.game.height), 
                this.enableDebug;
                var o = n.add(new z.TilemapLayer(this.game, this, s, e, i));
                return this.enableDebug, o;
            }
        },
        createBlankLayer: function(t, e, i, n, s, o) {
            if (void 0 === o && (o = this.game.world), null === this.getLayerIndex(t)) {
                for (var a, r = {
                    name: t,
                    x: 0,
                    y: 0,
                    width: e,
                    height: i,
                    widthInPixels: e * n,
                    heightInPixels: i * s,
                    alpha: 1,
                    visible: !0,
                    properties: {},
                    indexes: [],
                    callbacks: [],
                    bodies: [],
                    data: null
                }, h = [], l = 0; l < i; l++) {
                    a = [];
                    for (var c = 0; c < e; c++) a.push(new z.Tile(r, -1, c, l, n, s));
                    h.push(a);
                }
                r.data = h, this.layers.push(r), this.currentLayer = this.layers.length - 1;
                var u = r.widthInPixels, d = r.heightInPixels;
                return u > this.game.width && (u = this.game.width), d > this.game.height && (d = this.game.height), 
                (h = new z.TilemapLayer(this.game, this, this.layers.length - 1, u, d)).name = t, 
                o.add(h);
            }
        },
        getIndex: function(t, e) {
            for (var i = 0; i < t.length; i++) if (t[i].name === e) return i;
            return null;
        },
        getLayerIndex: function(t) {
            return this.getIndex(this.layers, t);
        },
        getTilesetIndex: function(t) {
            return this.getIndex(this.tilesets, t);
        },
        getImageIndex: function(t) {
            return this.getIndex(this.images, t);
        },
        setTileIndexCallback: function(t, e, i, n) {
            if (n = this.getLayer(n), "number" == typeof t) null === e ? delete this.layers[n].callbacks[t] : this.layers[n].callbacks[t] = {
                callback: e,
                callbackContext: i
            }; else for (var s = 0, o = t.length; s < o; s++) null === e ? delete this.layers[n].callbacks[t[s]] : this.layers[n].callbacks[t[s]] = {
                callback: e,
                callbackContext: i
            };
        },
        setTileLocationCallback: function(t, e, i, n, s, o, a) {
            if (a = this.getLayer(a), this.copy(t, e, i, n, a), !(this._results.length < 2)) for (var r = 1; r < this._results.length; r++) this._results[r].setCollisionCallback(s, o);
        },
        setCollision: function(t, e, i, n) {
            if (void 0 === e && (e = !0), void 0 === n && (n = !0), i = this.getLayer(i), "number" == typeof t) return this.setCollisionByIndex(t, e, i, !0);
            if (Array.isArray(t)) {
                for (var s = 0; s < t.length; s++) this.setCollisionByIndex(t[s], e, i, !1);
                n && this.calculateFaces(i);
            }
        },
        setCollisionBetween: function(t, e, i, n, s) {
            if (void 0 === i && (i = !0), void 0 === s && (s = !0), n = this.getLayer(n), !(e < t)) {
                for (var o = t; o <= e; o++) this.setCollisionByIndex(o, i, n, !1);
                s && this.calculateFaces(n);
            }
        },
        setCollisionByExclusion: function(t, e, i, n) {
            void 0 === e && (e = !0), void 0 === n && (n = !0), i = this.getLayer(i);
            for (var s = 0, o = this.tiles.length; s < o; s++) -1 === t.indexOf(s) && this.setCollisionByIndex(s, e, i, !1);
            n && this.calculateFaces(i);
        },
        setCollisionByIndex: function(t, e, i, n) {
            if (void 0 === e && (e = !0), void 0 === i && (i = this.currentLayer), void 0 === n && (n = !0), 
            e) this.collideIndexes.push(t); else {
                var s = this.collideIndexes.indexOf(t);
                -1 < s && this.collideIndexes.splice(s, 1);
            }
            for (var o = 0; o < this.layers[i].height; o++) for (var a = 0; a < this.layers[i].width; a++) {
                var r = this.layers[i].data[o][a];
                r && r.index === t && (e ? r.setCollision(!0, !0, !0, !0) : r.resetCollision(), 
                r.faceTop = e, r.faceBottom = e, r.faceLeft = e, r.faceRight = e);
            }
            return n && this.calculateFaces(i), i;
        },
        getLayer: function(t) {
            if (void 0 === t) t = this.currentLayer; else if ("string" == typeof t) {
                t = this.getLayerIndex(t);
            } else t instanceof z.TilemapLayer && (t = t.index);
            return t;
        },
        setPreventRecalculate: function(t) {
            if (!0 === t && !0 !== this.preventingRecalculate && (this.preventingRecalculate = !0, 
            this.needToRecalculate = {}), !1 === t && !0 === this.preventingRecalculate) {
                for (var e in this.preventingRecalculate = !1, this.needToRecalculate) this.calculateFaces(e);
                this.needToRecalculate = !1;
            }
        },
        calculateFaces: function(t) {
            if (this.preventingRecalculate) this.needToRecalculate[t] = !0; else for (var e = null, i = null, n = null, s = null, o = 0, a = this.layers[t].height; o < a; o++) for (var r = 0, h = this.layers[t].width; r < h; r++) {
                var l = this.layers[t].data[o][r];
                l && (e = this.getTileAbove(t, r, o), i = this.getTileBelow(t, r, o), n = this.getTileLeft(t, r, o), 
                s = this.getTileRight(t, r, o), l.collides && (l.faceTop = !0, l.faceBottom = !0, 
                l.faceLeft = !0, l.faceRight = !0), e && e.collides && (l.faceTop = !1), i && i.collides && (l.faceBottom = !1), 
                n && n.collides && (l.faceLeft = !1), s && s.collides && (l.faceRight = !1));
            }
        },
        getTileAbove: function(t, e, i) {
            return 0 < i ? this.layers[t].data[i - 1][e] : null;
        },
        getTileBelow: function(t, e, i) {
            return i < this.layers[t].height - 1 ? this.layers[t].data[i + 1][e] : null;
        },
        getTileLeft: function(t, e, i) {
            return 0 < e ? this.layers[t].data[i][e - 1] : null;
        },
        getTileRight: function(t, e, i) {
            return e < this.layers[t].width - 1 ? this.layers[t].data[i][e + 1] : null;
        },
        setLayer: function(t) {
            t = this.getLayer(t), this.layers[t] && (this.currentLayer = t);
        },
        hasTile: function(t, e, i) {
            return i = this.getLayer(i), void 0 !== this.layers[i].data[e] && void 0 !== this.layers[i].data[e][t] && -1 < this.layers[i].data[e][t].index;
        },
        removeTile: function(t, e, i) {
            if (i = this.getLayer(i), 0 <= t && t < this.layers[i].width && 0 <= e && e < this.layers[i].height && this.hasTile(t, e, i)) {
                var n = this.layers[i].data[e][t];
                return this.layers[i].data[e][t] = new z.Tile(this.layers[i], -1, t, e, this.tileWidth, this.tileHeight), 
                this.layers[i].dirty = !0, this.calculateFaces(i), n;
            }
        },
        removeTileWorldXY: function(t, e, i, n, s) {
            return s = this.getLayer(s), t = this.game.math.snapToFloor(t, i) / i, e = this.game.math.snapToFloor(e, n) / n, 
            this.removeTile(t, e, s);
        },
        putTile: function(t, e, i, n) {
            return null === t ? this.removeTile(e, i, n) : (n = this.getLayer(n), 0 <= e && e < this.layers[n].width && 0 <= i && i < this.layers[n].height ? (t instanceof z.Tile ? (s = t.index, 
            this.hasTile(e, i, n) ? this.layers[n].data[i][e].copy(t) : this.layers[n].data[i][e] = new z.Tile(n, s, e, i, t.width, t.height)) : (s = t, 
            this.hasTile(e, i, n) ? this.layers[n].data[i][e].index = s : this.layers[n].data[i][e] = new z.Tile(this.layers[n], s, e, i, this.tileWidth, this.tileHeight)), 
            -1 < this.collideIndexes.indexOf(s) ? this.layers[n].data[i][e].setCollision(!0, !0, !0, !0) : this.layers[n].data[i][e].resetCollision(), 
            this.layers[n].dirty = !0, this.calculateFaces(n), this.layers[n].data[i][e]) : null);
            var s;
        },
        putTileWorldXY: function(t, e, i, n, s, o) {
            return o = this.getLayer(o), e = this.game.math.snapToFloor(e, n) / n, i = this.game.math.snapToFloor(i, s) / s, 
            this.putTile(t, e, i, o);
        },
        searchTileIndex: function(t, e, i, n) {
            void 0 === e && (e = 0), void 0 === i && (i = !1), n = this.getLayer(n);
            var s = 0;
            if (i) {
                for (var o = this.layers[n].height - 1; 0 <= o; o--) for (var a = this.layers[n].width - 1; 0 <= a; a--) if (this.layers[n].data[o][a].index === t) {
                    if (s === e) return this.layers[n].data[o][a];
                    s++;
                }
            } else for (o = 0; o < this.layers[n].height; o++) for (a = 0; a < this.layers[n].width; a++) if (this.layers[n].data[o][a].index === t) {
                if (s === e) return this.layers[n].data[o][a];
                s++;
            }
            return null;
        },
        getTile: function(t, e, i, n) {
            return void 0 === n && (n = !1), i = this.getLayer(i), 0 <= t && t < this.layers[i].width && 0 <= e && e < this.layers[i].height ? -1 === this.layers[i].data[e][t].index ? n ? this.layers[i].data[e][t] : null : this.layers[i].data[e][t] : null;
        },
        getTileWorldXY: function(t, e, i, n, s, o) {
            return void 0 === i && (i = this.tileWidth), void 0 === n && (n = this.tileHeight), 
            s = this.getLayer(s), t = this.game.math.snapToFloor(t, i) / i, e = this.game.math.snapToFloor(e, n) / n, 
            this.getTile(t, e, s, o);
        },
        copy: function(t, e, i, n, s) {
            if (s = this.getLayer(s), this.layers[s]) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = this.layers[s].width), 
                void 0 === n && (n = this.layers[s].height), t < 0 && (t = 0), e < 0 && (e = 0), 
                i > this.layers[s].width && (i = this.layers[s].width), n > this.layers[s].height && (n = this.layers[s].height), 
                this._results.length = 0, this._results.push({
                    x: t,
                    y: e,
                    width: i,
                    height: n,
                    layer: s
                });
                for (var o = e; o < e + n; o++) for (var a = t; a < t + i; a++) this._results.push(this.layers[s].data[o][a]);
                return this._results;
            }
            this._results.length = 0;
        },
        paste: function(t, e, i, n) {
            if (void 0 === t && (t = 0), void 0 === e && (e = 0), n = this.getLayer(n), i && !(i.length < 2)) {
                for (var s = t - i[1].x, o = e - i[1].y, a = 1; a < i.length; a++) this.layers[n].data[o + i[a].y][s + i[a].x].copy(i[a]);
                this.layers[n].dirty = !0, this.calculateFaces(n);
            }
        },
        swap: function(t, e, i, n, s, o, a) {
            a = this.getLayer(a), this.copy(i, n, s, o, a), this._results.length < 2 || (this._tempA = t, 
            this._tempB = e, this._results.forEach(this.swapHandler, this), this.paste(i, n, this._results, a));
        },
        swapHandler: function(t) {
            t.index === this._tempA ? t.index = this._tempB : t.index === this._tempB && (t.index = this._tempA);
        },
        forEach: function(t, e, i, n, s, o, a) {
            a = this.getLayer(a), this.copy(i, n, s, o, a), this._results.length < 2 || (this._results.forEach(t, e), 
            this.paste(i, n, this._results, a));
        },
        replace: function(t, e, i, n, s, o, a) {
            if (a = this.getLayer(a), this.copy(i, n, s, o, a), !(this._results.length < 2)) {
                for (var r = 1; r < this._results.length; r++) this._results[r].index === t && (this._results[r].index = e);
                this.paste(i, n, this._results, a);
            }
        },
        random: function(t, e, i, n, s) {
            if (s = this.getLayer(s), this.copy(t, e, i, n, s), !(this._results.length < 2)) {
                for (var o = [], a = 1; a < this._results.length; a++) if (this._results[a].index) {
                    var r = this._results[a].index;
                    -1 === o.indexOf(r) && o.push(r);
                }
                for (var h = 1; h < this._results.length; h++) this._results[h].index = this.game.rnd.pick(o);
                this.paste(t, e, this._results, s);
            }
        },
        shuffle: function(t, e, i, n, s) {
            if (s = this.getLayer(s), this.copy(t, e, i, n, s), !(this._results.length < 2)) {
                for (var o = [], a = 1; a < this._results.length; a++) this._results[a].index && o.push(this._results[a].index);
                z.ArrayUtils.shuffle(o);
                for (var r = 1; r < this._results.length; r++) this._results[r].index = o[r - 1];
                this.paste(t, e, this._results, s);
            }
        },
        fill: function(t, e, i, n, s, o) {
            if (o = this.getLayer(o), this.copy(e, i, n, s, o), !(this._results.length < 2)) {
                for (var a = 1; a < this._results.length; a++) this._results[a].index = t;
                this.paste(e, i, this._results, o);
            }
        },
        removeAllLayers: function() {
            this.layers.length = 0, this.currentLayer = 0;
        },
        dump: function() {
            for (var t = "", e = [ "" ], i = 0; i < this.layers[this.currentLayer].height; i++) {
                for (var n = 0; n < this.layers[this.currentLayer].width; n++) t += "%c  ", 1 < this.layers[this.currentLayer].data[i][n] ? this.debugMap[this.layers[this.currentLayer].data[i][n]] ? e.push("background: " + this.debugMap[this.layers[this.currentLayer].data[i][n]]) : e.push("background: #ffffff") : e.push("background: rgb(0, 0, 0)");
                t += "\n";
            }
            e[0] = t;
        },
        destroy: function() {
            this.removeAllLayers(), this.data = [], this.game = null;
        }
    }, z.Tilemap.prototype.constructor = z.Tilemap, Object.defineProperty(z.Tilemap.prototype, "layer", {
        get: function() {
            return this.layers[this.currentLayer];
        },
        set: function(t) {
            t !== this.currentLayer && this.setLayer(t);
        }
    }), z.TilemapLayer = function(t, e, i, n, s) {
        n |= 0, s |= 0, z.Sprite.call(this, t, 0, 0), this.map = e, this.index = i, this.layer = e.layers[i], 
        this.canvas = z.CanvasPool.create(this, n, s), this.context = this.canvas.getContext("2d"), 
        this.setTexture(new PIXI.Texture(new PIXI.BaseTexture(this.canvas, null, this.game.resolution))), 
        this.type = z.TILEMAPLAYER, this.physicsType = z.TILEMAPLAYER, this.renderSettings = {
            enableScrollDelta: !0,
            overdrawRatio: .2,
            copyCanvas: null
        }, this.debug = !1, this.exists = !0, this.debugSettings = {
            missingImageFill: "rgb(255,255,255)",
            debuggedTileOverfill: "rgba(0,255,0,0.4)",
            forceFullRedraw: !0,
            debugAlpha: .5,
            facingEdgeStroke: "rgba(0,255,0,1)",
            collidingTileOverfill: "rgba(0,255,0,0.2)"
        }, this.scrollFactorX = 1, this.scrollFactorY = 1, this.dirty = !0, this.rayStepRate = 4, 
        this._wrap = !1, this._mc = {
            scrollX: 0,
            scrollY: 0,
            renderWidth: 0,
            renderHeight: 0,
            tileWidth: e.tileWidth,
            tileHeight: e.tileHeight,
            cw: e.tileWidth,
            ch: e.tileHeight,
            tilesets: []
        }, this._scrollX = 0, this._scrollY = 0, this.tileOffset = new z.Point(this.layer.offsetX || 0, this.layer.offsetY || 0), 
        this._results = [], t.device.canvasBitBltShift || (this.renderSettings.copyCanvas = z.TilemapLayer.ensureSharedCopyCanvas()), 
        this.fixedToCamera = !0;
    }, z.TilemapLayer.prototype = Object.create(z.Sprite.prototype), z.TilemapLayer.prototype.constructor = z.TilemapLayer, 
    z.TilemapLayer.prototype.preUpdateCore = z.Component.Core.preUpdate, z.TilemapLayer.sharedCopyCanvas = null, 
    z.TilemapLayer.ensureSharedCopyCanvas = function() {
        return this.sharedCopyCanvas || (this.sharedCopyCanvas = z.CanvasPool.create(this, 2, 2)), 
        this.sharedCopyCanvas;
    }, z.TilemapLayer.prototype.preUpdate = function() {
        return this.preUpdateCore();
    }, z.TilemapLayer.prototype.postUpdate = function() {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, 
        this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y), 
        this._scrollX = (this.game.camera.view.x - this.tileOffset.x) * this.scrollFactorX / this.scale.x, 
        this._scrollY = (this.game.camera.view.y - this.tileOffset.y) * this.scrollFactorY / this.scale.y;
    }, z.TilemapLayer.prototype._renderCanvas = function(t) {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, 
        this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y), 
        this._scrollX = (this.game.camera.view.x - this.tileOffset.x) * this.scrollFactorX / this.scale.x, 
        this._scrollY = (this.game.camera.view.y - this.tileOffset.y) * this.scrollFactorY / this.scale.y, 
        this.render(), PIXI.Sprite.prototype._renderCanvas.call(this, t);
    }, z.TilemapLayer.prototype._renderWebGL = function(t) {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, 
        this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y), 
        this._scrollX = (this.game.camera.view.x - this.tileOffset.x) * this.scrollFactorX / this.scale.x, 
        this._scrollY = (this.game.camera.view.y - this.tileOffset.y) * this.scrollFactorY / this.scale.y, 
        this.render(), PIXI.Sprite.prototype._renderWebGL.call(this, t);
    }, z.TilemapLayer.prototype.destroy = function() {
        z.CanvasPool.remove(this), z.Component.Destroy.prototype.destroy.call(this);
    }, z.TilemapLayer.prototype.resize = function(t, e) {
        this.canvas.width = t, this.canvas.height = e, this.texture.frame.resize(t, e), 
        this.texture.width = t, this.texture.height = e, this.texture.crop.width = t, this.texture.crop.height = e, 
        this.texture.baseTexture.width = t, this.texture.baseTexture.height = e, this.texture.baseTexture.dirty(), 
        this.texture.requiresUpdate = !0, this.texture._updateUvs(), this.dirty = !0;
    }, z.TilemapLayer.prototype.resizeWorld = function() {
        this.game.world.setBounds(0, 0, this.layer.widthInPixels * this.scale.x, this.layer.heightInPixels * this.scale.y);
    }, z.TilemapLayer.prototype.getTileOffsetX = function() {
        return this.tileOffset.x || (this.fixedToCamera ? 0 : this.position.x);
    }, z.TilemapLayer.prototype.getTileOffsetY = function() {
        return this.tileOffset.y || (this.fixedToCamera ? 0 : this.position.y);
    }, z.TilemapLayer.prototype._fixX = function(t) {
        return 1 === this.scrollFactorX || 0 === this.scrollFactorX && 0 === this.position.x ? t : 0 === this.scrollFactorX && 0 !== this.position.x ? t - this.position.x : this._scrollX + (t - this._scrollX / this.scrollFactorX);
    }, z.TilemapLayer.prototype._unfixX = function(t) {
        return 1 === this.scrollFactorX ? t : this._scrollX / this.scrollFactorX + (t - this._scrollX);
    }, z.TilemapLayer.prototype._fixY = function(t) {
        return 1 === this.scrollFactorY || 0 === this.scrollFactorY && 0 === this.position.y ? t : 0 === this.scrollFactorY && 0 !== this.position.y ? t - this.position.y : this._scrollY + (t - this._scrollY / this.scrollFactorY);
    }, z.TilemapLayer.prototype._unfixY = function(t) {
        return 1 === this.scrollFactorY ? t : this._scrollY / this.scrollFactorY + (t - this._scrollY);
    }, z.TilemapLayer.prototype.getTileX = function(t) {
        return Math.floor(this._fixX(t) / this._mc.tileWidth);
    }, z.TilemapLayer.prototype.getTileY = function(t) {
        return Math.floor(this._fixY(t) / this._mc.tileHeight);
    }, z.TilemapLayer.prototype.getTileXY = function(t, e, i) {
        return i.x = this.getTileX(t), i.y = this.getTileY(e), i;
    }, z.TilemapLayer.prototype.getRayCastTiles = function(t, e, i, n) {
        e || (e = this.rayStepRate), void 0 === i && (i = !1), void 0 === n && (n = !1);
        var s = this.getTiles(t.x, t.y, t.width, t.height, i, n);
        if (0 === s.length) return [];
        for (var o = t.coordinatesOnLine(e), a = [], r = 0; r < s.length; r++) for (var h = 0; h < o.length; h++) {
            var l = s[r], c = o[h];
            if (l.containsPoint(c[0], c[1])) {
                a.push(l);
                break;
            }
        }
        return a;
    }, z.TilemapLayer.prototype.getTiles = function(t, e, i, n, s, o) {
        void 0 === s && (s = !1), void 0 === o && (o = !1);
        var a = !(s || o);
        t = this._fixX(t), e = this._fixY(e);
        for (var r = Math.floor(t / (this._mc.cw * this.scale.x)), h = Math.floor(e / (this._mc.ch * this.scale.y)), l = Math.ceil((t + i) / (this._mc.cw * this.scale.x)) - r, c = Math.ceil((e + n) / (this._mc.ch * this.scale.y)) - h; this._results.length; ) this._results.pop();
        for (var u = h; u < h + c; u++) for (var d = r; d < r + l; d++) {
            var p = this.layer.data[u];
            p && p[d] && (a || p[d].isInteresting(s, o)) && this._results.push(p[d]);
        }
        return this._results.slice();
    }, z.TilemapLayer.prototype.resolveTileset = function(t) {
        var e = this._mc.tilesets;
        if (t < 2e3) for (;e.length < t; ) e.push(void 0);
        var i = this.map.tiles[t] && this.map.tiles[t][2];
        if (null !== i) {
            var n = this.map.tilesets[i];
            if (n && n.containsTileIndex(t)) return e[t] = n;
        }
        return e[t] = null;
    }, z.TilemapLayer.prototype.resetTilesetCache = function() {
        for (var t = this._mc.tilesets; t.length; ) t.pop();
    }, z.TilemapLayer.prototype.setScale = function(t, e) {
        t = t || 1, e = e || t;
        for (var i = 0; i < this.layer.data.length; i++) for (var n = this.layer.data[i], s = 0; s < n.length; s++) {
            var o = n[s];
            o.width = this.map.tileWidth * t, o.height = this.map.tileHeight * e, o.worldX = o.x * o.width, 
            o.worldY = o.y * o.height;
        }
        this.scale.setTo(t, e);
    }, z.TilemapLayer.prototype.shiftCanvas = function(t, e, i) {
        var n = t.canvas, s = n.width - Math.abs(e), o = n.height - Math.abs(i), a = 0, r = 0, h = e, l = i;
        e < 0 && (a = -e, h = 0), i < 0 && (r = -i, l = 0);
        var c = this.renderSettings.copyCanvas;
        if (c) {
            (c.width < s || c.height < o) && (c.width = s, c.height = o);
            var u = c.getContext("2d");
            u.clearRect(0, 0, s, o), u.drawImage(n, a, r, s, o, 0, 0, s, o), t.clearRect(h, l, s, o), 
            t.drawImage(c, 0, 0, s, o, h, l, s, o);
        } else t.save(), t.globalCompositeOperation = "copy", t.drawImage(n, a, r, s, o, h, l, s, o), 
        t.restore();
    }, z.TilemapLayer.prototype.renderRegion = function(t, e, i, n, s, o) {
        var a = this.context, r = this.layer.width, h = this.layer.height, l = this._mc.tileWidth, c = this._mc.tileHeight, u = this._mc.tilesets, d = NaN;
        this._wrap || (i <= s && (i = Math.max(0, i), s = Math.min(r - 1, s)), n <= o && (n = Math.max(0, n), 
        o = Math.min(h - 1, o)));
        var p, g, m, f, y, v, b = i * l - t, _ = (i + (1 << 20) * r) % r;
        for (f = (n + (1 << 20) * h) % h, v = o - n, g = n * c - e; 0 <= v; f++, v--, g += c) {
            h <= f && (f -= h);
            var S = this.layer.data[f];
            for (m = _, y = s - i, p = b; 0 <= y; m++, y--, p += l) {
                r <= m && (m -= r);
                var x = S[m];
                if (x && !(x.index < 0)) {
                    var w = x.index, A = u[w];
                    void 0 === A && (A = this.resolveTileset(w)), x.alpha === d || this.debug || (a.globalAlpha = x.alpha, 
                    d = x.alpha), A ? x.rotation || x.flipped ? (a.save(), a.translate(p + x.centerX, g + x.centerY), 
                    a.rotate(x.rotation), x.flipped && a.scale(-1, 1), A.draw(a, -x.centerX, -x.centerY, w), 
                    a.restore()) : A.draw(a, p, g, w) : this.debugSettings.missingImageFill && (a.fillStyle = this.debugSettings.missingImageFill, 
                    a.fillRect(p, g, l, c)), x.debug && this.debugSettings.debuggedTileOverfill && (a.fillStyle = this.debugSettings.debuggedTileOverfill, 
                    a.fillRect(p, g, l, c));
                }
            }
        }
    }, z.TilemapLayer.prototype.renderDeltaScroll = function(t, e) {
        var i = this._mc.scrollX, n = this._mc.scrollY, s = this.canvas.width, o = this.canvas.height, a = this._mc.tileWidth, r = this._mc.tileHeight, h = 0, l = -a, c = 0, u = -r;
        if (t < 0 ? (h = s + t, l = s - 1) : 0 < t && (l = t), e < 0 ? (c = o + e, u = o - 1) : 0 < e && (u = e), 
        this.shiftCanvas(this.context, t, e), h = Math.floor((h + i) / a), l = Math.floor((l + i) / a), 
        c = Math.floor((c + n) / r), u = Math.floor((u + n) / r), h <= l) {
            this.context.clearRect(h * a - i, 0, (l - h + 1) * a, o);
            var d = Math.floor((0 + n) / r), p = Math.floor((o - 1 + n) / r);
            this.renderRegion(i, n, h, d, l, p);
        }
        if (c <= u) {
            this.context.clearRect(0, c * r - n, s, (u - c + 1) * r);
            var g = Math.floor((0 + i) / a), m = Math.floor((s - 1 + i) / a);
            this.renderRegion(i, n, g, c, m, u);
        }
    }, z.TilemapLayer.prototype.renderFull = function() {
        var t = this._mc.scrollX, e = this._mc.scrollY, i = this.canvas.width, n = this.canvas.height, s = this._mc.tileWidth, o = this._mc.tileHeight, a = Math.floor(t / s), r = Math.floor((i - 1 + t) / s), h = Math.floor(e / o), l = Math.floor((n - 1 + e) / o);
        this.context.clearRect(0, 0, i, n), this.renderRegion(t, e, a, h, r, l);
    }, z.TilemapLayer.prototype.render = function() {
        var t = !1;
        if (this.visible) {
            (this.dirty || this.layer.dirty) && (t = !(this.layer.dirty = !1));
            var e = this.canvas.width, i = this.canvas.height, n = 0 | this._scrollX, s = 0 | this._scrollY, o = this._mc, a = o.scrollX - n, r = o.scrollY - s;
            if (t || 0 !== a || 0 !== r || o.renderWidth !== e || o.renderHeight !== i) return this.context.save(), 
            o.scrollX = n, o.scrollY = s, o.renderWidth === e && o.renderHeight === i || (o.renderWidth = e, 
            o.renderHeight = i), this.debug && (this.context.globalAlpha = this.debugSettings.debugAlpha, 
            this.debugSettings.forceFullRedraw && (t = !0)), !t && this.renderSettings.enableScrollDelta && Math.abs(a) + Math.abs(r) < Math.min(e, i) ? this.renderDeltaScroll(a, r) : this.renderFull(), 
            this.debug && (this.context.globalAlpha = 1, this.renderDebug()), this.texture.baseTexture.dirty(), 
            this.dirty = !1, this.context.restore(), !0;
        }
    }, z.TilemapLayer.prototype.renderDebug = function() {
        var t, e, i, n, s, o, a = this._mc.scrollX, r = this._mc.scrollY, h = this.context, l = this.canvas.width, c = this.canvas.height, u = this.layer.width, d = this.layer.height, p = this._mc.tileWidth, g = this._mc.tileHeight, m = Math.floor(a / p), f = Math.floor((l - 1 + a) / p), y = Math.floor(r / g), v = Math.floor((c - 1 + r) / g), b = m * p - a, _ = y * g - r, S = (m + (1 << 20) * u) % u, x = (y + (1 << 20) * d) % d;
        for (h.strokeStyle = this.debugSettings.facingEdgeStroke, n = x, o = v - y, e = _; 0 <= o; n++, 
        o--, e += g) {
            d <= n && (n -= d);
            var w = this.layer.data[n];
            for (i = S, s = f - m, t = b; 0 <= s; i++, s--, t += p) {
                u <= i && (i -= u);
                var A = w[i];
                !A || A.index < 0 || !A.collides || (this.debugSettings.collidingTileOverfill && (h.fillStyle = this.debugSettings.collidingTileOverfill, 
                h.fillRect(t, e, this._mc.cw, this._mc.ch)), this.debugSettings.facingEdgeStroke && (h.beginPath(), 
                A.faceTop && (h.moveTo(t, e), h.lineTo(t + this._mc.cw, e)), A.faceBottom && (h.moveTo(t, e + this._mc.ch), 
                h.lineTo(t + this._mc.cw, e + this._mc.ch)), A.faceLeft && (h.moveTo(t, e), h.lineTo(t, e + this._mc.ch)), 
                A.faceRight && (h.moveTo(t + this._mc.cw, e), h.lineTo(t + this._mc.cw, e + this._mc.ch)), 
                h.closePath(), h.stroke()));
            }
        }
    }, Object.defineProperty(z.TilemapLayer.prototype, "wrap", {
        get: function() {
            return this._wrap;
        },
        set: function(t) {
            this._wrap = t, this.dirty = !0;
        }
    }), Object.defineProperty(z.TilemapLayer.prototype, "scrollX", {
        get: function() {
            return this._scrollX;
        },
        set: function(t) {
            this._scrollX = t;
        }
    }), Object.defineProperty(z.TilemapLayer.prototype, "scrollY", {
        get: function() {
            return this._scrollY;
        },
        set: function(t) {
            this._scrollY = t;
        }
    }), Object.defineProperty(z.TilemapLayer.prototype, "collisionWidth", {
        get: function() {
            return this._mc.cw;
        },
        set: function(t) {
            this._mc.cw = 0 | t, this.dirty = !0;
        }
    }), Object.defineProperty(z.TilemapLayer.prototype, "collisionHeight", {
        get: function() {
            return this._mc.ch;
        },
        set: function(t) {
            this._mc.ch = 0 | t, this.dirty = !0;
        }
    }), z.TilemapParser = {
        INSERT_NULL: !1,
        parse: function(t, e, i, n, s, o) {
            if (void 0 === i && (i = 32), void 0 === n && (n = 32), void 0 === s && (s = 10), 
            void 0 === o && (o = 10), void 0 === e) return this.getEmptyData();
            if (null === e) return this.getEmptyData(i, n, s, o);
            var a = t.cache.getTilemapData(e);
            if (a) {
                if (a.format === z.Tilemap.CSV) return this.parseCSV(e, a.data, i, n);
                if (!a.format || a.format === z.Tilemap.TILED_JSON) return this.parseTiledJSON(a.data);
            }
        },
        parseCSV: function(t, e, i, n) {
            for (var s = this.getEmptyData(), o = [], a = (e = e.trim()).split("\n"), r = a.length, h = 0, l = 0; l < a.length; l++) {
                o[l] = [];
                for (var c = a[l].split(","), u = 0; u < c.length; u++) o[l][u] = new z.Tile(s.layers[0], parseInt(c[u], 10), u, l, i, n);
                0 === h && (h = c.length);
            }
            return s.format = z.Tilemap.CSV, s.name = t, s.width = h, s.height = r, s.tileWidth = i, 
            s.tileHeight = n, s.widthInPixels = h * i, s.heightInPixels = r * n, s.layers[0].width = h, 
            s.layers[0].height = r, s.layers[0].widthInPixels = s.widthInPixels, s.layers[0].heightInPixels = s.heightInPixels, 
            s.layers[0].data = o, s;
        },
        getEmptyData: function(t, e, i, n) {
            return {
                width: null != i ? i : 0,
                height: null != n ? n : 0,
                tileWidth: null != t ? t : 0,
                tileHeight: null != e ? e : 0,
                orientation: "orthogonal",
                version: "1",
                properties: {},
                widthInPixels: 0,
                heightInPixels: 0,
                layers: [ {
                    name: "layer",
                    x: 0,
                    y: 0,
                    width: 0,
                    height: 0,
                    widthInPixels: 0,
                    heightInPixels: 0,
                    alpha: 1,
                    visible: !0,
                    properties: {},
                    indexes: [],
                    callbacks: [],
                    bodies: [],
                    data: []
                } ],
                images: [],
                objects: {},
                collision: {},
                tilesets: [],
                tiles: []
            };
        },
        _slice: function(t, e) {
            var i = {};
            for (var n in e) {
                var s = e[n];
                void 0 !== t[s] && (i[s] = t[s]);
            }
            return i;
        },
        parseObjectGroup: function(t, e, i, n, s) {
            n = n || t.name, s = s || {
                x: 0,
                y: 0
            };
            var o = this._slice;
            void 0 === s.x || s.y, e[n] = e[n] || [], i[n] = i[n] || [];
            for (var a = 0, r = t.objects.length; a < r; a++) {
                var h = t.objects[a];
                if (h.gid) {
                    var l = {
                        gid: h.gid,
                        name: h.name,
                        type: h.type || "",
                        x: h.x + s.x,
                        y: h.y + s.y,
                        width: h.width,
                        height: h.height,
                        visible: h.visible,
                        properties: h.properties
                    };
                    h.rotation && (l.rotation = h.rotation), e[n].push(l);
                } else if (h.polyline) {
                    l = {
                        name: h.name,
                        type: h.type,
                        x: h.x + s.x,
                        y: h.y + s.y,
                        width: h.width,
                        height: h.height,
                        visible: h.visible,
                        properties: h.properties
                    };
                    h.rotation && (l.rotation = h.rotation), l.polyline = [];
                    for (var c = 0; c < h.polyline.length; c++) l.polyline.push([ h.polyline[c].x, h.polyline[c].y ]);
                    i[n].push(l), e[n].push(l);
                } else if (h.polygon) {
                    (l = o(h, [ "name", "type", "x", "y", "visible", "rotation", "properties" ])).x += s.x, 
                    l.y += s.y, l.polygon = [];
                    for (c = 0; c < h.polygon.length; c++) l.polygon.push([ h.polygon[c].x, h.polygon[c].y ]);
                    i[n].push(l), e[n].push(l);
                } else if (h.ellipse) {
                    (l = o(h, [ "name", "type", "ellipse", "x", "y", "width", "height", "visible", "rotation", "properties" ])).x += s.x, 
                    l.y += s.y, i[n].push(l), e[n].push(l);
                } else {
                    (l = o(h, [ "name", "type", "x", "y", "width", "height", "visible", "rotation", "properties" ])).x += s.x, 
                    l.y += s.y, l.rectangle = !0, i[n].push(l), e[n].push(l);
                }
            }
            return {
                objectsCollection: e,
                collisionCollection: i
            };
        },
        parseTiledJSON: function(t) {
            if ("orthogonal" !== t.orientation) return null;
            t.version;
            for (var e = {
                width: t.width,
                height: t.height,
                tileWidth: t.tilewidth,
                tileHeight: t.tileheight,
                orientation: t.orientation,
                format: z.Tilemap.TILED_JSON,
                version: t.version,
                properties: t.properties,
                widthInPixels: t.width * t.tilewidth,
                heightInPixels: t.height * t.tileheight
            }, i = [], n = 0; n < t.layers.length; n++) if ("tilelayer" === t.layers[n].type) {
                var s = t.layers[n];
                if (!s.compression && s.encoding && "base64" === s.encoding) {
                    for (var o = window.atob(s.data), a = o.length, r = new Array(a), h = 0; h < a; h += 4) r[h / 4] = (o.charCodeAt(h) | o.charCodeAt(h + 1) << 8 | o.charCodeAt(h + 2) << 16 | o.charCodeAt(h + 3) << 24) >>> 0;
                    s.data = r, delete s.encoding;
                } else if (s.compression) continue;
                var l = {
                    name: s.name,
                    x: s.x,
                    y: s.y,
                    width: s.width,
                    height: s.height,
                    widthInPixels: s.width * t.tilewidth,
                    heightInPixels: s.height * t.tileheight,
                    alpha: s.opacity,
                    offsetX: s.offsetx,
                    offsetY: s.offsety,
                    visible: s.visible,
                    properties: {},
                    indexes: [],
                    callbacks: [],
                    bodies: []
                };
                s.properties && (l.properties = s.properties);
                var c, u, d, p = 0, g = [], m = [], f = 0;
                for (a = s.data.length; f < a; f++) {
                    if (u = !1, d = c = 0, 536870912 < (T = s.data[f])) switch (2147483648 < T && (T -= 2147483648, 
                    d += 4), 1073741824 < T && (T -= 1073741824, d += 2), 536870912 < T && (T -= 536870912, 
                    d += 1), d) {
                      case 5:
                        c = Math.PI / 2;
                        break;

                      case 6:
                        c = Math.PI;
                        break;

                      case 3:
                        c = 3 * Math.PI / 2;
                        break;

                      case 4:
                        u = !(c = 0);
                        break;

                      case 7:
                        c = Math.PI / 2, u = !0;
                        break;

                      case 2:
                        c = Math.PI, u = !0;
                        break;

                      case 1:
                        c = 3 * Math.PI / 2, u = !0;
                    }
                    if (0 < T) (E = new z.Tile(l, T, p, m.length, t.tilewidth, t.tileheight)).rotation = c, 
                    E.flipped = u, 0 !== d && (E.flippedVal = d), g.push(E); else z.TilemapParser.INSERT_NULL ? g.push(null) : g.push(new z.Tile(l, -1, p, m.length, t.tilewidth, t.tileheight));
                    ++p === s.width && (m.push(g), p = 0, g = []);
                }
                l.data = m, i.push(l);
            }
            e.layers = i;
            var y = [];
            for (n = 0; n < t.layers.length; n++) if ("imagelayer" === t.layers[n].type) {
                var v = t.layers[n], b = {
                    name: v.name,
                    image: v.image,
                    x: v.x,
                    y: v.y,
                    alpha: v.opacity,
                    visible: v.visible,
                    properties: {}
                };
                v.properties && (b.properties = v.properties), y.push(b);
            }
            e.images = y;
            var _ = [], S = {}, x = [], w = null;
            for (n = 0; n < t.tilesets.length; n++) {
                if ((O = t.tilesets[n]).source) ; else if (O.image) {
                    var A = new z.Tileset(O.name, O.firstgid, O.tilewidth, O.tileheight, O.margin, O.spacing, O.properties);
                    O.tileproperties && (A.tileProperties = O.tileproperties), A.updateTileData(O.imagewidth, O.imageheight), 
                    _.push(A);
                } else {
                    if (!O.tiles) throw new Error("Tileset " + O.name + " has no `image` or `tiles` property.");
                    var P = new z.ImageCollection(O.name, O.firstgid, O.tilewidth, O.tileheight, O.margin, O.spacing, O.properties);
                    for (var C in O.tiles) {
                        b = O.tiles[C].image;
                        var T = O.firstgid + parseInt(C, 10);
                        P.addImage(T, b);
                    }
                    x.push(P);
                }
                for (var C in O.tiles) {
                    (R = O.tiles[C].objectgroup) && (S[parseInt(C, 10) + O.firstgid] = R);
                }
                w && (w.lastgid = O.firstgid - 1), w = O;
            }
            if (0 === _.length && 0 === x.length) throw new Error("This tilemap has no tilesets.");
            e.tilesets = _, e.imagecollections = x;
            var E, I, B = {}, L = {};
            for (n = 0; n < t.layers.length; n++) if ("objectgroup" === t.layers[n].type) {
                var R = t.layers[n];
                this.parseObjectGroup(R, B, L);
            }
            e.objects = B, e.collision = L, e.tiles = [];
            for (n = 0; n < e.tilesets.length; n++) {
                p = (O = e.tilesets[n]).tileMargin;
                var O, M = O.tileMargin, k = 0, D = 0, G = 0;
                for (f = O.firstgid; f < O.firstgid + O.total && (e.tiles[f] = [ p, M, n ], p += O.tileWidth + O.tileSpacing, 
                ++k !== O.total) && (++D !== O.columns || (p = O.tileMargin, M += O.tileHeight + O.tileSpacing, 
                D = 0, ++G !== O.rows)); f++) ;
            }
            for (n = 0; n < e.layers.length; n++) {
                L[(l = e.layers[n]).name] = [], O = null;
                for (h = 0; h < l.data.length; h++) {
                    g = l.data[h];
                    for (var U = 0; U < g.length; U++) {
                        if (!(null === (E = g[U]) || E.index < 0)) I = e.tiles[E.index][2], (O = e.tilesets[I]).tileProperties && O.tileProperties[E.index - O.firstgid] && (E.properties = z.Utils.mixin(O.tileProperties[E.index - O.firstgid], E.properties)), 
                        (R = S[E.index]) && this.parseObjectGroup(R, e.objects, e.collision, E.layer.name, {
                            x: E.worldX + R.x,
                            y: E.worldY + R.y
                        });
                    }
                }
            }
            return e;
        }
    }, z.Tileset = function(t, e, i, n, s, o, a) {
        (void 0 === i || i <= 0) && (i = 32), (void 0 === n || n <= 0) && (n = 32), void 0 === s && (s = 0), 
        void 0 === o && (o = 0), this.name = t, this.firstgid = 0 | e, this.tileWidth = 0 | i, 
        this.tileHeight = 0 | n, this.tileMargin = 0 | s, this.tileSpacing = 0 | o, this.properties = a || {}, 
        this.image = null, this.rows = 0, this.columns = 0, this.total = 0, this.drawCoords = [];
    }, z.Tileset.prototype = {
        draw: function(t, e, i, n) {
            var s = n - this.firstgid << 1;
            0 <= s && s + 1 < this.drawCoords.length && t.drawImage(this.image, this.drawCoords[s], this.drawCoords[s + 1], this.tileWidth, this.tileHeight, e, i, this.tileWidth, this.tileHeight);
        },
        containsTileIndex: function(t) {
            return t >= this.firstgid && t < this.firstgid + this.total;
        },
        setImage: function(t) {
            this.image = t, this.updateTileData(t.width, t.height);
        },
        setSpacing: function(t, e) {
            this.tileMargin = 0 | t, this.tileSpacing = 0 | e, this.image && this.updateTileData(this.image.width, this.image.height);
        },
        updateTileData: function(t, e) {
            var i = (e - 2 * this.tileMargin + this.tileSpacing) / (this.tileHeight + this.tileSpacing), n = (t - 2 * this.tileMargin + this.tileSpacing) / (this.tileWidth + this.tileSpacing);
            i = Math.floor(i), n = Math.floor(n), this.rows && this.rows !== i || this.columns && this.columns, 
            this.rows = i, this.columns = n, this.total = i * n, this.drawCoords.length = 0;
            for (var s = this.tileMargin, o = this.tileMargin, a = 0; a < this.rows; a++) {
                for (var r = 0; r < this.columns; r++) this.drawCoords.push(s), this.drawCoords.push(o), 
                s += this.tileWidth + this.tileSpacing;
                s = this.tileMargin, o += this.tileHeight + this.tileSpacing;
            }
        }
    }, z.Tileset.prototype.constructor = z.Tileset, z.Particle = function(t, e, i, n, s) {
        z.Sprite.call(this, t, e, i, n, s), this.autoScale = !1, this.scaleData = null, 
        this._s = 0, this.autoAlpha = !1, this.alphaData = null, this._a = 0;
    }, z.Particle.prototype = Object.create(z.Sprite.prototype), z.Particle.prototype.constructor = z.Particle, 
    z.Particle.prototype.update = function() {
        this.autoScale && (this._s--, this._s ? this.scale.set(this.scaleData[this._s].x, this.scaleData[this._s].y) : this.autoScale = !1), 
        this.autoAlpha && (this._a--, this._a ? this.alpha = this.alphaData[this._a].v : this.autoAlpha = !1);
    }, z.Particle.prototype.onEmit = function() {}, z.Particle.prototype.setAlphaData = function(t) {
        this.alphaData = t, this._a = t.length - 1, this.alpha = this.alphaData[this._a].v, 
        this.autoAlpha = !0;
    }, z.Particle.prototype.setScaleData = function(t) {
        this.scaleData = t, this._s = t.length - 1, this.scale.set(this.scaleData[this._s].x, this.scaleData[this._s].y), 
        this.autoScale = !0;
    }, z.Particle.prototype.reset = function(t, e, i) {
        return z.Component.Reset.prototype.reset.call(this, t, e, i), this.alpha = 1, this.scale.set(1), 
        this.autoScale = !1, this.autoAlpha = !1, this;
    }, z.Particles = function(t) {
        this.game = t, this.emitters = {}, this.ID = 0;
    }, z.Particles.prototype = {
        add: function(t) {
            return this.emitters[t.id] = t;
        },
        remove: function(t) {
            delete this.emitters[t.id];
        }
    }, z.Particles.prototype.constructor = z.Particles, z.Particles.Arcade = {}, z.Particles.Arcade.Emitter = function(t, e, i, n) {
        this.maxParticles = n || 50, z.Group.call(this, t), this._id = this.game.particles.ID++, 
        this.name = "emitter" + this.id, this.type = z.EMITTER, this.physicsType = z.GROUP, 
        this.area = new z.Rectangle(e, i, 1, 1), this.minAngle = null, this.maxAngle = null, 
        this.minSpeed = 0, this.maxSpeed = 100, this.minParticleSpeed = new z.Point(-100, -100), 
        this.maxParticleSpeed = new z.Point(100, 100), this.minParticleScale = 1, this.maxParticleScale = 1, 
        this.scaleData = null, this.minRotation = -360, this.maxRotation = 360, this.minParticleAlpha = 1, 
        this.maxParticleAlpha = 1, this.alphaData = null, this.particleClass = z.Particle, 
        this.particleDrag = new z.Point(), this.angularDrag = 0, this.frequency = 100, this.lifespan = 2e3, 
        this.bounce = new z.Point(), this.on = !1, this.particleAnchor = new z.Point(.5, .5), 
        this.blendMode = z.blendModes.NORMAL, this.emitX = e, this.emitY = i, this.autoScale = !1, 
        this.autoAlpha = !1, this.particleBringToTop = !1, this.particleSendToBack = !1, 
        this.counts = {
            emitted: 0,
            failed: 0,
            totalEmitted: 0,
            totalFailed: 0
        }, this._gravity = new z.Point(0, 100), this._minParticleScale = new z.Point(1, 1), 
        this._maxParticleScale = new z.Point(1, 1), this._total = 0, this._timer = 0, this._counter = 0, 
        this._flowQuantity = 0, this._flowTotal = 0, this._explode = !0, this._frames = null;
    }, z.Particles.Arcade.Emitter.prototype = Object.create(z.Group.prototype), z.Particles.Arcade.Emitter.prototype.constructor = z.Particles.Arcade.Emitter, 
    z.Particles.Arcade.Emitter.prototype.update = function() {
        if (this.counts.emitted = 0, this.counts.failed = 0, this.on && this.game.time.time >= this._timer) if (this._timer = this.game.time.time + this.frequency * this.game.time.slowMotion, 
        0 !== this._flowTotal) if (0 < this._flowQuantity) {
            for (var t = 0; t < this._flowQuantity; t++) if (this.emitParticle() && (this._counter++, 
            -1 !== this._flowTotal && this._counter >= this._flowTotal)) {
                this.on = !1;
                break;
            }
        } else this.emitParticle() && (this._counter++, -1 !== this._flowTotal && this._counter >= this._flowTotal && (this.on = !1)); else this.emitParticle() && (this._counter++, 
        0 < this._total && this._counter >= this._total && (this.on = !1));
        for (t = this.children.length; t--; ) this.children[t].exists && this.children[t].update();
    }, z.Particles.Arcade.Emitter.prototype.makeParticles = function(t, e, i, n, s, o) {
        var a;
        void 0 === e && (e = 0), void 0 === i && (i = this.maxParticles), void 0 === n && (n = !1), 
        void 0 === s && (s = !1), void 0 === o && (o = null);
        var r = 0, h = t, l = e;
        for (this._frames = e, i > this.maxParticles && (this.maxParticles = i); r < i; ) Array.isArray(t) && (h = this.game.rnd.pick(t)), 
        Array.isArray(e) && (l = this.game.rnd.pick(e)), a = new this.particleClass(this.game, 0, 0, h, l, o), 
        this.game.physics.arcade.enable(a, !1), a.body.checkCollision.none = !n, a.body.collideWorldBounds = s, 
        a.body.skipQuadTree = !0, a.exists = !1, a.visible = !1, a.anchor.copyFrom(this.particleAnchor), 
        this.add(a), r++;
        return this;
    }, z.Particles.Arcade.Emitter.prototype.kill = function() {
        return this.on = !1, this.alive = !1, this.exists = !1, this;
    }, z.Particles.Arcade.Emitter.prototype.revive = function() {
        return this.alive = !0, this.exists = !0, this;
    }, z.Particles.Arcade.Emitter.prototype.explode = function(t, e) {
        return void 0 === e && (e = this.maxParticles), this._flowTotal = 0, this.start(!0, t, 0, e, !1), 
        this;
    }, z.Particles.Arcade.Emitter.prototype.flow = function(t, e, i, n, s) {
        return null == e && (e = 250), void 0 !== i && 0 !== i || (i = 1), void 0 === n && (n = -1), 
        void 0 === s && (s = !0), i > this.maxParticles && (i = this.maxParticles), this._counter = 0, 
        this._flowQuantity = i, this._flowTotal = n, s ? (this.start(!0, t, e, i), this._counter += i, 
        this.on = !0, this._timer = this.game.time.time + e * this.game.time.slowMotion) : this.start(!1, t, e, i), 
        this;
    }, z.Particles.Arcade.Emitter.prototype.start = function(t, e, i, n, s) {
        if (void 0 === t && (t = !0), void 0 === e && (e = 0), null == i && (i = 250), void 0 === n && (n = 0), 
        void 0 === s && (s = !1), n > this.maxParticles && (n = this.maxParticles), this.revive(), 
        this.visible = !0, this.lifespan = e, this.frequency = i, t || s) for (var o = 0; o < n; o++) this.emitParticle(); else this.on = !0, 
        this._total = n, this._counter = 0, this._timer = this.game.time.time + i * this.game.time.slowMotion;
        return this;
    }, z.Particles.Arcade.Emitter.prototype.emitParticle = function(t, e, i, n) {
        void 0 === t && (t = null), void 0 === e && (e = null);
        var s = this.getNextParticle();
        if (null === s) return this.counts.failed++, this.counts.totalFailed++, !1;
        this.counts.emitted++, this.counts.totalEmitted++;
        var o = this.game.rnd;
        void 0 !== i && void 0 !== n ? s.loadTexture(i, n) : void 0 !== i && (s.loadTexture(i), 
        s.frame = Array.isArray(this._frames) ? o.pick(this._frames) : this._frames);
        var a = this.emitX, r = this.emitY;
        return null !== t ? a = t : 1 < this.width && (a = o.between(this.left, this.right)), 
        null !== e ? r = e : 1 < this.height && (r = o.between(this.top, this.bottom)), 
        this.resetParticle(s, a, r), !0;
    }, z.Particles.Arcade.Emitter.prototype.getNextParticle = function() {
        for (var t = this.length; t--; ) {
            var e = this.next();
            if (!e.exists) return e;
        }
        return null;
    }, z.Particles.Arcade.Emitter.prototype.resetParticle = function(t, e, i) {
        var n = this.game.rnd;
        t.reset(e, i), t.angle = 0, t.lifespan = this.lifespan, this.particleBringToTop ? this.bringToTop(t) : this.particleSendToBack && this.sendToBack(t), 
        this.autoScale ? t.setScaleData(this.scaleData) : 1 !== this.minParticleScale || 1 !== this.maxParticleScale ? t.scale.set(n.realInRange(this.minParticleScale, this.maxParticleScale)) : this._minParticleScale.x !== this._maxParticleScale.x || this._minParticleScale.y !== this._maxParticleScale.y ? t.scale.set(n.realInRange(this._minParticleScale.x, this._maxParticleScale.x), n.realInRange(this._minParticleScale.y, this._maxParticleScale.y)) : t.scale.set(this._minParticleScale.x, this._minParticleScale.y), 
        this.autoAlpha ? t.setAlphaData(this.alphaData) : t.alpha = n.realInRange(this.minParticleAlpha, this.maxParticleAlpha), 
        t.blendMode = this.blendMode;
        var s = t.body;
        s.updateBounds(), s.bounce.copyFrom(this.bounce), s.drag.copyFrom(this.particleDrag), 
        null != this.minAngle && null != this.maxAngle ? this.game.physics.arcade.velocityFromAngle(this.minAngle === this.maxAngle ? this.minAngle : n.between(this.minAngle, this.maxAngle), this.minSpeed === this.maxSpeed ? this.minSpeed : n.between(this.minSpeed, this.maxSpeed), s.velocity) : (s.velocity.x = n.between(this.minParticleSpeed.x, this.maxParticleSpeed.x), 
        s.velocity.y = n.between(this.minParticleSpeed.y, this.maxParticleSpeed.y)), s.angularVelocity = n.between(this.minRotation, this.maxRotation), 
        s.gravity.copyFrom(this.gravity), s.angularDrag = this.angularDrag, t.onEmit();
    }, z.Particles.Arcade.Emitter.prototype.destroy = function() {
        this.game.particles.remove(this), z.Group.prototype.destroy.call(this, !0, !1);
    }, z.Particles.Arcade.Emitter.prototype.setSize = function(t, e) {
        return this.area.width = t, this.area.height = e, this;
    }, z.Particles.Arcade.Emitter.prototype.setXSpeed = function(t, e) {
        return t = t || 0, e = e || 0, this.minParticleSpeed.x = t, this.maxParticleSpeed.x = e, 
        this;
    }, z.Particles.Arcade.Emitter.prototype.setYSpeed = function(t, e) {
        return t = t || 0, e = e || 0, this.minParticleSpeed.y = t, this.maxParticleSpeed.y = e, 
        this;
    }, z.Particles.Arcade.Emitter.prototype.setRotation = function(t, e) {
        return t = t || 0, e = e || 0, this.minRotation = t, this.maxRotation = e, this;
    }, z.Particles.Arcade.Emitter.prototype.setAlpha = function(t, e, i, n, s) {
        if (void 0 === t && (t = 1), void 0 === e && (e = 1), void 0 === i && (i = 0), void 0 === n && (n = z.Easing.Linear.None), 
        void 0 === s && (s = !1), this.minParticleAlpha = t, this.maxParticleAlpha = e, 
        this.autoAlpha = !1, 0 < i && t !== e) {
            var o = {
                v: t
            }, a = this.game.make.tween(o).to({
                v: e
            }, i, n);
            a.yoyo(s), this.alphaData = a.generateData(60), this.alphaData.reverse(), this.autoAlpha = !0;
        }
        return this;
    }, z.Particles.Arcade.Emitter.prototype.setScale = function(t, e, i, n, s, o, a) {
        if (void 0 === t && (t = 1), void 0 === e && (e = 1), void 0 === i && (i = 1), void 0 === n && (n = 1), 
        void 0 === s && (s = 0), void 0 === o && (o = z.Easing.Linear.None), void 0 === a && (a = !1), 
        this.minParticleScale = 1, this.maxParticleScale = 1, this._minParticleScale.set(t, i), 
        this._maxParticleScale.set(e, n), this.autoScale = !1, 0 < s && (t !== e || i !== n)) {
            var r = {
                x: t,
                y: i
            }, h = this.game.make.tween(r).to({
                x: e,
                y: n
            }, s, o);
            h.yoyo(a), this.scaleData = h.generateData(60), this.scaleData.reverse(), this.autoScale = !0;
        }
        return this;
    }, z.Particles.Arcade.Emitter.prototype.setAngle = function(t, e, i, n) {
        return this.minAngle = t, this.maxAngle = e, null != i && (this.minSpeed = i), null != n && (this.maxSpeed = n), 
        this;
    }, z.Particles.Arcade.Emitter.prototype.at = function(t) {
        return t.center ? (this.emitX = t.center.x, this.emitY = t.center.y) : (this.emitX = t.world.x + t.anchor.x * t.width, 
        this.emitY = t.world.y + t.anchor.y * t.height), this;
    }, Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "gravity", {
        get: function() {
            return this._gravity;
        },
        set: function(t) {
            "number" == typeof t ? this._gravity.y = t : this._gravity = t;
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "id", {
        get: function() {
            return this._id;
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "width", {
        get: function() {
            return this.area.width;
        },
        set: function(t) {
            this.area.width = t;
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "height", {
        get: function() {
            return this.area.height;
        },
        set: function(t) {
            this.area.height = t;
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "x", {
        get: function() {
            return this.emitX;
        },
        set: function(t) {
            this.emitX = t;
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "y", {
        get: function() {
            return this.emitY;
        },
        set: function(t) {
            this.emitY = t;
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "left", {
        get: function() {
            return Math.floor(this.x - this.area.width / 2);
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "right", {
        get: function() {
            return Math.floor(this.x + this.area.width / 2);
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "top", {
        get: function() {
            return Math.floor(this.y - this.area.height / 2);
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "bottom", {
        get: function() {
            return Math.floor(this.y + this.area.height / 2);
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "output", {
        get: function() {
            return 1e3 * this._flowQuantity / this.frequency;
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "lifespanOutput", {
        get: function() {
            return (0 === this.lifespan ? 1 / 0 : this.lifespan) * this._flowQuantity / this.frequency;
        }
    }), Object.defineProperty(z.Particles.Arcade.Emitter.prototype, "remainder", {
        get: function() {
            return this.maxParticles - this.lifespanOutput;
        }
    }), z.Weapon = function(t, e) {
        z.Plugin.call(this, t, e), this.bullets = null, this.autoExpandBulletsGroup = !1, 
        this.autofire = !1, this.shots = 0, this.fireLimit = 0, this.fireRate = 100, this.fireRateVariance = 0, 
        this.fireFrom = new z.Rectangle(0, 0, 1, 1), this.fireAngle = z.ANGLE_UP, this.bulletInheritSpriteSpeed = !1, 
        this.bulletAnimation = "", this.bulletFrameRandom = !1, this.bulletFrameCycle = !1, 
        this.bulletWorldWrap = !1, this.bulletWorldWrapPadding = 0, this.bulletAngleOffset = 0, 
        this.bulletAngleVariance = 0, this.bulletSpeed = 200, this.bulletSpeedVariance = 0, 
        this.bulletLifespan = 0, this.bulletKillDistance = 0, this.bulletGravity = new z.Point(0, 0), 
        this.bulletRotateToVelocity = !1, this.bulletKey = "", this.bulletFrame = "", this._bulletClass = z.Bullet, 
        this._bulletCollideWorldBounds = !1, this._bulletKillType = z.Weapon.KILL_WORLD_BOUNDS, 
        this._data = {
            customBody: !1,
            width: 0,
            height: 0,
            offsetX: 0,
            offsetY: 0
        }, this.bounds = new z.Rectangle(), this.bulletBounds = t.world.bounds, this.bulletFrames = [], 
        this.bulletFrameIndex = 0, this.anims = {}, this.onFire = new z.Signal(), this.onKill = new z.Signal(), 
        this.onFireLimit = new z.Signal(), this.trackedSprite = null, this.trackedPointer = null, 
        this.multiFire = !1, this._hasFired = !1, this.trackRotation = !1, this.trackOffset = new z.Point(), 
        this._nextFire = 0, this._tempNextFire = 0, this._rotatedPoint = new z.Point();
    }, z.Weapon.prototype = Object.create(z.Plugin.prototype), z.Weapon.prototype.constructor = z.Weapon, 
    z.Weapon.KILL_NEVER = 0, z.Weapon.KILL_LIFESPAN = 1, z.Weapon.KILL_DISTANCE = 2, 
    z.Weapon.KILL_WEAPON_BOUNDS = 3, z.Weapon.KILL_CAMERA_BOUNDS = 4, z.Weapon.KILL_WORLD_BOUNDS = 5, 
    z.Weapon.KILL_STATIC_BOUNDS = 6, z.Weapon.prototype.createBullets = function(t, e, i, n) {
        return void 0 === t && (t = 1), void 0 === n && (n = this.game.world), this.bullets && !this.bullets.game && (this.bullets = null), 
        this.bullets || (this.bullets = this.game.add.physicsGroup(z.Physics.ARCADE, n), 
        this.bullets.classType = this._bulletClass), 0 !== t && (-1 === t && (this.autoExpandBulletsGroup = !0, 
        t = 1), this.bullets.createMultiple(t, e, i), this.bullets.setAll("data.bulletManager", this), 
        this.bulletKey = e, this.bulletFrame = i), this;
    }, z.Weapon.prototype.forEach = function(t, e) {
        return this.bullets.forEachExists(t, e, arguments), this;
    }, z.Weapon.prototype.pauseAll = function() {
        return this.bullets.setAll("body.enable", !1), this;
    }, z.Weapon.prototype.resumeAll = function() {
        return this.bullets.setAll("body.enable", !0), this;
    }, z.Weapon.prototype.killAll = function() {
        return this.bullets.callAllExists("kill", !0), this.bullets.setAll("body.enable", !0), 
        this;
    }, z.Weapon.prototype.resetShots = function(t) {
        return void (this.shots = 0) !== t && (this.fireLimit = t), this;
    }, z.Weapon.prototype.destroy = function() {
        this.parent.remove(this, !1), this.bullets.destroy(), this.game = null, this.parent = null, 
        this.active = !1, this.visible = !1;
    }, z.Weapon.prototype.update = function() {
        this._bulletKillType === z.Weapon.KILL_WEAPON_BOUNDS && (this.trackedSprite ? (this.trackedSprite.updateTransform(), 
        this.bounds.centerOn(this.trackedSprite.worldPosition.x, this.trackedSprite.worldPosition.y)) : this.trackedPointer && this.bounds.centerOn(this.trackedPointer.worldX, this.trackedPointer.worldY)), 
        this.autofire && this.fire();
    }, z.Weapon.prototype.postRender = function() {
        this.multiFire && this._hasFired && (this._hasFired = !1, this._nextFire = this._tempNextFire);
    }, z.Weapon.prototype.trackSprite = function(t, e, i, n) {
        return void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = !1), 
        this.trackedPointer = null, this.trackedSprite = t, this.trackRotation = n, this.trackOffset.set(e, i), 
        this;
    }, z.Weapon.prototype.trackPointer = function(t, e, i) {
        return void 0 === t && (t = this.game.input.activePointer), void 0 === e && (e = 0), 
        void 0 === i && (i = 0), this.trackedPointer = t, this.trackedSprite = null, this.trackRotation = !1, 
        this.trackOffset.set(e, i), this;
    }, z.Weapon.prototype.fireMany = function(t, e) {
        this.multiFire = !0;
        var i = [], n = this;
        return e || this.trackedSprite || this.trackedPointer ? t.forEach(function(t) {
            i.push(n.fire(e, null, null, t.x, t.y));
        }) : t.forEach(function(t) {
            i.push(n.fire(t));
        }), i;
    }, z.Weapon.prototype.fireOffset = function(t, e) {
        return void 0 === t && (t = 0), void 0 === e && (e = 0), this.fire(null, null, null, t, e);
    }, z.Weapon.prototype.fire = function(t, e, i, n, s) {
        if (void 0 === e && (e = null), void 0 === i && (i = null), this.game.time.now < this._nextFire || 0 < this.fireLimit && this.shots === this.fireLimit) return null;
        var o = this.bulletSpeed;
        0 !== this.bulletSpeedVariance && (o += z.Math.between(-this.bulletSpeedVariance, this.bulletSpeedVariance)), 
        t ? 1 < this.fireFrom.width ? this.fireFrom.centerOn(t.x, t.y) : (this.fireFrom.x = t.x, 
        this.fireFrom.y = t.y) : this.trackedSprite ? (this.trackRotation ? (this._rotatedPoint.set(this.trackedSprite.world.x + this.trackOffset.x, this.trackedSprite.world.y + this.trackOffset.y), 
        this._rotatedPoint.rotate(this.trackedSprite.world.x, this.trackedSprite.world.y, this.trackedSprite.worldRotation), 
        1 < this.fireFrom.width ? this.fireFrom.centerOn(this._rotatedPoint.x, this._rotatedPoint.y) : (this.fireFrom.x = this._rotatedPoint.x, 
        this.fireFrom.y = this._rotatedPoint.y)) : 1 < this.fireFrom.width ? this.fireFrom.centerOn(this.trackedSprite.world.x + this.trackOffset.x, this.trackedSprite.world.y + this.trackOffset.y) : (this.fireFrom.x = this.trackedSprite.world.x + this.trackOffset.x, 
        this.fireFrom.y = this.trackedSprite.world.y + this.trackOffset.y), this.bulletInheritSpriteSpeed && (o += this.trackedSprite.body.speed)) : this.trackedPointer && (1 < this.fireFrom.width ? this.fireFrom.centerOn(this.trackedPointer.world.x + this.trackOffset.x, this.trackedPointer.world.y + this.trackOffset.y) : (this.fireFrom.x = this.trackedPointer.world.x + this.trackOffset.x, 
        this.fireFrom.y = this.trackedPointer.world.y + this.trackOffset.y)), void 0 !== n && (this.fireFrom.x += n), 
        void 0 !== s && (this.fireFrom.y += s);
        var a = 1 < this.fireFrom.width ? this.fireFrom.randomX : this.fireFrom.x, r = 1 < this.fireFrom.height ? this.fireFrom.randomY : this.fireFrom.y, h = this.trackRotation ? this.trackedSprite.angle : this.fireAngle;
        null !== e && null !== i && (h = this.game.math.radToDeg(Math.atan2(i - r, e - a))), 
        0 !== this.bulletAngleVariance && (h += z.Math.between(-this.bulletAngleVariance, this.bulletAngleVariance));
        var l = 0, c = 0;
        0 === h || 180 === h ? l = Math.cos(this.game.math.degToRad(h)) * o : (90 === h || 270 === h || (l = Math.cos(this.game.math.degToRad(h)) * o), 
        c = Math.sin(this.game.math.degToRad(h)) * o);
        var u = null;
        if (this.autoExpandBulletsGroup ? (u = this.bullets.getFirstExists(!1, !0, a, r, this.bulletKey, this.bulletFrame)).data.bulletManager = this : u = this.bullets.getFirstExists(!1), 
        u) {
            if (u.reset(a, r), u.data.fromX = a, u.data.fromY = r, u.data.killType = this.bulletKillType, 
            u.data.killDistance = this.bulletKillDistance, u.data.rotateToVelocity = this.bulletRotateToVelocity, 
            this.bulletKillType === z.Weapon.KILL_LIFESPAN && (u.lifespan = this.bulletLifespan), 
            u.angle = h + this.bulletAngleOffset, "" !== this.bulletAnimation) {
                if (null === u.animations.getAnimation(this.bulletAnimation)) {
                    var d = this.anims[this.bulletAnimation];
                    u.animations.add(d.name, d.frames, d.frameRate, d.loop, d.useNumericIndex);
                }
                u.animations.play(this.bulletAnimation);
            } else this.bulletFrameCycle ? (u.frame = this.bulletFrames[this.bulletFrameIndex], 
            this.bulletFrameIndex++, this.bulletFrameIndex >= this.bulletFrames.length && (this.bulletFrameIndex = 0)) : this.bulletFrameRandom && (u.frame = this.bulletFrames[Math.floor(Math.random() * this.bulletFrames.length)]);
            u.data.bodyDirty && (this._data.customBody && u.body.setSize(this._data.width, this._data.height, this._data.offsetX, this._data.offsetY), 
            u.body.collideWorldBounds = this.bulletCollideWorldBounds, u.data.bodyDirty = !1), 
            u.body.velocity.set(l, c), u.body.gravity.set(this.bulletGravity.x, this.bulletGravity.y);
            var p = 0;
            if (0 !== this.bulletSpeedVariance) {
                var g = this.fireRate;
                (g += z.Math.between(-this.fireRateVariance, this.fireRateVariance)) < 0 && (g = 0), 
                p = this.game.time.now + g;
            } else p = this.game.time.now + this.fireRate;
            this.multiFire ? this._hasFired || (this._hasFired = !0, this._tempNextFire = p, 
            this.shots++) : (this._nextFire = p, this.shots++), this.onFire.dispatch(u, this, o), 
            0 < this.fireLimit && this.shots === this.fireLimit && this.onFireLimit.dispatch(this, this.fireLimit);
        }
        return u;
    }, z.Weapon.prototype.fireAtPointer = function(t) {
        return void 0 === t && (t = this.game.input.activePointer), this.fire(null, t.worldX, t.worldY);
    }, z.Weapon.prototype.fireAtSprite = function(t) {
        return this.fire(null, t.world.x, t.world.y);
    }, z.Weapon.prototype.fireAtXY = function(t, e) {
        return this.fire(null, t, e);
    }, z.Weapon.prototype.setBulletBodyOffset = function(t, e, i, n) {
        return void 0 === i && (i = 0), void 0 === n && (n = 0), this._data.customBody = !0, 
        this._data.width = t, this._data.height = e, this._data.offsetX = i, this._data.offsetY = n, 
        this.bullets.callAll("body.setSize", "body", t, e, i, n), this.bullets.setAll("data.bodyDirty", !1), 
        this;
    }, z.Weapon.prototype.setBulletFrames = function(t, e, i, n) {
        return void 0 === i && (i = !0), void 0 === n && (n = !1), this.bulletFrames = z.ArrayUtils.numberArray(t, e), 
        this.bulletFrameIndex = 0, this.bulletFrameCycle = i, this.bulletFrameRandom = n, 
        this;
    }, z.Weapon.prototype.addBulletAnimation = function(t, e, i, n, s) {
        return this.anims[t] = {
            name: t,
            frames: e,
            frameRate: i,
            loop: n,
            useNumericIndex: s
        }, this.bullets.callAll("animations.add", "animations", t, e, i, n, s), this.bulletAnimation = t, 
        this;
    }, z.Weapon.prototype.debug = function(t, e, i) {
        void 0 === t && (t = 16), void 0 === e && (e = 32), void 0 === i && (i = !1), this.game.debug.text("Weapon Plugin", t, e), 
        this.game.debug.text("Bullets Alive: " + this.bullets.total + " - Total: " + this.bullets.length, t, e + 24), 
        i && this.bullets.forEachExists(this.game.debug.body, this.game.debug, "rgba(255, 0, 255, 0.8)");
    }, Object.defineProperty(z.Weapon.prototype, "bulletClass", {
        get: function() {
            return this._bulletClass;
        },
        set: function(t) {
            this._bulletClass = t, this.bullets && (this.bullets.classType = this._bulletClass);
        }
    }), Object.defineProperty(z.Weapon.prototype, "bulletKillType", {
        get: function() {
            return this._bulletKillType;
        },
        set: function(t) {
            switch (t) {
              case z.Weapon.KILL_STATIC_BOUNDS:
              case z.Weapon.KILL_WEAPON_BOUNDS:
                this.bulletBounds = this.bounds;
                break;

              case z.Weapon.KILL_CAMERA_BOUNDS:
                this.bulletBounds = this.game.camera.view;
                break;

              case z.Weapon.KILL_WORLD_BOUNDS:
                this.bulletBounds = this.game.world.bounds;
            }
            this._bulletKillType = t;
        }
    }), Object.defineProperty(z.Weapon.prototype, "bulletCollideWorldBounds", {
        get: function() {
            return this._bulletCollideWorldBounds;
        },
        set: function(t) {
            this._bulletCollideWorldBounds = t, this.bullets.setAll("body.collideWorldBounds", t), 
            this.bullets.setAll("data.bodyDirty", !1);
        }
    }), Object.defineProperty(z.Weapon.prototype, "x", {
        get: function() {
            return this.fireFrom.x;
        },
        set: function(t) {
            this.fireFrom.x = t;
        }
    }), Object.defineProperty(z.Weapon.prototype, "y", {
        get: function() {
            return this.fireFrom.y;
        },
        set: function(t) {
            this.fireFrom.y = t;
        }
    }), z.Bullet = function(t, e, i, n, s) {
        z.Sprite.call(this, t, e, i, n, s), this.anchor.set(.5), this.data = {
            bulletManager: null,
            fromX: 0,
            fromY: 0,
            bodyDirty: !0,
            rotateToVelocity: !1,
            killType: 0,
            killDistance: 0
        };
    }, z.Bullet.prototype = Object.create(z.Sprite.prototype), z.Bullet.prototype.constructor = z.Bullet, 
    z.Bullet.prototype.kill = function() {
        return this.alive = !1, this.exists = !1, this.visible = !1, this.data.bulletManager.onKill.dispatch(this), 
        this;
    }, z.Bullet.prototype.update = function() {
        this.exists && (this.data.killType > z.Weapon.KILL_LIFESPAN && (this.data.killType === z.Weapon.KILL_DISTANCE ? this.game.physics.arcade.distanceToXY(this, this.data.fromX, this.data.fromY, !0) > this.data.killDistance && this.kill() : this.data.bulletManager.bulletBounds.intersects(this) || this.kill()), 
        this.data.rotateToVelocity && (this.rotation = this.body.velocity.atan()), this.data.bulletManager.bulletWorldWrap && this.game.world.wrap(this, this.data.bulletManager.bulletWorldWrapPadding));
    }, z.Video = function(t, e, i) {
        if (void 0 === e && (e = null), void 0 === i && (i = null), this.game = t, this.key = e, 
        this.width = 0, this.height = 0, this.type = z.VIDEO, this.disableTextureUpload = !1, 
        this.touchLocked = !1, this.onPlay = new z.Signal(), this.onChangeSource = new z.Signal(), 
        this.onComplete = new z.Signal(), this.onAccess = new z.Signal(), this.onError = new z.Signal(), 
        this.onTimeout = new z.Signal(), this.onTouchUnlock = new z.Signal(), this.playWhenUnlocked = !0, 
        this.timeout = 15e3, this._timeOutID = null, this.video = null, this.videoStream = null, 
        this.isStreaming = !1, this.retryLimit = 20, this.retry = 0, this.retryInterval = 500, 
        this._retryID = null, this._codeMuted = !1, this._muted = !1, this._codePaused = !1, 
        this._paused = !1, this._pending = !1, this._pendingChangeSource = !1, this._autoplay = !1, 
        this._endCallback = null, this._playCallback = null, e && this.game.cache.checkVideoKey(e)) {
            var n = this.game.cache.getVideo(e);
            n.isBlob ? this.createVideoFromBlob(n.data) : this.video = n.data, this.width = this.video.videoWidth, 
            this.height = this.video.videoHeight;
        } else i && this.createVideoFromURL(i, !1);
        this.video && !i ? this.baseTexture = new PIXI.BaseTexture(this.video, null, this.game.resolution) : this.baseTexture = new PIXI.BaseTexture(z.Cache.DEFAULT.baseTexture.source, null, this.game.resolution), 
        this.baseTexture.forceLoaded(this.width, this.height), this.texture = new PIXI.Texture(this.baseTexture), 
        this.textureFrame = new z.Frame(0, 0, 0, this.width, this.height, "video"), this.texture.setFrame(this.textureFrame), 
        this.texture.valid = !1, null !== e && this.video && (this.texture.valid = this.video.canplay), 
        this.snapshot = null, z.BitmapData && (this.snapshot = new z.BitmapData(this.game, "", this.width, this.height)), 
        this.game.device.needsTouchUnlock() ? this.setTouchLock() : n && (n.locked = !1);
    }, z.Video.prototype = {
        connectToMediaStream: function(t, e) {
            return t && e && (this.video = t, this.videoStream = e, this.isStreaming = !0, this.baseTexture.source = this.video, 
            this.updateTexture(null, this.video.videoWidth, this.video.videoHeight), this.onAccess.dispatch(this)), 
            this;
        },
        startMediaStream: function(t, e, i) {
            if (void 0 === t && (t = !1), void 0 === e && (e = null), void 0 === i && (i = null), 
            !this.game.device.getUserMedia) return this.onError.dispatch(this, "No getUserMedia"), 
            !1;
            null !== this.videoStream && (this.videoStream.active ? this.videoStream.active = !1 : this.videoStream.stop()), 
            this.removeVideoElement(), this.video = document.createElement("video"), this.video.setAttribute("autoplay", "autoplay"), 
            this.video.setAttribute("playsinline", "playsinline"), null !== e && (this.video.width = e), 
            null !== i && (this.video.height = i), this._timeOutID = window.setTimeout(this.getUserMediaTimeout.bind(this), this.timeout);
            try {
                navigator.getUserMedia({
                    audio: t,
                    video: !0
                }, this.getUserMediaSuccess.bind(this), this.getUserMediaError.bind(this));
            } catch (t) {
                this.getUserMediaError(t);
            }
            return this;
        },
        getUserMediaTimeout: function() {
            clearTimeout(this._timeOutID), this.onTimeout.dispatch(this);
        },
        getUserMediaError: function(t) {
            clearTimeout(this._timeOutID), this.onError.dispatch(this, t);
        },
        getUserMediaSuccess: function(t) {
            clearTimeout(this._timeOutID), this.videoStream = t, void 0 !== this.video.mozSrcObject ? this.video.mozSrcObject = t : void 0 !== this.video.srcObject ? this.video.srcObject = t : this.video.src = window.URL && window.URL.createObjectURL(t) || t;
            var s = this;
            this.video.onloadeddata = function() {
                var n = 10;
                !function t() {
                    if (0 < n) if (0 < s.video.videoWidth) {
                        var e = s.video.videoWidth, i = s.video.videoHeight;
                        isNaN(s.video.videoHeight) && (i = e / (4 / 3)), s.video.play(), s.isStreaming = !0, 
                        s.baseTexture.source = s.video, s.updateTexture(null, e, i), s.onAccess.dispatch(s);
                    } else window.setTimeout(t, 500);
                    n--;
                }();
            };
        },
        createVideoFromBlob: function(t) {
            var e = this;
            return this.video = document.createElement("video"), this.video.controls = !1, this.video.setAttribute("autoplay", "autoplay"), 
            this.video.setAttribute("playsinline", "playsinline"), this.video.addEventListener("loadeddata", function(t) {
                e.updateTexture(t);
            }, !0), this.video.src = window.URL.createObjectURL(t), this.video.canplay = !0, 
            this;
        },
        createVideoFromURL: function(t, e) {
            return void 0 === e && (e = !1), this.texture && (this.texture.valid = !1), this.video = document.createElement("video"), 
            this.video.controls = !1, e && this.video.setAttribute("autoplay", "autoplay"), 
            this.video.setAttribute("playsinline", "playsinline"), this.video.src = t, this.video.canplay = !0, 
            this.video.load(), this.retry = this.retryLimit, this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval), 
            this.key = t, this;
        },
        updateTexture: function(t, e, i) {
            var n = !1;
            null == e && (e = this.video.videoWidth, n = !0), null == i && (i = this.video.videoHeight), 
            this.width = e, this.height = i, this.baseTexture.source !== this.video && (this.baseTexture.source = this.video), 
            this.baseTexture.forceLoaded(e, i), this.texture.frame.resize(e, i), this.texture.width = e, 
            this.texture.height = i, this.texture.valid = !0, this.snapshot && this.snapshot.resize(e, i), 
            n && null !== this.key && (this.onChangeSource.dispatch(this, e, i), this._autoplay && (this.video.play(), 
            this.onPlay.dispatch(this, this.loop, this.playbackRate)));
        },
        complete: function() {
            this.onComplete.dispatch(this);
        },
        play: function(t, e) {
            return this._pendingChangeSource || (void 0 === t && (t = !1), void 0 === e && (e = 1), 
            this.game.sound.onMute && (this.game.sound.onMute.add(this.setMute, this), this.game.sound.onUnMute.add(this.unsetMute, this), 
            this.game.sound.mute && this.setMute()), this.game.onPause.add(this.setPause, this), 
            this.game.onResume.add(this.setResume, this), this._endCallback = this.complete.bind(this), 
            this.video.addEventListener("ended", this._endCallback, !0), this.video.addEventListener("webkitendfullscreen", this._endCallback, !0), 
            this.video.loop = t ? "loop" : "", this.video.playbackRate = e, this.touchLocked ? this._pending = !0 : (this._pending = !1, 
            null !== this.key && (4 !== this.video.readyState ? (this.retry = this.retryLimit, 
            this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval)) : (this._playCallback = this.playHandler.bind(this), 
            this.video.addEventListener("playing", this._playCallback, !0))), this.video.play(), 
            this.onPlay.dispatch(this, t, e))), this;
        },
        playHandler: function() {
            this.video.removeEventListener("playing", this._playCallback, !0), this.updateTexture();
        },
        stop: function() {
            return this.game.sound.onMute && (this.game.sound.onMute.remove(this.setMute, this), 
            this.game.sound.onUnMute.remove(this.unsetMute, this)), this.game.onPause.remove(this.setPause, this), 
            this.game.onResume.remove(this.setResume, this), this.isStreaming ? (this.video.mozSrcObject ? (this.video.mozSrcObject.stop(), 
            this.video.src = null) : this.video.srcObject ? (this.video.srcObject.stop(), this.video.src = null) : (this.video.src = "", 
            this.videoStream.active ? this.videoStream.active = !1 : this.videoStream.getTracks ? this.videoStream.getTracks().forEach(function(t) {
                t.stop();
            }) : this.videoStream.stop()), this.videoStream = null, this.isStreaming = !1) : (this.video.removeEventListener("ended", this._endCallback, !0), 
            this.video.removeEventListener("webkitendfullscreen", this._endCallback, !0), this.video.removeEventListener("playing", this._playCallback, !0), 
            this.touchLocked ? this._pending = !1 : this.video.pause()), this;
        },
        add: function(t) {
            if (Array.isArray(t)) for (var e = 0; e < t.length; e++) t[e].loadTexture && t[e].loadTexture(this); else t.loadTexture(this);
            return this;
        },
        addToWorld: function(t, e, i, n, s, o) {
            s = s || 1, o = o || 1;
            var a = this.game.add.image(t, e, this);
            return a.anchor.set(i, n), a.scale.set(s, o), a;
        },
        render: function() {
            !this.disableTextureUpload && this.playing && this.baseTexture.dirty();
        },
        setMute: function() {
            this._muted || (this._muted = !0, this.video.muted = !0);
        },
        unsetMute: function() {
            this._muted && !this._codeMuted && (this._muted = !1, this.video.muted = !1);
        },
        setPause: function() {
            this._paused || this.touchLocked || (this._paused = !0, this.video.pause());
        },
        setResume: function() {
            !this._paused || this._codePaused || this.touchLocked || (this._paused = !1, this.video.ended || this.video.play());
        },
        changeSource: function(t, e) {
            return void 0 === e && (e = !0), this.texture.valid = !1, this.video.pause(), this._pendingChangeSource = !0, 
            this.retry = this.retryLimit, this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval), 
            this.video.src = t, this.video.load(), (this._autoplay = e) || (this.paused = !0), 
            this;
        },
        checkVideoProgress: function() {
            4 === this.video.readyState ? (this._pendingChangeSource = !1, this.updateTexture()) : (this.retry--, 
            0 < this.retry && (this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval)));
        },
        setTouchLock: function() {
            this.game.input.addTouchLockCallback(this.unlock, this, !0), this.touchLocked = !0;
        },
        unlock: function() {
            if (this.touchLocked = !1, this.playWhenUnlocked && (this.video.play(), this.onPlay.dispatch(this, this.loop, this.playbackRate)), 
            this.key) {
                var t = this.game.cache.getVideo(this.key);
                t && !t.isBlob && (t.locked = !1);
            }
            return this.onTouchUnlock.dispatch(this), !0;
        },
        grab: function(t, e, i) {
            if (void 0 === t && (t = !1), void 0 === e && (e = 1), void 0 === i && (i = null), 
            null !== this.snapshot) return t && this.snapshot.cls(), this.snapshot.copy(this.video, 0, 0, this.width, this.height, 0, 0, this.width, this.height, 0, 0, 0, 1, 1, e, i), 
            this.snapshot;
        },
        removeVideoElement: function() {
            if (this.video) {
                for (this.video.parentNode && this.video.parentNode.removeChild(this.video); this.video.hasChildNodes(); ) this.video.removeChild(this.video.firstChild);
                this.video.removeAttribute("autoplay"), this.video.removeAttribute("src"), this.video = null;
            }
        },
        destroy: function() {
            this.stop(), this.removeVideoElement(), this.touchLocked && this.game.input.removeTouchLockCallback(this.unlock, this), 
            this._retryID && window.clearTimeout(this._retryID);
        }
    }, Object.defineProperty(z.Video.prototype, "currentTime", {
        get: function() {
            return this.video ? this.video.currentTime : 0;
        },
        set: function(t) {
            this.video.currentTime = t;
        }
    }), Object.defineProperty(z.Video.prototype, "duration", {
        get: function() {
            return this.video ? this.video.duration : 0;
        }
    }), Object.defineProperty(z.Video.prototype, "progress", {
        get: function() {
            return this.video ? this.video.currentTime / this.video.duration : 0;
        }
    }), Object.defineProperty(z.Video.prototype, "mute", {
        get: function() {
            return this._muted;
        },
        set: function(t) {
            if (t = t || null) {
                if (this._muted) return;
                this._codeMuted = !0, this.setMute();
            } else {
                if (!this._muted) return;
                this._codeMuted = !1, this.unsetMute();
            }
        }
    }), Object.defineProperty(z.Video.prototype, "paused", {
        get: function() {
            return this._paused;
        },
        set: function(t) {
            if (t = t || null, !this.touchLocked) if (t) {
                if (this._paused) return;
                this._codePaused = !0, this.setPause();
            } else {
                if (!this._paused) return;
                this._codePaused = !1, this.setResume();
            }
        }
    }), Object.defineProperty(z.Video.prototype, "volume", {
        get: function() {
            return this.video ? this.video.volume : 1;
        },
        set: function(t) {
            t < 0 ? t = 0 : 1 < t && (t = 1), this.video && (this.video.volume = t);
        }
    }), Object.defineProperty(z.Video.prototype, "playbackRate", {
        get: function() {
            return this.video ? this.video.playbackRate : 1;
        },
        set: function(t) {
            this.video && (this.video.playbackRate = t);
        }
    }), Object.defineProperty(z.Video.prototype, "loop", {
        get: function() {
            return !!this.video && this.video.loop;
        },
        set: function(t) {
            t && this.video ? this.video.loop = "loop" : this.video && (this.video.loop = "");
        }
    }), Object.defineProperty(z.Video.prototype, "playing", {
        get: function() {
            return !!this.video && !(this.video.paused && this.video.ended);
        }
    }), z.Video.prototype.constructor = z.Video, void 0 === PIXI.blendModes && (PIXI.blendModes = z.blendModes), 
    void 0 === PIXI.scaleModes && (PIXI.scaleModes = z.scaleModes), void 0 === PIXI.Texture.emptyTexture && (PIXI.Texture.emptyTexture = new PIXI.Texture(new PIXI.BaseTexture())), 
    void 0 === PIXI.DisplayObject._tempMatrix && (PIXI.DisplayObject._tempMatrix = new z.Matrix()), 
    PIXI.TextureSilentFail = !0, PIXI.canUseNewCanvasBlendModes = function() {
        return z.Device.canUseMultiply;
    }, "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = z), 
    exports.Phaser = z) : "undefined" != typeof define && define.amd ? define("Phaser", t.Phaser = z) : t.Phaser = z, 
    z;
}.call(this), Phaser.ParticleStorm = function(t, e) {
    Phaser.Plugin.call(this, t, e), this.emitters = [], this.dataList = {};
    var i = PIXI.canUseNewCanvasBlendModes();
    this.blendModeMap = {
        NORMAL: [ 0, "source-over" ],
        ADD: [ 1, "lighter" ],
        MULTIPLY: [ 2, i ? "multiply" : "source-over" ],
        SCREEN: [ 3, i ? "screen" : "source-over" ],
        OVERLAY: [ 4, i ? "overlay" : "source-over" ],
        DARKEN: [ 5, i ? "darken" : "source-over" ],
        LIGHTEN: [ 6, i ? "lighten" : "source-over" ],
        COLOR_DODGE: [ 7, i ? "color-dodge" : "source-over" ],
        COLOR_BURN: [ 8, i ? "color-burn" : "source-over" ],
        HARD_LIGHT: [ 9, i ? "hard-light" : "source-over" ],
        SOFT_LIGHT: [ 10, i ? "soft-light" : "source-over" ],
        DIFFERENCE: [ 11, i ? "difference" : "source-over" ],
        EXCLUSION: [ 12, i ? "exclusion" : "source-over" ],
        HUE: [ 13, i ? "hue" : "source-over" ],
        SATURATION: [ 14, i ? "saturation" : "source-over" ],
        COLOR: [ 15, i ? "color" : "source-over" ],
        LUMINOSITY: [ 16, i ? "luminosity" : "source-over" ]
    }, this.hsv = Phaser.Color.HSVColorWheel();
}, Phaser.ParticleStorm.prototype = Object.create(Phaser.Plugin.prototype), Phaser.ParticleStorm.prototype.constructor = Phaser.ParticleStorm, 
Phaser.ParticleStorm.SPRITE = "sprite", Phaser.ParticleStorm.PIXEL = "pixel", Phaser.ParticleStorm.RENDERTEXTURE = "render texture", 
Phaser.ParticleStorm.SPRITE_BATCH = "sprite batch", Phaser.ParticleStorm.BITMAP_DATA = "bitmap data", 
Phaser.ParticleStorm.BASE = {
    value: 0,
    initial: 0,
    delta: 0,
    offset: 0,
    control: null,
    calc: 0
}, Phaser.ParticleStorm.BASE_1 = {
    value: 1,
    initial: 0,
    delta: 0,
    offset: 0,
    control: null,
    calc: 1
}, Phaser.ParticleStorm.BASE_255 = {
    value: 0,
    initial: 0,
    delta: 0,
    offset: 0,
    min: 0,
    max: 255,
    control: null,
    calc: 0
}, Phaser.ParticleStorm.BASE_359 = {
    value: 0,
    initial: 0,
    delta: 0,
    offset: 0,
    min: 0,
    max: 359,
    control: null,
    calc: 0
}, Phaser.ParticleStorm.BASE_NULL = {
    value: null,
    initial: 0,
    delta: 0,
    offset: 0,
    control: null,
    calc: 0
}, Phaser.ParticleStorm.BASE_EMIT = {
    name: null,
    value: 0,
    initial: 0,
    control: null,
    at: null,
    inherit: !0,
    offsetX: 0,
    offsetY: 0
}, Phaser.ParticleStorm.Controls = {}, Phaser.ParticleStorm.Zones = {}, Phaser.ParticleStorm.prototype.createEmitter = function(t, e, i) {
    var n = new Phaser.ParticleStorm.Emitter(this, t, e, i);
    return this.emitters.push(n), n;
}, Phaser.ParticleStorm.prototype.removeEmitter = function(t) {
    for (var e = 0; e < this.emitters.length; e++) if (this.emitters[e] === t) return void this.emitters.splice(e, 1);
}, Phaser.ParticleStorm.prototype.addData = function(t, e) {
    if (void 0 === t) return this;
    if (Array.isArray(t)) for (var i = 0; i < t.length; i++) this.dataList[t[i]] = this.game.cache.getJSON(t[i]); else this.dataList[t] = void 0 !== e ? e : this.game.cache.getJSON(t);
    return this;
}, Phaser.ParticleStorm.prototype.getData = function(t) {
    return this.dataList[t];
}, Phaser.ParticleStorm.prototype.clearData = function(t) {
    if (void 0 === t) this.dataList = {}; else if (Array.isArray(t)) for (var e = 0; e < t.length; e++) delete this.dataList[t[e]]; else delete this.dataList[t];
    return this;
}, Phaser.ParticleStorm.prototype.cloneData = function(t, e) {
    if (void 0 === t) return this;
    if (Array.isArray(t)) for (var i = 0; i < t.length; i++) this.dataList[t[i]] = Phaser.Utils.extend(!0, this.game.cache.getJSON(t[i])); else this.dataList[t] = void 0 !== e ? Phaser.Utils.extend(!0, e) : Phaser.Utils.extend(!0, this.game.cache.getJSON(t));
    return this;
}, Phaser.ParticleStorm.prototype.createPointZone = function(t, e) {
    return new Phaser.ParticleStorm.Zones.Point(this.game, t, e);
}, Phaser.ParticleStorm.prototype.createLineZone = function(t, e, i, n) {
    return new Phaser.ParticleStorm.Zones.Line(this.game, t, e, i, n);
}, Phaser.ParticleStorm.prototype.createRectangleZone = function(t, e) {
    return new Phaser.ParticleStorm.Zones.Rectangle(this.game, t, e);
}, Phaser.ParticleStorm.prototype.createCircleZone = function(t) {
    return new Phaser.ParticleStorm.Zones.Circle(this.game, t);
}, Phaser.ParticleStorm.prototype.createEllipseZone = function(t, e) {
    return new Phaser.ParticleStorm.Zones.Ellipse(this.game, t, e);
}, Phaser.ParticleStorm.prototype.createLinearSplineZone = function(t, e, i) {
    return new Phaser.ParticleStorm.Zones.Spline(this.game, 0, t, e, i);
}, Phaser.ParticleStorm.prototype.createBezierSplineZone = function(t, e, i) {
    return new Phaser.ParticleStorm.Zones.Spline(this.game, 1, t, e, i);
}, Phaser.ParticleStorm.prototype.createCatmullSplineZone = function(t, e, i) {
    return new Phaser.ParticleStorm.Zones.Spline(this.game, 2, t, e, i);
}, Phaser.ParticleStorm.prototype.createSplineZone = function(t, e, i, n) {
    return new Phaser.ParticleStorm.Zones.Spline(this.game, t, e, i, n);
}, Phaser.ParticleStorm.prototype.createTextZone = function(t) {
    return new Phaser.ParticleStorm.Zones.Text(this.game, t);
}, Phaser.ParticleStorm.prototype.createImageZone = function(t) {
    return new Phaser.ParticleStorm.Zones.Image(this.game, t);
}, Phaser.ParticleStorm.prototype.update = function() {
    if (this.active) for (var t = 0; t < this.emitters.length; t++) this.emitters[t].enabled && !this.emitters[t].manualUpdate && this.emitters[t].update();
}, Phaser.ParticleStorm.Emitter = function(t, e, i, n) {
    this.game = t.game, this.parent = t, this.renderer = null, this.renderType = null, 
    this.graph = Phaser.ParticleStorm.Graph, this.enabled = !1, this.manualUpdate = !1, 
    this.scrollSpeed = new Phaser.Point(), this.force = new Phaser.Point(), this.onEmit = null, 
    this.onComplete = null, this.onKill = null, this.particleClass = Phaser.ParticleStorm.Particle, 
    this.timer = this.game.time.create(!1), this.timerEvent = null, this.list = [], 
    this.pool = [], this.batch = [], this.wells = [], this._rnd = new Phaser.Point(), 
    this._step = new Phaser.Point(), this._pCount = 0, this._delay = {
        enabled: !1,
        start: 0,
        inc: 0,
        visible: !1
    }, this.init(e, i, n);
}, Phaser.ParticleStorm.Emitter.prototype = {
    init: function(t, e, i) {
        void 0 === t && (t = Phaser.ParticleStorm.SPRITE);
        var n = this.game.width, s = this.game.height;
        switch (t) {
          case Phaser.ParticleStorm.SPRITE:
            this.renderer = new Phaser.ParticleStorm.Renderer.Sprite(this);
            break;

          case Phaser.ParticleStorm.PIXEL:
            this.renderer = new Phaser.ParticleStorm.Renderer.Pixel(this, n, s);
            break;

          case Phaser.ParticleStorm.RENDERTEXTURE:
            this.renderer = new Phaser.ParticleStorm.Renderer.RenderTexture(this, n, s);
            break;

          case Phaser.ParticleStorm.SPRITE_BATCH:
            this.renderer = new Phaser.ParticleStorm.Renderer.SpriteBatch(this);
            break;

          case Phaser.ParticleStorm.BITMAP_DATA:
            this.renderer = new Phaser.ParticleStorm.Renderer.BitmapData(this, n, s);
            break;

          default:
            return !1;
        }
        this.renderType = t, e && this.force.set(e.x, e.y), i && this.scrollSpeed.set(i.x, i.y), 
        this.list = [], this.pool = [], this.wells = [], this.enabled = !0;
    },
    addToWorld: function(t) {
        return void 0 === t && (t = this.game.world), this.renderer.addToWorld(t);
    },
    createGravityWell: function(t, e, i, n, s) {
        var o = new Phaser.ParticleStorm.GravityWell(this, t, e, i, n, s);
        return this.wells.push(o), o;
    },
    seed: function(t) {
        for (var e = 0; e < t; e++) {
            var i = new Phaser.ParticleStorm.Particle(this);
            this.pool.push(i);
        }
        return this;
    },
    emitDelayed: function(t, e, i, n, s) {
        return !this.enabled || !this.parent.dataList[e] || t <= 0 ? null : (this.timerEvent = this.timer.add(t, this.emit, this, e, i, n, s), 
        this.timer.start(), this.timerEvent);
    },
    emit: function(t, e, i, n) {
        if (!this.enabled || !this.parent.dataList[t]) return null;
        if (this.batch = [], this._pCount = 0, this._step.x = 0, void (this._step.y = 0) === e && (e = 0), 
        void 0 === i && (i = 0), !n) return this.emitParticle(t, e, i, null);
        var s = n.hasOwnProperty("total") ? n.total : 1;
        if (0 < n.xStep ? this._step.x = n.xStep : this._step.x = 0, 0 < n.yStep ? this._step.y = n.yStep : this._step.y = 0, 
        this._delay.enabled = !1, n.delay && (this._delay.enabled = !0, "number" == typeof n.delay ? (this._delay.start = n.delay, 
        this._delay.step = 0, this._delay.visible = !1) : (this._delay.start = n.delay.start ? n.delay.start : 0, 
        this._delay.step = n.delay.step ? n.delay.step : 0, this._delay.visible = !!n.delay.visible)), 
        n.zone) if (void 0 === n.random && void 0 === n.full && void 0 === n.percent || n.random) n.zone.emit(this, t, e, i, s, n.setAlpha, n.setColor); else if (void 0 !== n.percent || void 0 === n.full && n.random) {
            if (void 0 !== n.percent) {
                var o = 0;
                "number" == typeof n.percent ? o = n.percent : n.percent.hasOwnProperty("min") ? o = this.game.rnd.between(n.percent.min, n.percent.max) : n.percent.callback && (o = n.percent.callback.call(n.percent.context, this)), 
                n.zone.emitPercent(this, t, e, i, s, o);
            }
        } else n.zone.emitFull(this, t, e, i, n.step, n.spacing, n.setAlpha, n.setColor); else for (var a = 0; a < s; a++) this.emitParticle(t, e, i, null);
        if (n.radiate) for (var r = 0; r < this.batch.length; r++) this.batch[r].radiate(n.radiate.velocity, n.radiate.from, n.radiate.to); else if (n.radiateFrom) for (r = 0; r < this.batch.length; r++) this.batch[r].radiateFrom(n.radiateFrom.x, n.radiateFrom.y, n.radiateFrom.velocity);
        var h = n.hasOwnProperty("repeat") ? n.repeat : 0;
        if (0 !== h) {
            var l = n.hasOwnProperty("frequency") ? n.frequency : 250;
            delete n.repeat, -1 === h ? this.timerEvent = this.timer.loop(l, this.emit, this, t, e, i, n) : 0 < h && (this.timerEvent = this.timer.repeat(l, h, this.emit, this, t, e, i, n)), 
            this.timer.start();
        }
        return this._pCount = 0, this.batch;
    },
    emitParticle: function(t, e, i, n) {
        var s = this.pool.pop();
        return s || (s = new this.particleClass(this)), s.parent = n, Array.isArray(e) && (e = this.game.rnd.between(e[0], e[1])), 
        Array.isArray(i) && (i = this.game.rnd.between(i[0], i[1])), e += this._step.x * this._pCount, 
        i += this._step.y * this._pCount, s.reset(this.renderer, e, i, this.parent.dataList[t]), 
        s.alive ? (!n && this._delay.enabled && (s.delay += this._delay.start + this._pCount * this._delay.step, 
        s.delayVisible = this._delay.visible), this.list.push(s), this.batch.push(s), n || this._pCount++) : (s.kill(), 
        this.onKill && this.onKill.dispatch(this, s), this.pool.push(s)), s;
    },
    update: function() {
        var t = this.game.time.elapsed;
        this.renderer.preUpdate();
        for (var e = this.list.length - 1; 0 <= e; e--) {
            var i = this.list[e];
            i.ignoreScrollSpeed || (i.transform.x += this.scrollSpeed.x, i.transform.y += this.scrollSpeed.y);
            for (var n = 0; n < this.wells.length; n++) this.wells[n].active && this.wells[n].step(i);
            i.step(t, this.force) || (i.kill(), this.pool.push(i), this.list.splice(e, 1));
        }
        return this.renderer.postUpdate(), this.list.length;
    },
    updateFrequency: function(t, e, i, n) {
        if (t.at) {
            for (var s = 0, o = 0; o < t.at.length; o++) {
                var a = t.at[o];
                (a.time > i || 0 === a.time && 0 === i) && a.time <= n && (0 < a.value && a.value < 1 ? Math.random() < a.value && (s += 1) : s += a.value);
            }
            return s;
        }
        return this.graph.getParamArea(t, i, n) * e;
    },
    forEach: function(t, e) {
        if (arguments.length <= 2) for (var i = 0; i < this.list.length; i++) t.call(e, this.list[i]); else {
            var n = [ null ];
            for (i = 2; i < arguments.length; i++) n.push(arguments[i]);
            for (i = 0; i < this.list.length; i++) n[0] = this.list[i], t.apply(e, n);
        }
    },
    forEachNew: function(t, e) {
        if (0 !== this.batch.length) if (arguments.length <= 2) for (var i = 0; i < this.batch.length; i++) t.call(e, this.batch[i]); else {
            var n = [ null ];
            for (i = 2; i < arguments.length; i++) n.push(arguments[i]);
            for (i = 0; i < this.batch.length; i++) n[0] = this.batch[i], t.apply(e, n);
        }
    },
    getParticle: function(t) {
        return void 0 === t && (t = 0), this.list[t] ? this.list[t] : null;
    },
    debug: function(t, e) {
        var i = this.game.debug;
        if (i) {
            i.start(t + 4, e + 16, "rgb(255, 255, 255)", 132), i.context.fillStyle = "rgba(0, 74, 128, 0.5)", 
            i.context.fillRect(t, e, 360, 70);
            var n = this.force.x + "", s = this.force.y + "";
            i.line("Force:", n.substr(0, 8), s.substr(0, 8)), i.line("Scroll Speed:", this.scrollSpeed.x, this.scrollSpeed.y), 
            i.line("Alive:", "Dead:", "Total:"), i.line(this.alive, this.dead, this.total), 
            i.stop();
        }
    },
    destroy: function() {
        this.renderer.clear && this.renderer.clear(), this.renderer.destroy(), this.renderer = null;
        for (var t = this.list.length - 1; 0 <= t; t--) this.list[t].kill(), this.list.splice(t, 1);
        this.list = [], this.pool = [], this.batch = [], this.wells = [];
    }
}, Object.defineProperty(Phaser.ParticleStorm.Emitter.prototype, "paused", {
    get: function() {
        return !this.enabled;
    },
    set: function(t) {
        this.enabled = !t;
    }
}), Object.defineProperty(Phaser.ParticleStorm.Emitter.prototype, "total", {
    get: function() {
        return this.alive + this.dead;
    }
}), Object.defineProperty(Phaser.ParticleStorm.Emitter.prototype, "alive", {
    get: function() {
        return this.list.length;
    }
}), Object.defineProperty(Phaser.ParticleStorm.Emitter.prototype, "dead", {
    get: function() {
        return this.pool.length;
    }
}), Phaser.ParticleStorm.Emitter.prototype.constructor = Phaser.ParticleStorm.Emitter, 
Phaser.ParticleStorm.Particle = function(t) {
    this.emitter = t, this.renderer = null, this.graph = Phaser.ParticleStorm.Graph, 
    this.transform = new Phaser.ParticleStorm.Controls.Transform(this), this.color = new Phaser.ParticleStorm.Controls.Color(this), 
    this.texture = new Phaser.ParticleStorm.Controls.Texture(this), this.parent = null, 
    this.lifespan = 2e3, this.keepAlive = !1, this.delay = 0, this.delayVisible = !1, 
    this.life = 0, this.sprite = null, this.visible = !1, this.isComplete = !1, this.ignoreForce = !1, 
    this.ignoreScrollSpeed = !1, this.emit = {}, this._age = 0, this._lastPercent = 0, 
    this._numToEmit = 0;
}, Phaser.ParticleStorm.Particle.prototype = {
    reset: function(t, e, i, n) {
        return this.renderer = t, this.transform.reset(), this.color.reset(), this.texture.reset(), 
        this.emit = Object.create(Phaser.ParticleStorm.BASE_EMIT), this.isComplete = !1, 
        this.keepAlive = !1, this.delay = 0, this.delayVisible = !1, this.ignoreForce = !1, 
        this.ignoreScrollSpeed = !1, this.alive = !1, this.lifespan = 2e3, this.life = 0, 
        this.visible = !1, this._age = 0, this._lastPercent = 0, void (this._numToEmit = 0) !== n && this.create(e, i, n), 
        this;
    },
    create: function(t, e, i) {
        if (i.hasOwnProperty("lifespan") && (this.lifespan = this.graph.getMinMax(i.lifespan)), 
        this.keepAlive = i.keepAlive, i.hasOwnProperty("delay") && (this.delay = this.graph.getMinMax(i.delay)), 
        this.ignoreForce = i.ignoreForce, this.ignoreScrollSpeed = i.ignoreScrollSpeed, 
        this.transform.init(t, e, i), this.color.init(i), this.texture.init(i), i.emit && (this.emit = Object.create(i.emit)), 
        this.visible = !1 !== i.visible, this.alive = !0, this.parent && this.parent.emit && this.parent.emit.inherit && (this.alive = this.onInherit(this.parent)), 
        this.alive) {
            this.transform.step(), this.color.step();
            var n = this.renderer.add(this);
            n && this.texture.step(i, n), this.onEmit(), this.emitter.onEmit && this.emitter.onEmit.dispatch(this.emitter, this), 
            this.renderer.update(this);
        }
        return this;
    },
    step: function(t, e) {
        if (this._age += t, this.delay) {
            if (this._age < this.delay) return this.renderer.update(this), !0;
            this.delay = 0, this._age = 0;
        }
        if (this._lastPercent = this.life, 0 < this.lifespan && (this.life = Math.min(this._age / this.lifespan, 1)), 
        e && !this.ignoreForce && (this.transform.velocity.x.value += e.x, this.transform.velocity.y.value += e.y), 
        this.transform.step(), this.color.step(), this.onUpdate(), this.alive) {
            for (this._numToEmit += this.emitter.updateFrequency(this.emit, t, this._lastPercent, this.life); 1 <= this._numToEmit; ) this.emitChild();
            this.renderer.update(this);
        }
        return this.isComplete || 1 !== this.life || (this.isComplete = !0, this.emitter.onComplete && this.emitter.onComplete.dispatch(this.emitter, this)), 
        this.life < 1 || this.keepAlive;
    },
    emitChild: function() {
        var t = 0 | this.graph.getMinMax(this.emit.offsetX), e = 0 | this.graph.getMinMax(this.emit.offsetY);
        if (this.emit.rect) {
            var i = this.emit.rect;
            t = Math.random() * i.width + i.x, e = Math.random() * i.height + i.y;
        } else if (this.emit.circle) {
            var n = this.emit.circle;
            e = Math.random() * n * 2 - n;
            var s = Math.sqrt(n * n - e * e);
            t = Math.random() * s * 2 - s;
        }
        var o = this.emit.name;
        if ("string" != typeof o && (o = this.getChildKey(this.emit.name)), o) {
            var a = this.emitter.emitParticle(o, this.transform.x + t, this.transform.y + e, this);
            a && this.emit.overwrite && this.applyOverwrite(this.emit.overwrite, a);
        }
        this._numToEmit -= 1;
    },
    applyOverwrite: function(t, e) {
        return e;
    },
    getChildKey: function(t) {
        if (Array.isArray(t)) return this.emitter.game.rnd.pick(t);
        if (void 0 !== t.at && 0 < t.at.length) {
            for (var e = t.at[0].value, i = 0; i < t.at.length && !(t.at[i].time > this.life); i++) e = t.at[i].value;
            return e;
        }
        return null;
    },
    radiate: function(t, e, i) {
        void 0 === i && void 0 !== e ? i = e : (void 0 === e && (e = 0), void 0 === i && (i = 359));
        var n = t;
        t.hasOwnProperty("min") ? n = this.graph.getMinMax(t) : Array.isArray(t) && (n = parseFloat(this.emitter.game.rnd.pick(t), 10));
        var s = (Math.random() * (i - e) + e) * Math.PI / 180;
        return this.transform.velocity.x.value = Math.sin(s) * n, this.transform.velocity.y.value = -Math.cos(s) * n, 
        this;
    },
    radiateFrom: function(t, e, i) {
        var n = i;
        i.hasOwnProperty("min") ? n = this.graph.getMinMax(i) : Array.isArray(i) && (n = parseFloat(this.emitter.game.rnd.pick(i), 10));
        var s = this.transform.x - t, o = this.transform.y - e, a = Math.sqrt(s * s + o * o);
        return this.transform.velocity.x.value = s * n / a, this.transform.velocity.y.value = o * n / a, 
        this;
    },
    target: function(t) {
        var e = 0, i = 0, n = this.transform;
        if (t.x && (e = t.x), t.y && (i = t.y), t.zone) {
            var s = t.zone.getRandom();
            e += s.x, i += s.y;
        }
        var o = Math.atan2(i - n.y, e - n.x), a = n.x - e, r = n.y - i, h = Math.sqrt(a * a + r * r) / (this.lifespan / 1e3), l = Math.cos(o) * h * n.time.physicsElapsed, c = Math.sin(o) * h * n.time.physicsElapsed;
        return t.speed ? (this.graph.fromControl({
            value: 2 * l,
            control: t.speed
        }, n.velocity.x), this.graph.fromControl({
            value: 2 * c,
            control: t.speed
        }, n.velocity.y)) : (n.velocity.x.value = l, n.velocity.y.value = c), this;
    },
    setLife: function(t, e) {
        return this.lifespan = this.graph.getMinMax(t), this.life = 0, this._age = 0, this._lastPercent = 0, 
        this.isComplete = !1, this.keepAlive = e, this;
    },
    kill: function() {
        this.alive = !1, this.renderer.kill(this), this.onKill();
    },
    onEmit: function() {},
    onUpdate: function() {},
    onInherit: function() {
        return !0;
    },
    onKill: function() {}
}, Object.defineProperty(Phaser.ParticleStorm.Particle.prototype, "lifePercent", {
    get: function() {
        return Math.round(100 * this.life);
    }
}), Object.defineProperty(Phaser.ParticleStorm.Particle.prototype, "frequency", {
    get: function() {
        return this.emit.value;
    },
    set: function(t) {
        this.emit.value = t;
    }
}), Phaser.ParticleStorm.Particle.prototype.constructor = Phaser.ParticleStorm.Particle, 
Phaser.ParticleStorm.GravityWell = function(t, e, i, n, s, o) {
    void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === s && (s = 100), 
    void 0 === o && (o = 50), this.emitter = t, this.time = t.game.time, this.position = new Phaser.Point(e, i), 
    this.active = !0, this._gravity = o, this._power = 0, this._epsilon = 0, this.power = n, 
    this.epsilon = s;
}, Phaser.ParticleStorm.GravityWell.prototype = {
    step: function(t) {
        var e = this.position.x - t.transform.x, i = this.position.y - t.transform.y, n = e * e + i * i;
        if (0 !== n) {
            var s = Math.sqrt(n);
            n < this._epsilon && (n = this._epsilon);
            var o = this._power * this.time.elapsed / (n * s);
            t.transform.velocity.x.value += e * o, t.transform.velocity.y.value += i * o;
        }
    }
}, Object.defineProperty(Phaser.ParticleStorm.GravityWell.prototype, "epsilon", {
    get: function() {
        return Math.sqrt(this._epsilon);
    },
    set: function(t) {
        this._epsilon = t * t;
    }
}), Object.defineProperty(Phaser.ParticleStorm.GravityWell.prototype, "power", {
    get: function() {
        return this._power / this.gravity;
    },
    set: function(t) {
        this._power = t * this.gravity;
    }
}), Object.defineProperty(Phaser.ParticleStorm.GravityWell.prototype, "gravity", {
    get: function() {
        return this._gravity;
    },
    set: function(t) {
        var e = this.power;
        this._gravity = t, this.power = e;
    }
}), Phaser.ParticleStorm.GravityWell.prototype.constructor = Phaser.ParticleStorm.GravityWell, 
Phaser.ParticleStorm.Graph = {
    CONTROL_LINEAR: [ {
        x: 0,
        y: 1
    }, {
        x: 1,
        y: 0
    } ],
    CONTROL_REVERSE: [ {
        x: 0,
        y: 0
    }, {
        x: 1,
        y: 1
    } ],
    CONTROL_YOYO: [ {
        x: 0,
        y: 0
    }, {
        x: .5,
        y: 1
    }, {
        x: 1,
        y: 0
    } ],
    getControlValue: function(t, e) {
        var i = 0, n = t[i];
        if (n.x === e) return n.y;
        for (;n.x <= e; ) {
            if (i >= t.length - 1) return n.x;
            n = t[++i];
        }
        var s = t[i - 1];
        return s.y + (e - s.x) * (n.y - s.y) / (n.x - s.x);
    },
    getControlValues: function(t, e, i) {
        var n = [ {
            x: e,
            y: Phaser.ParticleStorm.Graph.getControlValue(t, e)
        } ];
        if (i <= e) return n;
        for (var s = 0; s < t.length; s++) if (t[s].x > e) {
            if (!(t[s].x < i)) break;
            n.push(t[s]);
        }
        return n.push({
            x: i,
            y: Phaser.ParticleStorm.Graph.getControlValue(t, i)
        }), n;
    },
    getParamArea: function(t, e, i) {
        return t.control ? t.value * Phaser.ParticleStorm.Graph.getControlArea(t.control, e, i) : t.value;
    },
    getControlArea: function(t, e, i) {
        var n = Phaser.ParticleStorm.Graph.getControlValues(t, e, i);
        if (i <= e) return n[0].y;
        for (var s = 1 < n.length ? 0 : n.y, o = n[0], a = 1; a < n.length; a++) {
            var r = n[a];
            s += .5 * (r.x - o.x) * (o.y + r.y), o = r;
        }
        return s;
    },
    getMinMaxInitial: function(t) {
        return void 0 !== t.initial ? Phaser.ParticleStorm.Graph.getMinMax(t.initial) : 0;
    },
    isNumeric: function(t) {
        return !isNaN(parseFloat(t)) && isFinite(t);
    },
    getMinMax: function(t) {
        return null != t && void 0 !== t.min && void 0 !== t.max ? t.min + Math.random() * (t.max - t.min) : t;
    },
    clone: function(t, e) {
        return e.value = t.value, e.initial = t.initial, e.delta = t.delta, e.offset = t.offset, 
        e.min = t.min, e.max = t.max, e.control = t.control, e;
    },
    fromControl: function(t, e) {
        void 0 !== t.value && (e.value = Phaser.ParticleStorm.Graph.getMinMax(t.value)), 
        t.control && ("linear" === t.control ? e.control = Phaser.ParticleStorm.Graph.CONTROL_LINEAR : "reverse" === t.control ? e.control = Phaser.ParticleStorm.Graph.CONTROL_REVERSE : "yoyo" === t.control ? e.control = Phaser.ParticleStorm.Graph.CONTROL_YOYO : e.control = t.control);
    },
    fromData: function(t, e) {
        return null != t && ("number" == typeof t ? e.value = t : (void 0 !== t.min ? e.value = Phaser.ParticleStorm.Graph.getMinMax(t) : void 0 !== t.value && (e.value = Phaser.ParticleStorm.Graph.getMinMax(t.value)), 
        void 0 !== t.initial && (e.initial = Phaser.ParticleStorm.Graph.getMinMax(t.initial)), 
        void 0 !== t.delta && (e.delta = Phaser.ParticleStorm.Graph.getMinMax(t.delta)), 
        void 0 !== t.offset && (e.offset = Phaser.ParticleStorm.Graph.getMinMax(t.offset)), 
        t.control && ("linear" === t.control ? e.control = Phaser.ParticleStorm.Graph.CONTROL_LINEAR : "reverse" === t.control ? e.control = Phaser.ParticleStorm.Graph.CONTROL_REVERSE : "yoyo" === t.control ? e.control = Phaser.ParticleStorm.Graph.CONTROL_YOYO : e.control = t.control)), 
        !0);
    },
    getValue: function(t, e) {
        if (!t.control || void 0 === e) return t.value;
        var i = t.control[0];
        if (i.x === e) return i.y;
        var n = t.control.length - 1, s = t.control[n];
        if (s.x === e) return s.y;
        for (n = 0; i.x <= e; ) {
            if (n >= t.control.length - 1) return i.y;
            i = t.control[++n];
        }
        var o = t.control[n - 1];
        return t.value * (o.y + (e - o.x) * (i.y - o.y) / (i.x - o.x));
    },
    getClampedValue: function(t, e) {
        return Phaser.Math.clamp(Math.floor(t.initial + this.getValue(t, e)), t.min, t.max);
    }
}, Phaser.ParticleStorm.Zones = {}, Phaser.ParticleStorm.Zones.Base = function(t) {
    this.game = t, this.active = !0, this.scale = new Phaser.Point(1, 1), this.alphaThreshold = 0, 
    this._rnd = new Phaser.Point();
}, Phaser.ParticleStorm.Zones.Base.prototype = {
    getRandom: function() {
        return this.shape === Phaser.Point ? this._rnd = this.shape : this.shape.random(this._rnd), 
        this._rnd.x *= this.scale.x, this._rnd.y *= this.scale.y, this._rnd;
    },
    emit: function(t, e, i, n, s) {
        Array.isArray(i) && (i = this.game.rnd.between(i[0], i[1])), Array.isArray(n) && (n = this.game.rnd.between(n[0], n[1]));
        for (var o = null, a = 0; a < s; a++) this.shape.random(this._rnd), o = t.emitParticle(e, i + this._rnd.x * this.scale.x, n + this._rnd.y * this.scale.y, null);
        return o;
    }
}, Phaser.ParticleStorm.Zones.Base.prototype.constructor = Phaser.ParticleStorm.Zones.Base, 
Phaser.ParticleStorm.Zones.Point = function(t, e, i) {
    Phaser.ParticleStorm.Zones.Base.call(this, t), this.shape = new Phaser.Point(e, i);
}, Phaser.ParticleStorm.Zones.Point.prototype = Object.create(Phaser.ParticleStorm.Zones.Base.prototype), 
Phaser.ParticleStorm.Zones.Point.prototype.constructor = Phaser.ParticleStorm.Zones.Point, 
Phaser.ParticleStorm.Zones.Rectangle = function(t, e, i) {
    Phaser.ParticleStorm.Zones.Base.call(this, t), this.shape = new Phaser.Rectangle(0, 0, e, i);
}, Phaser.ParticleStorm.Zones.Rectangle.prototype = Object.create(Phaser.ParticleStorm.Zones.Base.prototype), 
Phaser.ParticleStorm.Zones.Rectangle.prototype.constructor = Phaser.ParticleStorm.Zones.Rectangle, 
Phaser.ParticleStorm.Zones.Circle = function(t, e) {
    Phaser.ParticleStorm.Zones.Base.call(this, t), this.shape = new Phaser.Circle(0, 0, 2 * e);
}, Phaser.ParticleStorm.Zones.Circle.prototype = Object.create(Phaser.ParticleStorm.Zones.Base.prototype), 
Phaser.ParticleStorm.Zones.Circle.prototype.constructor = Phaser.ParticleStorm.Zones.Circle, 
Phaser.ParticleStorm.Zones.Ellipse = function(t, e, i) {
    Phaser.ParticleStorm.Zones.Base.call(this, t), this.shape = new Phaser.Ellipse(0, 0, e, i);
}, Phaser.ParticleStorm.Zones.Ellipse.prototype = Object.create(Phaser.ParticleStorm.Zones.Base.prototype), 
Phaser.ParticleStorm.Zones.Ellipse.prototype.constructor = Phaser.ParticleStorm.Zones.Ellipse, 
Phaser.ParticleStorm.Zones.Line = function(t, e, i, n, s) {
    Phaser.ParticleStorm.Zones.Base.call(this, t), this.shape = new Phaser.Line(e, i, n, s);
}, Phaser.ParticleStorm.Zones.Line.prototype = Object.create(Phaser.ParticleStorm.Zones.Base.prototype), 
Phaser.ParticleStorm.Zones.Line.prototype.constructor = Phaser.ParticleStorm.Zones.Line, 
Phaser.ParticleStorm.Zones.Spline = function(t, e, i, n, s) {
    void 0 === e && (e = 0), void 0 === i && (i = 1e3), void 0 === n && (n = !0), Phaser.ParticleStorm.Zones.Base.call(this, t), 
    this.math = this.game.math, this.points = {
        x: [],
        y: []
    }, this.path = [], this.resolution = i, this.mode = e, this.closed = n, this.mult = 0, 
    this.update(s);
}, Phaser.ParticleStorm.Zones.Spline.prototype = Object.create(Phaser.ParticleStorm.Zones.Base.prototype), 
Phaser.ParticleStorm.Zones.Spline.prototype.constructor = Phaser.ParticleStorm.Zones.Spline, 
Phaser.ParticleStorm.Zones.Spline.prototype.update = function(t) {
    this.points = {
        x: [],
        y: []
    }, this.path = [];
    for (var e = 0; e < t.length; e++) this.points.x.push(t[e].x), this.points.y.push(t[e].y);
    this.closed && (this.points.x.push(t[0].x), this.points.y.push(t[0].y));
    var i = 0, n = 1 / this.resolution;
    for (e = 0; e <= 1; e += n) {
        if (0 === this.mode) var s = this.math.linearInterpolation(this.points.x, e), o = this.math.linearInterpolation(this.points.y, e); else if (1 === this.mode) s = this.math.bezierInterpolation(this.points.x, e), 
        o = this.math.bezierInterpolation(this.points.y, e); else if (2 === this.mode) s = this.math.catmullRomInterpolation(this.points.x, e), 
        o = this.math.catmullRomInterpolation(this.points.y, e);
        var a = {
            x: s,
            y: o,
            angle: 0
        };
        0 < i && (a.angle = this.math.angleBetweenPoints(this.path[i - 1], a)), this.path.push(a), 
        i++;
    }
    return this.mult = this.path.length / 100, this;
}, Phaser.ParticleStorm.Zones.Spline.prototype.getRandom = function() {
    return this.game.rnd.pick(this.path);
}, Phaser.ParticleStorm.Zones.Spline.prototype.emit = function(t, e, i, n, s) {
    Array.isArray(i) && (i = this.game.rnd.between(i[0], i[1])), Array.isArray(n) && (n = this.game.rnd.between(n[0], n[1]));
    for (var o = null, a = null, r = 0; r < s; r++) o = this.game.rnd.pick(this.path), 
    a = t.emitParticle(e, i + o.x, n + o.y);
    return a;
}, Phaser.ParticleStorm.Zones.Spline.prototype.emitPercent = function(t, e, i, n, s, o) {
    Array.isArray(i) && (i = this.game.rnd.between(i[0], i[1])), Array.isArray(n) && (n = this.game.rnd.between(n[0], n[1]));
    var a = null;
    o = Math.floor(o * this.mult);
    for (var r = 0; r < s; r++) {
        var h = this.path[o];
        h && (a = t.emitParticle(e, i + h.x, n + h.y));
    }
    return a;
}, Phaser.ParticleStorm.Zones.Text = function(t, e) {
    Phaser.ParticleStorm.Zones.Base.call(this, t), this.bmd = new Phaser.BitmapData(t, "ParticleStorm.Text"), 
    this.text = e, this.points = [], this.update(e);
}, Phaser.ParticleStorm.Zones.Text.prototype = Object.create(Phaser.ParticleStorm.Zones.Base.prototype), 
Phaser.ParticleStorm.Zones.Text.prototype.constructor = Phaser.ParticleStorm.Zones.Text, 
Phaser.ParticleStorm.Zones.Text.prototype.update = function(t) {
    void 0 !== t ? this.text = t : t = this.text;
    var e = t.x, i = t.y, n = t.scale.x, s = t.scale.y;
    return t.x = 0, t.y = 0, t.scale.set(1), this.points = [], this.bmd.load(t), this.bmd.processPixelRGB(this.addPixel, this), 
    this.scale = new Phaser.Point(n, s), t.x = e, t.y = i, t.scale.set(n, s), this;
}, Phaser.ParticleStorm.Zones.Text.prototype.addPixel = function(t, e, i) {
    return t.a > this.alphaThreshold && this.points.push({
        x: e,
        y: i,
        color: {
            r: t.r,
            g: t.g,
            b: t.b,
            a: t.a / 255
        }
    }), !1;
}, Phaser.ParticleStorm.Zones.Text.prototype.getRandom = function() {
    var t = this.game.rnd.pick(this.points);
    return t.x *= this.scale.x, t.y *= this.scale.y, t;
}, Phaser.ParticleStorm.Zones.Text.prototype.emit = function(t, e, i, n, s, o, a) {
    Array.isArray(i) && (i = this.game.rnd.between(i[0], i[1])), Array.isArray(n) && (n = this.game.rnd.between(n[0], n[1]));
    for (var r = null, h = null, l = 0; l < s; l++) r = this.game.rnd.pick(this.points), 
    (h = t.emitParticle(e, i + r.x * this.scale.x, n + r.y * this.scale.y)) && (o && r.color.a < 1 && (h.color.alpha.value = r.color.a), 
    a && h.color.setColor(r.color.r, r.color.g, r.color.b, r.color.a));
    return h;
}, Phaser.ParticleStorm.Zones.Text.prototype.emitFull = function(t, e, i, n, s, o, a, r) {
    void 0 === s && (s = 1);
    var h = 1, l = 1;
    Array.isArray(o) ? (h = o[0], l = o[1]) : "number" == typeof o && (l = h = o), Array.isArray(i) && (i = this.game.rnd.between(i[0], i[1])), 
    Array.isArray(n) && (n = this.game.rnd.between(n[0], n[1]));
    for (var c = null, u = null, d = 0; d < this.points.length; d += s) {
        var p = i + (c = this.points[d]).x * this.scale.x * (h / s), g = n + c.y * this.scale.y * (l / s);
        (u = t.emitParticle(e, p, g)) && (a && c.color.a < 1 && (u.color.alpha.value = c.color.a), 
        r && u.color.setColor(c.color.r, c.color.g, c.color.b, c.color.a));
    }
    return u;
}, Phaser.ParticleStorm.Zones.Image = function(t, e) {
    Phaser.ParticleStorm.Zones.Base.call(this, t), this.bmd = new Phaser.BitmapData(t, "ParticleStorm.Image"), 
    this.key = e, this.points = [], this.update(e);
}, Phaser.ParticleStorm.Zones.Image.prototype = Object.create(Phaser.ParticleStorm.Zones.Base.prototype), 
Phaser.ParticleStorm.Zones.Image.prototype.constructor = Phaser.ParticleStorm.Zones.Image, 
Phaser.ParticleStorm.Zones.Image.prototype.update = function(t) {
    return void 0 === t && (t = this.key), this.points = [], this.bmd.load(t), this.bmd.processPixelRGB(this.addPixel, this), 
    this;
}, Phaser.ParticleStorm.Zones.Image.prototype.addPixel = function(t, e, i) {
    return t.a > this.alphaThreshold && this.points.push({
        x: e,
        y: i,
        color: {
            r: t.r,
            g: t.g,
            b: t.b,
            a: t.a / 255
        }
    }), !1;
}, Phaser.ParticleStorm.Zones.Image.prototype.getRandom = function() {
    var t = this.game.rnd.pick(this.points);
    return t.x *= this.scale.x, t.y *= this.scale.y, t;
}, Phaser.ParticleStorm.Zones.Image.prototype.emit = function(t, e, i, n, s, o, a) {
    Array.isArray(i) && (i = this.game.rnd.between(i[0], i[1])), Array.isArray(n) && (n = this.game.rnd.between(n[0], n[1]));
    for (var r = null, h = null, l = 0; l < s; l++) r = this.game.rnd.pick(this.points), 
    (h = t.emitParticle(e, i + r.x * this.scale.x, n + r.y * this.scale.y)) && (o && r.color.a < 1 && (h.color.alpha.value = r.color.a), 
    a && h.color.setColor(r.color.r, r.color.g, r.color.b, r.color.a));
    return h;
}, Phaser.ParticleStorm.Zones.Image.prototype.emitFull = function(t, e, i, n, s, o, a, r) {
    void 0 === s && (s = 1);
    var h = 1, l = 1;
    Array.isArray(o) ? (h = o[0], l = o[1]) : "number" == typeof o && (l = h = o), Array.isArray(i) && (i = this.game.rnd.between(i[0], i[1])), 
    Array.isArray(n) && (n = this.game.rnd.between(n[0], n[1]));
    for (var c = null, u = null, d = 0; d < this.points.length; d += s) {
        var p = i + (c = this.points[d]).x * this.scale.x * (h / s), g = n + c.y * this.scale.y * (l / s);
        (u = t.emitParticle(e, p, g)) && (a && c.color.a < 1 && (u.color.alpha.value = c.color.a), 
        r && u.color.setColor(c.color.r, c.color.g, c.color.b, c.color.a));
    }
    return u;
}, Phaser.ParticleStorm.Controls.Texture = function(t) {
    this.particle = t, this.rnd = t.emitter.game.rnd, this.graph = Phaser.ParticleStorm.Graph, 
    this.sendToBack = !1, this.bringToTop = !0, this.key = null, this.frame = void 0, 
    this.frameName = void 0, this.scaleMode = Phaser.scaleModes.DEFAULT;
}, Phaser.ParticleStorm.Controls.Texture.prototype = {
    reset: function() {
        this.sendToBack = !1, this.bringToTop = !0, this.key = "__default", this.frame = void 0, 
        this.frameName = void 0, this.scaleMode = Phaser.scaleModes.DEFAULT;
    },
    init: function(t) {
        if (t.sendToBack ? this.sendToBack = t.sendToBack : t.bringToTop && (this.bringToTop = t.bringToTop), 
        t.image && (Array.isArray(t.image) ? this.key = this.rnd.pick(t.image) : this.key = t.image), 
        void 0 !== t.frame) {
            var e = t.frame;
            Array.isArray(t.frame) && (e = this.rnd.pick(t.frame)), this.graph.isNumeric(e) ? this.frame = e : this.frameName = e;
        }
        if (t.scaleMode) {
            var i = t.scaleMode.toUpperCase();
            "LINEAR" === i ? this.scaleMode = Phaser.scaleModes.LINEAR : "NEAREST" === i && (this.scaleMode = Phaser.scaleModes.NEAREST);
        }
    },
    step: function(t, e) {
        if (this.particle.emitter.renderType === Phaser.ParticleStorm.SPRITE && void 0 !== t.animations) {
            var i = [];
            for (var n in t.animations) {
                var s = t.animations[n], o = null, a = !0;
                void 0 !== s.frames && "string" == typeof (o = Array.isArray(s.frames) ? s.frames : Phaser.Animation.generateFrameNames(s.frames.prefix, s.frames.start, s.frames.stop, s.frames.suffix, s.frames.zeroPad))[0] && (a = !1);
                var r = void 0 === s.frameRate ? 60 : s.frameRate, h = void 0 !== s.loop && s.loop;
                e.animations.add(n, o, r, h, a), i.push(n);
            }
            0 < i.length && (void 0 !== t.play ? e.play(this.rnd.pick(i)) : e.play(i[0]));
        }
        this.sendToBack ? e.sendToBack() : this.bringToTop && e.bringToTop();
    }
}, Phaser.ParticleStorm.Controls.Texture.prototype.constructor = Phaser.ParticleStorm.Controls.Texture, 
Phaser.ParticleStorm.Controls.Color = function(t) {
    this.particle = t, this.graph = Phaser.ParticleStorm.Graph, this.red = {}, this.green = {}, 
    this.blue = {}, this.alpha = {}, this.hsv = {}, this.hsvData = this.particle.emitter.parent.hsv, 
    this.tint = 0, this.isTinted = !1, this.rgba = "rgba(0, 0, 0, 1)", this.blendMode = this.particle.emitter.parent.blendModeMap.NORMAL;
}, Phaser.ParticleStorm.Controls.Color.prototype = {
    reset: function() {
        this.red = Object.create(Phaser.ParticleStorm.BASE_255), this.green = Object.create(Phaser.ParticleStorm.BASE_255), 
        this.blue = Object.create(Phaser.ParticleStorm.BASE_255), this.alpha = Object.create(Phaser.ParticleStorm.BASE_1), 
        this.tint = 16777215, this.isTinted = !1, this.isHSV = !1, this.hsv = Object.create(Phaser.ParticleStorm.BASE_359), 
        this.rgba = "rgba(0, 0, 0, 1)", this.blendMode = this.particle.emitter.parent.blendModeMap.NORMAL;
    },
    init: function(t) {
        var e = !1;
        t.hasOwnProperty("hsv") ? ("number" == typeof t.hsv ? this.hsv.value = t.hsv : this.graph.fromData(t.hsv, this.hsv), 
        e = !0, this.isHSV = !0) : (t.hasOwnProperty("red") && ("number" == typeof t.red ? this.red.value = t.red : this.graph.fromData(t.red, this.red), 
        e = !0), t.hasOwnProperty("green") && ("number" == typeof t.green ? this.green.value = t.green : this.graph.fromData(t.green, this.green), 
        e = !0), t.hasOwnProperty("blue") && ("number" == typeof t.blue ? this.blue.value = t.blue : this.graph.fromData(t.blue, this.blue), 
        e = !0)), t.hasOwnProperty("alpha") && ("number" == typeof t.alpha ? this.alpha.value = t.alpha : this.graph.fromData(t.alpha, this.alpha)), 
        this.red.value = Phaser.Math.clamp(this.red.value, 0, 255), this.green.value = Phaser.Math.clamp(this.green.value, 0, 255), 
        this.blue.value = Phaser.Math.clamp(this.blue.value, 0, 255), this.alpha.value = Phaser.Math.clamp(this.alpha.value, 0, 1), 
        this.hsv.value = Phaser.Math.clamp(this.hsv.value, 0, 359), this.particle.emitter.renderType !== Phaser.ParticleStorm.PIXEL && (this.isTinted = e), 
        t.blendMode && (this.blendMode = this.particle.emitter.parent.blendModeMap[t.blendMode.toUpperCase()]);
    },
    step: function() {
        var t = this.particle.life;
        this.isHSV ? (this.hsv.value += this.hsv.delta, this.hsv.calc = Phaser.Math.clamp(Math.floor(this.hsv.initial + this.graph.getValue(this.hsv, t)), 0, 359), 
        this.red.value = this.hsvData[this.hsv.calc].r, this.green.value = this.hsvData[this.hsv.calc].g, 
        this.blue.value = this.hsvData[this.hsv.calc].b) : (this.red.value += this.red.delta, 
        this.green.value += this.green.delta, this.blue.value += this.blue.delta), this.red.calc = this.graph.getClampedValue(this.red, t), 
        this.green.calc = this.graph.getClampedValue(this.green, t), this.blue.calc = this.graph.getClampedValue(this.blue, t), 
        this.isTinted && (this.tint = this.red.calc << 16 | this.green.calc << 8 | this.blue.calc), 
        this.alpha.value += this.alpha.delta, this.alpha.calc = Phaser.Math.clamp(this.alpha.initial + this.graph.getValue(this.alpha, t), 0, 1), 
        this.rgba = "rgba(" + this.red.calc + "," + this.green.calc + "," + this.blue.calc + "," + this.alpha.calc + ")";
    },
    setColor: function(t, e, i, n) {
        this.red.value = t, this.green.value = e, this.blue.value = i, this.alpha.value = n, 
        this.particle.emitter.renderType !== Phaser.ParticleStorm.PIXEL && (this.isTinted = !0), 
        this.step();
    }
}, Phaser.ParticleStorm.Controls.Color.prototype.constructor = Phaser.ParticleStorm.Controls.Color, 
Phaser.ParticleStorm.Controls.Transform = function(t) {
    this.particle = t, this.time = t.emitter.game.time, this.graph = Phaser.ParticleStorm.Graph, 
    this.x = 0, this.y = 0, this.velocity = {
        x: null,
        y: null,
        facing: null
    }, this.acceleration = {
        x: null,
        y: null,
        facing: null
    }, this.scale = {
        x: null,
        y: null
    }, this.rotation = {}, this.anchor = new Phaser.Point();
}, Phaser.ParticleStorm.Controls.Transform.prototype = {
    reset: function() {
        this.velocity.x = Object.create(Phaser.ParticleStorm.BASE), this.velocity.y = Object.create(Phaser.ParticleStorm.BASE), 
        this.velocity.facing = Object.create(Phaser.ParticleStorm.BASE_NULL), this.acceleration.x = Object.create(Phaser.ParticleStorm.BASE), 
        this.acceleration.y = Object.create(Phaser.ParticleStorm.BASE), this.acceleration.facing = Object.create(Phaser.ParticleStorm.BASE_NULL), 
        this.scale.x = Object.create(Phaser.ParticleStorm.BASE_1), this.scale.y = Object.create(Phaser.ParticleStorm.BASE_1), 
        this.rotation = Object.create(Phaser.ParticleStorm.BASE), this.anchor.set(.5);
    },
    init: function(t, e, i) {
        if (this.x = t, this.y = e, i.hasOwnProperty("anchor") ? this.anchor.set(i.anchor) : (i.hasOwnProperty("anchorX") && (this.anchor.x = i.anchorX), 
        i.hasOwnProperty("anchorY") && (this.anchor.y = i.anchorY)), i.hasOwnProperty("velocity")) {
            if (this.graph.isNumeric(i.velocity)) this.velocity.x.value = i.velocity, this.velocity.y.value = i.velocity; else if (i.velocity.hasOwnProperty("min")) this.velocity.x.value = this.graph.getMinMax(i.velocity), 
            this.velocity.y.value = this.velocity.x.value; else if (i.velocity.radial) {
                var n = this.graph.getMinMaxInitial(i.velocity), s = i.velocity.radial.arcStart, o = i.velocity.radial.arcEnd;
                if (void 0 !== s && void 0 !== o) {
                    var a = (Math.random() * (o - s) + s) * Math.PI / 180, r = Math.sin(a), h = -Math.cos(a);
                    this.velocity.x.value = r * n, this.velocity.y.value = h * n;
                }
            } else this.velocity.x.initial = this.graph.getMinMaxInitial(i.velocity), this.velocity.y.initial = this.velocity.x.initial, 
            this.velocity.x.value = this.graph.getMinMax(i.velocity.value), this.velocity.y.value = this.velocity.x.value;
            i.velocity.hasOwnProperty("delta") && (this.velocity.x.delta = this.graph.getMinMax(i.velocity.delta), 
            this.velocity.y.delta = this.velocity.x.delta), i.velocity.hasOwnProperty("control") && (this.velocity.x.control = i.velocity.control, 
            this.velocity.y.control = i.velocity.control), i.hasOwnProperty("vx") && this.graph.fromData(i.vx, this.velocity.x), 
            i.hasOwnProperty("vy") && this.graph.fromData(i.vy, this.velocity.y);
        } else i.hasOwnProperty("target") ? this.particle.target(i.target) : ("number" == typeof i.vx ? this.velocity.x.value = i.vx : this.graph.fromData(i.vx, this.velocity.x), 
        "number" == typeof i.vy ? this.velocity.y.value = i.vy : this.graph.fromData(i.vy, this.velocity.y));
        "number" == typeof i.facingVelocity ? this.velocity.facing.value = i.facingVelocity : this.graph.fromData(i.facingVelocity, this.velocity.facing), 
        "number" == typeof i.facingAcceleration ? this.acceleration.facing.value = i.facingAcceleration : this.graph.fromData(i.facingAcceleration, this.acceleration.facing), 
        i.hasOwnProperty("acceleration") ? (this.graph.fromData(i.acceleration, this.acceleration.x), 
        this.graph.fromData(i.acceleration, this.acceleration.y)) : ("number" == typeof i.ax ? this.acceleration.x.value = i.ax : this.graph.fromData(i.ax, this.acceleration.x), 
        "number" == typeof i.ay ? this.acceleration.y.value = i.ay : this.graph.fromData(i.ay, this.acceleration.y)), 
        i.hasOwnProperty("scale") ? (this.graph.fromData(i.scale, this.scale.x), this.graph.clone(this.scale.x, this.scale.y)) : ("number" == typeof i.scaleX ? this.scale.x.value = i.scaleX : this.graph.fromData(i.scaleX, this.scale.x), 
        "number" == typeof i.scaleY ? this.scale.y.value = i.scaleY : this.graph.fromData(i.scaleY, this.scale.y)), 
        "number" == typeof i.rotation ? this.rotation.value = i.rotation : this.graph.fromData(i.rotation, this.rotation);
        var l = this.particle.parent;
        l && l.emit && l.emit.inherit && this.inherit(l);
    },
    inherit: function(t) {
        var e = t.emit.inherit, i = !1;
        if ("boolean" == typeof e && (i = !0), (i || e.vx || e.velocity) && this.graph.clone(t.transform.velocity.x, this.velocity.x), 
        (i || e.vy || e.velocity) && this.graph.clone(t.transform.velocity.y, this.velocity.y), 
        (i || e.facingVelocity) && this.graph.clone(t.transform.velocity.facing, this.velocity.facing), 
        (i || e.scaleX || e.scale) && this.graph.clone(t.transform.scale.x, this.scale.x), 
        (i || e.scaleY || e.scale) && this.graph.clone(t.transform.scale.y, this.scale.y), 
        (i || e.rotation) && this.graph.clone(t.transform.rotation, this.rotation), e.angularVelocity) {
            var n = (t.transform.rotation.initial + t.transform.rotation.value) * Math.PI / 180;
            this.velocity.x.initial = Math.sin(n), this.velocity.y.initial = -Math.cos(n);
        }
    },
    step: function() {
        var t = this.particle.life;
        if (this.scale.x.value += this.scale.x.delta, this.scale.y.value += this.scale.y.delta, 
        this.rotation.value += this.rotation.delta, this.rotation.calc = (this.rotation.initial + this.graph.getValue(this.rotation, t)) * Math.PI / 180, 
        this.scale.x.calc = this.scale.x.initial + this.graph.getValue(this.scale.x, t), 
        this.scale.y.calc = this.scale.y.initial + this.graph.getValue(this.scale.y, t), 
        0 !== t) {
            var e = 0, i = 0;
            null !== this.acceleration.facing.value && (this.acceleration.facing.value += this.acceleration.facing.delta, 
            e = this.rotation.calc + (90 + this.acceleration.facing.offset) * Math.PI / 180, 
            i = this.acceleration.facing.initial + this.graph.getValue(this.acceleration.facing, t), 
            this.velocity.x.value += i * Math.sin(e), this.velocity.y.value += i * -Math.cos(e)), 
            this.acceleration.x.value += this.acceleration.x.delta, this.acceleration.y.value += this.acceleration.y.delta, 
            this.velocity.x.value += this.velocity.x.delta + this.acceleration.x.initial + this.graph.getValue(this.acceleration.x, t), 
            this.velocity.y.value += this.velocity.y.delta + this.acceleration.y.initial + this.graph.getValue(this.acceleration.y, t), 
            null !== this.velocity.facing.value && (this.velocity.facing.value += this.velocity.facing.delta, 
            e = this.rotation.calc + (90 + this.velocity.facing.offset) * Math.PI / 180, i = this.velocity.facing.initial + this.graph.getValue(this.velocity.facing, t), 
            this.x += i * Math.sin(e), this.y += i * -Math.cos(e)), this.x += this.velocity.x.initial + this.graph.getValue(this.velocity.x, t), 
            this.y += this.velocity.y.initial + this.graph.getValue(this.velocity.y, t);
        }
    }
}, Phaser.ParticleStorm.Controls.Transform.prototype.constructor = Phaser.ParticleStorm.Controls.Transform, 
Phaser.ParticleStorm.Renderer = {}, Phaser.ParticleStorm.Renderer.Base = function(t) {
    this.game = t.game, this.emitter = t, this.parent = t.parent, this.pixelSize = 1;
}, Phaser.ParticleStorm.Renderer.Base.prototype = {
    addToWorld: function(t) {
        return t.add(this.display), this.display;
    },
    preUpdate: function() {},
    add: function() {
        return null;
    },
    update: function(t) {
        return t;
    },
    postUpdate: function() {},
    kill: function(t) {
        return t;
    },
    destroy: function() {
        this.game = null;
    }
}, Phaser.ParticleStorm.Renderer.Base.prototype.constructor = Phaser.ParticleStorm.Renderer.Base, 
Phaser.ParticleStorm.Renderer.Sprite = function(t) {
    Phaser.ParticleStorm.Renderer.Base.call(this, t), this.display = this.game.make.group(null, "particleStormSpriteRenderer");
}, Phaser.ParticleStorm.Renderer.Sprite.prototype = Object.create(Phaser.ParticleStorm.Renderer.Base.prototype), 
Phaser.ParticleStorm.Renderer.Sprite.prototype.constructor = Phaser.ParticleStorm.Renderer.Sprite, 
Phaser.ParticleStorm.Renderer.Sprite.prototype.add = function(t) {
    var e = t.sprite, i = t.texture.key, n = t.texture.frame;
    return void 0 === n && void 0 !== t.texture.frameName && (n = t.texture.frameName), 
    e ? (e.reset(t.transform.x, t.transform.y), e.key !== i ? e.loadTexture(i, n) : void 0 !== t.texture.frame ? e.frame = n : void 0 !== t.texture.frameName && (e.frameName = n)) : e = this.display.create(t.transform.x, t.transform.y, i, n), 
    e.anchor.set(t.transform.anchor.x, t.transform.anchor.y), t.color.isTinted && (e.tint = t.color.tint), 
    e.blendMode = t.color.blendMode[0], e.texture.baseTexture.scaleMode = t.texture.scaleMode, 
    e.visible = t.visible, t.sprite = e;
}, Phaser.ParticleStorm.Renderer.Sprite.prototype.update = function(t) {
    var e = t.sprite;
    0 < t.delay && !t.delayVisible ? e.visible = !1 : (e.visible = t.visible, e.alpha = t.color.alpha.calc, 
    e.rotation = t.transform.rotation.calc, t.color.isTinted && (e.tint = t.color.tint), 
    e.scale.setTo(t.transform.scale.x.calc, t.transform.scale.y.calc), e.x = t.transform.x, 
    e.y = t.transform.y);
}, Phaser.ParticleStorm.Renderer.Sprite.prototype.kill = function(t) {
    t.sprite && t.sprite.kill();
}, Phaser.ParticleStorm.Renderer.Sprite.prototype.destroy = function() {
    this.display.destroy(!0), this.emitter = null, this.game = null;
}, Phaser.ParticleStorm.Renderer.Pixel = function(t, e, i) {
    Phaser.ParticleStorm.Renderer.Base.call(this, t), this.bmd = this.game.make.bitmapData(e, i), 
    this.display = this.game.make.image(0, 0, this.bmd), this.autoClear = !0;
}, Phaser.ParticleStorm.Renderer.Pixel.prototype = Object.create(Phaser.ParticleStorm.Renderer.Base.prototype), 
Phaser.ParticleStorm.Renderer.Pixel.prototype.constructor = Phaser.ParticleStorm.Renderer.Pixel, 
Phaser.ParticleStorm.Renderer.Pixel.prototype.resize = function(t, e) {
    return this.bmd.resize(t, e), this;
}, Phaser.ParticleStorm.Renderer.Pixel.prototype.clear = function(t) {
    return this.bmd.fill(0, 0, 0, t), this.bmd.update(), this;
}, Phaser.ParticleStorm.Renderer.Pixel.prototype.preUpdate = function() {
    this.autoClear && (this.bmd.clear(), this.bmd.update());
}, Phaser.ParticleStorm.Renderer.Pixel.prototype.update = function(t) {
    if (!(0 < t.delay) || t.delayVisible) {
        var e = Math.floor(t.transform.x), i = Math.floor(t.transform.y), n = t.color.red.calc, s = t.color.green.calc, o = t.color.blue.calc, a = Math.floor(255 * t.color.alpha.calc);
        2 < this.pixelSize ? this.bmd.rect(e, i, this.pixelSize, this.pixelSize, t.color.rgba) : (this.bmd.setPixel32(e, i, n, s, o, a, !1), 
        2 === this.pixelSize && (this.bmd.setPixel32(e + 1, i, n, s, o, a, !1), this.bmd.setPixel32(e, i + 1, n, s, o, a, !1), 
        this.bmd.setPixel32(e + 1, i + 1, n, s, o, a, !1)));
    }
}, Phaser.ParticleStorm.Renderer.Pixel.prototype.postUpdate = function() {
    this.pixelSize <= 2 && this.bmd.context.putImageData(this.bmd.imageData, 0, 0), 
    this.bmd.dirty = !0;
}, Phaser.ParticleStorm.Renderer.Pixel.prototype.destroy = function() {
    this.game = null, this.display.destroy(), this.bmd.destroy();
}, Phaser.ParticleStorm.Renderer.BitmapData = function(t, e, i) {
    Phaser.ParticleStorm.Renderer.Base.call(this, t), this.bmd = this.game.make.bitmapData(e, i), 
    this.display = this.game.make.image(0, 0, this.bmd), this.roundPx = !0, this.autoClear = !0;
}, Phaser.ParticleStorm.Renderer.BitmapData.prototype = Object.create(Phaser.ParticleStorm.Renderer.Base.prototype), 
Phaser.ParticleStorm.Renderer.BitmapData.prototype.constructor = Phaser.ParticleStorm.Renderer.BitmapData, 
Phaser.ParticleStorm.Renderer.BitmapData.prototype.resize = function(t, e) {
    return this.bmd.resize(t, e), this;
}, Phaser.ParticleStorm.Renderer.BitmapData.prototype.clear = function(t) {
    return this.bmd.fill(0, 0, 0, t), this;
}, Phaser.ParticleStorm.Renderer.BitmapData.prototype.preUpdate = function() {
    this.autoClear && this.bmd.clear();
}, Phaser.ParticleStorm.Renderer.BitmapData.prototype.update = function(t) {
    if (!(0 < t.delay) || t.delayVisible) {
        var e = t.transform;
        this.bmd.copy(t.texture.key, 0, 0, null, null, e.x, e.y, null, null, e.rotation.calc, e.anchor.x, e.anchor.y, e.scale.x.calc, e.scale.y.calc, t.color.alpha.calc, t.color.blendMode[1], this.roundPx);
    }
}, Phaser.ParticleStorm.Renderer.BitmapData.prototype.destroy = function() {
    this.game = null, this.display.destroy(), this.bmd.destroy();
}, Phaser.ParticleStorm.Renderer.RenderTexture = function(t, e, i) {
    Phaser.ParticleStorm.Renderer.Base.call(this, t), this.renderTexture = this.game.make.renderTexture(e, i), 
    this.display = this.game.make.image(0, 0, this.renderTexture), this.stamp = this.game.make.image(0, 0), 
    this.autoClear = !0;
}, Phaser.ParticleStorm.Renderer.RenderTexture.prototype = Object.create(Phaser.ParticleStorm.Renderer.Base.prototype), 
Phaser.ParticleStorm.Renderer.RenderTexture.prototype.constructor = Phaser.ParticleStorm.Renderer.RenderTexture, 
Phaser.ParticleStorm.Renderer.RenderTexture.prototype.clear = function() {
    this.renderTexture.clear();
}, Phaser.ParticleStorm.Renderer.RenderTexture.prototype.preUpdate = function() {
    this.autoClear && this.renderTexture.clear();
}, Phaser.ParticleStorm.Renderer.RenderTexture.prototype.update = function(t) {
    if (!(0 < t.delay && !t.delayVisible || !t.visible || 0 === t.color.alpha.calc)) {
        var e = t.texture.key, i = t.texture.frame;
        void 0 === i && void 0 !== t.texture.frameName && (i = t.texture.frameName), this.stamp.key !== e ? this.stamp.loadTexture(e, i) : void 0 !== t.texture.frame ? this.stamp.frame = i : void 0 !== t.texture.frameName && (this.stamp.frameName = i), 
        this.stamp.anchor.set(t.transform.anchor.x, t.transform.anchor.y), this.stamp.alpha = t.color.alpha.calc, 
        this.stamp.rotation = t.transform.rotation.calc, t.color.isTinted && (this.stamp.tint = t.color.tint), 
        this.stamp.blendMode = t.color.blendMode[0], this.stamp.texture.baseTexture.scaleMode = t.texture.scaleMode, 
        this.stamp.scale.setTo(t.transform.scale.x.calc, t.transform.scale.y.calc), this.renderTexture.renderXY(this.stamp, t.transform.x, t.transform.y, !1);
    }
}, Phaser.ParticleStorm.Renderer.RenderTexture.prototype.destroy = function() {
    this.display.destroy(), this.stamp.destroy(), this.renderTexture.destroy(), this.emitter = null, 
    this.game = null;
}, Phaser.ParticleStorm.Renderer.SpriteBatch = function(t) {
    Phaser.ParticleStorm.Renderer.Base.call(this, t), this.display = this.game.make.spriteBatch();
}, Phaser.ParticleStorm.Renderer.SpriteBatch.prototype = Object.create(Phaser.ParticleStorm.Renderer.Base.prototype), 
Phaser.ParticleStorm.Renderer.SpriteBatch.prototype.constructor = Phaser.ParticleStorm.Renderer.SpriteBatch, 
Phaser.ParticleStorm.Renderer.SpriteBatch.prototype.add = function(t) {
    var e = t.sprite, i = t.texture.key, n = t.texture.frame;
    return void 0 === n && void 0 !== t.texture.frameName && (n = t.texture.frameName), 
    e ? (e.reset(t.transform.x, t.transform.y), e.key !== i ? e.loadTexture(i, n) : void 0 !== t.texture.frame ? e.frame = n : void 0 !== t.texture.frameName && (e.frameName = n)) : e = this.game.make.sprite(t.transform.x, t.transform.y, i, n), 
    this.display.addChild(e), e.anchor.set(t.transform.anchor.x, t.transform.anchor.y), 
    t.color.isTinted && (e.tint = t.color.tint), e.blendMode = t.color.blendMode[0], 
    e.texture.baseTexture.scaleMode = t.texture.scaleMode, e.visible = t.visible, t.sprite = e;
}, Phaser.ParticleStorm.Renderer.SpriteBatch.prototype.update = function(t) {
    var e = t.sprite;
    0 < t.delay && !t.delayVisible ? e.visible = !1 : (e.visible = t.visible, e.alpha = t.color.alpha.calc, 
    e.rotation = t.transform.rotation.calc, t.color.isTinted && (e.tint = t.color.tint), 
    e.scale.setTo(t.transform.scale.x.calc, t.transform.scale.y.calc), e.x = t.transform.x, 
    e.y = t.transform.y);
}, Phaser.ParticleStorm.Renderer.SpriteBatch.prototype.kill = function(t) {
    t.sprite && t.sprite.kill();
}, Phaser.ParticleStorm.Renderer.SpriteBatch.prototype.destroy = function() {
    this.display.destroy(!0), this.emitter = null, this.game = null;
}, function(t) {
    var e, i, n, s, o, a, r, h, l, c, u, d, p, g, m, f, y = y || function(r) {
        function i() {}
        var t = {}, e = t.lib = {}, n = e.Base = {
            extend: function(t) {
                i.prototype = this;
                var e = new i();
                return t && e.mixIn(t), e.hasOwnProperty("init") || (e.init = function() {
                    e.$super.init.apply(this, arguments);
                }), (e.init.prototype = e).$super = this, e;
            },
            create: function() {
                var t = this.extend();
                return t.init.apply(t, arguments), t;
            },
            init: function() {},
            mixIn: function(t) {
                for (var e in t) t.hasOwnProperty(e) && (this[e] = t[e]);
                t.hasOwnProperty("toString") && (this.toString = t.toString);
            },
            clone: function() {
                return this.init.prototype.extend(this);
            }
        }, h = e.WordArray = n.extend({
            init: function(t, e) {
                t = this.words = t || [], this.sigBytes = null != e ? e : 4 * t.length;
            },
            toString: function(t) {
                return (t || o).stringify(this);
            },
            concat: function(t) {
                var e = this.words, i = t.words, n = this.sigBytes;
                if (t = t.sigBytes, this.clamp(), n % 4) for (var s = 0; s < t; s++) e[n + s >>> 2] |= (i[s >>> 2] >>> 24 - s % 4 * 8 & 255) << 24 - (n + s) % 4 * 8; else if (65535 < i.length) for (s = 0; s < t; s += 4) e[n + s >>> 2] = i[s >>> 2]; else e.push.apply(e, i);
                return this.sigBytes += t, this;
            },
            clamp: function() {
                var t = this.words, e = this.sigBytes;
                t[e >>> 2] &= 4294967295 << 32 - e % 4 * 8, t.length = r.ceil(e / 4);
            },
            clone: function() {
                var t = n.clone.call(this);
                return t.words = this.words.slice(0), t;
            },
            random: function(t) {
                for (var e = [], i = 0; i < t; i += 4) e.push(4294967296 * r.random() | 0);
                return new h.init(e, t);
            }
        }), s = t.enc = {}, o = s.Hex = {
            stringify: function(t) {
                var e = t.words;
                t = t.sigBytes;
                for (var i = [], n = 0; n < t; n++) {
                    var s = e[n >>> 2] >>> 24 - n % 4 * 8 & 255;
                    i.push((s >>> 4).toString(16)), i.push((15 & s).toString(16));
                }
                return i.join("");
            },
            parse: function(t) {
                for (var e = t.length, i = [], n = 0; n < e; n += 2) i[n >>> 3] |= parseInt(t.substr(n, 2), 16) << 24 - n % 8 * 4;
                return new h.init(i, e / 2);
            }
        }, a = s.Latin1 = {
            stringify: function(t) {
                var e = t.words;
                t = t.sigBytes;
                for (var i = [], n = 0; n < t; n++) i.push(String.fromCharCode(e[n >>> 2] >>> 24 - n % 4 * 8 & 255));
                return i.join("");
            },
            parse: function(t) {
                for (var e = t.length, i = [], n = 0; n < e; n++) i[n >>> 2] |= (255 & t.charCodeAt(n)) << 24 - n % 4 * 8;
                return new h.init(i, e);
            }
        }, l = s.Utf8 = {
            stringify: function(t) {
                try {
                    return decodeURIComponent(escape(a.stringify(t)));
                } catch (t) {
                    throw Error("Malformed UTF-8 data");
                }
            },
            parse: function(t) {
                return a.parse(unescape(encodeURIComponent(t)));
            }
        }, c = e.BufferedBlockAlgorithm = n.extend({
            reset: function() {
                this._data = new h.init(), this._nDataBytes = 0;
            },
            _append: function(t) {
                "string" == typeof t && (t = l.parse(t)), this._data.concat(t), this._nDataBytes += t.sigBytes;
            },
            _process: function(t) {
                var e = this._data, i = e.words, n = e.sigBytes, s = this.blockSize, o = n / (4 * s);
                if (t = (o = t ? r.ceil(o) : r.max((0 | o) - this._minBufferSize, 0)) * s, n = r.min(4 * t, n), 
                t) {
                    for (var a = 0; a < t; a += s) this._doProcessBlock(i, a);
                    a = i.splice(0, t), e.sigBytes -= n;
                }
                return new h.init(a, n);
            },
            clone: function() {
                var t = n.clone.call(this);
                return t._data = this._data.clone(), t;
            },
            _minBufferSize: 0
        });
        e.Hasher = c.extend({
            cfg: n.extend(),
            init: function(t) {
                this.cfg = this.cfg.extend(t), this.reset();
            },
            reset: function() {
                c.reset.call(this), this._doReset();
            },
            update: function(t) {
                return this._append(t), this._process(), this;
            },
            finalize: function(t) {
                return t && this._append(t), this._doFinalize();
            },
            blockSize: 16,
            _createHelper: function(i) {
                return function(t, e) {
                    return new i.init(e).finalize(t);
                };
            },
            _createHmacHelper: function(i) {
                return function(t, e) {
                    return new u.HMAC.init(i, e).finalize(t);
                };
            }
        });
        var u = t.algo = {};
        return t;
    }(Math);
    !function(s) {
        function t(t) {
            return 4294967296 * (t - (0 | t)) | 0;
        }
        for (var e = y, i = (o = e.lib).WordArray, n = o.Hasher, o = e.algo, a = [], g = [], r = 2, h = 0; h < 64; ) {
            var l;
            t: {
                l = r;
                for (var c = s.sqrt(l), u = 2; u <= c; u++) if (!(l % u)) {
                    l = !1;
                    break t;
                }
                l = !0;
            }
            l && (h < 8 && (a[h] = t(s.pow(r, .5))), g[h] = t(s.pow(r, 1 / 3)), h++), r++;
        }
        var m = [];
        o = o.SHA256 = n.extend({
            _doReset: function() {
                this._hash = new i.init(a.slice(0));
            },
            _doProcessBlock: function(t, e) {
                for (var i = this._hash.words, n = i[0], s = i[1], o = i[2], a = i[3], r = i[4], h = i[5], l = i[6], c = i[7], u = 0; u < 64; u++) {
                    if (u < 16) m[u] = 0 | t[e + u]; else {
                        var d = m[u - 15], p = m[u - 2];
                        m[u] = ((d << 25 | d >>> 7) ^ (d << 14 | d >>> 18) ^ d >>> 3) + m[u - 7] + ((p << 15 | p >>> 17) ^ (p << 13 | p >>> 19) ^ p >>> 10) + m[u - 16];
                    }
                    d = c + ((r << 26 | r >>> 6) ^ (r << 21 | r >>> 11) ^ (r << 7 | r >>> 25)) + (r & h ^ ~r & l) + g[u] + m[u], 
                    p = ((n << 30 | n >>> 2) ^ (n << 19 | n >>> 13) ^ (n << 10 | n >>> 22)) + (n & s ^ n & o ^ s & o), 
                    c = l, l = h, h = r, r = a + d | 0, a = o, o = s, s = n, n = d + p | 0;
                }
                i[0] = i[0] + n | 0, i[1] = i[1] + s | 0, i[2] = i[2] + o | 0, i[3] = i[3] + a | 0, 
                i[4] = i[4] + r | 0, i[5] = i[5] + h | 0, i[6] = i[6] + l | 0, i[7] = i[7] + c | 0;
            },
            _doFinalize: function() {
                var t = this._data, e = t.words, i = 8 * this._nDataBytes, n = 8 * t.sigBytes;
                return e[n >>> 5] |= 128 << 24 - n % 32, e[14 + (64 + n >>> 9 << 4)] = s.floor(i / 4294967296), 
                e[15 + (64 + n >>> 9 << 4)] = i, t.sigBytes = 4 * e.length, this._process(), this._hash;
            },
            clone: function() {
                var t = n.clone.call(this);
                return t._hash = this._hash.clone(), t;
            }
        }), e.SHA256 = n._createHelper(o), e.HmacSHA256 = n._createHmacHelper(o);
    }(Math), f = y.enc.Utf8, y.algo.HMAC = y.lib.Base.extend({
        init: function(t, e) {
            t = this._hasher = new t.init(), "string" == typeof e && (e = f.parse(e));
            var i = t.blockSize, n = 4 * i;
            e.sigBytes > n && (e = t.finalize(e)), e.clamp();
            for (var s = this._oKey = e.clone(), o = this._iKey = e.clone(), a = s.words, r = o.words, h = 0; h < i; h++) a[h] ^= 1549556828, 
            r[h] ^= 909522486;
            s.sigBytes = o.sigBytes = n, this.reset();
        },
        reset: function() {
            var t = this._hasher;
            t.reset(), t.update(this._iKey);
        },
        update: function(t) {
            return this._hasher.update(t), this;
        },
        finalize: function(t) {
            var e = this._hasher;
            return t = e.finalize(t), e.reset(), e.finalize(this._oKey.clone().concat(t));
        }
    }), m = y.lib.WordArray, y.enc.Base64 = {
        stringify: function(t) {
            var e = t.words, i = t.sigBytes, n = this._map;
            t.clamp(), t = [];
            for (var s = 0; s < i; s += 3) for (var o = (e[s >>> 2] >>> 24 - s % 4 * 8 & 255) << 16 | (e[s + 1 >>> 2] >>> 24 - (s + 1) % 4 * 8 & 255) << 8 | e[s + 2 >>> 2] >>> 24 - (s + 2) % 4 * 8 & 255, a = 0; a < 4 && s + .75 * a < i; a++) t.push(n.charAt(o >>> 6 * (3 - a) & 63));
            if (e = n.charAt(64)) for (;t.length % 4; ) t.push(e);
            return t.join("");
        },
        parse: function(t) {
            var e = t.length, i = this._map;
            !(n = i.charAt(64)) || -1 != (n = t.indexOf(n)) && (e = n);
            for (var n = [], s = 0, o = 0; o < e; o++) if (o % 4) {
                var a = i.indexOf(t.charAt(o - 1)) << o % 4 * 2, r = i.indexOf(t.charAt(o)) >>> 6 - o % 4 * 2;
                n[s >>> 2] |= (a | r) << 24 - s % 4 * 8, s++;
            }
            return m.create(n, s);
        },
        _map: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
    }, e = v = v || {}, (i = e.EGAErrorSeverity || (e.EGAErrorSeverity = {}))[i.Undefined = 0] = "Undefined", 
    i[i.Debug = 1] = "Debug", i[i.Info = 2] = "Info", i[i.Warning = 3] = "Warning", 
    i[i.Error = 4] = "Error", i[i.Critical = 5] = "Critical", (n = e.EGAProgressionStatus || (e.EGAProgressionStatus = {}))[n.Undefined = 0] = "Undefined", 
    n[n.Start = 1] = "Start", n[n.Complete = 2] = "Complete", n[n.Fail = 3] = "Fail", 
    (s = e.EGAResourceFlowType || (e.EGAResourceFlowType = {}))[s.Undefined = 0] = "Undefined", 
    s[s.Source = 1] = "Source", s[s.Sink = 2] = "Sink", (o = e.EGAAdAction || (e.EGAAdAction = {}))[o.Undefined = 0] = "Undefined", 
    o[o.Clicked = 1] = "Clicked", o[o.Show = 2] = "Show", o[o.FailedShow = 3] = "FailedShow", 
    o[o.RewardReceived = 4] = "RewardReceived", (a = e.EGAAdError || (e.EGAAdError = {}))[a.Undefined = 0] = "Undefined", 
    a[a.Unknown = 1] = "Unknown", a[a.Offline = 2] = "Offline", a[a.NoFill = 3] = "NoFill", 
    a[a.InternalError = 4] = "InternalError", a[a.InvalidRequest = 5] = "InvalidRequest", 
    a[a.UnableToPrecache = 6] = "UnableToPrecache", (r = e.EGAAdType || (e.EGAAdType = {}))[r.Undefined = 0] = "Undefined", 
    r[r.Video = 1] = "Video", r[r.RewardedVideo = 2] = "RewardedVideo", r[r.Playable = 3] = "Playable", 
    r[r.Interstitial = 4] = "Interstitial", r[r.OfferWall = 5] = "OfferWall", r[r.Banner = 6] = "Banner", 
    (l = (h = e.http || (e.http = {})).EGAHTTPApiResponse || (h.EGAHTTPApiResponse = {}))[l.NoResponse = 0] = "NoResponse", 
    l[l.BadResponse = 1] = "BadResponse", l[l.RequestTimeout = 2] = "RequestTimeout", 
    l[l.JsonEncodeFailed = 3] = "JsonEncodeFailed", l[l.JsonDecodeFailed = 4] = "JsonDecodeFailed", 
    l[l.InternalServerError = 5] = "InternalServerError", l[l.BadRequest = 6] = "BadRequest", 
    l[l.Unauthorized = 7] = "Unauthorized", l[l.UnknownResponseCode = 8] = "UnknownResponseCode", 
    l[l.Ok = 9] = "Ok", l[l.Created = 10] = "Created", (u = (c = e.events || (e.events = {})).EGASdkErrorCategory || (c.EGASdkErrorCategory = {}))[u.Undefined = 0] = "Undefined", 
    u[u.EventValidation = 1] = "EventValidation", u[u.Database = 2] = "Database", u[u.Init = 3] = "Init", 
    u[u.Http = 4] = "Http", u[u.Json = 5] = "Json", (d = c.EGASdkErrorArea || (c.EGASdkErrorArea = {}))[d.Undefined = 0] = "Undefined", 
    d[d.BusinessEvent = 1] = "BusinessEvent", d[d.ResourceEvent = 2] = "ResourceEvent", 
    d[d.ProgressionEvent = 3] = "ProgressionEvent", d[d.DesignEvent = 4] = "DesignEvent", 
    d[d.ErrorEvent = 5] = "ErrorEvent", d[d.InitHttp = 9] = "InitHttp", d[d.EventsHttp = 10] = "EventsHttp", 
    d[d.ProcessEvents = 11] = "ProcessEvents", d[d.AddEventsToStore = 12] = "AddEventsToStore", 
    d[d.AdEvent = 20] = "AdEvent", (p = c.EGASdkErrorAction || (c.EGASdkErrorAction = {}))[p.Undefined = 0] = "Undefined", 
    p[p.InvalidCurrency = 1] = "InvalidCurrency", p[p.InvalidShortString = 2] = "InvalidShortString", 
    p[p.InvalidEventPartLength = 3] = "InvalidEventPartLength", p[p.InvalidEventPartCharacters = 4] = "InvalidEventPartCharacters", 
    p[p.InvalidStore = 5] = "InvalidStore", p[p.InvalidFlowType = 6] = "InvalidFlowType", 
    p[p.StringEmptyOrNull = 7] = "StringEmptyOrNull", p[p.NotFoundInAvailableCurrencies = 8] = "NotFoundInAvailableCurrencies", 
    p[p.InvalidAmount = 9] = "InvalidAmount", p[p.NotFoundInAvailableItemTypes = 10] = "NotFoundInAvailableItemTypes", 
    p[p.WrongProgressionOrder = 11] = "WrongProgressionOrder", p[p.InvalidEventIdLength = 12] = "InvalidEventIdLength", 
    p[p.InvalidEventIdCharacters = 13] = "InvalidEventIdCharacters", p[p.InvalidProgressionStatus = 15] = "InvalidProgressionStatus", 
    p[p.InvalidSeverity = 16] = "InvalidSeverity", p[p.InvalidLongString = 17] = "InvalidLongString", 
    p[p.DatabaseTooLarge = 18] = "DatabaseTooLarge", p[p.DatabaseOpenOrCreate = 19] = "DatabaseOpenOrCreate", 
    p[p.JsonError = 25] = "JsonError", p[p.FailHttpJsonDecode = 29] = "FailHttpJsonDecode", 
    p[p.FailHttpJsonEncode = 30] = "FailHttpJsonEncode", p[p.InvalidAdAction = 31] = "InvalidAdAction", 
    p[p.InvalidAdType = 32] = "InvalidAdType", p[p.InvalidString = 33] = "InvalidString", 
    (g = c.EGASdkErrorParameter || (c.EGASdkErrorParameter = {}))[g.Undefined = 0] = "Undefined", 
    g[g.Currency = 1] = "Currency", g[g.CartType = 2] = "CartType", g[g.ItemType = 3] = "ItemType", 
    g[g.ItemId = 4] = "ItemId", g[g.Store = 5] = "Store", g[g.FlowType = 6] = "FlowType", 
    g[g.Amount = 7] = "Amount", g[g.Progression01 = 8] = "Progression01", g[g.Progression02 = 9] = "Progression02", 
    g[g.Progression03 = 10] = "Progression03", g[g.EventId = 11] = "EventId", g[g.ProgressionStatus = 12] = "ProgressionStatus", 
    g[g.Severity = 13] = "Severity", g[g.Message = 14] = "Message", g[g.AdAction = 15] = "AdAction", 
    g[g.AdType = 16] = "AdType", g[g.AdSdkName = 17] = "AdSdkName", g[g.AdPlacement = 18] = "AdPlacement";
    var v, b, _, S, x;
    v.EGAErrorSeverity, v.EGAProgressionStatus, v.EGAResourceFlowType;
    (function(t) {
        var i, e;
        (e = i = i || {})[e.Error = 0] = "Error", e[e.Warning = 1] = "Warning", e[e.Info = 2] = "Info", 
        e[e.Debug = 3] = "Debug";
        var n = (s.setInfoLog = function(t) {
            s.instance.infoLogEnabled = t;
        }, s.setVerboseLog = function(t) {
            s.instance.infoLogVerboseEnabled = t;
        }, s.i = function(t) {
            if (s.instance.infoLogEnabled) {
                var e = "Info/" + s.Tag + ": " + t;
                s.instance.sendNotificationMessage(e, i.Info);
            }
        }, s.w = function(t) {
            var e = "Warning/" + s.Tag + ": " + t;
            s.instance.sendNotificationMessage(e, i.Warning);
        }, s.e = function(t) {
            var e = "Error/" + s.Tag + ": " + t;
            s.instance.sendNotificationMessage(e, i.Error);
        }, s.ii = function(t) {
            if (s.instance.infoLogVerboseEnabled) {
                var e = "Verbose/" + s.Tag + ": " + t;
                s.instance.sendNotificationMessage(e, i.Info);
            }
        }, s.d = function(t) {
            if (s.debugEnabled) {
                var e = "Debug/" + s.Tag + ": " + t;
                s.instance.sendNotificationMessage(e, i.Debug);
            }
        }, s.prototype.sendNotificationMessage = function(t, e) {
            switch (e) {
              case i.Error:
              case i.Warning:
                break;

              case i.Debug:
                console.debug;
                break;

              case i.Info:
            }
        }, s.instance = new s(), s.Tag = "GameAnalytics", s);
        function s() {
            s.debugEnabled = !1;
        }
        t.GALogger = n;
    })((x = v = v || {}).logging || (x.logging = {})), function(t) {
        var e, l, i;
        function c() {}
        e = t.utilities || (t.utilities = {}), l = t.logging.GALogger, c.getHmac = function(t, e) {
            var i = y.HmacSHA256(e, t);
            return y.enc.Base64.stringify(i);
        }, c.stringMatch = function(t, e) {
            return !(!t || !e) && e.test(t);
        }, c.joinStringArray = function(t, e) {
            for (var i = "", n = 0, s = t.length; n < s; n++) 0 < n && (i += e), i += t[n];
            return i;
        }, c.stringArrayContainsString = function(t, e) {
            if (0 === t.length) return !1;
            for (var i in t) if (t[i] === e) return !0;
            return !1;
        }, c.encode64 = function(t) {
            t = encodeURI(t);
            for (var e, i, n, s, o, a = "", r = 0, h = 0, l = 0; n = (e = t.charCodeAt(l++)) >> 2, 
            s = (3 & e) << 4 | (i = t.charCodeAt(l++)) >> 4, o = (15 & i) << 2 | (r = t.charCodeAt(l++)) >> 6, 
            h = 63 & r, isNaN(i) ? o = h = 64 : isNaN(r) && (h = 64), a = a + c.keyStr.charAt(n) + c.keyStr.charAt(s) + c.keyStr.charAt(o) + c.keyStr.charAt(h), 
            e = i = r = 0, n = s = o = h = 0, l < t.length; ) ;
            return a;
        }, c.decode64 = function(t) {
            var e, i, n, s, o = "", a = 0, r = 0, h = 0;
            for (/[^A-Za-z0-9\+\/\=]/g.exec(t) && l.w("There were invalid base64 characters in the input text. Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='. Expect errors in decoding."), 
            t = t.replace(/[^A-Za-z0-9\+\/\=]/g, ""); e = c.keyStr.indexOf(t.charAt(h++)) << 2 | (n = c.keyStr.indexOf(t.charAt(h++))) >> 4, 
            i = (15 & n) << 4 | (s = c.keyStr.indexOf(t.charAt(h++))) >> 2, a = (3 & s) << 6 | (r = c.keyStr.indexOf(t.charAt(h++))), 
            o += String.fromCharCode(e), 64 != s && (o += String.fromCharCode(i)), 64 != r && (o += String.fromCharCode(a)), 
            e = i = a = 0, n = s = r = 0, h < t.length; ) ;
            return decodeURI(o);
        }, c.timeIntervalSince1970 = function() {
            var t = new Date();
            return Math.round(t.getTime() / 1e3);
        }, c.createGuid = function() {
            return (c.s4() + c.s4() + "-" + c.s4() + "-4" + c.s4().substr(0, 3) + "-" + c.s4() + "-" + c.s4() + c.s4() + c.s4()).toLowerCase();
        }, c.s4 = function() {
            return (65536 * (1 + Math.random()) | 0).toString(16).substring(1);
        }, c.keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", 
        i = c, e.GAUtilities = i;
    }(v = v || {}), function(t) {
        var h = S.logging.GALogger, r = S.utilities.GAUtilities, l = S.events.EGASdkErrorCategory, c = S.events.EGASdkErrorArea, u = S.events.EGASdkErrorAction, d = S.events.EGASdkErrorParameter, p = function(t, e, i, n, s) {
            this.category = t, this.area = e, this.action = i, this.parameter = n, this.reason = s;
        };
        t.ValidationResult = p;
        var e = (g.validateBusinessEvent = function(t, e, i, n, s) {
            return g.validateCurrency(t) ? e < 0 ? (h.w("Validation fail - business event - amount. Cannot be less than 0. Failed amount: " + e), 
            new p(l.EventValidation, c.BusinessEvent, u.InvalidAmount, d.Amount, e + "")) : g.validateShortString(i, !0) ? g.validateEventPartLength(n, !1) ? g.validateEventPartCharacters(n) ? g.validateEventPartLength(s, !1) ? g.validateEventPartCharacters(s) ? null : (h.w("Validation fail - business event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + s), 
            new p(l.EventValidation, c.BusinessEvent, u.InvalidEventPartCharacters, d.ItemId, s)) : (h.w("Validation fail - business event - itemId. Cannot be (null), empty or above 64 characters. String: " + s), 
            new p(l.EventValidation, c.BusinessEvent, u.InvalidEventPartLength, d.ItemId, s)) : (h.w("Validation fail - business event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + n), 
            new p(l.EventValidation, c.BusinessEvent, u.InvalidEventPartCharacters, d.ItemType, n)) : (h.w("Validation fail - business event - itemType: Cannot be (null), empty or above 64 characters. String: " + n), 
            new p(l.EventValidation, c.BusinessEvent, u.InvalidEventPartLength, d.ItemType, n)) : (h.w("Validation fail - business event - cartType. Cannot be above 32 length. String: " + i), 
            new p(l.EventValidation, c.BusinessEvent, u.InvalidShortString, d.CartType, i)) : (h.w("Validation fail - business event - currency: Cannot be (null) and need to be A-Z, 3 characters and in the standard at openexchangerates.org. Failed currency: " + t), 
            new p(l.EventValidation, c.BusinessEvent, u.InvalidCurrency, d.Currency, t));
        }, g.validateResourceEvent = function(t, e, i, n, s, o, a) {
            return t == S.EGAResourceFlowType.Undefined ? (h.w("Validation fail - resource event - flowType: Invalid flow type."), 
            new p(l.EventValidation, c.ResourceEvent, u.InvalidFlowType, d.FlowType, "")) : e ? r.stringArrayContainsString(o, e) ? 0 < i ? n ? g.validateEventPartLength(n, !1) ? g.validateEventPartCharacters(n) ? r.stringArrayContainsString(a, n) ? g.validateEventPartLength(s, !1) ? g.validateEventPartCharacters(s) ? null : (h.w("Validation fail - resource event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + s), 
            new p(l.EventValidation, c.ResourceEvent, u.InvalidEventPartCharacters, d.ItemId, s)) : (h.w("Validation fail - resource event - itemId: Cannot be (null), empty or above 64 characters. String: " + s), 
            new p(l.EventValidation, c.ResourceEvent, u.InvalidEventPartLength, d.ItemId, s)) : (h.w("Validation fail - resource event - itemType: Not found in list of pre-defined available resource itemTypes. String: " + n), 
            new p(l.EventValidation, c.ResourceEvent, u.NotFoundInAvailableItemTypes, d.ItemType, n)) : (h.w("Validation fail - resource event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + n), 
            new p(l.EventValidation, c.ResourceEvent, u.InvalidEventPartCharacters, d.ItemType, n)) : (h.w("Validation fail - resource event - itemType: Cannot be (null), empty or above 64 characters. String: " + n), 
            new p(l.EventValidation, c.ResourceEvent, u.InvalidEventPartLength, d.ItemType, n)) : (h.w("Validation fail - resource event - itemType: Cannot be (null)"), 
            new p(l.EventValidation, c.ResourceEvent, u.StringEmptyOrNull, d.ItemType, "")) : (h.w("Validation fail - resource event - amount: Float amount cannot be 0 or negative. Value: " + i), 
            new p(l.EventValidation, c.ResourceEvent, u.InvalidAmount, d.Amount, i + "")) : (h.w("Validation fail - resource event - currency: Not found in list of pre-defined available resource currencies. String: " + e), 
            new p(l.EventValidation, c.ResourceEvent, u.NotFoundInAvailableCurrencies, d.Currency, e)) : (h.w("Validation fail - resource event - currency: Cannot be (null)"), 
            new p(l.EventValidation, c.ResourceEvent, u.StringEmptyOrNull, d.Currency, ""));
        }, g.validateProgressionEvent = function(t, e, i, n) {
            if (t == S.EGAProgressionStatus.Undefined) return h.w("Validation fail - progression event: Invalid progression status."), 
            new p(l.EventValidation, c.ProgressionEvent, u.InvalidProgressionStatus, d.ProgressionStatus, "");
            if (n && !i && e) return h.w("Validation fail - progression event: 03 found but 01+02 are invalid. Progression must be set as either 01, 01+02 or 01+02+03."), 
            new p(l.EventValidation, c.ProgressionEvent, u.WrongProgressionOrder, d.Undefined, e + ":" + i + ":" + n);
            if (i && !e) return h.w("Validation fail - progression event: 02 found but not 01. Progression must be set as either 01, 01+02 or 01+02+03"), 
            new p(l.EventValidation, c.ProgressionEvent, u.WrongProgressionOrder, d.Undefined, e + ":" + i + ":" + n);
            if (!e) return h.w("Validation fail - progression event: progression01 not valid. Progressions must be set as either 01, 01+02 or 01+02+03"), 
            new p(l.EventValidation, c.ProgressionEvent, u.WrongProgressionOrder, d.Undefined, (e || "") + ":" + (i || "") + ":" + (n || ""));
            if (!g.validateEventPartLength(e, !1)) return h.w("Validation fail - progression event - progression01: Cannot be (null), empty or above 64 characters. String: " + e), 
            new p(l.EventValidation, c.ProgressionEvent, u.InvalidEventPartLength, d.Progression01, e);
            if (!g.validateEventPartCharacters(e)) return h.w("Validation fail - progression event - progression01: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + e), 
            new p(l.EventValidation, c.ProgressionEvent, u.InvalidEventPartCharacters, d.Progression01, e);
            if (i) {
                if (!g.validateEventPartLength(i, !0)) return h.w("Validation fail - progression event - progression02: Cannot be empty or above 64 characters. String: " + i), 
                new p(l.EventValidation, c.ProgressionEvent, u.InvalidEventPartLength, d.Progression02, i);
                if (!g.validateEventPartCharacters(i)) return h.w("Validation fail - progression event - progression02: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + i), 
                new p(l.EventValidation, c.ProgressionEvent, u.InvalidEventPartCharacters, d.Progression02, i);
            }
            if (n) {
                if (!g.validateEventPartLength(n, !0)) return h.w("Validation fail - progression event - progression03: Cannot be empty or above 64 characters. String: " + n), 
                new p(l.EventValidation, c.ProgressionEvent, u.InvalidEventPartLength, d.Progression03, n);
                if (!g.validateEventPartCharacters(n)) return h.w("Validation fail - progression event - progression03: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: " + n), 
                new p(l.EventValidation, c.ProgressionEvent, u.InvalidEventPartCharacters, d.Progression03, n);
            }
            return null;
        }, g.validateDesignEvent = function(t) {
            return g.validateEventIdLength(t) ? g.validateEventIdCharacters(t) ? null : (h.w("Validation fail - design event - eventId: Non valid characters. Only allowed A-z, 0-9, -_., ()!?. String: " + t), 
            new p(l.EventValidation, c.DesignEvent, u.InvalidEventIdCharacters, d.EventId, t)) : (h.w("Validation fail - design event - eventId: Cannot be (null) or empty. Only 5 event parts allowed seperated by :. Each part need to be 64 characters or less. String: " + t), 
            new p(l.EventValidation, c.DesignEvent, u.InvalidEventIdLength, d.EventId, t));
        }, g.validateErrorEvent = function(t, e) {
            return t == S.EGAErrorSeverity.Undefined ? (h.w("Validation fail - error event - severity: Severity was unsupported value."), 
            new p(l.EventValidation, c.ErrorEvent, u.InvalidSeverity, d.Severity, "")) : g.validateLongString(e, !0) ? null : (h.w("Validation fail - error event - message: Message cannot be above 8192 characters."), 
            new p(l.EventValidation, c.ErrorEvent, u.InvalidLongString, d.Message, e));
        }, g.validateAdEvent = function(t, e, i, n) {
            return t == S.EGAAdAction.Undefined ? (h.w("Validation fail - error event - severity: Severity was unsupported value."), 
            new p(l.EventValidation, c.AdEvent, u.InvalidAdAction, d.AdAction, "")) : e == S.EGAAdType.Undefined ? (h.w("Validation fail - ad event - adType: Ad type was unsupported value."), 
            new p(l.EventValidation, c.AdEvent, u.InvalidAdType, d.AdType, "")) : g.validateShortString(i, !1) ? g.validateString(n, !1) ? null : (h.w("Validation fail - ad event - message: Ad placement cannot be above 64 characters."), 
            new p(l.EventValidation, c.AdEvent, u.InvalidString, d.AdPlacement, n)) : (h.w("Validation fail - ad event - message: Ad SDK name cannot be above 32 characters."), 
            new p(l.EventValidation, c.AdEvent, u.InvalidShortString, d.AdSdkName, i));
        }, g.validateSdkErrorEvent = function(t, e, i, n, s) {
            return !(!g.validateKeys(t, e) || (i === l.Undefined ? (h.w("Validation fail - sdk error event - type: Category was unsupported value."), 
            1) : n === c.Undefined ? (h.w("Validation fail - sdk error event - type: Area was unsupported value."), 
            1) : s === u.Undefined && (h.w("Validation fail - sdk error event - type: Action was unsupported value."), 
            1)));
        }, g.validateKeys = function(t, e) {
            return !(!r.stringMatch(t, /^[A-z0-9]{32}$/) || !r.stringMatch(e, /^[A-z0-9]{40}$/));
        }, g.validateCurrency = function(t) {
            return !!t && !!r.stringMatch(t, /^[A-Z]{3}$/);
        }, g.validateEventPartLength = function(t, e) {
            return !(!e || t) || !!t && !(64 < t.length);
        }, g.validateEventPartCharacters = function(t) {
            return !!r.stringMatch(t, /^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}$/);
        }, g.validateEventIdLength = function(t) {
            return !!t && !!r.stringMatch(t, /^[^:]{1,64}(?::[^:]{1,64}){0,4}$/);
        }, g.validateEventIdCharacters = function(t) {
            return !!t && !!r.stringMatch(t, /^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}(:[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}){0,4}$/);
        }, g.validateAndCleanInitRequestResponse = function(t, e) {
            if (null == t) return h.w("validateInitRequestResponse failed - no response dictionary."), 
            null;
            var i = {};
            try {
                var n = t.server_ts;
                if (!(0 < n)) return h.w("validateInitRequestResponse failed - invalid value in 'server_ts' field."), 
                null;
                i.server_ts = n;
            } catch (e) {
                return h.w("validateInitRequestResponse failed - invalid type in 'server_ts' field. type=" + typeof t.server_ts + ", value=" + t.server_ts + ", " + e), 
                null;
            }
            if (e) {
                try {
                    var s = t.configs;
                    i.configs = s;
                } catch (e) {
                    return h.w("validateInitRequestResponse failed - invalid type in 'configs' field. type=" + typeof t.configs + ", value=" + t.configs + ", " + e), 
                    null;
                }
                try {
                    var o = t.configs_hash;
                    i.configs_hash = o;
                } catch (e) {
                    return h.w("validateInitRequestResponse failed - invalid type in 'configs_hash' field. type=" + typeof t.configs_hash + ", value=" + t.configs_hash + ", " + e), 
                    null;
                }
                try {
                    var a = t.ab_id;
                    i.ab_id = a;
                } catch (e) {
                    return h.w("validateInitRequestResponse failed - invalid type in 'ab_id' field. type=" + typeof t.ab_id + ", value=" + t.ab_id + ", " + e), 
                    null;
                }
                try {
                    var r = t.ab_variant_id;
                    i.ab_variant_id = r;
                } catch (e) {
                    return h.w("validateInitRequestResponse failed - invalid type in 'ab_variant_id' field. type=" + typeof t.ab_variant_id + ", value=" + t.ab_variant_id + ", " + e), 
                    null;
                }
            }
            return i;
        }, g.validateBuild = function(t) {
            return !!g.validateShortString(t, !1);
        }, g.validateSdkWrapperVersion = function(t) {
            return !!r.stringMatch(t, /^(unity|unreal|gamemaker|cocos2d|construct|defold|godot) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/);
        }, g.validateEngineVersion = function(t) {
            return !(!t || !r.stringMatch(t, /^(unity|unreal|gamemaker|cocos2d|construct|defold|godot) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/));
        }, g.validateUserId = function(t) {
            return !!g.validateString(t, !1) || (h.w("Validation fail - user id: id cannot be (null), empty or above 64 characters."), 
            !1);
        }, g.validateShortString = function(t, e) {
            return !(!e || t) || !(!t || 32 < t.length);
        }, g.validateString = function(t, e) {
            return !(!e || t) || !(!t || 64 < t.length);
        }, g.validateLongString = function(t, e) {
            return !(!e || t) || !(!t || 8192 < t.length);
        }, g.validateConnectionType = function(t) {
            return r.stringMatch(t, /^(wwan|wifi|lan|offline)$/);
        }, g.validateCustomDimensions = function(t) {
            return g.validateArrayOfStrings(20, 32, !1, "custom dimensions", t);
        }, g.validateResourceCurrencies = function(t) {
            if (!g.validateArrayOfStrings(20, 64, !1, "resource currencies", t)) return !1;
            for (var e = 0; e < t.length; ++e) if (!r.stringMatch(t[e], /^[A-Za-z]+$/)) return h.w("resource currencies validation failed: a resource currency can only be A-Z, a-z. String was: " + t[e]), 
            !1;
            return !0;
        }, g.validateResourceItemTypes = function(t) {
            if (!g.validateArrayOfStrings(20, 32, !1, "resource item types", t)) return !1;
            for (var e = 0; e < t.length; ++e) if (!g.validateEventPartCharacters(t[e])) return h.w("resource item types validation failed: a resource item type cannot contain other characters than A-z, 0-9, -_., ()!?. String was: " + t[e]), 
            !1;
            return !0;
        }, g.validateDimension01 = function(t, e) {
            return !t || !!r.stringArrayContainsString(e, t);
        }, g.validateDimension02 = function(t, e) {
            return !t || !!r.stringArrayContainsString(e, t);
        }, g.validateDimension03 = function(t, e) {
            return !t || !!r.stringArrayContainsString(e, t);
        }, g.validateArrayOfStrings = function(t, e, i, n, s) {
            var o = n;
            if (o = o || "Array", !s) return h.w(o + " validation failed: array cannot be null. "), 
            !1;
            if (0 == i && 0 == s.length) return h.w(o + " validation failed: array cannot be empty. "), 
            !1;
            if (0 < t && s.length > t) return h.w(o + " validation failed: array cannot exceed " + t + " values. It has " + s.length + " values."), 
            !1;
            for (var a = 0; a < s.length; ++a) {
                var r = s[a] ? s[a].length : 0;
                if (0 === r) return h.w(o + " validation failed: contained an empty string. Array=" + JSON.stringify(s)), 
                !1;
                if (0 < e && e < r) return h.w(o + " validation failed: a string exceeded max allowed length (which is: " + e + "). String was: " + s[a]), 
                !1;
            }
            return !0;
        }, g.validateClientTs = function(t) {
            return !(t < 0 || 99999999999 < t);
        }, g);
        function g() {}
        t.GAValidator = e;
    }((S = v = v || {}).validators || (S.validators = {})), function(t) {
        var e = function(t, e, i) {
            this.name = t, this.value = e, this.version = i;
        };
        t.NameValueVersion = e;
        var c = function(t, e) {
            this.name = t, this.version = e;
        };
        t.NameVersion = c;
        var i = (s.touch = function() {}, s.getRelevantSdkVersion = function() {
            return s.sdkGameEngineVersion ? s.sdkGameEngineVersion : s.sdkWrapperVersion;
        }, s.getConnectionType = function() {
            return s.connectionType;
        }, s.updateConnectionType = function() {
            s.connectionType = navigator.onLine ? "ios" === s.buildPlatform || "android" === s.buildPlatform ? "wwan" : "lan" : "offline";
        }, s.getOSVersionString = function() {
            return s.buildPlatform + " " + s.osVersionPair.version;
        }, s.runtimePlatformToString = function() {
            return s.osVersionPair.name;
        }, s.getBrowserVersionString = function() {
            var t, e = navigator.userAgent, i = e.match(/(opera|chrome|safari|firefox|ubrowser|msie|trident|fbav(?=\/))\/?\s*(\d+)/i) || [];
            if (0 == i.length && "ios" === s.buildPlatform) return "webkit_" + s.osVersion;
            if (/trident/i.test(i[1])) return "IE " + ((t = /\brv[ :]+(\d+)/g.exec(e) || [])[1] || "");
            if ("Chrome" === i[1] && null != (t = e.match(/\b(OPR|Edge|UBrowser)\/(\d+)/))) return t.slice(1).join(" ").replace("OPR", "Opera").replace("UBrowser", "UC").toLowerCase();
            if (i[1] && "fbav" === i[1].toLowerCase() && (i[1] = "facebook", i[2])) return "facebook " + i[2];
            var n = i[2] ? [ i[1], i[2] ] : [ navigator.appName, navigator.appVersion, "-?" ];
            return null != (t = e.match(/version\/(\d+)/i)) && n.splice(1, 1, t[1]), n.join(" ").toLowerCase();
        }, s.getDeviceModel = function() {
            return "unknown";
        }, s.getDeviceManufacturer = function() {
            return "unknown";
        }, s.matchItem = function(t, e) {
            var i, n, s, o, a = new c("unknown", "0.0.0"), r = 0, h = 0;
            for (r = 0; r < e.length; r += 1) if (new RegExp(e[r].value, "i").test(t)) {
                if (i = new RegExp(e[r].version + "[- /:;]([\\d._]+)", "i"), o = "", (n = t.match(i)) && n[1] && (s = n[1]), 
                s) {
                    var l = s.split(/[._]+/);
                    for (h = 0; h < Math.min(l.length, 3); h += 1) o += l[h] + (h < Math.min(l.length, 3) - 1 ? "." : "");
                } else o = "0.0.0";
                return a.name = e[r].name, a.version = o, a;
            }
            return a;
        }, s.sdkWrapperVersion = "javascript 4.2.1", s.osVersionPair = s.matchItem([ navigator.platform, navigator.userAgent, navigator.appVersion, navigator.vendor ].join(" "), [ new e("windows_phone", "Windows Phone", "OS"), new e("windows", "Win", "NT"), new e("ios", "iPhone", "OS"), new e("ios", "iPad", "OS"), new e("ios", "iPod", "OS"), new e("android", "Android", "Android"), new e("blackBerry", "BlackBerry", "/"), new e("mac_osx", "Mac", "OS X"), new e("tizen", "Tizen", "Tizen"), new e("linux", "Linux", "rv"), new e("kai_os", "KAIOS", "KAIOS") ]), 
        s.buildPlatform = s.runtimePlatformToString(), s.deviceModel = s.getDeviceModel(), 
        s.deviceManufacturer = s.getDeviceManufacturer(), s.osVersion = s.getOSVersionString(), 
        s.browserVersion = s.getBrowserVersionString(), s);
        function s() {}
        t.GADevice = i;
    }((_ = v = v || {}).device || (_.device = {})), function(t) {
        var e, i;
        function n(t) {
            this.deadline = t, this.ignore = !1, this.async = !1, this.running = !1, this.id = ++n.idCounter;
        }
        e = t.threading || (t.threading = {}), n.idCounter = 0, i = n, e.TimedBlock = i;
    }(v = v || {}), function(t) {
        var e, i;
        function n(t) {
            this.comparer = t, this._subQueues = {}, this._sortedKeys = [];
        }
        e = t.threading || (t.threading = {}), n.prototype.enqueue = function(t, e) {
            -1 === this._sortedKeys.indexOf(t) && this.addQueueOfPriority(t), this._subQueues[t].push(e);
        }, n.prototype.addQueueOfPriority = function(t) {
            var i = this;
            this._sortedKeys.push(t), this._sortedKeys.sort(function(t, e) {
                return i.comparer.compare(t, e);
            }), this._subQueues[t] = [];
        }, n.prototype.peek = function() {
            if (this.hasItems()) return this._subQueues[this._sortedKeys[0]][0];
            throw new Error("The queue is empty");
        }, n.prototype.hasItems = function() {
            return 0 < this._sortedKeys.length;
        }, n.prototype.dequeue = function() {
            if (this.hasItems()) return this.dequeueFromHighPriorityQueue();
            throw new Error("The queue is empty");
        }, n.prototype.dequeueFromHighPriorityQueue = function() {
            var t = this._sortedKeys[0], e = this._subQueues[t].shift();
            return 0 === this._subQueues[t].length && (this._sortedKeys.shift(), delete this._subQueues[t]), 
            e;
        }, i = n, e.PriorityQueue = i;
    }(v = v || {}), function(t) {
        var u, e, i, n, s = b.logging.GALogger;
        (e = u = t.EGAStoreArgsOperator || (t.EGAStoreArgsOperator = {}))[e.Equal = 0] = "Equal", 
        e[e.LessOrEqual = 1] = "LessOrEqual", e[e.NotEqual = 2] = "NotEqual", (n = i = t.EGAStore || (t.EGAStore = {}))[n.Events = 0] = "Events", 
        n[n.Sessions = 1] = "Sessions", n[n.Progression = 2] = "Progression";
        var o = (d.isStorageAvailable = function() {
            return d.storageAvailable;
        }, d.isStoreTooLargeForEvents = function() {
            return d.instance.eventsStore.length + d.instance.sessionsStore.length > d.MaxNumberOfEntries;
        }, d.select = function(t, e, i, n) {
            void 0 === e && (e = []), void 0 === i && (i = !1), void 0 === n && (n = 0);
            var s = d.getStore(t);
            if (!s) return null;
            for (var o = [], a = 0; a < s.length; ++a) {
                for (var r = s[a], h = !0, l = 0; l < e.length; ++l) {
                    var c = e[l];
                    if (r[c[0]]) switch (c[1]) {
                      case u.Equal:
                        h = r[c[0]] == c[2];
                        break;

                      case u.LessOrEqual:
                        h = r[c[0]] <= c[2];
                        break;

                      case u.NotEqual:
                        h = r[c[0]] != c[2];
                        break;

                      default:
                        h = !1;
                    } else h = !1;
                    if (!h) break;
                }
                h && o.push(r);
            }
            return i && o.sort(function(t, e) {
                return t.client_ts - e.client_ts;
            }), 0 < n && o.length > n && (o = o.slice(0, n + 1)), o;
        }, d.update = function(t, e, i) {
            void 0 === i && (i = []);
            var n = d.getStore(t);
            if (!n) return !1;
            for (var s = 0; s < n.length; ++s) {
                for (var o = n[s], a = !0, r = 0; r < i.length; ++r) {
                    var h = i[r];
                    if (o[h[0]]) switch (h[1]) {
                      case u.Equal:
                        a = o[h[0]] == h[2];
                        break;

                      case u.LessOrEqual:
                        a = o[h[0]] <= h[2];
                        break;

                      case u.NotEqual:
                        a = o[h[0]] != h[2];
                        break;

                      default:
                        a = !1;
                    } else a = !1;
                    if (!a) break;
                }
                if (a) for (r = 0; r < e.length; ++r) {
                    var l = e[r];
                    o[l[0]] = l[1];
                }
            }
            return !0;
        }, d.delete = function(t, e) {
            var i = d.getStore(t);
            if (i) for (var n = 0; n < i.length; ++n) {
                for (var s = i[n], o = !0, a = 0; a < e.length; ++a) {
                    var r = e[a];
                    if (s[r[0]]) switch (r[1]) {
                      case u.Equal:
                        o = s[r[0]] == r[2];
                        break;

                      case u.LessOrEqual:
                        o = s[r[0]] <= r[2];
                        break;

                      case u.NotEqual:
                        o = s[r[0]] != r[2];
                        break;

                      default:
                        o = !1;
                    } else o = !1;
                    if (!o) break;
                }
                o && (i.splice(n, 1), --n);
            }
        }, d.insert = function(t, e, i, n) {
            void 0 === i && (i = !1), void 0 === n && (n = null);
            var s = d.getStore(t);
            if (s) if (i) {
                if (!n) return;
                for (var o = !1, a = 0; a < s.length; ++a) {
                    var r = s[a];
                    if (r[n] == e[n]) {
                        for (var h in e) r[h] = e[h];
                        o = !0;
                        break;
                    }
                }
                o || s.push(e);
            } else s.push(e);
        }, d.save = function(t) {
            d.isStorageAvailable() ? (localStorage.setItem(d.StringFormat(d.KeyFormat, t, d.EventsStoreKey), JSON.stringify(d.instance.eventsStore)), 
            localStorage.setItem(d.StringFormat(d.KeyFormat, t, d.SessionsStoreKey), JSON.stringify(d.instance.sessionsStore)), 
            localStorage.setItem(d.StringFormat(d.KeyFormat, t, d.ProgressionStoreKey), JSON.stringify(d.instance.progressionStore)), 
            localStorage.setItem(d.StringFormat(d.KeyFormat, t, d.ItemsStoreKey), JSON.stringify(d.instance.storeItems))) : s.w("Storage is not available, cannot save.");
        }, d.load = function(t) {
            if (d.isStorageAvailable()) {
                try {
                    d.instance.eventsStore = JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat, t, d.EventsStoreKey))), 
                    d.instance.eventsStore || (d.instance.eventsStore = []);
                } catch (t) {
                    s.w("Load failed for 'events' store. Using empty store."), d.instance.eventsStore = [];
                }
                try {
                    d.instance.sessionsStore = JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat, t, d.SessionsStoreKey))), 
                    d.instance.sessionsStore || (d.instance.sessionsStore = []);
                } catch (t) {
                    s.w("Load failed for 'sessions' store. Using empty store."), d.instance.sessionsStore = [];
                }
                try {
                    d.instance.progressionStore = JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat, t, d.ProgressionStoreKey))), 
                    d.instance.progressionStore || (d.instance.progressionStore = []);
                } catch (t) {
                    s.w("Load failed for 'progression' store. Using empty store."), d.instance.progressionStore = [];
                }
                try {
                    d.instance.storeItems = JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat, t, d.ItemsStoreKey))), 
                    d.instance.storeItems || (d.instance.storeItems = {});
                } catch (t) {
                    s.w("Load failed for 'items' store. Using empty store."), d.instance.progressionStore = [];
                }
            } else s.w("Storage is not available, cannot load.");
        }, d.setItem = function(t, e, i) {
            var n = d.StringFormat(d.KeyFormat, t, e);
            i ? d.instance.storeItems[n] = i : n in d.instance.storeItems && delete d.instance.storeItems[n];
        }, d.getItem = function(t, e) {
            var i = d.StringFormat(d.KeyFormat, t, e);
            return i in d.instance.storeItems ? d.instance.storeItems[i] : null;
        }, d.getStore = function(t) {
            switch (t) {
              case i.Events:
                return d.instance.eventsStore;

              case i.Sessions:
                return d.instance.sessionsStore;

              case i.Progression:
                return d.instance.progressionStore;

              default:
                return s.w("GAStore.getStore(): Cannot find store: " + t), null;
            }
        }, d.instance = new d(), d.MaxNumberOfEntries = 2e3, d.StringFormat = function(t) {
            for (var i = [], e = 1; e < arguments.length; e++) i[e - 1] = arguments[e];
            return t.replace(/{(\d+)}/g, function(t, e) {
                return i[e] || "";
            });
        }, d.KeyFormat = "GA::{0}::{1}", d.EventsStoreKey = "ga_event", d.SessionsStoreKey = "ga_session", 
        d.ProgressionStoreKey = "ga_progression", d.ItemsStoreKey = "ga_items", d);
        function d() {
            this.eventsStore = [], this.sessionsStore = [], this.progressionStore = [], this.storeItems = {};
            try {
                "object" == typeof localStorage ? (localStorage.setItem("testingLocalStorage", "yes"), 
                localStorage.removeItem("testingLocalStorage"), d.storageAvailable = !0) : d.storageAvailable = !1;
            } catch (t) {}
        }
        t.GAStore = o;
    }((b = v = v || {}).store || (b.store = {})), function(t) {
        var e, s, h, l, r, o, c, i, n;
        function u() {
            this.availableCustomDimensions01 = [], this.availableCustomDimensions02 = [], this.availableCustomDimensions03 = [], 
            this.availableResourceCurrencies = [], this.availableResourceItemTypes = [], this.configurations = {}, 
            this.remoteConfigsListeners = [], this.beforeUnloadListeners = [], this.sdkConfigDefault = {}, 
            this.sdkConfig = {}, this.progressionTries = {}, this._isEventSubmissionEnabled = !0, 
            this.isUnloading = !1;
        }
        e = t.state || (t.state = {}), s = t.validators.GAValidator, h = t.utilities.GAUtilities, 
        l = t.logging.GALogger, r = t.store.GAStore, o = t.device.GADevice, c = t.store.EGAStore, 
        i = t.store.EGAStoreArgsOperator, u.setUserId = function(t) {
            u.instance.userId = t, u.cacheIdentifier();
        }, u.getIdentifier = function() {
            return u.instance.identifier;
        }, u.isInitialized = function() {
            return u.instance.initialized;
        }, u.setInitialized = function(t) {
            u.instance.initialized = t;
        }, u.getSessionStart = function() {
            return u.instance.sessionStart;
        }, u.getSessionNum = function() {
            return u.instance.sessionNum;
        }, u.getTransactionNum = function() {
            return u.instance.transactionNum;
        }, u.getSessionId = function() {
            return u.instance.sessionId;
        }, u.getCurrentCustomDimension01 = function() {
            return u.instance.currentCustomDimension01;
        }, u.getCurrentCustomDimension02 = function() {
            return u.instance.currentCustomDimension02;
        }, u.getCurrentCustomDimension03 = function() {
            return u.instance.currentCustomDimension03;
        }, u.getGameKey = function() {
            return u.instance.gameKey;
        }, u.getGameSecret = function() {
            return u.instance.gameSecret;
        }, u.getAvailableCustomDimensions01 = function() {
            return u.instance.availableCustomDimensions01;
        }, u.setAvailableCustomDimensions01 = function(t) {
            s.validateCustomDimensions(t) && (u.instance.availableCustomDimensions01 = t, u.validateAndFixCurrentDimensions(), 
            l.i("Set available custom01 dimension values: (" + h.joinStringArray(t, ", ") + ")"));
        }, u.getAvailableCustomDimensions02 = function() {
            return u.instance.availableCustomDimensions02;
        }, u.setAvailableCustomDimensions02 = function(t) {
            s.validateCustomDimensions(t) && (u.instance.availableCustomDimensions02 = t, u.validateAndFixCurrentDimensions(), 
            l.i("Set available custom02 dimension values: (" + h.joinStringArray(t, ", ") + ")"));
        }, u.getAvailableCustomDimensions03 = function() {
            return u.instance.availableCustomDimensions03;
        }, u.setAvailableCustomDimensions03 = function(t) {
            s.validateCustomDimensions(t) && (u.instance.availableCustomDimensions03 = t, u.validateAndFixCurrentDimensions(), 
            l.i("Set available custom03 dimension values: (" + h.joinStringArray(t, ", ") + ")"));
        }, u.getAvailableResourceCurrencies = function() {
            return u.instance.availableResourceCurrencies;
        }, u.setAvailableResourceCurrencies = function(t) {
            s.validateResourceCurrencies(t) && (u.instance.availableResourceCurrencies = t, 
            l.i("Set available resource currencies: (" + h.joinStringArray(t, ", ") + ")"));
        }, u.getAvailableResourceItemTypes = function() {
            return u.instance.availableResourceItemTypes;
        }, u.setAvailableResourceItemTypes = function(t) {
            s.validateResourceItemTypes(t) && (u.instance.availableResourceItemTypes = t, l.i("Set available resource item types: (" + h.joinStringArray(t, ", ") + ")"));
        }, u.getBuild = function() {
            return u.instance.build;
        }, u.setBuild = function(t) {
            u.instance.build = t, l.i("Set build version: " + t);
        }, u.getUseManualSessionHandling = function() {
            return u.instance.useManualSessionHandling;
        }, u.isEventSubmissionEnabled = function() {
            return u.instance._isEventSubmissionEnabled;
        }, u.getABTestingId = function() {
            return u.instance.abId;
        }, u.getABTestingVariantId = function() {
            return u.instance.abVariantId;
        }, u.prototype.setDefaultId = function(t) {
            this.defaultUserId = t || "", u.cacheIdentifier();
        }, u.getDefaultId = function() {
            return u.instance.defaultUserId;
        }, u.getSdkConfig = function() {
            var t, e = 0;
            for (var i in u.instance.sdkConfig) 0 === e && (t = i), ++e;
            if (t && 0 < e) return u.instance.sdkConfig;
            for (var i in e = 0, u.instance.sdkConfigCached) 0 === e && (t = i), ++e;
            return t && 0 < e ? u.instance.sdkConfigCached : u.instance.sdkConfigDefault;
        }, u.isEnabled = function() {
            return !!u.instance.initAuthorized;
        }, u.setCustomDimension01 = function(t) {
            u.instance.currentCustomDimension01 = t, r.setItem(u.getGameKey(), u.Dimension01Key, t), 
            l.i("Set custom01 dimension value: " + t);
        }, u.setCustomDimension02 = function(t) {
            u.instance.currentCustomDimension02 = t, r.setItem(u.getGameKey(), u.Dimension02Key, t), 
            l.i("Set custom02 dimension value: " + t);
        }, u.setCustomDimension03 = function(t) {
            u.instance.currentCustomDimension03 = t, r.setItem(u.getGameKey(), u.Dimension03Key, t), 
            l.i("Set custom03 dimension value: " + t);
        }, u.incrementSessionNum = function() {
            var t = u.getSessionNum() + 1;
            u.instance.sessionNum = t;
        }, u.incrementTransactionNum = function() {
            var t = u.getTransactionNum() + 1;
            u.instance.transactionNum = t;
        }, u.incrementProgressionTries = function(t) {
            var e = u.getProgressionTries(t) + 1;
            u.instance.progressionTries[t] = e;
            var i = {};
            i.progression = t, i.tries = e, r.insert(c.Progression, i, !0, "progression");
        }, u.getProgressionTries = function(t) {
            return t in u.instance.progressionTries ? u.instance.progressionTries[t] : 0;
        }, u.clearProgressionTries = function(t) {
            t in u.instance.progressionTries && delete u.instance.progressionTries[t];
            var e = [];
            e.push([ "progression", i.Equal, t ]), r.delete(c.Progression, e);
        }, u.setKeys = function(t, e) {
            u.instance.gameKey = t, u.instance.gameSecret = e;
        }, u.setManualSessionHandling = function(t) {
            u.instance.useManualSessionHandling = t, l.i("Use manual session handling: " + t);
        }, u.setEnabledEventSubmission = function(t) {
            u.instance._isEventSubmissionEnabled = t;
        }, u.getEventAnnotations = function() {
            var t = {
                v: 2
            };
            t.user_id = u.instance.identifier, t.client_ts = u.getClientTsAdjusted(), t.sdk_version = o.getRelevantSdkVersion(), 
            t.os_version = o.osVersion, t.manufacturer = o.deviceManufacturer, t.device = o.deviceModel, 
            t.browser_version = o.browserVersion, t.platform = o.buildPlatform, t.session_id = u.instance.sessionId, 
            t[u.SessionNumKey] = u.instance.sessionNum;
            var e = o.getConnectionType();
            if (s.validateConnectionType(e) && (t.connection_type = e), o.gameEngineVersion && (t.engine_version = o.gameEngineVersion), 
            u.instance.configurations) {
                var i = 0;
                for (var n in u.instance.configurations) {
                    i++;
                    break;
                }
                0 < i && (t.configurations = u.instance.configurations);
            }
            return u.instance.abId && (t.ab_id = u.instance.abId), u.instance.abVariantId && (t.ab_variant_id = u.instance.abVariantId), 
            u.instance.build && (t.build = u.instance.build), t;
        }, u.getSdkErrorEventAnnotations = function() {
            var t = {
                v: 2
            };
            t.category = u.CategorySdkError, t.sdk_version = o.getRelevantSdkVersion(), t.os_version = o.osVersion, 
            t.manufacturer = o.deviceManufacturer, t.device = o.deviceModel, t.platform = o.buildPlatform;
            var e = o.getConnectionType();
            return s.validateConnectionType(e) && (t.connection_type = e), o.gameEngineVersion && (t.engine_version = o.gameEngineVersion), 
            t;
        }, u.getInitAnnotations = function() {
            var t = {};
            return u.getIdentifier() || u.cacheIdentifier(), t.user_id = u.getIdentifier(), 
            t.sdk_version = o.getRelevantSdkVersion(), t.os_version = o.osVersion, t.platform = o.buildPlatform, 
            u.getBuild() ? t.build = u.getBuild() : t.build = null, t.session_num = u.getSessionNum(), 
            t.random_salt = u.getSessionNum(), t;
        }, u.getClientTsAdjusted = function() {
            var t = h.timeIntervalSince1970(), e = t + u.instance.clientServerTimeOffset;
            return s.validateClientTs(e) ? e : t;
        }, u.sessionIsStarted = function() {
            return 0 != u.instance.sessionStart;
        }, u.cacheIdentifier = function() {
            u.instance.userId ? u.instance.identifier = u.instance.userId : u.instance.defaultUserId && (u.instance.identifier = u.instance.defaultUserId);
        }, u.ensurePersistedStates = function() {
            r.isStorageAvailable() && r.load(u.getGameKey());
            var t = u.instance;
            t.setDefaultId(null != r.getItem(u.getGameKey(), u.DefaultUserIdKey) ? r.getItem(u.getGameKey(), u.DefaultUserIdKey) : h.createGuid()), 
            t.sessionNum = null != r.getItem(u.getGameKey(), u.SessionNumKey) ? Number(r.getItem(u.getGameKey(), u.SessionNumKey)) : 0, 
            t.transactionNum = null != r.getItem(u.getGameKey(), u.TransactionNumKey) ? Number(r.getItem(u.getGameKey(), u.TransactionNumKey)) : 0, 
            t.currentCustomDimension01 ? r.setItem(u.getGameKey(), u.Dimension01Key, t.currentCustomDimension01) : (t.currentCustomDimension01 = null != r.getItem(u.getGameKey(), u.Dimension01Key) ? r.getItem(u.getGameKey(), u.Dimension01Key) : "", 
            t.currentCustomDimension01), t.currentCustomDimension02 ? r.setItem(u.getGameKey(), u.Dimension02Key, t.currentCustomDimension02) : (t.currentCustomDimension02 = null != r.getItem(u.getGameKey(), u.Dimension02Key) ? r.getItem(u.getGameKey(), u.Dimension02Key) : "", 
            t.currentCustomDimension02), t.currentCustomDimension03 ? r.setItem(u.getGameKey(), u.Dimension03Key, t.currentCustomDimension03) : (t.currentCustomDimension03 = null != r.getItem(u.getGameKey(), u.Dimension03Key) ? r.getItem(u.getGameKey(), u.Dimension03Key) : "", 
            t.currentCustomDimension03);
            var e = null != r.getItem(u.getGameKey(), u.SdkConfigCachedKey) ? r.getItem(u.getGameKey(), u.SdkConfigCachedKey) : "";
            if (e) {
                var i = JSON.parse(h.decode64(e));
                i && (t.sdkConfigCached = i);
            }
            var n = u.getSdkConfig();
            t.configsHash = n.configs_hash ? n.configs_hash : "", t.abId = n.ab_id ? n.ab_id : "", 
            t.abVariantId = n.ab_variant_id ? n.ab_variant_id : "";
            var s = r.select(c.Progression);
            if (s) for (var o = 0; o < s.length; ++o) {
                var a = s[o];
                a && (t.progressionTries[a.progression] = a.tries);
            }
        }, u.calculateServerTimeOffset = function(t) {
            return t - h.timeIntervalSince1970();
        }, u.validateAndCleanCustomFields = function(t) {
            var e = {};
            if (t) {
                var i = 0;
                for (var n in t) {
                    var s = t[n];
                    if (n && s) if (i < u.MAX_CUSTOM_FIELDS_COUNT) {
                        var o = new RegExp("^[a-zA-Z0-9_]{1," + u.MAX_CUSTOM_FIELDS_KEY_LENGTH + "}$");
                        if (h.stringMatch(n, o)) {
                            var a = typeof s;
                            if ("string" == a || s instanceof String) s.length <= u.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH && 0 < s.length ? (e[n] = s, 
                            ++i) : l.w("validateAndCleanCustomFields: entry with key=" + n + ", value=" + s + " has been omitted because its value is an empty string or exceeds the max number of characters (" + u.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH + ")"); else if ("number" == a || s instanceof Number) {
                                var r = s;
                                e[n] = r, ++i;
                            } else l.w("validateAndCleanCustomFields: entry with key=" + n + ", value=" + s + " has been omitted because its value is not a string or number");
                        } else l.w("validateAndCleanCustomFields: entry with key=" + n + ", value=" + s + " has been omitted because its key contains illegal character, is empty or exceeds the max number of characters (" + u.MAX_CUSTOM_FIELDS_KEY_LENGTH + ")");
                    } else l.w("validateAndCleanCustomFields: entry with key=" + n + ", value=" + s + " has been omitted because it exceeds the max number of custom fields (" + u.MAX_CUSTOM_FIELDS_COUNT + ")"); else l.w("validateAndCleanCustomFields: entry with key=" + n + ", value=" + s + " has been omitted because its key or value is null");
                }
            }
            return e;
        }, u.validateAndFixCurrentDimensions = function() {
            s.validateDimension01(u.getCurrentCustomDimension01(), u.getAvailableCustomDimensions01()) || u.setCustomDimension01(""), 
            s.validateDimension02(u.getCurrentCustomDimension02(), u.getAvailableCustomDimensions02()) || u.setCustomDimension02(""), 
            s.validateDimension03(u.getCurrentCustomDimension03(), u.getAvailableCustomDimensions03()) || u.setCustomDimension03("");
        }, u.getConfigurationStringValue = function(t, e) {
            return u.instance.configurations[t] ? u.instance.configurations[t].toString() : e;
        }, u.isRemoteConfigsReady = function() {
            return u.instance.remoteConfigsIsReady;
        }, u.addRemoteConfigsListener = function(t) {
            u.instance.remoteConfigsListeners.indexOf(t) < 0 && u.instance.remoteConfigsListeners.push(t);
        }, u.removeRemoteConfigsListener = function(t) {
            var e = u.instance.remoteConfigsListeners.indexOf(t);
            -1 < e && u.instance.remoteConfigsListeners.splice(e, 1);
        }, u.getRemoteConfigsContentAsString = function() {
            return JSON.stringify(u.instance.configurations);
        }, u.populateConfigurations = function(t) {
            var e = t.configs;
            if (e) {
                u.instance.configurations = {};
                for (var i = 0; i < e.length; ++i) {
                    var n = e[i];
                    if (n) {
                        var s = n.key, o = n.value, a = n.start_ts ? n.start_ts : Number.MIN_VALUE, r = n.end_ts ? n.end_ts : Number.MAX_VALUE, h = u.getClientTsAdjusted();
                        s && o && a < h && h < r && (u.instance.configurations[s] = o);
                    }
                }
            }
            u.instance.remoteConfigsIsReady = !0;
            var l = u.instance.remoteConfigsListeners;
            for (i = 0; i < l.length; ++i) l[i] && l[i].onRemoteConfigsUpdated();
        }, u.addOnBeforeUnloadListener = function(t) {
            u.instance.beforeUnloadListeners.indexOf(t) < 0 && u.instance.beforeUnloadListeners.push(t);
        }, u.removeOnBeforeUnloadListener = function(t) {
            var e = u.instance.beforeUnloadListeners.indexOf(t);
            -1 < e && u.instance.beforeUnloadListeners.splice(e, 1);
        }, u.notifyBeforeUnloadListeners = function() {
            for (var t = u.instance.beforeUnloadListeners, e = 0; e < t.length; ++e) t[e] && t[e].onBeforeUnload();
        }, u.CategorySdkError = "sdk_error", u.MAX_CUSTOM_FIELDS_COUNT = 50, u.MAX_CUSTOM_FIELDS_KEY_LENGTH = 64, 
        u.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH = 256, u.instance = new u(), u.DefaultUserIdKey = "default_user_id", 
        u.SessionNumKey = "session_num", u.TransactionNumKey = "transaction_num", u.Dimension01Key = "dimension01", 
        u.Dimension02Key = "dimension02", u.Dimension03Key = "dimension03", u.SdkConfigCachedKey = "sdk_config_cached", 
        n = u, e.GAState = n;
    }(v = v || {}), function(t) {
        var e, r, h, i;
        function l() {}
        e = t.tasks || (t.tasks = {}), r = t.utilities.GAUtilities, h = t.logging.GALogger, 
        l.execute = function(t, e, i, n) {
            var s = new Date();
            if (l.timestampMap[e] || (l.timestampMap[e] = s), l.countMap[e] || (l.countMap[e] = 0), 
            3600 <= (s.getTime() - l.timestampMap[e].getTime()) / 1e3 && (l.timestampMap[e] = s, 
            l.countMap[e] = 0), !(l.countMap[e] >= l.MaxCount)) {
                var o = r.getHmac(n, i), a = new XMLHttpRequest();
                a.onreadystatechange = function() {
                    if (4 === a.readyState) {
                        if (!a.responseText) return;
                        if (200 != a.status) return void h.w("sdk error failed. response code not 200. status code: " + a.status + ", description: " + a.statusText + ", body: " + a.responseText);
                        l.countMap[e] = l.countMap[e] + 1;
                    }
                }, a.open("POST", t, !0), a.setRequestHeader("Content-Type", "application/json"), 
                a.setRequestHeader("Authorization", o);
                try {
                    a.send(i);
                } catch (t) {}
            }
        }, l.MaxCount = 10, l.countMap = {}, l.timestampMap = {}, i = l, e.SdkErrorTask = i;
    }(v = v || {}), function(t) {
        var c, y, v, u, b, _, d, p, g, m, e;
        function S() {
            this.protocol = "https", this.hostName = "api.gameanalytics.com", this.version = "v2", 
            this.remoteConfigsVersion = "v1", this.baseUrl = this.protocol + "://" + this.hostName + "/" + this.version, 
            this.remoteConfigsBaseUrl = this.protocol + "://" + this.hostName + "/remote_configs/" + this.remoteConfigsVersion, 
            this.initializeUrlPath = "init", this.eventsUrlPath = "events", this.useGzip = !1;
        }
        c = t.http || (t.http = {}), y = t.state.GAState, v = t.logging.GALogger, u = t.utilities.GAUtilities, 
        b = t.validators.GAValidator, _ = t.tasks.SdkErrorTask, d = t.events.EGASdkErrorCategory, 
        p = t.events.EGASdkErrorArea, g = t.events.EGASdkErrorAction, m = t.events.EGASdkErrorParameter, 
        S.prototype.requestInit = function(t, e) {
            var i = y.getGameKey(), n = this.remoteConfigsBaseUrl + "/" + this.initializeUrlPath + "?game_key=" + i + "&interval_seconds=0&configs_hash=" + t, s = y.getInitAnnotations(), o = JSON.stringify(s);
            if (o) {
                var a = this.createPayloadData(o, this.useGzip), r = [];
                r.push(o), S.sendRequest(n, a, r, this.useGzip, S.initRequestCallback, e);
            } else e(c.EGAHTTPApiResponse.JsonEncodeFailed, null);
        }, S.prototype.sendEventsInArray = function(t, e, i) {
            if (0 != t.length) {
                var n = y.getGameKey(), s = this.baseUrl + "/" + n + "/" + this.eventsUrlPath, o = JSON.stringify(t);
                if (o) {
                    var a = this.createPayloadData(o, this.useGzip), r = [];
                    r.push(o), r.push(e), r.push(t.length.toString()), S.sendRequest(s, a, r, this.useGzip, S.sendEventInArrayRequestCallback, i);
                } else i(c.EGAHTTPApiResponse.JsonEncodeFailed, null, e, t.length);
            }
        }, S.prototype.sendSdkErrorEvent = function(t, e, i, n, s, o, a) {
            if (y.isEventSubmissionEnabled() && b.validateSdkErrorEvent(o, a, t, e, i)) {
                var r, h = this.baseUrl + "/" + o + "/" + this.eventsUrlPath, l = "", c = y.getSdkErrorEventAnnotations(), u = S.sdkErrorCategoryString(t);
                l += c.error_category = u;
                var d = S.sdkErrorAreaString(e);
                l += ":" + (c.error_area = d);
                var p = S.sdkErrorActionString(i);
                c.error_action = p;
                var g = S.sdkErrorParameterString(n);
                if (0 < g.length && (c.error_parameter = g), 0 < s.length) {
                    var m = s;
                    s.length > S.MAX_ERROR_MESSAGE_LENGTH && (m = s.substring(0, S.MAX_ERROR_MESSAGE_LENGTH)), 
                    c.reason = m;
                }
                var f = [];
                f.push(c), (r = JSON.stringify(f)) ? _.execute(h, l, r, a) : v.w("sendSdkErrorEvent: JSON encoding failed.");
            }
        }, S.sendEventInArrayRequestCallback = function(t, e, i, n) {
            void 0 === n && (n = null), n[0], n[1];
            var s, o, a = n[2], r = parseInt(n[3]);
            s = t.responseText, o = t.status;
            var h = S.instance.processRequestResponse(o, t.statusText, s, "Events");
            if (h == c.EGAHTTPApiResponse.Ok || h == c.EGAHTTPApiResponse.Created || h == c.EGAHTTPApiResponse.BadRequest) {
                var l = s ? JSON.parse(s) : {};
                if (null == l) return i(c.EGAHTTPApiResponse.JsonDecodeFailed, null, a, r), void S.instance.sendSdkErrorEvent(d.Http, p.EventsHttp, g.FailHttpJsonDecode, m.Undefined, s, y.getGameKey(), y.getGameSecret());
                c.EGAHTTPApiResponse.BadRequest, i(h, l, a, r);
            } else i(h, null, a, r);
        }, S.sendRequest = function(t, e, i, n, s, o) {
            var a = new XMLHttpRequest(), r = y.getGameSecret(), h = u.getHmac(r, e), l = [];
            for (var c in l.push(h), i) l.push(i[c]);
            if (a.onreadystatechange = function() {
                4 === a.readyState && s(a, t, o, l);
            }, a.open("POST", t, !0), a.setRequestHeader("Content-Type", "application/json"), 
            a.setRequestHeader("Authorization", h), n) throw new Error("gzip not supported");
            try {
                a.send(e);
            } catch (t) {}
        }, S.initRequestCallback = function(t, e, i, n) {
            var s, o;
            void 0 === n && (n = null), n[0], n[1], s = t.responseText, o = t.status;
            var a = s ? JSON.parse(s) : {}, r = S.instance.processRequestResponse(o, t.statusText, s, "Init");
            if (r == c.EGAHTTPApiResponse.Ok || r == c.EGAHTTPApiResponse.Created || r == c.EGAHTTPApiResponse.BadRequest) {
                if (null == a) return i(c.EGAHTTPApiResponse.JsonDecodeFailed, null, "", 0), void S.instance.sendSdkErrorEvent(d.Http, p.InitHttp, g.FailHttpJsonDecode, m.Undefined, s, y.getGameKey(), y.getGameSecret());
                if (r !== c.EGAHTTPApiResponse.BadRequest) {
                    var h = b.validateAndCleanInitRequestResponse(a, r === c.EGAHTTPApiResponse.Created);
                    h ? i(r, h, "", 0) : i(c.EGAHTTPApiResponse.BadResponse, null, "", 0);
                } else i(r, null, "", 0);
            } else i(r, null, "", 0);
        }, S.prototype.createPayloadData = function(t, e) {
            if (e) throw new Error("gzip not supported");
            return t;
        }, S.prototype.processRequestResponse = function(t, e, i, n) {
            return i ? 200 === t ? c.EGAHTTPApiResponse.Ok : 201 === t ? c.EGAHTTPApiResponse.Created : 0 === t || 401 === t ? c.EGAHTTPApiResponse.Unauthorized : 400 === t ? c.EGAHTTPApiResponse.BadRequest : 500 === t ? c.EGAHTTPApiResponse.InternalServerError : c.EGAHTTPApiResponse.UnknownResponseCode : c.EGAHTTPApiResponse.NoResponse;
        }, S.sdkErrorCategoryString = function(t) {
            switch (t) {
              case d.EventValidation:
                return "event_validation";

              case d.Database:
                return "db";

              case d.Init:
                return "init";

              case d.Http:
                return "http";

              case d.Json:
                return "json";
            }
            return "";
        }, S.sdkErrorAreaString = function(t) {
            switch (t) {
              case p.BusinessEvent:
                return "business";

              case p.ResourceEvent:
                return "resource";

              case p.ProgressionEvent:
                return "progression";

              case p.DesignEvent:
                return "design";

              case p.ErrorEvent:
                return "error";

              case p.InitHttp:
                return "init_http";

              case p.EventsHttp:
                return "events_http";

              case p.ProcessEvents:
                return "process_events";

              case p.AddEventsToStore:
                return "add_events_to_store";
            }
            return "";
        }, S.sdkErrorActionString = function(t) {
            switch (t) {
              case g.InvalidCurrency:
                return "invalid_currency";

              case g.InvalidShortString:
                return "invalid_short_string";

              case g.InvalidEventPartLength:
                return "invalid_event_part_length";

              case g.InvalidEventPartCharacters:
                return "invalid_event_part_characters";

              case g.InvalidStore:
                return "invalid_store";

              case g.InvalidFlowType:
                return "invalid_flow_type";

              case g.StringEmptyOrNull:
                return "string_empty_or_null";

              case g.NotFoundInAvailableCurrencies:
                return "not_found_in_available_currencies";

              case g.InvalidAmount:
                return "invalid_amount";

              case g.NotFoundInAvailableItemTypes:
                return "not_found_in_available_item_types";

              case g.WrongProgressionOrder:
                return "wrong_progression_order";

              case g.InvalidEventIdLength:
                return "invalid_event_id_length";

              case g.InvalidEventIdCharacters:
                return "invalid_event_id_characters";

              case g.InvalidProgressionStatus:
                return "invalid_progression_status";

              case g.InvalidSeverity:
                return "invalid_severity";

              case g.InvalidLongString:
                return "invalid_long_string";

              case g.DatabaseTooLarge:
                return "db_too_large";

              case g.DatabaseOpenOrCreate:
                return "db_open_or_create";

              case g.JsonError:
                return "json_error";

              case g.FailHttpJsonDecode:
                return "fail_http_json_decode";

              case g.FailHttpJsonEncode:
                return "fail_http_json_encode";
            }
            return "";
        }, S.sdkErrorParameterString = function(t) {
            switch (t) {
              case m.Currency:
                return "currency";

              case m.CartType:
                return "cart_type";

              case m.ItemType:
                return "item_type";

              case m.ItemId:
                return "item_id";

              case m.Store:
                return "store";

              case m.FlowType:
                return "flow_type";

              case m.Amount:
                return "amount";

              case m.Progression01:
                return "progression01";

              case m.Progression02:
                return "progression02";

              case m.Progression03:
                return "progression03";

              case m.EventId:
                return "event_id";

              case m.ProgressionStatus:
                return "progression_status";

              case m.Severity:
                return "severity";

              case m.Message:
                return "message";
            }
            return "";
        }, S.instance = new S(), S.MAX_ERROR_MESSAGE_LENGTH = 256, e = S, c.GAHTTPApi = e;
    }(v = v || {}), function(p) {
        var g, m, f, y, v, b, _, l, S, x, t;
        function w() {}
        g = p.events || (p.events = {}), m = p.store.GAStore, f = p.store.EGAStore, y = p.store.EGAStoreArgsOperator, 
        v = p.state.GAState, b = p.logging.GALogger, _ = p.utilities.GAUtilities, l = p.http.EGAHTTPApiResponse, 
        S = p.http.GAHTTPApi, x = p.validators.GAValidator, w.addSessionStartEvent = function() {
            if (v.isEventSubmissionEnabled()) {
                var t = {};
                t.category = w.CategorySessionStart, v.incrementSessionNum(), m.setItem(v.getGameKey(), v.SessionNumKey, v.getSessionNum().toString()), 
                w.addDimensionsToEvent(t), w.addEventToStore(t), b.i("Add SESSION START event"), 
                w.processEvents(w.CategorySessionStart, !1);
            }
        }, w.addSessionEndEvent = function() {
            if (v.isEventSubmissionEnabled()) {
                var t = v.getSessionStart(), e = v.getClientTsAdjusted() - t;
                e < 0 && (b.w("Session length was calculated to be less then 0. Should not be possible. Resetting to 0."), 
                e = 0);
                var i = {};
                i.category = w.CategorySessionEnd, i.length = e, w.addDimensionsToEvent(i), w.addEventToStore(i), 
                b.i("Add SESSION END event."), w.processEvents("", !1);
            }
        }, w.addBusinessEvent = function(t, e, i, n, s, o) {
            if (void 0 === s && (s = null), v.isEventSubmissionEnabled()) {
                var a = x.validateBusinessEvent(t, e, s, i, n);
                if (null == a) {
                    var r = {};
                    v.incrementTransactionNum(), m.setItem(v.getGameKey(), v.TransactionNumKey, v.getTransactionNum().toString()), 
                    r.event_id = i + ":" + n, r.category = w.CategoryBusiness, r.currency = t, r.amount = e, 
                    r[v.TransactionNumKey] = v.getTransactionNum(), s && (r.cart_type = s), w.addDimensionsToEvent(r), 
                    w.addFieldsToEvent(r, v.validateAndCleanCustomFields(o)), b.i("Add BUSINESS event: {currency:" + t + ", amount:" + e + ", itemType:" + i + ", itemId:" + n + ", cartType:" + s + "}"), 
                    w.addEventToStore(r);
                } else S.instance.sendSdkErrorEvent(a.category, a.area, a.action, a.parameter, a.reason, v.getGameKey(), v.getGameSecret());
            }
        }, w.addResourceEvent = function(t, e, i, n, s, o) {
            if (v.isEventSubmissionEnabled()) {
                var a = x.validateResourceEvent(t, e, i, n, s, v.getAvailableResourceCurrencies(), v.getAvailableResourceItemTypes());
                if (null == a) {
                    t === p.EGAResourceFlowType.Sink && (i *= -1);
                    var r = {}, h = w.resourceFlowTypeToString(t);
                    r.event_id = h + ":" + e + ":" + n + ":" + s, r.category = w.CategoryResource, r.amount = i, 
                    w.addDimensionsToEvent(r), w.addFieldsToEvent(r, v.validateAndCleanCustomFields(o)), 
                    b.i("Add RESOURCE event: {currency:" + e + ", amount:" + i + ", itemType:" + n + ", itemId:" + s + "}"), 
                    w.addEventToStore(r);
                } else S.instance.sendSdkErrorEvent(a.category, a.area, a.action, a.parameter, a.reason, v.getGameKey(), v.getGameSecret());
            }
        }, w.addProgressionEvent = function(t, e, i, n, s, o, a) {
            if (v.isEventSubmissionEnabled()) {
                var r = w.progressionStatusToString(t), h = x.validateProgressionEvent(t, e, i, n);
                if (null == h) {
                    var l, c = {};
                    l = i ? n ? e + ":" + i + ":" + n : e + ":" + i : e, c.category = w.CategoryProgression, 
                    c.event_id = r + ":" + l;
                    var u = 0;
                    o && t != p.EGAProgressionStatus.Start && (c.score = s), t === p.EGAProgressionStatus.Fail && v.incrementProgressionTries(l), 
                    t === p.EGAProgressionStatus.Complete && (v.incrementProgressionTries(l), u = v.getProgressionTries(l), 
                    c.attempt_num = u, v.clearProgressionTries(l)), w.addDimensionsToEvent(c), w.addFieldsToEvent(c, v.validateAndCleanCustomFields(a)), 
                    b.i("Add PROGRESSION event: {status:" + r + ", progression01:" + e + ", progression02:" + i + ", progression03:" + n + ", score:" + s + ", attempt:" + u + "}"), 
                    w.addEventToStore(c);
                } else S.instance.sendSdkErrorEvent(h.category, h.area, h.action, h.parameter, h.reason, v.getGameKey(), v.getGameSecret());
            }
        }, w.addDesignEvent = function(t, e, i, n) {
            if (v.isEventSubmissionEnabled()) {
                var s = x.validateDesignEvent(t);
                if (null == s) {
                    var o = {};
                    o.category = w.CategoryDesign, o.event_id = t, i && (o.value = e), w.addDimensionsToEvent(o), 
                    w.addFieldsToEvent(o, v.validateAndCleanCustomFields(n)), b.i("Add DESIGN event: {eventId:" + t + ", value:" + e + "}"), 
                    w.addEventToStore(o);
                } else S.instance.sendSdkErrorEvent(s.category, s.area, s.action, s.parameter, s.reason, v.getGameKey(), v.getGameSecret());
            }
        }, w.addErrorEvent = function(t, e, i) {
            if (v.isEventSubmissionEnabled()) {
                var n = w.errorSeverityToString(t), s = x.validateErrorEvent(t, e);
                if (null == s) {
                    var o = {};
                    o.category = w.CategoryError, o.severity = n, o.message = e, w.addDimensionsToEvent(o), 
                    w.addFieldsToEvent(o, v.validateAndCleanCustomFields(i)), b.i("Add ERROR event: {severity:" + n + ", message:" + e + "}"), 
                    w.addEventToStore(o);
                } else S.instance.sendSdkErrorEvent(s.category, s.area, s.action, s.parameter, s.reason, v.getGameKey(), v.getGameSecret());
            }
        }, w.addAdEvent = function(t, e, i, n, s, o, a, r) {
            if (v.isEventSubmissionEnabled()) {
                var h = w.adActionToString(t), l = w.adTypeToString(e), c = w.adErrorToString(s), u = x.validateAdEvent(t, e, i, n);
                if (null == u) {
                    var d = {};
                    d.category = w.CategoryAds, d.ad_sdk_name = i, d.ad_placement = n, d.ad_type = l, 
                    d.ad_action = h, t == p.EGAAdAction.FailedShow && 0 < c.length && (d.ad_fail_show_reason = c), 
                    !a || e != p.EGAAdType.RewardedVideo && e != p.EGAAdType.Video || (d.ad_duration = o), 
                    w.addDimensionsToEvent(d), w.addFieldsToEvent(d, v.validateAndCleanCustomFields(r)), 
                    b.i("Add AD event: {ad_sdk_name:" + i + ", ad_placement:" + n + ", ad_type:" + l + ", ad_action:" + h + (t == p.EGAAdAction.FailedShow && 0 < c.length ? ", ad_fail_show_reason:" + c : "") + (!a || e != p.EGAAdType.RewardedVideo && e != p.EGAAdType.Video ? "" : ", ad_duration:" + o) + "}"), 
                    w.addEventToStore(d);
                } else S.instance.sendSdkErrorEvent(u.category, u.area, u.action, u.parameter, u.reason, v.getGameKey(), v.getGameSecret());
            }
        }, w.processEvents = function(t, e) {
            if (v.isEventSubmissionEnabled()) try {
                var i = _.createGuid();
                e && (w.cleanupEvents(), w.fixMissingSessionEndEvents());
                var n = [];
                n.push([ "status", y.Equal, "new" ]);
                var s = [];
                s.push([ "status", y.Equal, "new" ]), t && (n.push([ "category", y.Equal, t ]), 
                s.push([ "category", y.Equal, t ]));
                var o = [];
                o.push([ "status", i ]);
                var a = m.select(f.Events, n);
                if (!a || 0 == a.length) return b.i("Event queue: No events to send"), void w.updateSessionStore();
                if (a.length > w.MaxEventCount) {
                    if (!(a = m.select(f.Events, n, !0, w.MaxEventCount))) return;
                    var r = a[a.length - 1].client_ts;
                    if (n.push([ "client_ts", y.LessOrEqual, r ]), !(a = m.select(f.Events, n))) return;
                    s.push([ "client_ts", y.LessOrEqual, r ]);
                }
                if (b.i("Event queue: Sending " + a.length + " events."), !m.update(f.Events, o, s)) return;
                for (var h = [], l = 0; l < a.length; ++l) {
                    var c = a[l], u = JSON.parse(_.decode64(c.event));
                    if (0 != u.length) {
                        var d = u.client_ts;
                        d && !x.validateClientTs(d) && delete u.client_ts, h.push(u);
                    }
                }
                S.instance.sendEventsInArray(h, i, w.processEventsCallback);
            } catch (t) {
                b.e("Error during ProcessEvents(): " + t.stack), S.instance.sendSdkErrorEvent(g.EGASdkErrorCategory.Json, g.EGASdkErrorArea.ProcessEvents, g.EGASdkErrorAction.JsonError, g.EGASdkErrorParameter.Undefined, t.stack, v.getGameKey(), v.getGameSecret());
            }
        }, w.processEventsCallback = function(t, e, i, n) {
            var s = [];
            if (s.push([ "status", y.Equal, i ]), t === l.Ok) m.delete(f.Events, s), b.i("Event queue: " + n + " events sent."); else if (t === l.NoResponse) {
                var o = [];
                o.push([ "status", "new" ]), b.w("Event queue: Failed to send events to collector - Retrying next time"), 
                m.update(f.Events, o, s);
            } else {
                if (e) {
                    var a, r = 0;
                    for (var h in e) 0 == r && (a = e[h]), ++r;
                    t === l.BadRequest && a.constructor === Array ? b.w("Event queue: " + n + " events sent. " + r + " events failed GA server validation.") : b.w("Event queue: Failed to send events.");
                } else b.w("Event queue: Failed to send events.");
                m.delete(f.Events, s);
            }
        }, w.cleanupEvents = function() {
            m.update(f.Events, [ [ "status", "new" ] ]);
        }, w.fixMissingSessionEndEvents = function() {
            if (v.isEventSubmissionEnabled()) {
                var t = [];
                t.push([ "session_id", y.NotEqual, v.getSessionId() ]);
                var e = m.select(f.Sessions, t);
                if (e && 0 != e.length) {
                    b.i(e.length + " session(s) located with missing session_end event.");
                    for (var i = 0; i < e.length; ++i) {
                        var n = JSON.parse(_.decode64(e[i].event)), s = n.client_ts - e[i].timestamp;
                        s = Math.max(0, s), n.category = w.CategorySessionEnd, n.length = s, w.addEventToStore(n);
                    }
                }
            }
        }, w.addEventToStore = function(t) {
            if (v.isEventSubmissionEnabled()) if (v.isInitialized()) try {
                if (m.isStoreTooLargeForEvents() && !_.stringMatch(t.category, /^(user|session_end|business)$/)) return b.w("Database too large. Event has been blocked."), 
                void S.instance.sendSdkErrorEvent(g.EGASdkErrorCategory.Database, g.EGASdkErrorArea.AddEventsToStore, g.EGASdkErrorAction.DatabaseTooLarge, g.EGASdkErrorParameter.Undefined, "", v.getGameKey(), v.getGameSecret());
                var e = v.getEventAnnotations(), i = _.encode64(JSON.stringify(e));
                for (var n in t) e[n] = t[n];
                var s = JSON.stringify(e);
                b.ii("Event added to queue: " + s);
                var o = {
                    status: "new"
                };
                o.category = e.category, o.session_id = e.session_id, o.client_ts = e.client_ts, 
                o.event = _.encode64(JSON.stringify(e)), m.insert(f.Events, o), t.category == w.CategorySessionEnd ? m.delete(f.Sessions, [ [ "session_id", y.Equal, e.session_id ] ]) : ((o = {}).session_id = e.session_id, 
                o.timestamp = v.getSessionStart(), o.event = i, m.insert(f.Sessions, o, !0, "session_id")), 
                m.isStorageAvailable() && m.save(v.getGameKey());
            } catch (n) {
                b.e("addEventToStore: error"), b.e(n.stack), S.instance.sendSdkErrorEvent(g.EGASdkErrorCategory.Database, g.EGASdkErrorArea.AddEventsToStore, g.EGASdkErrorAction.DatabaseTooLarge, g.EGASdkErrorParameter.Undefined, n.stack, v.getGameKey(), v.getGameSecret());
            } else b.w("Could not add event: SDK is not initialized");
        }, w.updateSessionStore = function() {
            if (v.sessionIsStarted()) {
                var t = {};
                t.session_id = v.instance.sessionId, t.timestamp = v.getSessionStart(), t.event = _.encode64(JSON.stringify(v.getEventAnnotations())), 
                m.insert(f.Sessions, t, !0, "session_id"), m.isStorageAvailable() && m.save(v.getGameKey());
            }
        }, w.addDimensionsToEvent = function(t) {
            t && (v.getCurrentCustomDimension01() && (t.custom_01 = v.getCurrentCustomDimension01()), 
            v.getCurrentCustomDimension02() && (t.custom_02 = v.getCurrentCustomDimension02()), 
            v.getCurrentCustomDimension03() && (t.custom_03 = v.getCurrentCustomDimension03()));
        }, w.addFieldsToEvent = function(t, e) {
            t && e && 0 < Object.keys(e).length && (t.custom_fields = e);
        }, w.resourceFlowTypeToString = function(t) {
            return t == p.EGAResourceFlowType.Source || t == p.EGAResourceFlowType[p.EGAResourceFlowType.Source] ? "Source" : t == p.EGAResourceFlowType.Sink || t == p.EGAResourceFlowType[p.EGAResourceFlowType.Sink] ? "Sink" : "";
        }, w.progressionStatusToString = function(t) {
            return t == p.EGAProgressionStatus.Start || t == p.EGAProgressionStatus[p.EGAProgressionStatus.Start] ? "Start" : t == p.EGAProgressionStatus.Complete || t == p.EGAProgressionStatus[p.EGAProgressionStatus.Complete] ? "Complete" : t == p.EGAProgressionStatus.Fail || t == p.EGAProgressionStatus[p.EGAProgressionStatus.Fail] ? "Fail" : "";
        }, w.errorSeverityToString = function(t) {
            return t == p.EGAErrorSeverity.Debug || t == p.EGAErrorSeverity[p.EGAErrorSeverity.Debug] ? "debug" : t == p.EGAErrorSeverity.Info || t == p.EGAErrorSeverity[p.EGAErrorSeverity.Info] ? "info" : t == p.EGAErrorSeverity.Warning || t == p.EGAErrorSeverity[p.EGAErrorSeverity.Warning] ? "warning" : t == p.EGAErrorSeverity.Error || t == p.EGAErrorSeverity[p.EGAErrorSeverity.Error] ? "error" : t == p.EGAErrorSeverity.Critical || t == p.EGAErrorSeverity[p.EGAErrorSeverity.Critical] ? "critical" : "";
        }, w.adActionToString = function(t) {
            return t == p.EGAAdAction.Clicked || t == p.EGAAdAction[p.EGAAdAction.Clicked] ? "clicked" : t == p.EGAAdAction.Show || t == p.EGAAdAction[p.EGAAdAction.Show] ? "show" : t == p.EGAAdAction.FailedShow || t == p.EGAAdAction[p.EGAAdAction.FailedShow] ? "failed_show" : t == p.EGAAdAction.RewardReceived || t == p.EGAAdAction[p.EGAAdAction.RewardReceived] ? "reward_received" : "";
        }, w.adErrorToString = function(t) {
            return t == p.EGAAdError.Unknown || t == p.EGAAdError[p.EGAAdError.Unknown] ? "unknown" : t == p.EGAAdError.Offline || t == p.EGAAdError[p.EGAAdError.Offline] ? "offline" : t == p.EGAAdError.NoFill || t == p.EGAAdError[p.EGAAdError.NoFill] ? "no_fill" : t == p.EGAAdError.InternalError || t == p.EGAAdError[p.EGAAdError.InternalError] ? "internal_error" : t == p.EGAAdError.InvalidRequest || t == p.EGAAdError[p.EGAAdError.InvalidRequest] ? "invalid_request" : t == p.EGAAdError.UnableToPrecache || t == p.EGAAdError[p.EGAAdError.UnableToPrecache] ? "unable_to_precache" : "";
        }, w.adTypeToString = function(t) {
            return t == p.EGAAdType.Video || t == p.EGAAdType[p.EGAAdType.Video] ? "video" : t == p.EGAAdType.RewardedVideo || t == p.EGAAdError[p.EGAAdType.RewardedVideo] ? "rewarded_video" : t == p.EGAAdType.Playable || t == p.EGAAdError[p.EGAAdType.Playable] ? "playable" : t == p.EGAAdType.Interstitial || t == p.EGAAdError[p.EGAAdType.Interstitial] ? "interstitial" : t == p.EGAAdType.OfferWall || t == p.EGAAdError[p.EGAAdType.OfferWall] ? "offer_wall" : t == p.EGAAdType.Banner || t == p.EGAAdError[p.EGAAdType.Banner] ? "banner" : "";
        }, w.CategorySessionStart = "user", w.CategorySessionEnd = "session_end", w.CategoryDesign = "design", 
        w.CategoryBusiness = "business", w.CategoryProgression = "progression", w.CategoryResource = "resource", 
        w.CategoryError = "error", w.CategoryAds = "ads", w.MaxEventCount = 500, t = w, 
        g.GAEvents = t;
    }(v = v || {}), function(t) {
        var s, e, i, n, o;
        function a() {
            this.blocks = new s.PriorityQueue({
                compare: function(t, e) {
                    return t - e;
                }
            }), this.id2TimedBlockMap = {}, a.startThread();
        }
        s = t.threading || (t.threading = {}), e = t.logging.GALogger, i = t.state.GAState, 
        n = t.events.GAEvents, a.createTimedBlock = function(t) {
            void 0 === t && (t = 0);
            var e = new Date();
            return e.setSeconds(e.getSeconds() + t), new s.TimedBlock(e);
        }, a.performTaskOnGAThread = function(t, e) {
            void 0 === e && (e = 0);
            var i = new Date();
            i.setSeconds(i.getSeconds() + e);
            var n = new s.TimedBlock(i);
            n.block = t, a.instance.id2TimedBlockMap[n.id] = n, a.instance.addTimedBlock(n);
        }, a.performTimedBlockOnGAThread = function(t) {
            a.instance.id2TimedBlockMap[t.id] = t, a.instance.addTimedBlock(t);
        }, a.scheduleTimer = function(t, e) {
            var i = new Date();
            i.setSeconds(i.getSeconds() + t);
            var n = new s.TimedBlock(i);
            return n.block = e, a.instance.id2TimedBlockMap[n.id] = n, a.instance.addTimedBlock(n), 
            n.id;
        }, a.getTimedBlockById = function(t) {
            return t in a.instance.id2TimedBlockMap ? a.instance.id2TimedBlockMap[t] : null;
        }, a.ensureEventQueueIsRunning = function() {
            a.instance.keepRunning = !0, a.instance.isRunning || (a.instance.isRunning = !0, 
            a.scheduleTimer(a.ProcessEventsIntervalInSeconds, a.processEventQueue));
        }, a.endSessionAndStopQueue = function() {
            i.isInitialized() && (e.i("Ending session."), a.stopEventQueue(), i.isEnabled() && i.sessionIsStarted() && (n.addSessionEndEvent(), 
            i.instance.sessionStart = 0));
        }, a.stopEventQueue = function() {
            a.instance.keepRunning = !1;
        }, a.ignoreTimer = function(t) {
            t in a.instance.id2TimedBlockMap && (a.instance.id2TimedBlockMap[t].ignore = !0);
        }, a.setEventProcessInterval = function(t) {
            0 < t && (a.ProcessEventsIntervalInSeconds = t);
        }, a.prototype.addTimedBlock = function(t) {
            this.blocks.enqueue(t.deadline.getTime(), t);
        }, a.run = function() {
            clearTimeout(a.runTimeoutId);
            try {
                for (var t; t = a.getNextBlock(); ) if (!t.ignore) if (t.async) {
                    if (!t.running) {
                        t.running = !0, t.block();
                        break;
                    }
                } else t.block();
                return void (a.runTimeoutId = setTimeout(a.run, a.ThreadWaitTimeInMs));
            } catch (t) {
                e.e("Error on GA thread"), e.e(t.stack);
            }
        }, a.startThread = function() {
            a.runTimeoutId = setTimeout(a.run, 0);
        }, a.getNextBlock = function() {
            var t = new Date();
            return a.instance.blocks.hasItems() && a.instance.blocks.peek().deadline.getTime() <= t.getTime() ? a.instance.blocks.peek().async && a.instance.blocks.peek().running ? a.instance.blocks.peek() : a.instance.blocks.dequeue() : null;
        }, a.processEventQueue = function() {
            n.processEvents("", !0), a.instance.keepRunning ? a.scheduleTimer(a.ProcessEventsIntervalInSeconds, a.processEventQueue) : a.instance.isRunning = !1;
        }, a.instance = new a(), a.ThreadWaitTimeInMs = 1e3, a.ProcessEventsIntervalInSeconds = 8, 
        o = a, s.GAThreading = o;
    }(v = v || {}), function(a) {
        var r = a.threading.GAThreading, h = a.logging.GALogger, l = a.store.GAStore, c = a.state.GAState, t = a.http.GAHTTPApi, u = a.device.GADevice, n = a.validators.GAValidator, d = a.http.EGAHTTPApiResponse, p = a.utilities.GAUtilities, g = a.events.GAEvents, e = (m.getGlobalObject = function() {
            return "undefined" != typeof globalThis ? globalThis : "undefined" != typeof self ? self : "undefined" != typeof window ? window : "undefined" != typeof global ? global : void 0;
        }, m.init = function() {
            if (u.touch(), m.methodMap.configureAvailableCustomDimensions01 = m.configureAvailableCustomDimensions01, 
            m.methodMap.configureAvailableCustomDimensions02 = m.configureAvailableCustomDimensions02, 
            m.methodMap.configureAvailableCustomDimensions03 = m.configureAvailableCustomDimensions03, 
            m.methodMap.configureAvailableResourceCurrencies = m.configureAvailableResourceCurrencies, 
            m.methodMap.configureAvailableResourceItemTypes = m.configureAvailableResourceItemTypes, 
            m.methodMap.configureBuild = m.configureBuild, m.methodMap.configureSdkGameEngineVersion = m.configureSdkGameEngineVersion, 
            m.methodMap.configureGameEngineVersion = m.configureGameEngineVersion, m.methodMap.configureUserId = m.configureUserId, 
            m.methodMap.initialize = m.initialize, m.methodMap.addBusinessEvent = m.addBusinessEvent, 
            m.methodMap.addResourceEvent = m.addResourceEvent, m.methodMap.addProgressionEvent = m.addProgressionEvent, 
            m.methodMap.addDesignEvent = m.addDesignEvent, m.methodMap.addErrorEvent = m.addErrorEvent, 
            m.methodMap.addAdEvent = m.addAdEvent, m.methodMap.setEnabledInfoLog = m.setEnabledInfoLog, 
            m.methodMap.setEnabledVerboseLog = m.setEnabledVerboseLog, m.methodMap.setEnabledManualSessionHandling = m.setEnabledManualSessionHandling, 
            m.methodMap.setEnabledEventSubmission = m.setEnabledEventSubmission, m.methodMap.setCustomDimension01 = m.setCustomDimension01, 
            m.methodMap.setCustomDimension02 = m.setCustomDimension02, m.methodMap.setCustomDimension03 = m.setCustomDimension03, 
            m.methodMap.setEventProcessInterval = m.setEventProcessInterval, m.methodMap.startSession = m.startSession, 
            m.methodMap.endSession = m.endSession, m.methodMap.onStop = m.onStop, m.methodMap.onResume = m.onResume, 
            m.methodMap.addRemoteConfigsListener = m.addRemoteConfigsListener, m.methodMap.removeRemoteConfigsListener = m.removeRemoteConfigsListener, 
            m.methodMap.getRemoteConfigsValueAsString = m.getRemoteConfigsValueAsString, m.methodMap.isRemoteConfigsReady = m.isRemoteConfigsReady, 
            m.methodMap.getRemoteConfigsContentAsString = m.getRemoteConfigsContentAsString, 
            m.methodMap.addOnBeforeUnloadListener = m.addOnBeforeUnloadListener, m.methodMap.removeOnBeforeUnloadListener = m.removeOnBeforeUnloadListener, 
            void 0 !== m.getGlobalObject() && void 0 !== m.getGlobalObject().GameAnalytics && void 0 !== m.getGlobalObject().GameAnalytics.q) {
                var t = m.getGlobalObject().GameAnalytics.q;
                for (var e in t) m.gaCommand.apply(null, t[e]);
            }
            window.addEventListener("beforeunload", function(t) {
                c.instance.isUnloading = !0, c.notifyBeforeUnloadListeners(), r.endSessionAndStopQueue(), 
                c.instance.isUnloading = !1;
            });
        }, m.gaCommand = function() {
            for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
            0 < t.length && t[0] in a.GameAnalytics.methodMap && (1 < t.length ? a.GameAnalytics.methodMap[t[0]].apply(null, Array.prototype.slice.call(t, 1)) : a.GameAnalytics.methodMap[t[0]]());
        }, m.configureAvailableCustomDimensions01 = function(t) {
            void 0 === t && (t = []), r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !1) ? h.w("Available custom dimensions must be set before SDK is initialized") : c.setAvailableCustomDimensions01(t);
            });
        }, m.configureAvailableCustomDimensions02 = function(t) {
            void 0 === t && (t = []), r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !1) ? h.w("Available custom dimensions must be set before SDK is initialized") : c.setAvailableCustomDimensions02(t);
            });
        }, m.configureAvailableCustomDimensions03 = function(t) {
            void 0 === t && (t = []), r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !1) ? h.w("Available custom dimensions must be set before SDK is initialized") : c.setAvailableCustomDimensions03(t);
            });
        }, m.configureAvailableResourceCurrencies = function(t) {
            void 0 === t && (t = []), r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !1) ? h.w("Available resource currencies must be set before SDK is initialized") : c.setAvailableResourceCurrencies(t);
            });
        }, m.configureAvailableResourceItemTypes = function(t) {
            void 0 === t && (t = []), r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !1) ? h.w("Available resource item types must be set before SDK is initialized") : c.setAvailableResourceItemTypes(t);
            });
        }, m.configureBuild = function(t) {
            void 0 === t && (t = ""), r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !1) ? h.w("Build version must be set before SDK is initialized.") : n.validateBuild(t) ? c.setBuild(t) : h.i("Validation fail - configure build: Cannot be null, empty or above 32 length. String: " + t);
            });
        }, m.configureSdkGameEngineVersion = function(t) {
            void 0 === t && (t = ""), r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !1) || (n.validateSdkWrapperVersion(t) ? u.sdkGameEngineVersion = t : h.i("Validation fail - configure sdk version: Sdk version not supported. String: " + t));
            });
        }, m.configureGameEngineVersion = function(t) {
            void 0 === t && (t = ""), r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !1) || (n.validateEngineVersion(t) ? u.gameEngineVersion = t : h.i("Validation fail - configure game engine version: Game engine version not supported. String: " + t));
            });
        }, m.configureUserId = function(t) {
            void 0 === t && (t = ""), r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !1) ? h.w("A custom user id must be set before SDK is initialized.") : n.validateUserId(t) ? c.setUserId(t) : h.i("Validation fail - configure user_id: Cannot be null, empty or above 64 length. Will use default user_id method. Used string: " + t);
            });
        }, m.initialize = function(t, e) {
            void 0 === t && (t = ""), void 0 === e && (e = ""), u.updateConnectionType();
            var i = r.createTimedBlock();
            i.async = !0, m.initTimedBlockId = i.id, i.block = function() {
                m.isSdkReady(!0, !1) ? h.w("SDK already initialized. Can only be called once.") : n.validateKeys(t, e) ? (c.setKeys(t, e), 
                m.internalInitialize()) : h.w("SDK failed initialize. Game key or secret key is invalid. Can only contain characters A-z 0-9, gameKey is 32 length, gameSecret is 40 length. Failed keys - gameKey: " + t + ", secretKey: " + e);
            }, r.performTimedBlockOnGAThread(i);
        }, m.addBusinessEvent = function(t, e, i, n, s) {
            if (void 0 === t && (t = ""), void 0 === e && (e = 0), void 0 === i && (i = ""), 
            void 0 === n && (n = ""), void 0 === s && (s = ""), u.updateConnectionType(), c.instance.isUnloading) {
                if (!m.isSdkReady(!0, !0, "Could not add business event")) return;
                g.addBusinessEvent(t, e, i, n, s, {});
            } else r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !0, "Could not add business event") && g.addBusinessEvent(t, e, i, n, s, {});
            });
        }, m.addResourceEvent = function(t, e, i, n, s) {
            if (void 0 === t && (t = a.EGAResourceFlowType.Undefined), void 0 === e && (e = ""), 
            void 0 === i && (i = 0), void 0 === n && (n = ""), void 0 === s && (s = ""), u.updateConnectionType(), 
            c.instance.isUnloading) {
                if (!m.isSdkReady(!0, !0, "Could not add resource event")) return;
                g.addResourceEvent(t, e, i, n, s, {});
            } else r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !0, "Could not add resource event") && g.addResourceEvent(t, e, i, n, s, {});
            });
        }, m.addProgressionEvent = function(e, i, n, s, o) {
            if (void 0 === e && (e = a.EGAProgressionStatus.Undefined), void 0 === i && (i = ""), 
            void 0 === n && (n = ""), void 0 === s && (s = ""), u.updateConnectionType(), c.instance.isUnloading) {
                if (!m.isSdkReady(!0, !0, "Could not add progression event")) return;
                var t = "number" == typeof o;
                g.addProgressionEvent(e, i, n, s, t ? o : 0, t, {});
            } else r.performTaskOnGAThread(function() {
                if (m.isSdkReady(!0, !0, "Could not add progression event")) {
                    var t = "number" == typeof o;
                    g.addProgressionEvent(e, i, n, s, t ? o : 0, t, {});
                }
            });
        }, m.addDesignEvent = function(e, i) {
            if (u.updateConnectionType(), c.instance.isUnloading) {
                if (!m.isSdkReady(!0, !0, "Could not add design event")) return;
                var t = "number" == typeof i;
                g.addDesignEvent(e, t ? i : 0, t, {});
            } else r.performTaskOnGAThread(function() {
                if (m.isSdkReady(!0, !0, "Could not add design event")) {
                    var t = "number" == typeof i;
                    g.addDesignEvent(e, t ? i : 0, t, {});
                }
            });
        }, m.addErrorEvent = function(t, e) {
            if (void 0 === t && (t = a.EGAErrorSeverity.Undefined), void 0 === e && (e = ""), 
            u.updateConnectionType(), c.instance.isUnloading) {
                if (!m.isSdkReady(!0, !0, "Could not add error event")) return;
                g.addErrorEvent(t, e, {});
            } else r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !0, "Could not add error event") && g.addErrorEvent(t, e, {});
            });
        }, m.addAdEventWithNoAdReason = function(t, e, i, n, s) {
            if (void 0 === t && (t = a.EGAAdAction.Undefined), void 0 === e && (e = a.EGAAdType.Undefined), 
            void 0 === i && (i = ""), void 0 === n && (n = ""), void 0 === s && (s = a.EGAAdError.Undefined), 
            u.updateConnectionType(), c.instance.isUnloading) {
                if (!m.isSdkReady(!0, !0, "Could not add ad event")) return;
                g.addAdEvent(t, e, i, n, s, 0, !1, {});
            } else r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !0, "Could not add ad event") && g.addAdEvent(t, e, i, n, s, 0, !1, {});
            });
        }, m.addAdEventWithDuration = function(t, e, i, n, s) {
            if (void 0 === t && (t = a.EGAAdAction.Undefined), void 0 === e && (e = a.EGAAdType.Undefined), 
            void 0 === i && (i = ""), void 0 === n && (n = ""), void 0 === s && (s = 0), u.updateConnectionType(), 
            c.instance.isUnloading) {
                if (!m.isSdkReady(!0, !0, "Could not add ad event")) return;
                g.addAdEvent(t, e, i, n, a.EGAAdError.Undefined, s, !0, {});
            } else r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !0, "Could not add ad event") && g.addAdEvent(t, e, i, n, a.EGAAdError.Undefined, s, !0, {});
            });
        }, m.addAdEvent = function(t, e, i, n) {
            if (void 0 === t && (t = a.EGAAdAction.Undefined), void 0 === e && (e = a.EGAAdType.Undefined), 
            void 0 === i && (i = ""), void 0 === n && (n = ""), u.updateConnectionType(), c.instance.isUnloading) {
                if (!m.isSdkReady(!0, !0, "Could not add ad event")) return;
                g.addAdEvent(t, e, i, n, a.EGAAdError.Undefined, 0, !1, {});
            } else r.performTaskOnGAThread(function() {
                m.isSdkReady(!0, !0, "Could not add ad event") && g.addAdEvent(t, e, i, n, a.EGAAdError.Undefined, 0, !1, {});
            });
        }, m.setEnabledInfoLog = function(t) {
            void 0 === t && (t = !1), r.performTaskOnGAThread(function() {
                t ? (h.setInfoLog(t), h.i("Info logging enabled")) : (h.i("Info logging disabled"), 
                h.setInfoLog(t));
            });
        }, m.setEnabledVerboseLog = function(t) {
            void 0 === t && (t = !1), r.performTaskOnGAThread(function() {
                t ? (h.setVerboseLog(t), h.i("Verbose logging enabled")) : (h.i("Verbose logging disabled"), 
                h.setVerboseLog(t));
            });
        }, m.setEnabledManualSessionHandling = function(t) {
            void 0 === t && (t = !1), r.performTaskOnGAThread(function() {
                c.setManualSessionHandling(t);
            });
        }, m.setEnabledEventSubmission = function(t) {
            void 0 === t && (t = !1), r.performTaskOnGAThread(function() {
                t ? (c.setEnabledEventSubmission(t), h.i("Event submission enabled")) : (h.i("Event submission disabled"), 
                c.setEnabledEventSubmission(t));
            });
        }, m.setCustomDimension01 = function(t) {
            void 0 === t && (t = ""), r.performTaskOnGAThread(function() {
                n.validateDimension01(t, c.getAvailableCustomDimensions01()) ? c.setCustomDimension01(t) : h.w("Could not set custom01 dimension value to '" + t + "'. Value not found in available custom01 dimension values");
            });
        }, m.setCustomDimension02 = function(t) {
            void 0 === t && (t = ""), r.performTaskOnGAThread(function() {
                n.validateDimension02(t, c.getAvailableCustomDimensions02()) ? c.setCustomDimension02(t) : h.w("Could not set custom02 dimension value to '" + t + "'. Value not found in available custom02 dimension values");
            });
        }, m.setCustomDimension03 = function(t) {
            void 0 === t && (t = ""), r.performTaskOnGAThread(function() {
                n.validateDimension03(t, c.getAvailableCustomDimensions03()) ? c.setCustomDimension03(t) : h.w("Could not set custom03 dimension value to '" + t + "'. Value not found in available custom03 dimension values");
            });
        }, m.setEventProcessInterval = function(t) {
            r.performTaskOnGAThread(function() {
                r.setEventProcessInterval(t);
            });
        }, m.startSession = function() {
            if (c.isInitialized()) {
                var t = r.createTimedBlock();
                t.async = !0, m.initTimedBlockId = t.id, t.block = function() {
                    c.isEnabled() && c.sessionIsStarted() && r.endSessionAndStopQueue(), m.resumeSessionAndStartQueue();
                }, r.performTimedBlockOnGAThread(t);
            }
        }, m.endSession = function() {
            m.onStop();
        }, m.onStop = function() {
            r.performTaskOnGAThread(function() {
                try {
                    r.endSessionAndStopQueue();
                } catch (t) {}
            });
        }, m.onResume = function() {
            var t = r.createTimedBlock();
            t.async = !0, m.initTimedBlockId = t.id, t.block = function() {
                m.resumeSessionAndStartQueue();
            }, r.performTimedBlockOnGAThread(t);
        }, m.getRemoteConfigsValueAsString = function(t, e) {
            return void 0 === e && (e = null), c.getConfigurationStringValue(t, e);
        }, m.isRemoteConfigsReady = function() {
            return c.isRemoteConfigsReady();
        }, m.addRemoteConfigsListener = function(t) {
            c.addRemoteConfigsListener(t);
        }, m.removeRemoteConfigsListener = function(t) {
            c.removeRemoteConfigsListener(t);
        }, m.getRemoteConfigsContentAsString = function() {
            return c.getRemoteConfigsContentAsString();
        }, m.getABTestingId = function() {
            return c.getABTestingId();
        }, m.getABTestingVariantId = function() {
            return c.getABTestingVariantId();
        }, m.addOnBeforeUnloadListener = function(t) {
            c.addOnBeforeUnloadListener(t);
        }, m.removeOnBeforeUnloadListener = function(t) {
            c.removeOnBeforeUnloadListener(t);
        }, m.internalInitialize = function() {
            c.ensurePersistedStates(), l.setItem(c.getGameKey(), c.DefaultUserIdKey, c.getDefaultId()), 
            c.setInitialized(!0), m.newSession(), c.isEnabled() && r.ensureEventQueueIsRunning();
        }, m.newSession = function() {
            h.i("Starting a new session."), c.validateAndFixCurrentDimensions(), t.instance.requestInit(c.instance.configsHash, m.startNewSessionCallback);
        }, m.startNewSessionCallback = function(t, e) {
            if (t !== d.Ok && t !== d.Created || !e) t == d.Unauthorized ? (h.w("Initialize SDK failed - Unauthorized"), 
            c.instance.initAuthorized = !1) : (t === d.NoResponse || t === d.RequestTimeout ? h.i("Init call (session start) failed - no response. Could be offline or timeout.") : t === d.BadResponse || t === d.JsonEncodeFailed || t === d.JsonDecodeFailed ? h.i("Init call (session start) failed - bad response. Could be bad response from proxy or GA servers.") : t !== d.BadRequest && t !== d.UnknownResponseCode || h.i("Init call (session start) failed - bad request or unknown response."), 
            null == c.instance.sdkConfig ? null != c.instance.sdkConfigCached ? (h.i("Init call (session start) failed - using cached init values."), 
            c.instance.sdkConfig = c.instance.sdkConfigCached) : (h.i("Init call (session start) failed - using default init values."), 
            c.instance.sdkConfig = c.instance.sdkConfigDefault) : h.i("Init call (session start) failed - using cached init values."), 
            c.instance.initAuthorized = !0); else {
                var i = 0;
                if (e.server_ts) {
                    var n = e.server_ts;
                    i = c.calculateServerTimeOffset(n);
                }
                if (e.time_offset = i, t != d.Created) {
                    var s = c.getSdkConfig();
                    s.configs && (e.configs = s.configs), s.configs_hash && (e.configs_hash = s.configs_hash), 
                    s.ab_id && (e.ab_id = s.ab_id), s.ab_variant_id && (e.ab_variant_id = s.ab_variant_id);
                }
                c.instance.configsHash = e.configs_hash ? e.configs_hash : "", c.instance.abId = e.ab_id ? e.ab_id : "", 
                c.instance.abVariantId = e.ab_variant_id ? e.ab_variant_id : "", l.setItem(c.getGameKey(), c.SdkConfigCachedKey, p.encode64(JSON.stringify(e))), 
                c.instance.sdkConfigCached = e, c.instance.sdkConfig = e, c.instance.initAuthorized = !0;
            }
            if (c.instance.clientServerTimeOffset = c.getSdkConfig().time_offset ? c.getSdkConfig().time_offset : 0, 
            c.populateConfigurations(c.getSdkConfig()), !c.isEnabled()) return h.w("Could not start session: SDK is disabled."), 
            void r.stopEventQueue();
            r.ensureEventQueueIsRunning();
            var o = p.createGuid();
            c.instance.sessionId = o, c.instance.sessionStart = c.getClientTsAdjusted(), g.addSessionStartEvent();
            var a = r.getTimedBlockById(m.initTimedBlockId);
            null != a && (a.running = !1), m.initTimedBlockId = -1;
        }, m.resumeSessionAndStartQueue = function() {
            c.isInitialized() && (h.i("Resuming session."), c.sessionIsStarted() || m.newSession());
        }, m.isSdkReady = function(t, e, i) {
            return void 0 === e && (e = !0), void 0 === i && (i = ""), i && (i += ": "), t && !c.isInitialized() ? (e && h.w(i + "SDK is not initialized"), 
            !1) : t && !c.isEnabled() ? (e && h.w(i + "SDK is disabled"), !1) : !(t && !c.sessionIsStarted() && (e && h.w(i + "Session has not started yet"), 
            1));
        }, m.initTimedBlockId = -1, m.methodMap = {}, m);
        function m() {}
        a.GameAnalytics = e;
    }(v = v || {}), v.GameAnalytics.init();
    var w = v.GameAnalytics.gaCommand;
    t.gameanalytics = v, t.GameAnalytics = w;
}(this);

var TransitionState, Platform, __extends = this && this.__extends || function() {
    var n = function(t, e) {
        return (n = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(t, e) {
            t.__proto__ = e;
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i]);
        })(t, e);
    };
    return function(t, e) {
        function i() {
            this.constructor = t;
        }
        n(t, e), t.prototype = null === e ? Object.create(e) : (i.prototype = e.prototype, 
        new i());
    };
}(), __values = this && this.__values || function(t) {
    var e = "function" == typeof Symbol && t[Symbol.iterator], i = 0;
    return e ? e.call(t) : {
        next: function() {
            return t && i >= t.length && (t = void 0), {
                value: t && t[i++],
                done: !t
            };
        }
    };
};

!function(t) {
    t[t.Idle = 0] = "Idle", t[t.FadeIn = 1] = "FadeIn", t[t.FadeOut = 2] = "FadeOut";
}(TransitionState || (TransitionState = {})), function(t) {
    t[t.WEB_IOS = 0] = "WEB_IOS", t[t.IOS = 1] = "IOS", t[t.WEB_ANDROID = 2] = "WEB_ANDROID", 
    t[t.ANDROID = 3] = "ANDROID", t[t.WEB_WINDOWS = 4] = "WEB_WINDOWS", t[t.UWP = 5] = "UWP", 
    t[t.UWP_MOBILE = 6] = "UWP_MOBILE", t[t.WEB = 7] = "WEB", t[t.CHROME = 8] = "CHROME", 
    t[t.FACEBOOK = 9] = "FACEBOOK", t[t.WEB_CHROME = 10] = "WEB_CHROME", t[t.WEB_SAFARI = 11] = "WEB_SAFARI", 
    t[t.AMAZON = 12] = "AMAZON", t[t.HUAWEI = 13] = "HUAWEI";
}(Platform || (Platform = {}));

var StorageHelper, AmazingGame = function(n) {
    function a(t) {
        var e = n.call(this, t) || this;
        e.ratio = 1, e.isGamePaused = !1, e.transitionTimer = 0, e.logoAnimTimer = 0, e.transitionState = TransitionState.Idle, 
        e.transitionImageName = void 0, e.shoudlRequestAboutCreated = !1, e.list = new Array(), 
        e.isLandscape = e.width > e.height, e.PlatformProvider = new CrossPlatformTools(), 
        e.lastHeight = Number(t.height), e.lastWidth = Number(t.width);
        var i = a._instance = e;
        return document.addEventListener("backbutton", function() {
            i.back_press();
        }, !1), document.addEventListener("keyup", function(t) {
            "Escape" !== t.key && "Esc" !== t.key || a.getInstance().back_press();
        }, !1), e;
    }
    return __extends(a, n), a.getInstance = function() {
        return a._instance;
    }, a.prototype.boot = function() {
        n.prototype.boot.call(this);
        this.input.mouse.start();
    }, a.prototype.mouseWheel = function(t) {}, a.prototype.InitInstallPrompt = function() {
        this.installPrompt = new InstallPrompt(this), this.installPrompt.initialize();
    }, a.prototype.InitPromoPopUp = function() {
        this.promodialog = new PromoPopUp(this, "promo"), this.promodialog.init();
    }, a.prototype.addScene = function(t, e) {
        e.game = this, e.name = t, this.state.add(t, e, !1), this.list.push(e);
    }, a.prototype.getGenerator = function() {
        return this.graphicsGenerator || (this.graphicsGenerator = this.add.graphics(0, 0)), 
        this.graphicsGenerator;
    }, a.prototype.getScene = function(t) {
        var e, i;
        try {
            for (var n = __values(this.list), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                if (o.name === t) return o;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return null;
    }, a.prototype.runScene = function(t, e, i) {
        void 0 === e && (e = !1), void 0 === i && (i = !1), this.previousSceneName = this.currentSceneName, 
        this.nextSceneName = t, null != this.previousSceneName && e ? (void 0 === this.transitionImage && (this.transitionImageName ? (this.transitionImage = new Phaser.Sprite(this, 0, 0, this.transitionImageName), 
        this.transitionImage.anchor.set(.5)) : (this.transitionImage = new Phaser.Sprite(this, 0, 0, SpriteUtils.create_rectangle(this, 680, 110, 16777215, 1)), 
        this.transitionImage.tint = a.BACKGROUND_TINT), this.transitionGroup = new Phaser.Group(this), 
        this.transitionLogo = new Phaser.Image(this, 0, 0, Images.ALPHA_LOGO), this.transitionLogo.anchor.set(.5), 
        this.transitionImage.tint = a.BACKGROUND_TINT, this.transitionLogo.scale.set(this.ratio), 
        Constants.ROTATE_LOGO && (this.transitionLogo.scale.y *= -1), this.transitionLogo.blendMode = a.LOGO_BLEND, 
        this.transitionGroup.add(this.transitionImage), this.transitionGroup.add(this.transitionLogo), 
        this.stage.addChild(this.transitionGroup)), this.transitionImage.tint = a.BACKGROUND_TINT, 
        this.transitionLogo.alpha = a.LOGO_OPACITY, this.transitionLogo.tint = a.LOGO_TINT, 
        this.transitionGroup.visible = !0, this.transitionGroup.alpha = 0, this.transitionState = TransitionState.FadeIn, 
        this.transitionTimer = 0, this.logoAnimTimer = 0, this.currentScene.enable(!1)) : (this.transitionState = TransitionState.Idle, 
        this.currentSceneName = t, this.translation && this.translation.clearAllListeners(), 
        this.state.start(this.currentSceneName, !0, !1), this.state.onCreateCallback = function() {}, 
        this.currentScene = this.getScene(t), this.shoudlRequestAboutCreated = !0);
    }, a.prototype.on_resize = function() {
        if (!this.isGamePaused) {
            window.innerWidth, window.innerHeight;
            Constants.COMPILE_PLATFORM === Platform.IOS && (screen.width, screen.height), this.isLandscape = !1, 
            this.currentScene.isPortraitLocked || (this.isLandscape = window.innerWidth > window.innerHeight);
            var t = Constants.WIDTH, e = Constants.HEIGHT;
            this.isLandscape && !this.currentScene.isPortraitLocked || (t = Constants.HEIGHT, 
            e = Constants.WIDTH);
            var i = Math.ceil(window.innerWidth * devicePixelRatio), n = Math.ceil(window.innerHeight * devicePixelRatio);
            if (this.scale.setGameSize(i, n), this.scale.refresh(), n < i / t * e) {
                this.ratio = n / e;
                var s = i - this.ratio * t;
                this.borderWidth = s / 2, this.borderHeight = 0;
            } else {
                this.ratio = i / t;
                var o = n - this.ratio * e;
                this.borderHeight = o / 2, this.borderWidth = 0;
            }
            null !== this.currentScene && this.currentScene.on_resize(), null != a.BLACK_LAYER && a.BLACK_LAYER.visible && (this.world.bringToTop(a.BLACK_LAYER), 
            a.BLACK_LAYER.x = 0, a.BLACK_LAYER.y = 0, a.BLACK_LAYER.width = this.width, a.BLACK_LAYER.height = this.height, 
            a.BLACK_LAYER.anchor.set(0, 0)), Constants.COMPILE_PLATFORM !== Platform.WEB && Constants.COMPILE_PLATFORM !== Platform.UWP || this.check_orientation_lock();
        }
    }, a.prototype.update = function(t) {
        if (n.prototype.update.call(this, t), this.shoudlRequestAboutCreated && this.currentScene.created && (this.shoudlRequestAboutCreated = !1, 
        this.currentScene.show(), this.currentScene.enable(!0)), this.transitionState === TransitionState.FadeIn || this.transitionState === TransitionState.FadeOut) {
            var e = 0;
            if (this.transitionTimer += this.time.elapsedMS / 1e3, this.logoAnimTimer += this.time.elapsedMS / 1e3, 
            this.transitionState === TransitionState.FadeIn ? (e = Phaser.Math.clamp(Phaser.Easing.Quartic.Out(this.transitionTimer / a.TRANSITION_TIME), 0, 1), 
            1 <= this.transitionTimer / a.TRANSITION_TIME && (this.transitionState = TransitionState.FadeOut, 
            this.transitionTimer = 0, this.previousSceneName = this.currentSceneName, this.currentSceneName = this.nextSceneName, 
            this.translation && this.translation.clearAllListeners(), this.state.start(this.currentSceneName, !0, !1), 
            this.currentScene = this.getScene(this.currentSceneName), this.world.pivot.x = 0)) : this.transitionState === TransitionState.FadeOut && (e = Phaser.Math.clamp(Phaser.Easing.Quartic.Out(1 - this.transitionTimer / a.TRANSITION_TIME), 0, 1), 
            this.currentScene.state.created && !this.currentScene.showed && this.currentScene.show(), 
            1 <= this.transitionTimer / a.TRANSITION_TIME && (this.transitionState = TransitionState.Idle, 
            this.transitionTimer = 0, this.transitionGroup.visible = !1, this.currentScene.enable(!0))), 
            this.isTransitioning()) {
                this.transitionGroup.alpha = e, this.transitionGroup.x = 0, this.transitionGroup.y = 0;
                var i = this.transitionGroup.getChildAt(1);
                Math.sin(this.transitionTimer);
                i.scale.set(this.ratio, this.ratio), Constants.ROTATE_LOGO && (i.scale.x *= -1), 
                i.position.set(this.width / 2, this.height / 2 - 70 * this.ratio), i.worldAlpha = Phaser.Math.clamp(this.logoAnimTimer, .1, a.LOGO_OPACITY), 
                this.transitionImageName ? this.refreshBackround(this.transitionImage) : (this.transitionImage.width = this.width, 
                this.transitionImage.height = this.height), this.transitionImage.anchor.set(0, 0), 
                this.fadeLayerToTop();
            }
        }
        this.promodialog && this.promodialog.independent_Update();
    }, a.prototype.fadeLayerToTop = function() {
        this.transitionImage;
    }, a.prototype.setTransitionColor = function(t) {
        a.BACKGROUND_TINT = Phaser.Color.hexToRGB(t), this.transitionImage.tint = Phaser.Color.hexToRGB(t);
    }, a.prototype.isTransitioning = function() {
        return this.transitionState != TransitionState.Idle;
    }, a.prototype.show_overlay = function() {
        null == a.BLACK_LAYER && (a.BLACK_LAYER = this.add.sprite(Constants.HEIGHT / 2, Constants.WIDTH / 2, GlobalVars.DIALOG_BG), 
        this.world.add(a.BLACK_LAYER), this.world.remove(a.BLACK_LAYER)), a.BLACK_LAYER.visible = !0, 
        a.BLACK_LAYER.x = 0, a.BLACK_LAYER.y = 0, a.BLACK_LAYER.width = this.width, a.BLACK_LAYER.height = this.height, 
        a.BLACK_LAYER.anchor.set(0, 0), this.world.add(a.BLACK_LAYER), this.world.bringToTop(a.BLACK_LAYER), 
        this.tweens.removeFrom(a.BLACK_LAYER), a.BLACK_LAYER.alpha = 0, this.add.tween(a.BLACK_LAYER).to({
            alpha: .85
        }, PopUp.TRANSITION_TIME, "Linear", !0);
    }, a.prototype.hide_overlay = function() {
        null != a.BLACK_LAYER && a.BLACK_LAYER.visible && (a.BLACK_LAYER.visible = !1, this.world.remove(a.BLACK_LAYER));
    }, a.prototype.check_orientation_lock = function() {
        Constants.LANDSCAPE_LOCKED ? this.width > this.height ? this.hide_lock_orientation() : this.show_lock_orientation() : Constants.PORTRAIT_LOCKED;
    }, a.prototype.show_lock_orientation = function() {
        this.paused || (this.paused = !0), document.getElementById("orientation").style.display = "block";
    }, a.prototype.hide_lock_orientation = function() {
        this.paused && (this.paused = !1), document.getElementById("orientation").style.display = "none";
    }, a.prototype.prepare_ad_show = function() {
        AudioManager.getInstance().pause_background(), this.amazingAdProvider.VideoController && (this.amazingAdProvider.VideoController.isAdPlaying = !0), 
        this.isGamePaused = !0, this.paused = !0;
    }, a.prototype.stopAdShowing = function() {
        this.paused = !1, this.amazingAdProvider.VideoController && (this.amazingAdProvider.VideoController.isAdPlaying = !1), 
        AudioManager.getInstance().unpause_background(), this.isGamePaused = !1, this.on_resize();
    }, a.prototype.back_press = function() {
        this.currentScene.back_press();
    }, a.prototype.refreshBackround = function(t, e) {
        if (void 0 === e && (e = !1), void 0 !== t && null != t) {
            var i = t.texture.width, n = t.texture.height;
            t.angle = 0, e && (this.isLandscape || (i = t.texture.height, n = t.texture.width, 
            t.angle = 90));
            var s = 1;
            s = this.width / i * n > this.height ? this.width / i : this.height / n, t.x = this.width / 2, 
            t.y = this.height / 2, t.scale.set(s);
        }
    }, a.prototype.changeLanguage = function(t) {
        t ? this.translation.setLanguage(t) : this.translation.changeToNextLanguage(), this.translation.translateScene(this.currentScene);
    }, a.prototype.changeToNextLanguage = function() {
        var t = this.translation.availableLanguages.indexOf(this.translation.languageCode);
        ++t >= this.translation.availableLanguages.length && (t = 0), this.changeLanguage(this.translation.availableLanguages[t]);
    }, a.prototype.translate = function(t) {
        return this.translation.translate(t);
    }, a.prototype.on_resume = function() {
        null != this.currentScene && this.currentScene.on_resume();
    }, a.prototype.doScreenshot = function() {
        this.paused = !0, this.doScreenShots = !0, this.screenShotLoopIterrator = 0, this.screenShotsToSend = [];
        var t = new Date();
        this.screenShotname = t.toISOString();
    }, a.prototype.updateScreenShots = function() {}, a.prototype.doAndSendScreenshot = function() {}, 
    a.TRANSITION_TIME = .55, a.LOGO_TIME_TIME = 1, a.AMAZING_VERSION = "1.1.4", a.LOGO_BLEND = PIXI.blendModes.NORMAL, 
    a.LOGO_OPACITY = .75, a.LOGO_TINT = 16777215, a.BACKGROUND_TINT = 16777215, a.RENDERER = Phaser.CANVAS, 
    a;
}(Phaser.Game), CallbackReceiver = function() {
    function t() {
        if (t._instance) throw new Error("Error: Instantiation failed: Use SingletonClass.getInstance() instead of new.");
        t._instance = this;
    }
    return t.getInstance = function() {
        return t._instance;
    }, t.prototype.reciveCallback = function(t, e) {
        if ("videoready" === t) Constants.COMPILE_PLATFORM === Platform.UWP && Constants.IS_UWP_WEBVIEW ? void 0 !== (i = AmazingGame.getInstance().amazingAdProvider.VideoController.getNamedVideo(e)) && i.onAdReadyCallback() : AmazingGame.getInstance().amazingAdProvider.VideoController.VideoAds[0].onAdReadyCallback(); else if ("videoclosed" === t) {
            if (Constants.COMPILE_PLATFORM === Platform.UWP) if (Constants.IS_UWP_WEBVIEW) void 0 !== (i = AmazingGame.getInstance().amazingAdProvider.VideoController.getNamedVideo(e)) && i.onAdClosedCallback(); else AmazingGame.getInstance().amazingAdProvider.VideoController.VideoAds[0].onAdClosedCallback(); else AmazingGame.getInstance().amazingAdProvider.VideoController.VideoAds[0].onAdClosedCallback();
        } else if ("videoerror" === t) {
            var i;
            if (Constants.COMPILE_PLATFORM === Platform.UWP) if (Constants.IS_UWP_WEBVIEW) void 0 !== (i = AmazingGame.getInstance().amazingAdProvider.VideoController.getNamedVideo(e)) && i.onAdFailLoadCallback(); else AmazingGame.getInstance().amazingAdProvider.VideoController.VideoAds[0].onAdFailLoadCallback(); else AmazingGame.getInstance().amazingAdProvider.VideoController.VideoAds[0].onAdFailLoadCallback();
        } else if ("bannererror" === t) Utils.androidColoredLog("Try Play Cross Promo: " + JSON.stringify(AmazingGame.getInstance().amazingAdProvider.BannerController.currentBanner)), 
        null != AmazingGame.getInstance().amazingAdProvider.BannerController.currentBanner && (AmazingGame.getInstance().amazingAdProvider.BannerController.currentBanner.remove_ad_control(), 
        AmazingGame.getInstance().amazingAdProvider.BannerController.currentBanner.onAdFailLoadCallback()); else if ("onbackpressed" === t) AmazingGame.getInstance().back_press(); else if ("rewardready" === t) AmazingGame.getInstance().amazingAdProvider.VideoController.RewardAds[0].onAdReadyCallback(); else if (-1 !== t.indexOf("rewarditem_")) AmazingGame.getInstance().amazingAdProvider.VideoController.RewardAds[0].onAdClosedCallback(); else if ("rewardclosed" === t) AmazingGame.getInstance().amazingAdProvider.VideoController.RewardAds[0].onAdClosedCallback(); else if ("save_game" === t) GameSettings.getInstance().save(); else if ("rewarderror" === t) AmazingGame.getInstance().amazingAdProvider.VideoController.RewardAds[0].onAdFailLoadCallback(); else if (-1 !== t.indexOf("uuid")) {
            var n = t.split(":")[1];
            document.uuid = n;
        } else if ("settings" === t) document.settings = e; else if (-1 !== t.indexOf("savetop")) {
            var s = Number(t.split(":")[1]);
            Constants.SAVE_AREA_TOP = s;
        } else if (-1 !== t.indexOf("savebottom")) {
            var o = Number(t.split(":")[1]);
            Constants.SAVE_AREA_BOTTOM = o;
        }
        "onresume" === t && AmazingGame.getInstance().on_resume();
    }, t._instance = new t(), t;
}(), CrossPlatformTools = function() {
    function n() {}
    return n.sendIOSRequest = function(t, e) {
        var i = n.createIFrame("amazing://?message=" + t + e);
        i.parentNode.removeChild(i);
    }, n.sendUWPRequest = function(t, e) {
        window.external.notify(t + "_" + e);
    }, n.createIFrame = function(t) {
        var e = document.documentElement, i = document.createElement("IFRAME");
        return i.setAttribute("src", t), e.appendChild(i), i;
    }, n.prototype.review_game = function() {
        if (GameSettings.getInstance().gameReview = !0, GameSettings.getInstance().save(), 
        Constants.COMPILE_PLATFORM === Platform.UWP) if (Constants.IS_UWP_WEBVIEW) n.sendUWPRequest("openurl", "ms-windows-store://review/?ProductId=" + Constants.UWP_REVIEW); else try {
            Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri("ms-windows-store://review/?ProductId=" + Constants.UWP_REVIEW));
        } catch (t) {
            Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri("ms-windows-store://review/?ProductId=" + Constants.UWP_REVIEW));
        } else Constants.COMPILE_PLATFORM === Platform.ANDROID ? window.open("market://details?id=" + Constants.ANDROID_REVIEW) : Constants.COMPILE_PLATFORM === Platform.IOS ? this.open_in_store(Constants.IOS_REVIEW) : Constants.COMPILE_PLATFORM === Platform.AMAZON ? this.open_in_store(Constants.AMAZON_REVIEW) : Constants.COMPILE_PLATFORM === Platform.CHROME && this.open_link(Constants.CHROME_REVIEW);
    }, n.prototype.open_link = function(t) {
        Constants.COMPILE_PLATFORM;
        Constants.COMPILE_PLATFORM === Platform.UWP ? Constants.IS_UWP_WEBVIEW ? n.sendUWPRequest("openurl", t) : Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(t)) : Constants.COMPILE_PLATFORM === Platform.ANDROID || Constants.COMPILE_PLATFORM === Platform.AMAZON ? window.open(t, "_system", "location=no") : Constants.COMPILE_PLATFORM === Platform.IOS ? n.sendIOSRequest("openurl", "&url=" + t) : Constants.IS_MOBILE_COMPILE_VERSION || window.open(t, "_blank");
    }, n.prototype.openThisAppFromWebView = function() {
        GlobalVars.Platform === Platform.WEB_IOS ? this.open_in_store(Constants.IOS_APP_ID) : GlobalVars.Platform === Platform.WEB_ANDROID ? this.open_in_store(Constants.ANDROID_APP_ID) : this.open_in_store(Constants.UWP_APP_ID);
    }, n.prototype.open_in_store = function(t) {
        if (Constants.COMPILE_PLATFORM === Platform.UWP || GlobalVars.Platform === Platform.UWP_MOBILE) Constants.IS_UWP_WEBVIEW ? n.sendUWPRequest("openurl", "ms-windows-store:PDP?PRODUCTID=" + t) : Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri("ms-windows-store:PDP?PRODUCTID=" + t)); else if (Constants.COMPILE_PLATFORM === Platform.ANDROID) window.open("market://details?id=" + t); else if (GlobalVars.Platform === Platform.WEB_ANDROID) window.open("market://details?id=" + t); else if (Constants.COMPILE_PLATFORM === Platform.AMAZON) window.open("http://www.amazon.com/gp/mas/dl/android?p=" + t); else if (Constants.COMPILE_PLATFORM === Platform.IOS) {
            n.sendIOSRequest("openurl", "&url=" + ("itms-apps://itunes.apple.com/app/" + t));
        } else GlobalVars.Platform === Platform.WEB_IOS ? window.open("itms-apps://itunes.apple.com/app/" + t, "_blank") : window.open("ms-windows-store:PDP?PRODUCTID=" + t);
    }, n.prototype.open_more_games = function() {
        Constants.COMPILE_PLATFORM === Platform.UWP ? Constants.IS_UWP_WEBVIEW ? n.sendUWPRequest("openurl", Constants.MORE_GAMES) : Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(Constants.MORE_GAMES)) : Constants.COMPILE_PLATFORM === Platform.ANDROID || GlobalVars.Platform === Platform.WEB_ANDROID ? window.open("https://play.google.com/store/apps/developer?id=Amazing+Hedgehog") : Constants.COMPILE_PLATFORM === Platform.AMAZON ? window.open("http://www.amazon.com/gp/mas/dl/android?p=com.amazinghedgehog.mamazingspider&showAll=1") : Constants.COMPILE_PLATFORM === Platform.IOS ? n.sendIOSRequest("openurl", "&url=" + Constants.MORE_GAMES) : Constants.IS_MOBILE_COMPILE_VERSION || window.open(Constants.MORE_GAMES, "_blank");
    }, n.prototype.contact = function() {
        Constants.COMPILE_PLATFORM === Platform.UWP ? Constants.IS_UWP_WEBVIEW ? n.sendUWPRequest("openurl", "mailto: support@amazinghedgehog.com") : Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri("mailto:support@amazinghedgehog.com")) : Constants.COMPILE_PLATFORM === Platform.IOS && n.sendIOSRequest("openurl", "&url=mailto:support@amazinghedgehog.com"), 
        window.open("mailto:support@amazinghedgehog.com", "_blank");
    }, n;
}();

Array.prototype.min = function(t) {
    for (var e = t.call(this, this[0], 0, this), i = 1; i < this.length; i++) {
        var n = t.call(this, this[i], i, this);
        n < e && (e = n);
    }
    return e;
}, Array.prototype.max = function(t) {
    for (var e = t.call(this, this[0], 0, this), i = 1; i < this.length; i++) {
        var n = t.call(this, this[i], i, this);
        e < n && (e = n);
    }
    return e;
}, Array.prototype.sum = function(t) {
    for (var e = 0, i = 0; i < this.length; i++) e += t.call(this, this[i], i, this);
    return e;
}, function(t) {
    var e = function() {
        function t(t) {
            this.namespace = "";
            try {
                this.localStorageSupported = void 0 !== window.localStorage && null != window.localStorage, 
                this.localStorageSupported || this.setNamespace(t);
            } catch (t) {}
        }
        return t.prototype.add = function(t, e) {
            this.localStorageSupported ? localStorage.setItem(t, e) : document.cookie = encodeURIComponent(this.namespace + t) + "=" + encodeURIComponent(e) + "; expires=Tue, 25 Feb 2040 02:59:00 GMT; path=/";
        }, t.prototype.get = function(t) {
            if (this.localStorageSupported) return localStorage.getItem(t);
            try {
                return this.getCookiesForNameSpace()[t];
            } catch (t) {
                return null;
            }
        }, t.prototype.remove = function(t) {
            this.localStorageSupported && localStorage.removeItem(t);
        }, t.prototype.clear = function() {
            this.localStorageSupported && localStorage.clear();
        }, t.prototype.setNamespace = function(t) {
            t && (this.namespace = t + ":", this.reg = new RegExp("^" + this.namespace + "[a-zA-Z0-9]*", "g"));
        }, t.prototype.getNameSpaceMatches = function() {
            var e = this;
            return decodeURIComponent(document.cookie).split("; ").filter(function(t) {
                return null !== t.match(e.reg) && 0 < t.match(e.reg).length;
            });
        }, t.prototype.getCookiesForNameSpace = function() {
            var i = this, n = {};
            return this.getNameSpaceMatches().forEach(function(t) {
                var e = t.replace(i.namespace, "").split("=");
                n[e[0]] = e[1];
            }), n;
        }, t;
    }();
    t.LocalStorageWorker = e;
}(StorageHelper || (StorageHelper = {}));

var GameSettings = function() {
    function t() {
        if (this.playerScore = 0, this.playerCurrency = 0, this.playedGames = 0, this.menuEntries = 0, 
        this.gameSession = 0, this.winGames = 0, this.playerName = "Amazing Player", this.tutorialPassed = !1, 
        this.musicEnabled = !0, this.soundEnabled = !0, this.gameReview = !1, this.firstRun = !1, 
        t._instance) throw new Error("Error: Instantiation failed: Use SingletonClass.getInstance() instead of new.");
        (t._instance = this).storage = new StorageHelper.LocalStorageWorker("namee");
    }
    return t.getInstance = function() {
        return t._instance;
    }, t.prototype.load = function() {
        navigator.language;
        try {
            var t = this.storage.get(Constants.APP_KEY);
            document.settings && (t = document.settings);
            var e = JSON.parse(t);
            this.load_json(e);
        } catch (t) {
            this.load_json(null);
        }
    }, t.prototype.load_json = function(t) {
        null != t ? (this.playerName = t.playerName, this.playerScore = t.playerScore, void 0 !== t.playerCurrency && (this.playerCurrency = t.playerCurrency), 
        this.winGames = t.winGames, this.playedGames = t.playedGames, this.menuEntries = t.menuEntries, 
        this.userID = t.userID, this.soundEnabled = t.soundEnabled, this.musicEnabled = t.musicEnabled, 
        this.tutorialPassed = t.tutorialPassed, this.gameSession = t.gameSession + 1, this.gameReview = t.gameReview, 
        void 0 !== t.userLanguage && (this.userLanguage = t.userLanguage), this.firstRun = !1, 
        void 0 === this.userID && (this.userID = this.create_guid(32, "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ")), 
        this.gameData = t.gameData, AmazingGame.getInstance().getScene("gamescene").set_game_Data(t.gameData), 
        void 0 === t.applicationData ? this.applicationData = new ApplicationData() : this.applicationData = ApplicationData.reproduce(t.applicationData)) : (this.playerName = this.generateName() + " " + this.getRandomInt(1, 9999), 
        this.userID = this.create_guid(32, "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"), 
        this.firstRun = !0, this.applicationData = new ApplicationData(), this.save());
    }, t.prototype.capFirst = function(t) {
        return t.charAt(0).toUpperCase() + t.slice(1);
    }, t.prototype.getRandomInt = function(t, e) {
        return Math.floor(Math.random() * (e - t)) + t;
    }, t.prototype.generateName = function() {
        var t = [ "abandoned", "able", "absolute", "adorable", "adventurous", "academic", "acceptable", "acclaimed", "accomplished", "accurate", "aching", "acidic", "acrobatic", "active", "actual", "adept", "admirable", "admired", "adolescent", "adorable", "adored", "advanced", "afraid", "affectionate", "aged", "aggravating", "aggressive", "agile", "agitated", "agonizing", "agreeable", "ajar", "alarmed", "alarming", "alert", "alienated", "alive", "all", "altruistic", "amazing", "ambitious", "ample", "amused", "amusing", "anchored", "ancient", "angelic", "angry", "anguished", "animated", "annual", "another", "antique", "anxious", "any", "apprehensive", "appropriate", "apt", "arctic", "arid", "aromatic", "artistic", "ashamed", "assured", "astonishing", "athletic", "attached", "attentive", "attractive", "austere", "authentic", "authorized", "automatic", "avaricious", "average", "aware", "awesome", "awful", "awkward", "babyish", "bad", "back", "baggy", "bare", "barren", "basic", "beautiful", "belated", "beloved", "beneficial", "better", "best", "bewitched", "big", "big-hearted", "biodegradable", "bite-sized", "bitter", "black", "black-and-white", "bland", "blank", "blaring", "bleak", "blind", "blissful", "blond", "blue", "blushing", "bogus", "boiling", "bold", "bony", "boring", "bossy", "both", "bouncy", "bountiful", "bowed", "brave", "breakable", "brief", "bright", "brilliant", "brisk", "broken", "bronze", "brown", "bruised", "bubbly", "bulky", "bumpy", "buoyant", "burdensome", "burly", "bustling", "busy", "buttery", "buzzing", "calculating", "calm", "candid", "canine", "capital", "carefree", "careful", "careless", "caring", "cautious", "cavernous", "celebrated", "charming", "cheap", "cheerful", "cheery", "chief", "chilly", "chubby", "circular", "classic", "clean", "clear", "clear-cut", "clever", "close", "closed", "cloudy", "clueless", "clumsy", "cluttered", "coarse", "cold", "colorful", "colorless", "colossal", "comfortable", "common", "compassionate", "competent", "complete", "complex", "complicated", "composed", "concerned", "concrete", "confused", "conscious", "considerate", "constant", "content", "conventional", "cooked", "cool", "cooperative", "coordinated", "corny", "corrupt", "costly", "courageous", "courteous", "crafty", "crazy", "creamy", "creative", "creepy", "criminal", "crisp", "critical", "crooked", "crowded", "cruel", "crushing", "cuddly", "cultivated", "cultured", "cumbersome", "curly", "curvy", "cute", "cylindrical", "damaged", "damp", "dangerous", "dapper", "daring", "darling", "dark", "dazzling", "dead", "deadly", "deafening", "dear", "dearest", "decent", "decimal", "decisive", "deep", "defenseless", "defensive", "defiant", "deficient", "definite", "definitive", "delayed", "delectable", "delicious", "delightful", "delirious", "demanding", "dense", "dental", "dependable", "dependent", "descriptive", "deserted", "detailed", "determined", "devoted", "different", "difficult", "digital", "diligent", "dim", "dimpled", "dimwitted", "direct", "disastrous", "discrete", "disfigured", "disgusting", "disloyal", "dismal", "distant", "downright", "dreary", "dirty", "disguised", "dishonest", "dismal", "distant", "distinct", "distorted", "dizzy", "dopey", "doting", "double", "downright", "drab", "drafty", "dramatic", "dreary", "droopy", "dry", "dual", "dull", "dutiful", "each", "eager", "earnest", "early", "easy", "easy-going", "ecstatic", "edible", "educated", "elaborate", "elastic", "elated", "elderly", "electric", "elegant", "elementary", "elliptical", "embarrassed", "embellished", "eminent", "emotional", "empty", "enchanted", "enchanting", "energetic", "enlightened", "enormous", "enraged", "entire", "envious", "equal", "equatorial", "essential", "esteemed", "ethical", "euphoric", "even", "evergreen", "everlasting", "every", "evil", "exalted", "excellent", "exemplary", "exhausted", "excitable", "excited", "exciting", "exotic", "expensive", "experienced", "expert", "extraneous", "extroverted", "extra-large", "extra-small", "fabulous", "failing", "faint", "fair", "faithful", "fake", "false", "familiar", "famous", "fancy", "fantastic", "far", "faraway", "far-flung", "far-off", "fast", "fat", "fatal", "fatherly", "favorable", "favorite", "fearful", "fearless", "feisty", "feline", "female", "feminine", "few", "fickle", "filthy", "fine", "finished", "firm", "first", "firsthand", "fitting", "fixed", "flaky", "flamboyant", "flashy", "flat", "flawed", "flawless", "flickering", "flimsy", "flippant", "flowery", "fluffy", "fluid", "flustered", "focused", "fond", "foolhardy", "foolish", "forceful", "forked", "formal", "forsaken", "forthright", "fortunate", "fragrant", "frail", "frank", "frayed", "free", "French", "fresh", "frequent", "friendly", "frightened", "frightening", "frigid", "frilly", "frizzy", "frivolous", "front", "frosty", "frozen", "frugal", "fruitful", "full", "fumbling", "functional", "funny", "fussy", "fuzzy", "gargantuan", "gaseous", "general", "generous", "gentle", "genuine", "giant", "giddy", "gigantic", "gifted", "giving", "glamorous", "glaring", "glass", "gleaming", "gleeful", "glistening", "glittering", "gloomy", "glorious", "glossy", "glum", "golden", "good", "good-natured", "gorgeous", "graceful", "gracious", "grand", "grandiose", "granular", "grateful", "grave", "gray", "great", "greedy", "green", "gregarious", "grim", "grimy", "gripping", "grizzled", "gross", "grotesque", "grouchy", "grounded", "growing", "growling", "grown", "grubby", "gruesome", "grumpy", "guilty", "gullible", "gummy", "hairy", "half", "handmade", "handsome", "handy", "happy", "happy-go-lucky", "hard", "hard-to-find", "harmful", "harmless", "harmonious", "harsh", "hasty", "hateful", "haunting", "healthy", "heartfelt", "hearty", "heavenly", "heavy", "hefty", "helpful", "helpless", "hidden", "hideous", "high", "high-level", "hilarious", "hoarse", "hollow", "homely", "honest", "honorable", "honored", "hopeful", "horrible", "hospitable", "hot", "huge", "humble", "humiliating", "humming", "humongous", "hungry", "hurtful", "husky", "icky", "icy", "ideal", "idealistic", "identical", "idle", "idiotic", "idolized", "ignorant", "ill", "illegal", "ill-fated", "ill-informed", "illiterate", "illustrious", "imaginary", "imaginative", "immaculate", "immaterial", "immediate", "immense", "impassioned", "impeccable", "impartial", "imperfect", "imperturbable", "impish", "impolite", "important", "impossible", "impractical", "impressionable", "impressive", "improbable", "impure", "inborn", "incomparable", "incompatible", "incomplete", "inconsequential", "incredible", "indelible", "inexperienced", "indolent", "infamous", "infantile", "infatuated", "inferior", "infinite", "informal", "innocent", "insecure", "insidious", "insignificant", "insistent", "instructive", "insubstantial", "intelligent", "intent", "intentional", "interesting", "internal", "international", "intrepid", "ironclad", "irresponsible", "irritating", "itchy", "jaded", "jagged", "jam-packed", "jaunty", "jealous", "jittery", "joint", "jolly", "jovial", "joyful", "joyous", "jubilant", "judicious", "juicy", "jumbo", "junior", "jumpy", "juvenile", "kaleidoscopic", "keen", "key", "kind", "kindhearted", "kindly", "klutzy", "knobby", "knotty", "knowledgeable", "knowing", "known", "kooky", "kosher", "lame", "lanky", "large", "last", "lasting", "late", "lavish", "lawful", "lazy", "leading", "lean", "leafy", "left", "legal", "legitimate", "light", "lighthearted", "likable", "likely", "limited", "limp", "limping", "linear", "lined", "liquid", "little", "live", "lively", "livid", "loathsome", "lone", "lonely", "long", "long-term", "loose", "lopsided", "lost", "loud", "lovable", "lovely", "loving", "low", "loyal", "lucky", "lumbering", "luminous", "lumpy", "lustrous", "luxurious", "mad", "made-up", "magnificent", "majestic", "major", "male", "mammoth", "married", "marvelous", "masculine", "massive", "mature", "meager", "mealy", "mean", "measly", "meaty", "medical", "mediocre", "medium", "meek", "mellow", "melodic", "memorable", "menacing", "merry", "messy", "metallic", "mild", "milky", "mindless", "miniature", "minor", "minty", "miserable", "miserly", "misguided", "misty", "mixed", "modern", "modest", "moist", "monstrous", "monthly", "monumental", "moral", "mortified", "motherly", "motionless", "mountainous", "muddy", "muffled", "multicolored", "mundane", "murky", "mushy", "musty", "muted", "mysterious", "naive", "narrow", "nasty", "natural", "naughty", "nautical", "near", "neat", "necessary", "needy", "negative", "neglected", "negligible", "neighboring", "nervous", "new", "next", "nice", "nifty", "nimble", "nippy", "nocturnal", "noisy", "nonstop", "normal", "notable", "noted", "noteworthy", "novel", "noxious", "numb", "nutritious", "nutty", "obedient", "obese", "oblong", "oily", "oblong", "obvious", "occasional", "odd", "oddball", "offbeat", "offensive", "official", "old", "old-fashioned", "only", "open", "optimal", "optimistic", "opulent", "orange", "orderly", "organic", "ornate", "ornery", "ordinary", "original", "other", "our", "outlying", "outgoing", "outlandish", "outrageous", "outstanding", "oval", "overcooked", "overdue", "overjoyed", "overlooked", "palatable", "pale", "paltry", "parallel", "parched", "partial", "passionate", "past", "pastel", "peaceful", "peppery", "perfect", "perfumed", "periodic", "perky", "personal", "pertinent", "pesky", "pessimistic", "petty", "phony", "physical", "piercing", "pink", "pitiful", "plain", "plaintive", "plastic", "playful", "pleasant", "pleased", "pleasing", "plump", "plush", "polished", "polite", "political", "pointed", "pointless", "poised", "poor", "popular", "portly", "posh", "positive", "possible", "potable", "powerful", "powerless", "practical", "precious", "present", "prestigious", "pretty", "precious", "previous", "pricey", "prickly", "primary", "prime", "pristine", "private", "prize", "probable", "productive", "profitable", "profuse", "proper", "proud", "prudent", "punctual", "pungent", "puny", "pure", "purple", "pushy", "putrid", "puzzled", "puzzling", "quaint", "qualified", "quarrelsome", "quarterly", "queasy", "querulous", "questionable", "quick", "quick-witted", "quiet", "quintessential", "quirky", "quixotic", "quizzical", "radiant", "ragged", "rapid", "rare", "rash", "raw", "recent", "reckless", "rectangular", "ready", "real", "realistic", "reasonable", "red", "reflecting", "regal", "regular", "reliable", "relieved", "remarkable", "remorseful", "remote", "repentant", "required", "respectful", "responsible", "repulsive", "revolving", "rewarding", "rich", "rigid", "right", "ringed", "ripe", "roasted", "robust", "rosy", "rotating", "rotten", "rough", "round", "rowdy", "royal", "rubbery", "rundown", "ruddy", "rude", "runny", "rural", "rusty", "sad", "safe", "salty", "same", "sandy", "sane", "sarcastic", "sardonic", "satisfied", "scaly", "scarce", "scared", "scary", "scented", "scholarly", "scientific", "scornful", "scratchy", "scrawny", "second", "secondary", "second-hand", "secret", "self-assured", "self-reliant", "selfish", "sentimental", "separate", "serene", "serious", "serpentine", "several", "severe", "shabby", "shadowy", "shady", "shallow", "shameful", "shameless", "sharp", "shimmering", "shiny", "shocked", "shocking", "shoddy", "short", "short-term", "showy", "shrill", "shy", "sick", "silent", "silky", "silly", "silver", "similar", "simple", "simplistic", "sinful", "single", "sizzling", "skeletal", "skinny", "sleepy", "slight", "slim", "slimy", "slippery", "slow", "slushy", "small", "smart", "smoggy", "smooth", "smug", "snappy", "snarling", "sneaky", "sniveling", "snoopy", "sociable", "soft", "soggy", "solid", "somber", "some", "spherical", "sophisticated", "sore", "sorrowful", "soulful", "soupy", "sour", "Spanish", "sparkling", "sparse", "specific", "spectacular", "speedy", "spicy", "spiffy", "spirited", "spiteful", "splendid", "spotless", "spotted", "spry", "square", "squeaky", "squiggly", "stable", "staid", "stained", "stale", "standard", "starchy", "stark", "starry", "steep", "sticky", "stiff", "stimulating", "stingy", "stormy", "straight", "strange", "steel", "strict", "strident", "striking", "striped", "strong", "studious", "stunning", "stupendous", "stupid", "sturdy", "stylish", "subdued", "submissive", "substantial", "subtle", "suburban", "sudden", "sugary", "sunny", "super", "superb", "superficial", "superior", "supportive", "sure-footed", "surprised", "suspicious", "svelte", "sweaty", "sweet", "sweltering", "swift", "sympathetic", "tall", "talkative", "tame", "tan", "tangible", "tart", "tasty", "tattered", "taut", "tedious", "teeming", "tempting", "tender", "tense", "tepid", "terrible", "terrific", "testy", "thankful", "that", "these", "thick", "thin", "third", "thirsty", "this", "thorough", "thorny", "those", "thoughtful", "threadbare", "thrifty", "thunderous", "tidy", "tight", "timely", "tinted", "tiny", "tired", "torn", "total", "tough", "traumatic", "treasured", "tremendous", "tragic", "trained", "tremendous", "triangular", "tricky", "trifling", "trim", "trivial", "troubled", "true", "trusting", "trustworthy", "trusty", "truthful", "tubby", "turbulent", "twin", "ugly", "ultimate", "unacceptable", "unaware", "uncomfortable", "uncommon", "unconscious", "understated", "unequaled", "uneven", "unfinished", "unfit", "unfolded", "unfortunate", "unhappy", "unhealthy", "uniform", "unimportant", "unique", "united", "unkempt", "unknown", "unlawful", "unlined", "unlucky", "unnatural", "unpleasant", "unrealistic", "unripe", "unruly", "unselfish", "unsightly", "unsteady", "unsung", "untidy", "untimely", "untried", "untrue", "unused", "unusual", "unwelcome", "unwieldy", "unwilling", "unwitting", "unwritten", "upbeat", "upright", "upset", "urban", "usable", "used", "useful", "useless", "utilized", "utter", "vacant", "vague", "vain", "valid", "valuable", "vapid", "variable", "vast", "velvety", "venerated", "vengeful", "verifiable", "vibrant", "vicious", "victorious", "vigilant", "vigorous", "villainous", "violet", "violent", "virtual", "virtuous", "visible", "vital", "vivacious", "vivid", "voluminous", "wan", "warlike", "warm", "warmhearted", "warped", "wary", "wasteful", "watchful", "waterlogged", "watery", "wavy", "wealthy", "weak", "weary", "webbed", "wee", "weekly", "weepy", "weighty", "weird", "welcome", "well-documented", "well-groomed", "well-informed", "well-lit", "well-made", "well-off", "well-to-do", "well-worn", "wet", "which", "whimsical", "whirlwind", "whispered", "white", "whole", "whopping", "wicked", "wide", "wide-eyed", "wiggly", "wild", "willing", "wilted", "winding", "windy", "winged", "wiry", "wise", "witty", "wobbly", "woeful", "wonderful", "wooden", "woozy", "wordy", "worldly", "worn", "worried", "worrisome", "worse", "worst", "worthless", "worthwhile", "worthy", "wrathful", "wretched", "writhing", "wrong", "wry", "yawning", "yearly", "yellow", "yellowish", "young", "youthful", "yummy", "zany", "zealous", "zesty", "zigzag", "rocky" ], e = [ "people", "history", "way", "art", "world", "information", "map", "family", "government", "health", "system", "computer", "meat", "year", "thanks", "music", "person", "reading", "method", "data", "food", "understanding", "theory", "law", "bird", "literature", "problem", "software", "control", "knowledge", "power", "ability", "economics", "love", "internet", "television", "science", "library", "nature", "fact", "product", "idea", "temperature", "investment", "area", "society", "activity", "story", "industry", "media", "thing", "oven", "community", "definition", "safety", "quality", "development", "language", "management", "player", "variety", "video", "week", "security", "country", "exam", "movie", "organization", "equipment", "physics", "analysis", "policy", "series", "thought", "basis", "boyfriend", "direction", "strategy", "technology", "army", "camera", "freedom", "paper", "environment", "child", "instance", "month", "truth", "marketing", "university", "writing", "article", "department", "difference", "goal", "news", "audience", "fishing", "growth", "income", "marriage", "user", "combination", "failure", "meaning", "medicine", "philosophy", "teacher", "communication", "night", "chemistry", "disease", "disk", "energy", "nation", "road", "role", "soup", "advertising", "location", "success", "addition", "apartment", "education", "math", "moment", "painting", "politics", "attention", "decision", "event", "property", "shopping", "student", "wood", "competition", "distribution", "entertainment", "office", "population", "president", "unit", "category", "cigarette", "context", "introduction", "opportunity", "performance", "driver", "flight", "length", "magazine", "newspaper", "relationship", "teaching", "cell", "dealer", "debate", "finding", "lake", "member", "message", "phone", "scene", "appearance", "association", "concept", "customer", "death", "discussion", "housing", "inflation", "insurance", "mood", "woman", "advice", "blood", "effort", "expression", "importance", "opinion", "payment", "reality", "responsibility", "situation", "skill", "statement", "wealth", "application", "city", "county", "depth", "estate", "foundation", "grandmother", "heart", "perspective", "photo", "recipe", "studio", "topic", "collection", "depression", "imagination", "passion", "percentage", "resource", "setting", "ad", "agency", "college", "connection", "criticism", "debt", "description", "memory", "patience", "secretary", "solution", "administration", "aspect", "attitude", "director", "personality", "psychology", "recommendation", "response", "selection", "storage", "version", "alcohol", "argument", "complaint", "contract", "emphasis", "highway", "loss", "membership", "possession", "preparation", "steak", "union", "agreement", "cancer", "currency", "employment", "engineering", "entry", "interaction", "limit", "mixture", "preference", "region", "republic", "seat", "tradition", "virus", "actor", "classroom", "delivery", "device", "difficulty", "drama", "election", "engine", "football", "guidance", "hotel", "match", "owner", "priority", "protection", "suggestion", "tension", "variation", "anxiety", "atmosphere", "awareness", "bread", "climate", "comparison", "confusion", "construction", "elevator", "emotion", "employee", "employer", "guest", "height", "leadership", "mall", "manager", "operation", "recording", "respect", "sample", "transportation", "boring", "charity", "cousin", "disaster", "editor", "efficiency", "excitement", "extent", "feedback", "guitar", "homework", "leader", "mom", "outcome", "permission", "presentation", "promotion", "reflection", "refrigerator", "resolution", "revenue", "session", "singer", "tennis", "basket", "bonus", "cabinet", "childhood", "church", "clothes", "coffee", "dinner", "drawing", "hair", "hearing", "initiative", "judgment", "lab", "measurement", "mode", "mud", "orange", "poetry", "police", "possibility", "procedure", "queen", "ratio", "relation", "restaurant", "satisfaction", "sector", "signature", "significance", "song", "tooth", "town", "vehicle", "volume", "wife", "accident", "airport", "appointment", "arrival", "assumption", "baseball", "chapter", "committee", "conversation", "database", "enthusiasm", "error", "explanation", "farmer", "gate", "girl", "hall", "historian", "hospital", "injury", "instruction", "maintenance", "manufacturer", "meal", "perception", "pie", "poem", "presence", "proposal", "reception", "replacement", "revolution", "river", "son", "speech", "tea", "village", "warning", "winner", "worker", "writer", "assistance", "breath", "buyer", "chest", "chocolate", "conclusion", "contribution", "cookie", "courage", "desk", "drawer", "establishment", "examination", "garbage", "grocery", "honey", "impression", "improvement", "independence", "insect", "inspection", "inspector", "king", "ladder", "menu", "penalty", "piano", "potato", "profession", "professor", "quantity", "reaction", "requirement", "salad", "sister", "supermarket", "tongue", "weakness", "wedding", "affair", "ambition", "analyst", "apple", "assignment", "assistant", "bathroom", "bedroom", "beer", "birthday", "celebration", "championship", "cheek", "client", "consequence", "departure", "diamond", "dirt", "ear", "fortune", "friendship", "funeral", "gene", "girlfriend", "hat", "indication", "intention", "lady", "midnight", "negotiation", "obligation", "passenger", "pizza", "platform", "poet", "pollution", "recognition", "reputation", "shirt", "speaker", "stranger", "surgery", "sympathy", "tale", "throat", "trainer", "uncle", "youth", "time", "work", "film", "water", "money", "example", "while", "business", "study", "game", "life", "form", "air", "day", "place", "number", "part", "field", "fish", "back", "process", "heat", "hand", "experience", "job", "book", "end", "point", "type", "home", "economy", "value", "body", "market", "guide", "interest", "state", "radio", "course", "company", "price", "size", "card", "list", "mind", "trade", "line", "care", "group", "risk", "word", "fat", "force", "key", "light", "training", "name", "school", "top", "amount", "level", "order", "practice", "research", "sense", "service", "piece", "web", "boss", "sport", "fun", "house", "page", "term", "test", "answer", "sound", "focus", "matter", "kind", "soil", "board", "oil", "picture", "access", "garden", "range", "rate", "reason", "future", "site", "demand", "exercise", "image", "case", "cause", "coast", "action", "age", "bad", "boat", "record", "result", "section", "building", "mouse", "cash", "class", "period", "plan", "store", "tax", "side", "subject", "space", "rule", "stock", "weather", "chance", "figure", "man", "model", "source", "beginning", "earth", "program", "chicken", "design", "feature", "head", "material", "purpose", "question", "rock", "salt", "act", "birth", "car", "dog", "object", "scale", "sun", "note", "profit", "rent", "speed", "style", "war", "bank", "craft", "half", "inside", "outside", "standard", "bus", "exchange", "eye", "fire", "position", "pressure", "stress", "advantage", "benefit", "box", "frame", "issue", "step", "cycle", "face", "item", "metal", "paint", "review", "room", "screen", "structure", "view", "account", "ball", "discipline", "medium", "share", "balance", "bit", "black", "bottom", "choice", "gift", "impact", "machine", "shape", "tool", "wind", "address", "average", "career", "culture", "morning", "pot", "sign", "table", "task", "condition", "contact", "credit", "egg", "hope", "ice", "network", "north", "square", "attempt", "date", "effect", "link", "post", "star", "voice", "capital", "challenge", "friend", "self", "shot", "brush", "couple", "exit", "front", "function", "lack", "living", "plant", "plastic", "spot", "summer", "taste", "theme", "track", "wing", "brain", "button", "click", "desire", "foot", "gas", "influence", "notice", "rain", "wall", "base", "damage", "distance", "feeling", "pair", "savings", "staff", "sugar", "target", "text", "animal", "author", "budget", "discount", "file", "ground", "lesson", "minute", "officer", "phase", "reference", "register", "sky", "stage", "stick", "title", "trouble", "bowl", "bridge", "campaign", "character", "club", "edge", "evidence", "fan", "letter", "lock", "maximum", "novel", "option", "pack", "park", "quarter", "skin", "sort", "weight", "baby", "background", "carry", "dish", "factor", "fruit", "glass", "joint", "master", "muscle", "red", "strength", "traffic", "trip", "vegetable", "appeal", "chart", "gear", "ideal", "kitchen", "land", "log", "mother", "net", "party", "principle", "relative", "sale", "season", "signal", "spirit", "street", "tree", "wave", "belt", "bench", "commission", "copy", "drop", "minimum", "path", "progress", "project", "sea", "south", "status", "stuff", "ticket", "tour", "angle", "blue", "breakfast", "confidence", "daughter", "degree", "doctor", "dot", "dream", "duty", "essay", "father", "fee", "finance", "hour", "juice", "luck", "milk", "mouth", "peace", "pipe", "stable", "storm", "substance", "team", "trick", "afternoon", "bat", "beach", "blank", "catch", "chain", "consideration", "cream", "crew", "detail", "gold", "interview", "kid", "mark", "mission", "pain", "pleasure", "score", "screw", "sex", "shop", "shower", "suit", "tone", "window", "agent", "band", "bath", "block", "bone", "calendar", "candidate", "cap", "coat", "contest", "corner", "court", "cup", "district", "door", "east", "finger", "garage", "guarantee", "hole", "hook", "implement", "layer", "lecture", "lie", "manner", "meeting", "nose", "parking", "partner", "profile", "rice", "routine", "schedule", "swimming", "telephone", "tip", "winter", "airline", "bag", "battle", "bed", "bill", "bother", "cake", "code", "curve", "designer", "dimension", "dress", "ease", "emergency", "evening", "extension", "farm", "fight", "gap", "grade", "holiday", "horror", "horse", "host", "husband", "loan", "mistake", "mountain", "nail", "noise", "occasion", "package", "patient", "pause", "phrase", "proof", "race", "relief", "sand", "sentence", "shoulder", "smoke", "stomach", "string", "tourist", "towel", "vacation", "west", "wheel", "wine", "arm", "aside", "associate", "bet", "blow", "border", "branch", "breast", "brother", "buddy", "bunch", "chip", "coach", "cross", "document", "draft", "dust", "expert", "floor", "god", "golf", "habit", "iron", "judge", "knife", "landscape", "league", "mail", "mess", "native", "opening", "parent", "pattern", "pin", "pool", "pound", "request", "salary", "shame", "shelter", "shoe", "silver", "tackle", "tank", "trust", "assist", "bake", "bar", "bell", "bike", "blame", "boy", "brick", "chair", "closet", "clue", "collar", "comment", "conference", "devil", "diet", "fear", "fuel", "glove", "jacket", "lunch", "monitor", "mortgage", "nurse", "pace", "panic", "peak", "plane", "reward", "row", "sandwich", "shock", "spite", "spray", "surprise", "till", "transition", "weekend", "welcome", "yard", "alarm", "bend", "bicycle", "bite", "blind", "bottle", "cable", "candle", "clerk", "cloud", "concert", "counter", "flower", "grandfather", "harm", "knee", "lawyer", "leather", "load", "mirror", "neck", "pension", "plate", "purple", "ruin", "ship", "skirt", "slice", "snow", "specialist", "stroke", "switch", "trash", "tune", "zone", "anger", "award", "bid", "bitter", "boot", "bug", "camp", "candy", "carpet", "cat", "champion", "channel", "clock", "comfort", "cow", "crack", "engineer", "entrance", "fault", "grass", "guy", "hell", "highlight", "incident", "island", "joke", "jury", "leg", "lip", "mate", "motor", "nerve", "passage", "pen", "pride", "priest", "prize", "promise", "resident", "resort", "ring", "roof", "rope", "sail", "scheme", "script", "sock", "station", "toe", "tower", "truck", "witness", "can", "will", "other", "use", "make", "good", "look", "help", "go", "great", "being", "still", "public", "read", "keep", "start", "give", "human", "local", "general", "specific", "long", "play", "feel", "high", "put", "common", "set", "change", "simple", "past", "big", "possible", "particular", "major", "personal", "current", "national", "cut", "natural", "physical", "show", "try", "check", "second", "call", "move", "pay", "let", "increase", "single", "individual", "turn", "ask", "buy", "guard", "hold", "main", "offer", "potential", "professional", "international", "travel", "cook", "alternative", "special", "working", "whole", "dance", "excuse", "cold", "commercial", "low", "purchase", "deal", "primary", "worth", "fall", "necessary", "positive", "produce", "search", "present", "spend", "talk", "creative", "tell", "cost", "drive", "green", "support", "glad", "remove", "return", "run", "complex", "due", "effective", "middle", "regular", "reserve", "independent", "leave", "original", "reach", "rest", "serve", "watch", "beautiful", "charge", "active", "break", "negative", "safe", "stay", "visit", "visual", "affect", "cover", "report", "rise", "walk", "white", "junior", "pick", "unique", "classic", "final", "lift", "mix", "private", "stop", "teach", "western", "concern", "familiar", "fly", "official", "broad", "comfortable", "gain", "rich", "save", "stand", "young", "heavy", "lead", "listen", "valuable", "worry", "handle", "leading", "meet", "release", "sell", "finish", "normal", "press", "ride", "secret", "spread", "spring", "tough", "wait", "brown", "deep", "display", "flow", "hit", "objective", "shoot", "touch", "cancel", "chemical", "cry", "dump", "extreme", "push", "conflict", "eat", "fill", "formal", "jump", "kick", "opposite", "pass", "pitch", "remote", "total", "treat", "vast", "abuse", "beat", "burn", "deposit", "print", "raise", "sleep", "somewhere", "advance", "consist", "dark", "double", "draw", "equal", "fix", "hire", "internal", "join", "kill", "sensitive", "tap", "win", "attack", "claim", "constant", "drag", "drink", "guess", "minor", "pull", "raw", "soft", "solid", "wear", "weird", "wonder", "annual", "count", "dead", "doubt", "feed", "forever", "impress", "repeat", "round", "sing", "slide", "strip", "wish", "combine", "command", "dig", "divide", "equivalent", "hang", "hunt", "initial", "march", "mention", "spiritual", "survey", "tie", "adult", "brief", "crazy", "escape", "gather", "hate", "prior", "repair", "rough", "sad", "scratch", "sick", "strike", "employ", "external", "hurt", "illegal", "laugh", "lay", "mobile", "nasty", "ordinary", "respond", "royal", "senior", "split", "strain", "struggle", "swim", "train", "upper", "wash", "yellow", "convert", "crash", "dependent", "fold", "funny", "grab", "hide", "miss", "permit", "quote", "recover", "resolve", "roll", "sink", "slip", "spare", "suspect", "sweet", "swing", "twist", "upstairs", "usual", "abroad", "brave", "calm", "concentrate", "estimate", "grand", "male", "mine", "prompt", "quiet", "refuse", "regret", "reveal", "rush", "shake", "shift", "shine", "steal", "suck", "surround", "bear", "brilliant", "dare", "dear", "delay", "drunk", "female", "hurry", "inevitable", "invite", "kiss", "neat", "pop", "punch", "quit", "reply", "representative", "resist", "rip", "rub", "silly", "smile", "spell", "stretch", "stupid", "tear", "temporary", "tomorrow", "wake", "wrap", "yesterday", "Thomas", "Tom", "Lieuwe" ];
        return this.capFirst(t[this.getRandomInt(0, t.length + 1)]) + " " + this.capFirst(e[this.getRandomInt(0, e.length + 1)]);
    }, t.prototype.saveDebugSettings = function(t) {
        this.storage.add(Constants.APP_KEY, t);
    }, t.prototype.save = function() {
        this.gameData = AmazingGame.getInstance().getScene("gamescene").get_game_data(), 
        this.applicationData && (this.applicationData.runOnGameScreen = !1), AmazingGame.getInstance().currentSceneName === GameScene.Name && (this.applicationData.runOnGameScreen = !0);
        var t = JSON.stringify(this);
        this.storage.add(Constants.APP_KEY, t), Constants.SAVE_SERVER_SETTINGS, Constants.COMPILE_PLATFORM === Platform.UWP && Constants.IS_UWP_WEBVIEW;
    }, t.prototype.create_guid = function(t, e) {
        for (var i = "", n = t; 0 < n; --n) i += e[Math.floor(Math.random() * e.length)];
        return i;
    }, t.prototype.clear = function() {
        this.storage.clear();
    }, t._instance = new t(), t;
}(), GlobalVars = function() {
    function h() {}
    return h.setup_platform = function(t, e, i, n, s) {
        t ? h.Platform = Platform.ANDROID : e ? h.Platform = Platform.IOS : n ? h.Platform = Platform.UWP_MOBILE : i ? h.Platform = Platform.UWP : s && (h.Platform = Platform.AMAZON), 
        h.IsMobile = !0;
    }, h.setup_web_platform = function(t, e, i, n, s, o, a, r) {
        h.Platform = Platform.WEB, t ? (h.Platform = Platform.WEB_ANDROID, h.IsMobile = !0, 
        h.IsWebMobile = !0) : e ? (h.Platform = Platform.WEB_IOS, h.IsMobile = !0, h.IsWebMobile = !0) : i && (h.Platform = Platform.UWP_MOBILE, 
        h.IsMobile = !0, h.IsWebMobile = !0);
    }, h.LANDSCAPE_BG = "landscape_bg", h.PORTRAIT_BG = "portrait_bg", h.DIALOG_BG = "dialog_bg", 
    h.BUTTON_SOUND = "button_click", h.BACKGROUND_MUSIC = "background_music", h.AccentColor = "#ffffff", 
    h.TransitionColor = "#ffffff", h;
}();

String.prototype.get_frame_name = function() {
    return SpriteUtils.get_frame_name(this);
};

var AmazingAd, AudioManager = function() {
    function r() {
        if (r._instance) throw new Error("Error: Instantiation failed: Use SingletonClass.getInstance() instead of new.");
        (r._instance = this).sounds = [];
    }
    return r.getInstance = function() {
        return r._instance;
    }, r.prototype.initialize = function(t, e, i) {
        var n, s;
        if (this.game = t, null != e) try {
            for (var o = __values(e), a = o.next(); !a.done; a = o.next()) {
                var r = a.value;
                this.sounds.push(this.game.add.audio(r));
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (s = o.return) && s.call(o);
            } finally {
                if (n) throw n.error;
            }
        }
    }, r.prototype.push_sound = function(t) {
        this.game.add.audio(t).name = t, this.sounds.push(this.game.add.audio(t));
    }, r.prototype.play_button = function() {
        GameSettings.getInstance().soundEnabled && (void 0 === this.button && (this.button = this.game.add.audio(Sounds.CLICK)), 
        this.button.play());
    }, r.prototype.play_effect = function(t, e) {
        var i, n;
        if (void 0 === e && (e = 1), GameSettings.getInstance().soundEnabled) try {
            for (var s = __values(this.sounds), o = s.next(); !o.done; o = s.next()) {
                var a = o.value;
                a.name === t && (a.volume = r.GLOBAL_VOLUME * e, a.allowMultiple = !0, a.play());
            }
        } catch (t) {
            i = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (n = s.return) && n.call(s);
            } finally {
                if (i) throw i.error;
            }
        }
    }, r.prototype.play_background = function(t) {
        void 0 === t && (t = .25), GameSettings.getInstance().musicEnabled && (void 0 === this.background && (this.background = this.game.add.audio(Sounds.BACKGROUND)), 
        this.background.volume = t, this.paused ? this.background.play() : this.background.isPlaying || this.background.loopFull());
    }, r.prototype.stop_background = function() {
        void 0 !== this.background && (this.background.stop(), this.paused = !1);
    }, r.prototype.pause_background = function() {
        void 0 !== this.background && (this.background.pause(), this.paused = !0);
    }, r.prototype.unpause_background = function() {
        void 0 !== this.background && (this.background.resume(), this.paused = !1);
    }, r.GLOBAL_VOLUME = .75, r._instance = new r(), r;
}(), UIAdsManager = function() {
    function t() {
        if (this.adsAlreadyShowed = !1, t._instance) throw new Error("Error: Instantiation failed: Use SingletonClass.getInstance() instead of new.");
        t._instance = this;
    }
    return t.getInstance = function() {
        return t._instance;
    }, t.prototype.initialize = function(t) {
        this.game = t;
    }, t.prototype.removeAd = function() {
        this.adsAlreadyShowed && (AmazingGame.getInstance().amazingAdProvider.BannerController.remove_ad_control(), 
        this.adsAlreadyShowed = !1), this.clearAdTween();
    }, t.prototype.clearAdTween = function() {
        this.showAdTween && (this.showAdTween.stop(), AmazingGame.getInstance().tweens.remove(this.showAdTween), 
        this.showAdTween = void 0), AmazingGame.getInstance().tweens.removeFrom(this);
    }, t.prototype.tryShowAd = function(t) {
        if (RemoteConfig.PLAY_BANNER_ADS) {
            this.removeAd(), this.clearAdTween();
            this.showAdTween = AmazingGame.getInstance().add.tween(this), this.showAdTween.to({}, 1e3, Phaser.Easing.Linear.None, !0).onComplete.addOnce(function() {
                AmazingGame.getInstance().amazingAdProvider.BannerController.showAd(t);
            }), this.adsAlreadyShowed = !0;
        }
    }, t._instance = new t(), t;
}(), AmazingGroup = function(n) {
    function t(t, e) {
        var i = n.call(this, t) || this;
        return i.ScaleOnResize = !0, i.parentComponent = e, i;
    }
    return __extends(t, n), t.prototype.on_resize = function() {
        this.ScaleOnResize && (this.scale.set(AmazingGame.getInstance().ratio, AmazingGame.getInstance().ratio), 
        this.position.x = Math.round(AmazingGame.getInstance().borderWidth), this.position.y = Math.round(AmazingGame.getInstance().borderHeight), 
        this.updateTransform());
    }, t;
}(Phaser.Group), BMFLabel = function(c) {
    function t(t, e, i, n, s, o, a, r, h) {
        var l = c.call(this, t, e, i, n, s, o) || this;
        return l.baseFontSize = 50, l.replaceLastByDots = !1, l.maxDotWidth = 0, l.maxWidth = a, 
        l.maxHeight = r, l.translation = h, l.smoothed = !0, l.baseFontSize = o, l.game.add.existing(l), 
        h && l.setTranslation(h), l.setText(s), l;
    }
    return __extends(t, c), t.UniformTextSizes = function(t) {
        var e, i, n = t.map(function(t) {
            return t && t.fontSize;
        }), s = Utils.arrayMin(n);
        try {
            for (var o = __values(t), a = o.next(); !a.done; a = o.next()) {
                var r = a.value;
                r && (r.fontSize = s);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (i = o.return) && i.call(o);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.UniformTextSizesForButtons = function(t) {
        var e, i, n, s, o = [];
        try {
            for (var a = __values(t), r = a.next(); !r.done; r = a.next()) {
                var h = r.value;
                h && o.push(h.bmfLabel);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                r && !r.done && (i = a.return) && i.call(a);
            } finally {
                if (e) throw e.error;
            }
        }
        var l = o.map(function(t) {
            return t && t.fontSize;
        }), c = Utils.arrayMin(l);
        try {
            for (var u = __values(o), d = u.next(); !d.done; d = u.next()) {
                var p = d.value;
                p && (p.fontSize = c);
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                d && !d.done && (s = u.return) && s.call(u);
            } finally {
                if (n) throw n.error;
            }
        }
    }, t.prototype.setTranslation = function(t) {
        var e = this;
        this.translation = t, this.translate(), AmazingGame.getInstance().translation.addListener(function() {
            e.translate();
        });
    }, t.prototype.setText = function(t, e) {
        return void 0 === e && (e = !0), c.prototype.setText.call(this, t), e && (this.maxWidth || this.maxHeight) && this.makeFontFit(), 
        this;
    }, t.prototype.setMaxSize = function(t, e) {
        this.maxWidth = t, this.maxHeight = e, this.makeFontFit();
    }, t.prototype.setMaxSizeForDots = function(t, e) {
        this.maxDotWidth = t, this.maxHeight = e, this.makeFontFit();
    }, t.prototype.setAlignRight = function() {
        this.anchor.x = 1;
    }, t.prototype.setAlignLeft = function() {
        this.anchor.x = 0;
    }, t.prototype.setAlignCenter = function() {
        this.anchor.x = .5;
    }, t.prototype.setVerticalCenter = function() {
        this.anchor.y = .5;
    }, t.prototype.setVerticalBottom = function() {
        this.anchor.y = 1;
    }, t.prototype.setVerticalandHorizontalCenter = function() {
        this.anchor.x = .5, this.anchor.y = .5, this.align = "center";
    }, t.prototype.makeFontFit = function() {
        var e, t;
        this.scale;
        this.fontSize = this.baseFontSize;
        var i;
        if (this.replaceLastByDots) {
            var n = this.text;
            if (this.width > this.maxDotWidth) {
                this.text = "";
                try {
                    for (var s = __values(n), o = s.next(); !o.done; o = s.next()) {
                        var a = o.value;
                        if (this.text += a, this.updateTransform(), this.width > this.maxDotWidth) {
                            this.text = this.text.slice(0, this.text.length - 5), this.text += "...", this.updateTransform();
                            break;
                        }
                    }
                } catch (t) {
                    e = {
                        error: t
                    };
                } finally {
                    try {
                        o && !o.done && (t = s.return) && t.call(s);
                    } finally {
                        if (e) throw e.error;
                    }
                }
            }
        } else for (;this.width > this.maxWidth || this.height > this.maxHeight; ) {
            if ((i = this.fontSize - 1) < 10) {
                i = 10, this.fontSize = i;
                break;
            }
            this.fontSize = i;
        }
    }, t.prototype.setColoredWord = function(t) {
        for (var e = t.first; e < t.second; e++) {
            if (e < this.children.length) this.getChildAt(e).tint = t.third;
        }
    }, t.prototype.translate = function() {
        if (this.translation) {
            var t = AmazingGame.getInstance().translate(this.translation.translationID);
            this.translation.isUpperCase && (t = t.toUpperCase()), this.translation.isFirstUpperCase && (t = t[0].toUpperCase() + t.slice(1)), 
            this.setText(t);
        }
    }, t;
}(Phaser.BitmapText), ColorButton = function(h) {
    function u(t, e, i, n, s, o, a) {
        var r = h.call(this, t, e, i, n, s, o, a, a, a) || this;
        return r.startColor = Utils.RGBtoHEX(245, 245, 245), r.pressColor = Utils.RGBtoHEX(127, 127, 127), 
        r.hoverColor = Utils.RGBtoHEX(200, 200, 200), r;
    }
    return __extends(u, h), u.create_button_with_text = function(t, e, i, n, s, o, a, r, h) {
        var l = new u(t, e, i, n, a, r, h);
        l.anchor.set(.5);
        var c = t.add.bitmapText(0, -25, s, o, 96);
        return c.align = "center", c.anchor.set(.5, .5), l.buttonLabel = c, l.addChild(c), 
        l;
    }, u.create_button_with_text_from_sheet = function(t, e, i, n, s) {}, u.prototype.onInputDownHandler = function(t, e) {
        h.prototype.onInputDownHandler.call(this, t, e), this.tint = this.pressColor;
    }, u.prototype.onInputUpHandler = function(t, e, i) {
        h.prototype.onInputUpHandler.call(this, t, e, i), this.tint = this.startColor;
    }, u.prototype.onInputOutHandler = function(t, e) {
        h.prototype.onInputOutHandler.call(this, t, e), this.tint = this.startColor;
    }, u.prototype.onInputOverHandler = function(t, e) {
        h.prototype.onInputOverHandler.call(this, t, e), this.tint = this.hoverColor;
    }, u.prototype.create_overlay_texture = function(t) {
        var e = this.game.make.graphics(0, 0);
        e.beginFill(0, .3).drawRoundedRect(5, 5, this.width - 10, this.width, 15).beginFill(t).endFill(), 
        this.overlayTexture = this.game.add.sprite(0, 0, e.generateTexture()), this.overlayTexture.anchor.set(.5), 
        this.addChild(this.overlayTexture), e.destroy(!0);
    }, u.prototype.set_disabled = function() {
        this.tint = this.pressColor, this.inputEnabled = !1;
    }, u.prototype.set_enabled = function() {
        this.tint = this.startColor, this.inputEnabled = !0;
    }, u.prototype.set_all_frames = function(t) {
        this.frameName = t, this.setFrames(t, t, t, t);
    }, u;
}(Phaser.Button), Component = function(e) {
    function t() {
        var t = null !== e && e.apply(this, arguments) || this;
        return t.showed = !1, t.enabled = !1, t.created = !1, t.isPortraitLocked = !1, t.keyboardButtons = {}, 
        t;
    }
    return __extends(t, e), t.prototype.init = function() {
        this.dialogs = [], this.layers = [], this.layers.push(new AmazingGroup(this.game, this)), 
        this.layers.push(new AmazingGroup(this.game, this)), this.layers[0].ScaleOnResize = !1, 
        e.prototype.init.call(this), AmazingGame.getInstance().fadeLayerToTop();
    }, t.prototype.preload = function() {
        AmazingGame.getInstance().fadeLayerToTop();
    }, t.prototype.create = function() {
        this.game.renderType === Phaser.CANVAS && (this.game.canvas.getContext("2d").imageSmoothingEnabled = !0), 
        this.input.keyboard.addCallbacks(this, this.on_keyboard_clicked, this.on_keyboard_Up), 
        AmazingGame.getInstance().fadeLayerToTop(), this.showed = !1, this.enabled = !1, 
        this.created = !0;
    }, t.prototype.show = function() {
        this.showed = !0, null != this.game.google && (this.game.google.send_event("send", "pageview", {
            page: "/" + this.name
        }), gameanalytics.GameAnalytics.addDesignEvent("screen:" + this.name)), AmazingGame.getInstance().fadeLayerToTop();
    }, t.prototype.enable = function(t) {
        this.enabled = t;
    }, t.prototype.add_game_element = function(t, e) {
        void 0 === e && (e = -1), -1 < e ? this.layers[0].addChildAt(t, e) : this.layers[0].addChild(t), 
        this.layers[0].on_resize();
    }, t.prototype.add_ui_element = function(t) {
        this.layers[1].addChild(t), this.layers[1].on_resize();
    }, t.prototype.add_popup = function(t) {
        t.dialogParent = this, t.init(), this.dialogs.push(t);
    }, t.prototype.open_popup = function(t) {
        try {
            this.get_dialog(t).on_resize(), this.get_dialog(t).show(), Utils.switch_input(this.layers, !1);
        } catch (t) {}
    }, t.prototype.close_popup = function() {}, t.prototype.get_dialog = function(t) {
        for (var e = 0; e < this.dialogs.length; e++) if (this.dialogs[e].name === t) return this.dialogs[e];
    }, t.prototype.add_button = function(t, e, i, n, s, o, a) {
        void 0 === o && (o = .5), void 0 === a && (a = .5);
        var r = new ScaleButton(this.game, t, e, null, i, this.onButtonClick, this), h = this.game.add.bitmapText(0, 0, n, s, 45);
        return h.anchor.set(o, a), h.align = "center", r.anchor.set(.5), r.addChild(h), 
        r.events.onInputOver.add(this.over, this), r.events.onInputDown.add(this.down, this), 
        this.add_ui_element(r), r;
    }, t.prototype.add_scale_button = function(t, e, i, n, s, o) {
        var a = new ScaleButton(this.game, t, e, i, n, this.onButtonClick, this);
        if (null != s) {
            var r = this.game.add.text(-100, 0, s, {
                font: "bold 20px Trebuchet MS",
                fill: "white",
                align: "left"
            });
            r.anchor.set(0, .5), r.align = "left", a.addChild(r);
        }
        return a.smoothed = !0, a.anchor.set(.5), a.name = o, this.add_ui_element(a), a;
    }, t.prototype.onButtonClick = function(t) {
        void 0 === this.activeDialog && AudioManager.getInstance().play_button();
    }, t.prototype.registerKeyboardButton = function(t, e) {
        this.keyboardButtons[t] = e;
    }, t.prototype.processKeyboardClick = function(t) {
        this.keyboardButtons[t] && this.keyboardButtons[t].fireAsKeyboardClick();
    }, t.prototype.on_resume = function() {}, t.prototype.up = function(t) {}, t.prototype.down = function(t) {}, 
    t.prototype.over = function(t) {}, t.prototype.out = function(t) {}, t.prototype.on_resize = function() {
        null != this.layers && (this.layers[0].on_resize(), this.layers[1].on_resize(), 
        null == this.activeDialog ? (this.game.world.bringToTop(this.layers[0]), this.game.world.bringToTop(this.layers[1])) : this.activeDialog.on_resize()), 
        AmazingGame.getInstance().fadeLayerToTop();
    }, t.prototype.on_keyboard_clicked = function(t) {}, t.prototype.on_keyboard_Up = function(t) {
        this.enabled && !this.game.isTransitioning() && (this.activeDialog && !this.activeDialog.moveTween ? this.activeDialog.processKeyboardClick(t.keyCode) : this.keyboardButtons[t.keyCode] && this.keyboardButtons[t.keyCode].fireAsKeyboardClick());
    }, t.prototype.back_press = function() {
        null == this.activeDialog || this.activeDialog.moveTween || this.activeDialog.back_press();
    }, t.prototype.shutdown = function() {
        if (e.prototype.shutdown.call(this, this.game), this.layers && (this.layers[0].destroy(!0), 
        this.layers[1].destroy(!0)), this.dialogs) for (var t = 0; t < this.dialogs.length; t++) this.dialogs[t].destroy();
        this.input.keyboard.removeCallbacks(), this.dialogs = null, this.layers = null, 
        this.game = null;
    }, t.prototype.translate = function(t) {
        return this.game.translate(t);
    }, t;
}(Phaser.State), FPSLabel = function(a) {
    function t(t, e, i, n) {
        var s = a.call(this, t, e, i, "", n) || this;
        s.align = "center", s.anchor.set(.5, .5), s.game.add.existing(s), s.position.x = s.game.width - 20, 
        s.position.y = 20;
        var o = s;
        return window.addEventListener("resize", function(t) {
            o.position.x = AmazingGame.getInstance().width - 20, o.position.y = 20;
        }), s;
    }
    return __extends(t, a), t.createFpsLabel = function() {
        return new t(AmazingGame.getInstance(), 0, 0, {
            font: " 26px" + Fonts.HELVETICA,
            fill: "0xffffff"
        });
    }, t.prototype.update = function() {
        a.prototype.update.call(this), this.text = AmazingGame.getInstance().time.fps.toString(), 
        AmazingGame.getInstance().time.fps < 15 ? (this.tint = 14301547, this.addColor("#DA396B", 0)) : AmazingGame.getInstance().time.fps < 25 ? (this.tint = 13413158, 
        this.addColor("#CCAB26", 0)) : (this.tint = 5823801, this.addColor("#58DD39", 0));
    }, t;
}(Phaser.Text), InstallPrompt = function(i) {
    function t(t) {
        var e = i.call(this, t, t.world) || this;
        return e.isShowed = !1, e.game = t, e;
    }
    return __extends(t, i), t.prototype.initialize = function() {
        this.addChild(this.background = this.game.add.image(0, 0, Images.PIXEL)), this.addChild(this.icon = this.game.add.image(0, 0, Images.ICON)), 
        this.addChild(this.starsBanner = this.game.add.image(0, 0, Images.STARS)), this.addChild(this.closebutton = new ScaleButton(this.game, 0, 0, Images.CLOSE, null, this.closeCallback, this)), 
        this.installCaption1 = new Label(this.game, 0, 0, "", {
            font: " 36px" + Fonts.HELVETICA,
            fill: "#3367D6"
        }, 600, 36).setText(AmazingGame.getInstance().translate("store_download_android")), 
        this.addChild(this.installCaption1), this.installCaption2 = new Label(this.game, 0, 0, "", {
            font: " 26px" + Fonts.HELVETICA,
            fill: "#8F8F8F"
        }, 600, 26).setText(AmazingGame.getInstance().translate("star_rating")), this.addChild(this.installCaption2), 
        this.game.device.android ? this.addChild(this.installBanner = this.game.add.image(0, 0, Atlases.EXTRAS, _EXTRAS.google)) : this.game.device.iOS || this.game.device.iPad || this.game.device.safari ? this.addChild(this.installBanner = this.game.add.image(0, 0, Atlases.EXTRAS, _EXTRAS.apple)) : this.addChild(this.installBanner = this.game.add.image(0, 0, Atlases.EXTRAS, _EXTRAS.windows)), 
        this.game.world.removeChild(this);
    }, t.prototype.openInstallWindow = function() {
        AmazingGame.getInstance().PlatformProvider.openThisAppFromWebView(), gameanalytics.GameAnalytics.addDesignEvent("installprompt:click"), 
        this.closePrompt();
    }, t.prototype.show = function(t) {
        this.game = AmazingGame.getInstance(), AmazingGame.getInstance().isLandscape ? this.canShowLandscape(t) && (this.game.world.addChild(this), 
        this.refreshBanner(t), this.isShowed = !0, gameanalytics.GameAnalytics.addDesignEvent("installprompt:impression:landscape")) : this.canShowPortrait(t) && (this.game.world.addChild(this), 
        this.refreshBanner(t), this.isShowed = !0, gameanalytics.GameAnalytics.addDesignEvent("installprompt:impression:portrait")), 
        this.isShowed && (this.background.events.onInputDown.add(this.openInstallWindow), 
        this.background.inputEnabled = !0);
    }, t.prototype.onResize = function(t) {
        this.game = AmazingGame.getInstance(), this.isShowed && (AmazingGame.getInstance().isLandscape ? this.canShowLandscape(t) ? this.refreshBanner(t) : this.closePrompt() : this.canShowPortrait(t) ? this.refreshBanner(t) : this.closePrompt());
    }, t.prototype.canShowLandscape = function(t) {
        return 0 < t.left - 160;
    }, t.prototype.canShowPortrait = function(t) {
        return t.bottom + 100 < this.game.height;
    }, t.prototype.refreshBanner = function(t) {
        var e = 2 < this.game.device.pixelRatio ? 2 : 1;
        if (AmazingGame.getInstance().isLandscape) {
            var i = AmazingGame.getInstance().height / 600 * .9;
            t.left < 160 * i && (i = 1), this.icon.loadTexture(Images.ICON_2X), this.background.width = 160, 
            this.background.height = 600, this.background.anchor.set(.5, .5);
            var n = t.left / 2, s = this.game.height / 2, o = t.left / 2 - 80, a = this.game.height / 2 - 300;
            this.background.position.set(n, s), this.icon.anchor.set(.5, .5), this.icon.position.set(o + 80, a + 112), 
            this.closebutton.anchor.set(.5, .5), this.closebutton.set_scale(.5), this.closebutton.position.set(o + 145, a + 15), 
            this.starsBanner.anchor.set(.5, .5), this.starsBanner.scale.set(.75), this.starsBanner.position.set(n, s + 195), 
            this.game.device.android ? this.installCaption1.setText(AmazingGame.getInstance().translate("store_download_android")) : this.game.device.iOS || this.game.device.iPad || this.game.device.safari ? this.installCaption1.setText(AmazingGame.getInstance().translate("store_download_ios")) : this.installCaption1.setText(AmazingGame.getInstance().translate("store_download_microsoft")), 
            this.installCaption1.anchor.set(.5, .5), this.installCaption1.wordWrap = !0, this.installCaption1.wordWrapWidth = 150 * i, 
            this.installCaption1.fontSize = 32 * i + "px", this.installCaption1.scale.set(1 / i), 
            this.installCaption1.position.set(n, s + 20), this.installCaption2.anchor.set(.5, .5), 
            this.installCaption2.position.set(n, s + 225), this.installCaption2.fontSize = 26 * i + "px", 
            this.installCaption2.setMaxSize(150, 26), this.installCaption2.setText(AmazingGame.getInstance().translate("star_rating")), 
            this.installCaption2.scale.set(1 / i), this.installBanner.visible = !0, this.installBanner.anchor.set(.5, .5), 
            this.installBanner.scale.set(.5, .5), this.installBanner.position.set(n, s + 270), 
            this.scale.set(.9 * i);
            var r = n - n * this.scale.y, h = s - s * this.scale.y;
            this.position.set(r, h);
        } else this.background.width = this.game.width, this.background.height = 92 * e, 
        this.background.anchor.set(.5, 1), this.background.position.set(this.game.width / 2, this.game.height), 
        this.icon.loadTexture(2 === e ? Images.ICON_2X : Images.ICON), this.icon.anchor.set(.5, .5), 
        this.icon.position.set(this.icon.width / 2 + 10, this.game.height - this.icon.height / 2 - 10 * e), 
        this.starsBanner.anchor.set(0, .5), this.starsBanner.scale.set(.75 * e), this.starsBanner.position.set(this.icon.width + 15, this.game.height - this.icon.height / 2 - 5 * e), 
        this.installCaption1.anchor.set(0, .5), this.installCaption1.position.set(this.icon.width + 20, this.game.height - this.icon.height + 5), 
        this.installCaption1.wordWrap = !1, this.installCaption1.fontSize = 32 * e + "px", 
        this.installCaption1.setMaxSize(this.game.width - this.icon.width - this.closebutton.width - 40, 32 * e), 
        this.game.device.android ? this.installCaption1.setText(AmazingGame.getInstance().translate("store_download_android")) : this.game.device.iOS || this.game.device.iPad || this.game.device.safari ? this.installCaption1.setText(AmazingGame.getInstance().translate("store_download_ios")) : this.installCaption1.setText(AmazingGame.getInstance().translate("store_download_microsoft")), 
        this.installCaption2.anchor.set(0, .5), this.installCaption2.fontSize = 26 * e + "px", 
        this.installCaption2.position.set(this.icon.width + 20, this.game.height - 18 * e), 
        this.installCaption2.setMaxSize(this.game.width - this.icon.width - this.closebutton.width - 40, 26 * e), 
        this.closebutton.anchor.set(.5, .5), this.closebutton.set_scale(.5 * e), this.closebutton.position.set(this.game.width - 15 * e, this.game.height - 92 * e + 15 * e), 
        this.installBanner.anchor.set(1, .5), this.installBanner.scale.set(.45 * e, .45 * e), 
        this.installBanner.position.set(this.game.width - 10, this.game.height - 25 * e), 
        this.installBanner.left + 10 < this.installCaption2.right ? this.installBanner.visible = !1 : this.installBanner.visible = !0, 
        this.position.set(0, 0), this.scale.set(1, 1);
        AmazingGame.getInstance().world.bringToTop(this);
    }, t.prototype.closePrompt = function() {
        this.background.inputEnabled = !1, this.background.events.onInputDown.remove(this.openInstallWindow), 
        this.game.world.removeChild(this), this.isShowed = !1;
    }, t.prototype.closeCallback = function(t) {
        this.closePrompt(), gameanalytics.GameAnalytics.addDesignEvent("installprompt:closebyuser");
    }, t;
}(Phaser.Group), Label = function(h) {
    function l(t, e, i, n, s, o, a) {
        var r = h.call(this, t, e, i, n, s) || this;
        return r.origStyle = s, r.origSize = Number(r.fontSize), r.maxWidth = o, r.maxHeight = a, 
        r.setText(n), r.align = "center", r.anchor.set(.5, .5), r.game.add.existing(r), 
        r;
    }
    return __extends(l, h), l.create_with_color = function(t, e, i, n, s, o, a, r) {
        void 0 === r && (r = "center");
        var h = new l(t, e, i, n, s, o, a);
        return h.anchor.set(.5), h.align = r, "right" == h.align && h.anchor.set(1, .5), 
        "left" == h.align && h.anchor.set(0, .5), h.setText(n), h;
    }, l.UniformTextSizes = function(t) {
        var e, i, n = t.map(function(t) {
            return t.fontSize;
        }), s = Utils.arrayMin(n);
        try {
            for (var o = __values(t), a = o.next(); !a.done; a = o.next()) {
                a.value.fontSize = s;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (i = o.return) && i.call(o);
            } finally {
                if (e) throw e.error;
            }
        }
    }, l.prototype.setTranslation = function(t) {
        var e = this;
        this.translation = t, AmazingGame.getInstance().translation.addListener(function() {
            e.translate();
        });
    }, l.prototype.setText = function(t) {
        return h.prototype.setText.call(this, t), (this.maxWidth || this.maxHeight) && this.makeFontFit(), 
        this;
    }, l.prototype.setMaxSize = function(t, e) {
        this.maxWidth = t, this.maxHeight = e, this.makeFontFit();
    }, l.prototype.onResize = function() {
        this.scale.set(1 / AmazingGame.getInstance().ratio), this.fontSize = this.origSize * AmazingGame.getInstance().ratio, 
        this.makeFontFit();
    }, l.prototype.makeFontFit = function() {
        for (var t; this.width > this.maxWidth || this.height > this.maxHeight; ) {
            if ((t = parseInt(this.fontSize.toString().replace("px", ""), 10) - 1) < 10) {
                t = 10, this.fontSize = t;
                break;
            }
            this.fontSize = t;
        }
    }, l.prototype.translate = function() {
        if (this.translation) {
            var t = AmazingGame.getInstance().translate(this.translation.translationID);
            this.translation.isUpperCase && (t = t.toUpperCase()), this.setText(t);
        }
    }, l;
}(Phaser.Text), LoadingHelper = function() {
    function i() {}
    return i.show = function() {
        var t = document.getElementById("spinner");
        t && (t.style.display = "block");
    }, i.hide = function() {
        if (i.isShowed) {
            var t = document.getElementById("spinner");
            t && (t.style.display = "none");
            var e = 0;
            Constants.COMPILE_PLATFORM === Platform.UWP && (e = 1e5), setTimeout(function() {
                var t = document.getElementById("loader");
                t && t.parentNode.removeChild(t);
                var e = document.getElementById("gameinfo");
                e && (e.style.display = "none");
            }, e), i.isShowed = !1;
        }
    }, i.isShowed = !0, i;
}(), MultiLineBMF = function(l) {
    function t(t, e, i, n, s, o, a, r) {
        void 0 === r && (r = 0);
        var h = l.call(this, t) || this;
        return h.font = n, h.size = o, h.maxLineHeight = 250, h.maxLineWidth = 830, h.baseFontSize = 75, 
        h.replaceLastByDots = !1, h.maxDotWidth = 0, h.lineSpace = 80, h.posX = 0, h.posY = 0, 
        h.tinted = 16777215, h.translation = a, h.posX = e, h.posY = i, h.setMultilineText(s, r), 
        AmazingGame.getInstance().translation.addListener(function() {
            h.translate();
        }), h;
    }
    return __extends(t, l), t.prototype.setMultilineText = function(t, i) {
        var n = this;
        void 0 === i && (i = 0), this.removeAll(), this.tinted = i;
        var e = t.split("\n"), s = this.posY;
        e.forEach(function(t) {
            var e = new BMFLabel(n.game, n.posX, s, n.font, t.toUpperCase(), n.size);
            e.setMaxSize(n.maxLineWidth, n.maxLineHeight), e.tint = i, e.align = "center", e.setAlignCenter(), 
            n.addChild(e), s += e.height + n.lineSpace;
        }), BMFLabel.UniformTextSizes(this.children);
    }, t.prototype.setTranslation = function(t) {
        var e = this;
        this.translation = t, AmazingGame.getInstance().translation.addListener(function() {
            e.translate();
        }), this.translate();
    }, t.prototype.translate = function() {
        if (this.removeAll(!0), this.translation) {
            var t = AmazingGame.getInstance().translate(this.translation.translationID);
            this.translation.isUpperCase && (t = t.toUpperCase()), this.translation.isFirstUpperCase && (t = t[0].toUpperCase() + t.slice(1)), 
            this.setMultilineText(t, this.tinted);
        }
    }, t;
}(Phaser.Group), PopUp = function(n) {
    function s(t, e) {
        var i = n.call(this, t, t.world, e) || this;
        return i.designWidth = 800, i.designHeight = 800, i.boundsWidth = -1, i.boundsHeight = -1, 
        i.showTween = !0, i.showInstallPrompt = !0, i.showBannerAd = !0, i.showfade = !0, 
        i.backgroundAlpha = -1, i.keyboardButtons = {}, i.game = t, i.name = e, IS_CRAZY_GAMES && (i.showBannerAd = !1), 
        i;
    }
    return __extends(s, n), s.prototype.init = function() {
        this.background = this.game.add.sprite(0, 0, GlobalVars.DIALOG_BG), this.background.visible = this.visible = !1, 
        this.background.alpha = 1, this.game.world.remove(this), this.game.world.remove(this.background);
    }, s.prototype.show = function() {
        var t = this;
        if (this.alpha = 0, this.game.world.add(this), this.background.visible = this.visible = !0, 
        (this.dialogParent.activeDialog = this).game.world.add(this.background), this.game.world.bringToTop(this.background), 
        this.game.world.bringToTop(this), this.background.alpha = 0, this.showfade) {
            var e = s.BACKGROUND_ALPHA;
            -1 !== this.backgroundAlpha && (e = this.backgroundAlpha), this.game.add.tween(this.background).to({
                alpha: e
            }, s.TRANSITION_TIME, "Linear", !0).onComplete.add(function() {
                t.showed = !0;
            }, this);
        } else this.showed = !0;
        if (this.on_resize(), this.showTween) {
            this.game.height;
            if (s.SCALE_POP_IN) {
                this.calculateScale(), this.setCenter();
                var i = this.scale.x;
                this.scale.x = 0, this.scale.y = 0, this.moveTween = this.game.add.tween(this.scale).to({
                    x: i,
                    y: i
                }, s.TRANSITION_TIME, s.EaseIn, !0), this.moveTween.onComplete.add(function() {
                    t.moveTween = void 0, t.showed = !0, t.enabledChanged();
                }, this);
            } else this.moveTween = this.game.add.tween(this).to({
                centerY: this.game.height / 2,
                centerX: this.centerX
            }, s.TRANSITION_TIME, s.EaseIn, !0), this.moveTween.onComplete.add(function() {
                t.moveTween = void 0, t.showed = !0, t.enabledChanged();
            }, this);
            this.game.add.tween(this).to({
                alpha: 1
            }, s.TRANSITION_TIME, "Linear", !0);
        } else this.alpha = 1;
        this.game.google.send_event("send", "pageview", {
            page: "/" + this.name
        }), gameanalytics.GameAnalytics.addDesignEvent(this.name + ":show");
    }, s.prototype.enabledChanged = function() {
        this.showBannerAd ? this.showed && this.tryShowAd() : Constants.COMPILE_PLATFORM === Platform.WEB && this.showInstallPrompt && RemoteConfig.SHOW_INSTALL_PROMPT && (this.showed ? this.game.installPrompt.show(this) : this.game.installPrompt.closePrompt());
    }, s.prototype.close = function() {
        this.visible = !1, this.background.visible = !1, this.dialogParent.activeDialog = void 0, 
        this.game.world.remove(this), this.game.world.remove(this.background), this.showed = !1, 
        this.enabledChanged();
        var t = this;
        setTimeout(function() {
            Utils.switch_input(t.dialogParent.layers, !0);
        }, 1), this.game.google.send_event("send", "pageclose", {
            page: "/" + this.name
        }), gameanalytics.GameAnalytics.addDesignEvent(this.name + ":close"), this.closeAd(), 
        this.dialogParent.close_popup();
    }, s.prototype.onButtonClick = function(t) {
        AudioManager.getInstance().play_button();
    }, s.prototype.on_resize = function() {
        this.background.x = 0, this.background.y = 0, this.background.width = this.game.width, 
        this.background.height = this.game.height, this.background.anchor.set(0, 0), this.game.world.bringToTop(this.background), 
        this.game.world.bringToTop(this), this.calculateScale(), this.setCenter(), void 0 !== this.moveTween && (this.moveTween.stop(), 
        this.moveTween = void 0), UIAdsManager.getInstance().removeAd(), this.showed && this.tryShowAd();
    }, s.prototype.setBounds = function(t, e, i, n) {
        void 0 === i && (i = -1), void 0 === n && (n = -1), this.designWidth = t, this.designHeight = e, 
        this.boundsWidth = i, this.boundsHeight = n;
    }, s.prototype.setCenter = function() {
        if (-1 != this.boundsWidth) {
            this.getLocalBounds();
            var t = (this.designWidth - this.boundsWidth) / 2 * this.scale.x, e = (this.designHeight - this.boundsHeight) / 2 * this.scale.x, i = (this.game.width - this.designWidth * this.scale.x) / 2, n = (this.game.height - this.designHeight * this.scale.x) / 2;
            this.x = t + i + this.boundsWidth / 2 * this.scale.x, this.y = e + n + this.boundsHeight / 2 * this.scale.x, 
            this.pivot.x = this.boundsWidth / 2, this.pivot.y = this.boundsHeight / 2;
        } else this.centerX = this.game.width / 2, this.centerY = this.game.height / 2;
    }, s.prototype.calculateScale = function() {
        var t = window.innerWidth > window.innerHeight, e = this.designWidth, i = this.designHeight;
        t || (e = this.designHeight, i = this.designWidth);
        var n = Math.ceil(window.innerWidth * devicePixelRatio), s = Math.ceil(window.innerHeight * devicePixelRatio), o = 1;
        o = s < n / e * i ? s / i : n / e, this.scale.set(o);
    }, s.prototype.back_press = function() {
        this.close();
    }, s.prototype.registerKeyboardButton = function(t, e) {
        this.keyboardButtons[t] = e;
    }, s.prototype.processKeyboardClick = function(t) {
        this.keyboardButtons[t] && this.keyboardButtons[t].fireAsKeyboardClick();
    }, s.prototype.destroy = function() {
        n.prototype.destroy.call(this, !0), this.dialogParent = null, this.background = null;
    }, s.prototype.translate = function(t) {
        return this.game.translate(t);
    }, s.prototype.closeAd = function() {
        this.showBannerAd && UIAdsManager.getInstance().removeAd();
    }, s.prototype.tryShowAd = function() {
        if (RemoteConfig.PLAY_BANNER_DIALOG_ADS && this.showBannerAd) if (this.game.isLandscape) {
            var t = 0, e = 0, i = this.worldPosition.x - this.getBounds().width / 2, n = this.game.height, s = [], o = new AdDetail(t, e, i, n);
            s.push(new Pair(o, [ RECT_BANNER ])), UIAdsManager.getInstance().tryShowAd(s);
        } else {
            t = 0, e = this.worldPosition.y + this.getBounds().height, i = this.game.width, 
            n = this.game.height - e, s = [], o = new AdDetail(t, e, i, n);
            s.push(new Pair(o, [ RECT_BANNER, HUGE_BANNER, MEDIUM_BANNER, SMALL_BANNER ])), 
            UIAdsManager.getInstance().tryShowAd(s);
        }
    }, s.NAME = "exitgame", s.TRANSITION_TIME = 500, s.BACKGROUND_ALPHA = .75, s.SCALE_POP_IN = !1, 
    s.EaseIn = Phaser.Easing.Sinusoidal.Out, s.EaseOut = Phaser.Easing.Quartic.In, s;
}(Phaser.Group), ScrollBar = function(r) {
    function t(t, e, i, n, s, o) {
        void 0 === o && (o = 4);
        var a = r.call(this, t, 0, 0) || this;
        return a.scrollWidth = 0, a.scrollHeight = 0, a.backgroundColor = 0, a.scrollBarColor = 0, 
        a.offset = 4, a.progress = 0, a.scrollWidth = e, a.scrollHeight = i, a.backgroundColor = n, 
        a.scrollBarColor = s, a.offset = o, a.create_bars(), a;
    }
    return __extends(t, r), t.prototype.create_bars = function() {
        this.scrollBackground = this.game.add.sprite(0, 0, Images.PIXEL), this.scrollBar = this.game.add.sprite(2, 2, Images.PIXEL), 
        this.scrollBackground.width = this.scrollWidth, this.scrollBackground.height = this.scrollHeight, 
        this.scrollBackground.tint = this.backgroundColor, this.scrollBar.width = this.scrollWidth - this.offset, 
        this.scrollBar.height = this.scrollHeight / 15, this.scrollBar.tint = this.scrollBarColor, 
        this.scrollBackground.fixedToCamera = !0, this.scrollBar.fixedToCamera = !1, this.addChild(this.scrollBackground), 
        this.addChild(this.scrollBar);
    }, t.prototype.update_position = function(t) {
        this.progress = t, this.scrollBar.position.y = (this.scrollHeight - this.scrollBar.height - this.offset) * t, 
        this.scrollBar.position.y = Phaser.Math.clamp(this.scrollBar.position.y, this.offset, this.scrollHeight - this.scrollBar.height - this.offset);
    }, t.prototype.on_resize = function(t) {
        this.scrollHeight = Math.round(t / this.parent.scale.y), this.scrollBackground.height = this.scrollHeight, 
        this.scrollBar.height = Math.round(this.scrollHeight / 15), this.update_position(this.progress);
    }, t.prototype.destroy = function() {
        r.prototype.destroy.call(this, !0), this.scrollBackground = null, this.scrollBar = null;
    }, t;
}(Phaser.Sprite), RoundedScrollBar = function(r) {
    function t(t, e, i, n, s, o) {
        void 0 === o && (o = 10);
        var a = r.call(this, t, e, i, n, s, 0) || this;
        return a.roudness = 8, a.roudness = o, a;
    }
    return __extends(t, r), t.prototype.create_bars = function() {
        var t = SpriteUtils.create_round_rectangle(this.game, this.scrollWidth, this.scrollHeight, this.backgroundColor, 1, this.roudness), e = SpriteUtils.create_round_rectangle(this.game, this.scrollWidth, this.scrollHeight / 5, this.scrollBarColor, 1, this.roudness);
        this.scrollBackground = this.game.add.sprite(0, 0, t), this.scrollBar = this.game.add.sprite(0, 0, e), 
        this.scrollBackground.fixedToCamera = !0, this.scrollBar.fixedToCamera = !1, this.addChild(this.scrollBackground), 
        this.addChild(this.scrollBar);
    }, t;
}(ScrollBar), ScaleButton = function(h) {
    function u(t, e, i, n, s, o, a) {
        var r = h.call(this, t, e, i, n, o, a, s, s, s) || this;
        return r.SCALE = .05, r.bmfLabelBaseTint = 16777215, r.bmfLabelDisableTint = 8355711, 
        r.isDisabled = !1, r.lockInput = !1, r.overlayAlpha = .45, r.startScale = 1, r.input.useHandCursor = !1, 
        r.anchor.set(.5), r.smoothed = !0, r.callback = o, r.callbackContext = a, r;
    }
    return __extends(u, h), u.create_scale_button_with_icon = function(t, e, i, n, s, o, a, r) {
        var h = new u(AmazingGame.getInstance(), t, e, "menusheet", i, a, r);
        if (null != n) {
            var l = AmazingGame.getInstance().add.text(-100, 0, n, {
                font: "bold 22px  Trebuchet MS",
                fill: "white",
                align: "left"
            });
            l.smoothed = !0, l.anchor.set(0, .5), l.align = "left", h.addChild(l);
        }
        if (null != o) {
            var c = AmazingGame.getInstance().add.image(-150, -3, "menusheet", o);
            c.anchor.set(.5), h.addChild(c);
        }
        return h.anchor.set(.5), h.name = s, h;
    }, u.create_scale_button_with_graphics = function(t, e, i, n, s, o, a, r) {
        var h = new u(AmazingGame.getInstance(), t, e, null, null, o, a);
        if (h.texture = i, null != n) {
            var l = {
                font: " 22px " + Fonts.HELVETICA,
                fill: "#000"
            };
            void 0 !== r && (l = r), h.label = new Label(AmazingGame.getInstance(), 0, 2, n, l, i.width, i.height), 
            h.label.anchor.set(.5), h.label.smoothed = !0, h.addChild(h.label);
        }
        return h.anchor.set(.5, .5), h.name = s, h;
    }, u.addBMFWithTranslations = function(t, e, i, n, s) {
        return t.addBMFLabel(AmazingGame.getInstance().translate(n), e, i), t.bmfLabel.setTranslation({
            translationID: n,
            isUpperCase: s
        }), t.bmfLabel;
    }, u.prototype.createOverlayTexture = function(t) {
        void 0 === t && (t = -1), -1 != t && (this.overlayAlpha = t), this.clone && (this.removeChild(this.clone), 
        this.clone.destroy(), this.clone = void 0), this.clone || (this.clone = new Phaser.Sprite(this.game, 0, 0, this.texture, this.frameName), 
        this.clone.anchor.set(.5), this.clone.blendMode = Phaser.blendModes.ADD, this.clone.alpha = this.overlayAlpha, 
        this.clone.visible = !1, this.addChild(this.clone));
    }, u.prototype.animateCloneTexture = function(t) {
        void 0 === t && (t = 1e3), this.clone && (this.clone.alpha = 0, this.clone.visible = !0, 
        this.animTween = this.game.add.tween(this.clone).to({
            alpha: this.overlayAlpha
        }, t, Phaser.Easing.Quadratic.In, !0, 0, -1, !0));
    }, u.prototype.stopAnimateCloneTexture = function() {
        this.animTween && this.animTween.stop(), this.animTween = void 0, this.clone.visible = !1;
    }, u.prototype.disable = function() {
        this.isDisabled = !0, this.tint = Utils.RGBtoHEX(127, 127, 127), null != this.label && (this.labelColor = this.label.colors[0], 
        this.label.clearColors(), this.label.addColor("#404040", 0)), this.bmfLabel && (this.bmfLabel.tint = this.bmfLabelDisableTint);
    }, u.prototype.enable = function() {
        this.isDisabled = !1, this.tint = Utils.RGBtoHEX(255, 255, 255), null != this.label && null != this.labelColor && (this.label.clearColors(), 
        this.label.addColor(this.labelColor, 0)), this.bmfLabel && (this.bmfLabel.tint = this.bmfLabelBaseTint);
    }, u.prototype.onInputDownHandler = function(t, e) {
        this.isDisabled || this.lockInput || (h.prototype.onInputDownHandler.call(this, t, e), 
        this.onDown());
    }, u.prototype.onInputUpHandler = function(t, e, i) {
        this.isDisabled || this.lockInput || (i && h.prototype.onInputUpHandler.call(this, t, e, i), 
        t.scale.set(this.startScale), this.clone && (this.animTween || (this.clone.visible = !1)));
    }, u.prototype.onInputOutHandler = function(t, e) {
        this.isDisabled || this.lockInput || (h.prototype.onInputOutHandler.call(this, t, e), 
        t.scale.set(this.startScale), this.clone && (this.animTween || (this.clone.visible = !1)));
    }, u.prototype.onInputOverHandler = function(t, e) {
        this.isDisabled || this.lockInput || (this.clone && (this.animTween || (this.clone.visible = !0)), 
        h.prototype.onInputOverHandler.call(this, t, e), t.scale.set(this.startScale + this.startScale * this.SCALE / 2));
    }, u.prototype.fireAsKeyboardClick = function() {
        this.callback && this.callbackContext && this.callback.call(this.callbackContext, this);
    }, u.prototype.onDown = function() {
        this.scale.set(this.startScale + this.startScale * this.SCALE), this.clone && (this.animTween || (this.clone.visible = !0));
    }, u.prototype.onUp = function() {
        this.clone && (this.animTween || (this.clone.visible = !1)), this.scale.set(this.startScale);
    }, u.prototype.onOver = function() {
        this.scale.set(this.startScale + this.startScale * this.SCALE / 2);
    }, u.prototype.onOut = function() {
        this.scale.set(this.startScale), this.clone && (this.animTween || (this.clone.visible = !1));
    }, u.prototype.set_scale = function(t) {
        this.scale.set(t), this.startScale = t;
    }, u.prototype.add_label = function(t, e) {
        void 0 === e && (e = {
            font: "bold 22px  Trebuchet MS",
            fill: "white",
            align: "left"
        }), this.label = new Label(AmazingGame.getInstance(), 0, 2, t, e, this.width, this.height), 
        this.label.anchor.set(.5), this.label.smoothed = !0, this.addChild(this.label);
    }, u.prototype.addBMFLabel = function(t, e, i, n, s, o, a, r) {
        return void 0 === a && (a = !1), this.bmfLabel = new BMFLabel(this.game, 0, 0, e, t, i, void 0, void 0, r), 
        this.bmfLabel.setVerticalandHorizontalCenter(), n && (this.bmfLabel.position.x = n), 
        s && (this.bmfLabel.position.y = s), o && (this.bmfLabel.tint = this.bmfLabelBaseTint = o), 
        a && this.bmfLabel.setMaxSize(this.width, this.height), this.bmfLabel.smoothed = !0, 
        this.addChild(this.bmfLabel), this.bmfLabel;
    }, u.prototype.cacheFont = function() {
        this.bmfLabel && (this.bmfLabel.cacheAsBitmap = !0);
    }, u.prototype.set_all_frames = function(t) {
        this.frameName = t, this.setFrames(t, t, t, t);
    }, u.prototype.destroy = function() {
        this.label && this.label.destroy(!0), this.label = null, h.prototype.destroy.call(this, !0);
    }, u.prototype.translate = function() {
        this.bmfLabel && this.bmfLabel.translate();
    }, u;
}(Phaser.Button), ScrollGroup = function(o) {
    function t(t, e, i, n) {
        void 0 === e && (e = 0), void 0 === i && (i = 960), void 0 === n && (n = 800);
        var s = o.call(this, t, t.world) || this;
        return s.DISABLE_CLICK_AFTER__SCROLL_PX = 20, s.velocityWheelY = 0, s.velocityWheelYAbs = 0, 
        s.autoScrollY = !0, s.pressedDown = !1, s.canClick = !0, s.interact = !1, s._h = i, 
        s._width = n, s.interact = !1, s.scrollContainer = s.game.add.group(), s._y = e, 
        s.gfxMask = s.game.make.graphics(0, 0), s.gfxMask.beginFill(0, 1).drawRoundedRect(0, 0, s._width, s._h, 0).endFill(), 
        s.scrollContainer.interactive = !0, s.scrollContainer.inputEnableChildren = !0, 
        s.scrollContainer.cursor = "pointer", s.mask = s.gfxMask, s.addChild(s.scrollContainer), 
        s.addChild(s.gfxMask), s;
    }
    return __extends(t, o), t.prototype.start = function() {
        this.game.input.onDown.add(this.beginMove, this), this.callbackID = this.game.input.addMoveCallback(this.move_group, this), 
        this.game.input.onUp.add(this.endMove, this), this.game.input.mouse.mouseWheelCallback = this.mouseWheel.bind(this), 
        document.addEventListener("mousewheel", this.mouseWheel.bind(this), !1);
        this.game.device.wheelEvent;
        this.interact = !0, this.scrollContainer.interactive = !0, this.scrollContainer.inputEnableChildren = !0, 
        this.canClick = !0, this.velocityWheelY = 0;
    }, t.prototype.stop = function() {
        this.game.input.onDown.remove(this.beginMove, this), this.game.input.deleteMoveCallback(this.move_group, this), 
        this.game.input.onUp.remove(this.endMove, this), this.interact = !1, this.pressedDown = !1, 
        this.interact = !1, this.scrollContainer.interactive = !1, this.scrollContainer.inputEnableChildren = !1, 
        this.canClick = !1, document.removeEventListener("mousewheel", this.mouseWheel.bind(this), !1);
    }, t.prototype.mouseWheel = function(t) {
        if (this.interact) {
            t.preventDefault();
            var e = t.deltaY / 10 * -1;
            this.autoScrollY = !1, this.velocityWheelY += e;
        }
    }, t.prototype.update = function() {
        if (this.interact) {
            if (this.elapsed = Date.now() - this.timestamp, this.velocityWheelYAbs = Math.abs(this.velocityWheelY), 
            this.autoScrollY) {
                var t = -this.amplitudeY * Math.exp(-this.elapsed / (500 * this.game.device.pixelRatio));
                .5 < t || t < -.5 ? this.scrollContainer.y = this.targetY + t : (this.autoScrollY = !1, 
                this.canClick = !0);
            } else this.pressedDown || (this.canClick = !0);
            .1 < this.velocityWheelYAbs && (this.dragging = !0, this.autoScrollY = !1, this.scrollContainer.y += this.velocityWheelY, 
            this.velocityWheelY *= .95), this.limit_movment();
        }
    }, t.prototype.beginMove = function(t, e) {
        this.interact && (this.startY = this.game.input.y, this.pressedDown = !0, this.timestamp = Date.now(), 
        this.velocityY = this.amplitudeY = 0);
    }, t.prototype.endMove = function(t, e) {
        this.interact && (this.pressedDown = !1, this.scrollContainer.ignoreChildInput = !1, 
        this.now = Date.now(), (100 < this.velocityY || this.velocityY < -100) && (this.amplitudeY = .8 * this.velocityY, 
        this.targetY = Math.round(this.scrollContainer.y + this.amplitudeY), this.autoScrollY = !0));
    }, t.prototype.move_group = function(t, e, i) {
        if (this.pressedDown && this.interact) {
            this.now = Date.now();
            var n = this.now - this.timestamp;
            this.timestamp = this.now;
            var s = i - this.startY;
            0 !== s && (this.dragging = !0), this.startY = i, this.velocityY = 1e3 * s / (1 + n) * .8 + .2 * this.velocityY, 
            this.scrollContainer.y += s / this.parent.scale.y, Math.abs(s) > Math.abs(this.DISABLE_CLICK_AFTER__SCROLL_PX) && (this.canClick = !1), 
            this.limit_movment();
        }
    }, t.prototype.set_position = function() {
        this.scrollContainer.y += this.position.y - this._y, Utils.round_position(this);
    }, t.prototype.limit_movment = function() {
        this.scrollContainer.y > this._y && (this.scrollContainer.y = this._y), this.scrollContainer.bottom < this._h - 10 && (this.scrollContainer.bottom = this._h - 10);
    }, t.prototype.onOver = function(t) {
        t.onOver();
    }, t.prototype.onDown = function(t) {
        t.onDown();
    }, t.prototype.onOut = function(t) {
        t.onOut();
    }, t.prototype.onUp = function(t) {
        t.onUp();
    }, t.prototype.addButton = function(t) {
        this.scrollContainer.addChild(t);
    }, t;
}(Phaser.Group), ToggleButton = function(a) {
    function t(t, e, i, n, s) {
        var o = a.call(this, t, 0, 0, e, n, s, i.on_txt) || this;
        return o.opt = i, o.OnText = new BMFLabel(o.game, o.width / 2 + i.offset, 0, i.font, i.on_str, i.size), 
        o.OnText.setAlignLeft(), o.OnText.setVerticalCenter(), o.addChild(o.OnText), o.OffText = new BMFLabel(o.game, -o.width / 2 - i.offset, 0, i.font, i.off_str, i.size), 
        o.OffText.setAlignRight(), o.OffText.setVerticalCenter(), o.addChild(o.OffText), 
        o;
    }
    return __extends(t, a), t.prototype.setToggleOn = function() {
        this.OnText.tint = this.opt.on_tint, this.OffText.tint = this.opt.default_tint, 
        this.set_all_frames(this.opt.on_txt);
    }, t.prototype.setToggleOff = function() {
        this.OnText.tint = this.opt.default_tint, this.OffText.tint = this.opt.off_tint, 
        this.set_all_frames(this.opt.off_txt);
    }, t.prototype.setToggleState = function(t) {
        t ? this.setToggleOn() : this.setToggleOff();
    }, t;
}(ColorButton);

!function(t) {
    var r = function() {}, e = function() {};
    t.AdDto = e;
    var i = function(n) {
        function a(t, e) {
            var i = n.call(this, t, e) || this;
            return Object.defineProperty(t, "amazingAd", {
                value: i
            }), i;
        }
        return __extends(a, n), a.prototype.initialize = function(t) {
            this.baseUrl = t, Constants.IS_MOBILE_COMPILE_VERSION ? (this.platform = Constants.COMPILE_PLATFORM, 
            Constants.COMPILE_PLATFORM === Platform.AMAZON && (this.platform = Platform.ANDROID)) : this.platform = GlobalVars.Platform, 
            this.appId = Constants.APP_KEY, this.initialized = !0;
        }, a.prototype.get_ad = function(t, n, s) {
            if (this.initialized) {
                var e = new r();
                e.appId = this.appId, e.platform = this.platform, e.size = t;
                var i = new RequestDto();
                i.action = a.ACTION_GET_AD, i.data = JSON.stringify(e);
                var o = void 0;
                (o = {}).command = JSON.stringify(i);
                HttpUtils.request(this.baseUrl, o, function(t) {
                    try {
                        var e = JSON.parse(t);
                        if (e.isSuccess) {
                            var i = JSON.parse(e.data);
                            n(i);
                        } else s();
                    } catch (t) {
                        s();
                    }
                });
            }
        }, a.ACTION_GET_AD = 1, a;
    }(Phaser.Plugin);
    t.AmazingAd = i;
}(AmazingAd || (AmazingAd = {}));

var AmazingWrapper, AmazingAdProvider, VideoAdProvider = function(t, e, i) {
    this.isAdAvaible = !1, this.AdType = t, this.AppKey = e, this.AppID = i;
}, GameDisttributionReward = function(s) {
    function t(t, e, i) {
        var n = s.call(this, t, e, i) || this;
        return n.name = "gd-reward", n;
    }
    return __extends(t, s), t.prototype.init = function() {
        this.preloadAd();
    }, t.prototype.preloadAd = function() {
        var e = this;
        "undefined" !== gdsdk && "undefined" !== gdsdk.showAd && gdsdk.preloadAd("rewarded").then(function(t) {
            e.isAdAvaible = !0;
        }).catch(function(t) {
            e.isAdAvaible = !1;
        });
    }, t.prototype.show_ad = function(t) {
        this.resumeCallback = t;
        var e = this;
        "undefined" !== gdsdk && "undefined" !== gdsdk.showAd && gdsdk.showAd("rewarded").then(function(t) {
            e.onAdClosedCallback();
        }).catch(function(t) {
            e.onAdClosedCallback();
        });
    }, t.prototype.onAdReadyCallback = function() {}, t.prototype.onAdClosedCallback = function() {
        this.videoControler.onContentResumed.dispatch(), this.resumeCallback.apply(null), 
        AmazingGame.getInstance().sound.mute = !1, this.isAdAvaible = !1, this.preloadAd();
    }, t.prototype.onAdFailLoadCallback = function() {
        this.isAdAvaible = !1;
    }, t.prototype.onAdRewarded = function() {}, t;
}(VideoAdProvider);

!function(t) {
    var e = function(n) {
        function t(t, e) {
            var i = n.call(this, t, e) || this;
            return i.AddRewardAd = !1, Object.defineProperty(t, "amazingAdProvider", {
                value: i
            }), i;
        }
        return __extends(t, n), t.prototype.initialize = function() {
            if (this.VideoController = new VideoController(), this.BannerController = new BannerController(), 
            this.BannerController.refreshTime = 9e4, Constants.COMPILE_PLATFORM === Platform.WEB && (Constants.IS_GAME_DISTRIBUTION && this.BannerController.add_banner_ad("gd", new GDBannerAd(Constants.APP_KEY, "")), 
            IS_AMAZING && (this.BannerController.add_banner_ad("google", new GoogleAdSenseBanner("", "")), 
            this.VideoController.add_videoAds(new GoogleInterstitial(AdType.GoogleAdSense, "-", "-")))), 
            this.BannerController.add_banner_ad("amazing", new AmazingBannerAd(Constants.APP_KEY, "")), 
            Constants.COMPILE_PLATFORM === Platform.UWP) {
                if (Constants.IS_UWP_WEBVIEW) {
                    var t = new UWPWebViewInterstatial(AdType.UWP, Constants.UWP_VIDEO_APPLICATION_ID, Constants.UWP_VIDEO_ADD_UNIT_ID);
                    t.name = "vungle", this.VideoController.add_videoAds(t), this.BannerController.add_banner_ad("vungle", new UWPWebViewBanner(Constants.UWP_BANNER_APPLICATION_ID, Constants.UWP_BANNER_ADD_UNIT_ID)), 
                    CrossPlatformTools.sendUWPRequest("intializeVideo", "");
                }
            } else if (Constants.COMPILE_PLATFORM === Platform.ANDROID) {
                AmazingWrapper.intializeAds(Constants.ANDROID_MOBILE_APP_ID, Constants.ANDROID_ADMOB_BANNER, Constants.ANDROID_ADMOB_INTERSATIAL), 
                AmazingWrapper.initializeReward(Constants.ANDROID_ADMOB_REWARDED);
                var e = new AdMobCordovaProvider(AdType.GoogleAdMob, Constants.ANDROID_ADMOB_INTERSATIAL, "");
                if (e.name = "android_video", this.VideoController.add_videoAds(e), this.AddRewardAd) {
                    var i = new AdMobRewardProvider(AdType.GoogleAdMob, Constants.ANDROID_ADMOB_REWARDED, "");
                    i.name = "android_reward", this.VideoController.add_rewardAds(i);
                }
                this.BannerController.add_banner_ad("admob", new AdMobCordovaBanner(Constants.ANDROID_ADMOB_BANNER, ""));
            } else if (Constants.COMPILE_PLATFORM === Platform.AMAZON) AmazingWrapper.intializeAds(Constants.AMAZON_APP_ID, Constants.AMAZON_BANNER, Constants.AMAZON_INTERSATIAL), 
            this.VideoController.add_videoAds(new AdMobCordovaProvider(AdType.AmazonMobile, Constants.AMAZON_INTERSATIAL, "")), 
            this.BannerController.add_banner_ad("amazon", new AdMobCordovaBanner(Constants.AMAZON_BANNER, "")); else if (Constants.COMPILE_PLATFORM === Platform.IOS) {
                CrossPlatformTools.sendIOSRequest("intializeAds", "&appdID=" + Constants.IOS_MOBILE_APP_ID + "&bannerID=" + Constants.IOS_ADMOB_BANNER + "&videoID=" + Constants.IOS_ADMOB_INTERSATIAL);
                var n = new IOSVideoAdMob(AdType.GoogleAdMob, Constants.IOS_ADMOB_INTERSATIAL, "");
                if (n.name = "ios_video", this.VideoController.add_videoAds(n), this.BannerController.add_banner_ad("admob", new IOSBannerAdMob(Constants.IOS_ADMOB_BANNER, "")), 
                this.AddRewardAd) {
                    CrossPlatformTools.sendIOSRequest("intializeReward", "&rewardID=" + Constants.IOS_ADMOB_REWARDED);
                    var s = new IOSRewardAdMob(AdType.GoogleAdMob, Constants.IOS_ADMOB_REWARDED, "");
                    s.name = "ios_reward", this.VideoController.add_rewardAds(s);
                }
            } else Constants.COMPILE_PLATFORM === Platform.WEB ? Constants.IS_GAME_DISTRIBUTION ? (this.VideoController.add_videoAds(new GameDisttribution(AdType.GameDistribution, Constants.GAME_DISTRIBUTION_ID, Constants.USER_DISTRIBUTION_ID)), 
            this.VideoController.add_rewardAds(new GameDisttributionReward(AdType.GameDistribution, Constants.GAME_DISTRIBUTION_ID, Constants.USER_DISTRIBUTION_ID), !1)) : Constants.IS_GAME_MONETIZATION && this.VideoController.add_videoAds(new GameMonetization(AdType.GameMonetization, Constants.GAME_MONETIZATION_ID, Constants.USER_MONETIZATION_ID)) : Constants.COMPILE_PLATFORM === Platform.CHROME || Constants.COMPILE_PLATFORM === Platform.FACEBOOK || this.inIframe();
        }, t.prototype.remove_banner = function() {
            this.BannerController && this.BannerController.remove_ad_control();
        }, t.prototype.open_ad_depends_on_platform = function(t) {
            Constants.IS_MOBILE_COMPILE_VERSION ? AmazingGame.getInstance().PlatformProvider.open_in_store(t) : GlobalVars.Platform === Platform.WEB_ANDROID || GlobalVars.Platform === Platform.WEB_IOS ? AmazingGame.getInstance().PlatformProvider.open_in_store(t) : GlobalVars.Platform === Platform.WEB_WINDOWS ? AmazingGame.getInstance().PlatformProvider.open_link(t) : GlobalVars.Platform === Platform.UWP_MOBILE ? AmazingGame.getInstance().PlatformProvider.open_in_store(t) : GlobalVars.Platform === Platform.WEB_CHROME ? AmazingGame.getInstance().PlatformProvider.open_link(t) : GlobalVars.Platform === Platform.WEB && AmazingGame.getInstance().PlatformProvider.open_link(t);
        }, t.prototype.inIframe = function() {
            try {
                return window.self !== window.top;
            } catch (t) {
                return !0;
            }
        }, t.prototype.sendRequest = function(t) {
            gameanalytics.GameAnalytics.addDesignEvent("ads:request:" + Constants.CONFIG_GAME_NAME + ":" + t);
        }, t.prototype.sendImpression = function(t) {
            var e = t.sourceUrl.split("/"), i = e[e.length - 2], n = e[e.length - 1];
            gameanalytics.GameAnalytics.addDesignEvent("ads:impression:" + i + ":" + n);
        }, t.prototype.sendClick = function(t) {
            var e = t.sourceUrl.split("/"), i = e[e.length - 2], n = e[e.length - 1];
            gameanalytics.GameAnalytics.addDesignEvent("ads:click:" + i + ":" + n);
        }, t.prototype.getDetailedString = function(t) {
            var e = t.sourceUrl.split("/");
            return e[e.length - 2] + ":" + e[e.length - 1];
        }, t;
    }(Phaser.Plugin);
    t.AmazingAdProvider = e;
}(AmazingAdProvider || (AmazingAdProvider = {}));

var AmazingRank, AmazingTranslation, BasicPlugin = function(i) {
    function t(t, e) {
        return i.call(this, t, e) || this;
    }
    return __extends(t, i), t.prototype.get_user_id = function() {
        var t = "";
        if (Constants.COMPILE_PLATFORM === Platform.UWP) {
            if (Constants.IS_UWP_WEBVIEW) t = document.uuid, Utils.androidColoredLog("Rank | UWP ID : " + t); else if (Windows.Foundation.Metadata.ApiInformation.isTypePresent("Windows.System.Profile.HardwareIdentification")) {
                var e = Windows.System.Profile.HardwareIdentification.getPackageSpecificToken(null).id, i = new Windows.Storage.Streams.DataReader.fromBuffer(e), n = new Array(e.length);
                i.readBytes(n);
                for (var s = 0; s < n.length; s++) t += n[s].toString();
            }
        } else Constants.COMPILE_PLATFORM !== Platform.ANDROID && Constants.COMPILE_PLATFORM !== Platform.AMAZON || (t = document.uuid, 
        Utils.androidColoredLog("Rank | Android ID : " + t));
        return t && "" !== t || (t = GameSettings.getInstance().userID, Utils.androidColoredLog("Rank | GameSettings.getInstance().userID : " + t)), 
        t;
    }, t.prototype.get_user_country = function() {
        try {
            if (Constants.COMPILE_PLATFORM === Platform.UWP) {
                if (!Constants.IS_UWP_WEBVIEW) return Windows.ApplicationModel.Resources.Core.ResourceManager.current.current.defaultContext.qualifierValues.lookup("Language");
            } else Constants.COMPILE_PLATFORM, Platform.ANDROID;
        } catch (t) {}
        return "en-US";
    }, t;
}(Phaser.Plugin);

!function(t) {
    var e = function() {};
    t.RankDto = e;
    var i = function() {};
    t.RankDtoData = i;
    var n = function() {};
    t.PagesCountDto = n;
    var s = function(n) {
        function t(t, e) {
            var i = n.call(this, t, e) || this;
            return Object.defineProperty(t, "amazingRank", {
                value: i
            }), i;
        }
        return __extends(t, n), t.prototype.initialize = function(t, e, i, n) {
            void 0 === e && (e = 10), void 0 === i && (i = "score"), void 0 === n && (n = 0), 
            this.baseUrl = t, this.gameName = Constants.CONFIG_GAME_NAME, this.pageSize = e, 
            this.field = i, this.mode = n, this.userId = this.get_user_id(), Constants.IS_MOBILE_COMPILE_VERSION ? this.platform = Constants.COMPILE_PLATFORM : this.platform = GlobalVars.Platform, 
            this.initialized = !0;
        }, t.prototype.get_page_size = function(t, i) {
            this.initialized && HttpUtils.get(this.baseUrl + "/hiscore/count/" + this.gameName + "/" + this.pageSize + (0 !== this.mode ? "/" + this.platform : "") + "/" + t, function(t) {
                try {
                    var e = JSON.parse(t);
                    i(e);
                } catch (t) {}
            });
        }, t.prototype.get_overall_page_size = function(t) {
            this.get_page_size("overall", t);
        }, t.prototype.get_daily_page_size = function(t) {
            this.get_page_size("daily", t);
        }, t.prototype.get_weekly_page_size = function(t) {
            this.get_page_size("weekly", t);
        }, t.prototype.get_monthly_page_size = function(t) {
            this.get_page_size("monthly", t);
        }, t.prototype.get_my_rank = function(t, i) {
            this.initialized && HttpUtils.get(this.baseUrl + "/hiscore/my/" + this.gameName + "/" + this.field + "/" + this.userId + "/" + this.platform + "/" + this.pageSize + "/" + this.mode + "/" + t, function(t) {
                try {
                    var e = JSON.parse(t);
                    i(e);
                } catch (t) {}
            });
        }, t.prototype.get_my_overall_rank = function(t) {
            this.get_my_rank("overall", t);
        }, t.prototype.get_my_daily_rank = function(t) {
            this.get_my_rank("daily", t);
        }, t.prototype.get_my_weekly_rank = function(t) {
            this.get_my_rank("weekly", t);
        }, t.prototype.get_my_monthly_rank = function(t) {
            this.get_my_rank("monthly", t);
        }, t.prototype.get_paged_rank = function(t, e, i) {
            this.initialized && HttpUtils.get(this.baseUrl + "/hiscore/page/" + this.gameName + "/" + this.field + "/" + this.userId + "/" + this.platform + "/" + this.pageSize + "/" + t + "/" + this.mode + "/" + e, function(t) {
                try {
                    var e = JSON.parse(t);
                    i(e);
                } catch (t) {}
            });
        }, t.prototype.get_top_overall_rank = function(t) {
            this.get_paged_rank(0, "overall", t);
        }, t.prototype.get_top_daily_rank = function(t) {
            this.get_paged_rank(0, "daily", t);
        }, t.prototype.get_top_weekly_rank = function(t) {
            this.get_paged_rank(0, "weekly", t);
        }, t.prototype.get_top_monthly_rank = function(t) {
            this.get_paged_rank(0, "monthly", t);
        }, t.prototype.get_user_data = function(i) {
            this.initialized && HttpUtils.get(this.baseUrl + "/hiscore/name/" + this.gameName + "/" + this.userId + "/" + this.platform, function(t) {
                try {
                    var e = JSON.parse(t);
                    i(e);
                } catch (t) {}
            });
        }, t.prototype.post_score_object = function(t, e, i) {
            if (void 0 === e && (e = null), this.initialized) {
                var n = "";
                if (null === e || e.length <= 0) n = this.field; else {
                    n = e[0];
                    for (var s = 1; s < e.length; s++) n += "," + e[s];
                }
                t.userId = this.get_user_id(), t.os = this.platform, Utils.androidColoredLog("RANK | post score: " + JSON.stringify(t)), 
                HttpUtils.post(this.baseUrl + "/hiscore/add/" + this.gameName + "/" + n, t, function(t) {
                    try {
                        var e = JSON.parse(t);
                        i(e);
                    } catch (t) {}
                });
            }
        }, t.prototype.change_name = function(i, n) {
            this.initialized && (i.userId = this.userId, i.os = this.platform, Utils.androidColoredLog("RANK | change_name: " + JSON.stringify(i)), 
            HttpUtils.post(this.baseUrl + "/hiscore/rename/" + this.gameName, i, function(t) {
                try {
                    Utils.androidColoredLog("RANK | succes change_name: " + JSON.stringify(i));
                    var e = JSON.parse(t);
                    n(e);
                } catch (t) {}
            }));
        }, t;
    }(BasicPlugin);
    t.AmazingRank = s;
}(AmazingRank || (AmazingRank = {})), function(t) {
    var e = function(n) {
        function t(t, e) {
            var i = n.call(this, t, e) || this;
            return i.defaultLanguage = "en", i.languageCode = "en", i.availableLanguages = [ "en", "pl", "pt", "fr" ], 
            i.translations = {}, i.eventsListeners = [], Object.defineProperty(t, "translation", {
                value: i
            }), i.game = t, i;
        }
        return __extends(t, n), t.prototype.initialize = function(t, e) {
            var i, n;
            this.availableLanguages = [], this.defaultLanguage = t;
            try {
                for (var s = __values(e), o = s.next(); !o.done; o = s.next()) {
                    var a = o.value;
                    this.availableLanguages.push(a.substr(0, 2));
                }
            } catch (t) {
                i = {
                    error: t
                };
            } finally {
                try {
                    o && !o.done && (n = s.return) && n.call(s);
                } finally {
                    if (i) throw i.error;
                }
            }
            this.loadAvalibleLanguages(e);
            var r = navigator.language || window.navigator.userLanguage || window.navigator.browserLanguage || window.navigator.systemLanguage || this.defaultLanguage;
            null == r || !1 === r ? this.languageCode = this.defaultLanguage : 2 < r.length ? this.languageCode = r.substr(0, 2) : this.languageCode = r, 
            this.contains(this.availableLanguages, this.languageCode) || (this.languageCode = this.defaultLanguage), 
            GameSettings.getInstance().userLanguage && this.contains(this.availableLanguages, GameSettings.getInstance().userLanguage) && (this.languageCode = GameSettings.getInstance().userLanguage);
        }, t.prototype.setLanguage = function(t) {
            this.languageCode = t;
        }, t.prototype.loadAvalibleLanguages = function(t) {
            var e, i;
            try {
                for (var n = __values(t), s = n.next(); !s.done; s = n.next()) {
                    var o = s.value;
                    this.translations[o.substr(0, 2)] = this.game.cache.getJSON(o);
                }
            } catch (t) {
                e = {
                    error: t
                };
            } finally {
                try {
                    s && !s.done && (i = n.return) && i.call(n);
                } finally {
                    if (e) throw e.error;
                }
            }
        }, t.prototype.translate = function(t) {
            try {
                if (this.translations[this.languageCode][t]) return this.translations[this.languageCode][t];
                if (this.translations[this.defaultLanguage][t]) return this.translations[this.defaultLanguage][t];
            } catch (t) {}
            return t;
        }, t.prototype.getFullLanguagePath = function(t) {
            return t.toLocaleLowerCase() + "-" + t.toUpperCase();
        }, t.prototype.contains = function(t, e) {
            for (var i = 0; i < t.length; i++) if (t[i] === e) return !0;
            return !1;
        }, t.prototype.isTranslated = function(t) {
            return t.translate;
        }, t.prototype.addListener = function(t) {
            this.eventsListeners.push(t);
        }, t.prototype.dispatchTranslate = function() {
            var e = this;
            this.eventsListeners.forEach(function(t) {
                t(e.languageCode);
            });
        }, t.prototype.clearAllListeners = function() {
            this.eventsListeners = [];
        }, t.prototype.translateScene = function(t) {
            this.dispatchTranslate();
        }, t.prototype.changeToNextLanguage = function() {
            var t = this.availableLanguages.indexOf(this.languageCode);
            t + 1 !== this.availableLanguages.length ? this.setLanguage(this.availableLanguages[t + 1]) : this.setLanguage(this.availableLanguages[0]);
        }, t;
    }(Phaser.Plugin);
    t.AmazingTranslation = e;
}(AmazingTranslation || (AmazingTranslation = {}));

var GoogleAnalytics, PhaserNineSlice, RequestDto = function() {}, ResponseDto = function() {};

!function(t) {
    var e = function(n) {
        function t(t, e) {
            var i = n.call(this, t, e) || this;
            return Object.defineProperty(t, "google", {
                value: i
            }), i;
        }
        return __extends(t, n), t.prototype.initialize = function() {
            var t, e, i, n, s = new Date();
            Constants.COMPILE_PLATFORM === Platform.ANDROID || Constants.COMPILE_PLATFORM === Platform.AMAZON || Constants.COMPILE_PLATFORM === Platform.IOS || Constants.COMPILE_PLATFORM === Platform.UWP || (t = window, 
            e = document, t.GoogleAnalyticsObject = "ga", t.ga = t.ga || function() {
                (t.ga.q = t.ga.q || []).push(arguments);
            }, t.ga.l = 1 * s, i = e.createElement("script"), n = e.getElementsByTagName("script")[0], 
            i.async = 1, i.src = "//www.google-analytics.com/analytics.js", n.parentNode.insertBefore(i, n), 
            this.isReady = !0, this.send_event("create", Constants.GOOGLE_ANALYTICS), this.send_event("send", "pageview"));
        }, t.prototype.send_event = function(t, e, i, n, s, o) {
            this.isReady && (Constants.COMPILE_PLATFORM !== Platform.WEB && GlobalVars.Platform !== Platform.WEB_ANDROID && GlobalVars.Platform !== Platform.IOS || ga(t, e, i, n, s, o));
        }, t;
    }(Phaser.Plugin);
    t.GoogleAnalytics = e;
}(GoogleAnalytics || (GoogleAnalytics = {})), function(t) {
    var e = function(l) {
        function t(t, e, i, n, s, o, a, r) {
            var h = l.call(this, t, e, i, n, s) || this;
            return h.baseTexture = h.texture.baseTexture, h.baseFrame = h.texture.frame, null === s || r ? r || (r = t.cache.getNineSlice(n)) : r = t.cache.getNineSlice(s), 
            void 0 === r || (h.topSize = r.top, r.left ? h.leftSize = r.left : h.leftSize = h.topSize, 
            r.right ? h.rightSize = r.right : h.rightSize = h.leftSize, r.bottom ? h.bottomSize = r.bottom : h.bottomSize = h.topSize, 
            h.loadTexture(new Phaser.RenderTexture(h.game, h.localWidth, h.localHeight)), h.resize(o, a)), 
            h;
        }
        return __extends(t, l), t.prototype.renderTexture = function() {
            this.texture.resize(this.localWidth, this.localHeight, !0);
            var t = [ 0, this.leftSize, this.baseFrame.width - this.rightSize, this.baseFrame.width ], e = [ 0, this.topSize, this.baseFrame.height - this.bottomSize, this.baseFrame.height ], i = [ 0, this.leftSize, this.localWidth - this.rightSize, this.localWidth ], n = [ 0, this.topSize, this.localHeight - this.bottomSize, this.localHeight ];
            this.texture.clear();
            for (var s = 0; s < 3; s++) for (var o = 0; o < 3; o++) {
                var a = this.createTexturePart(t[o], e[s], t[o + 1] - t[o], e[s + 1] - e[s]);
                a.width = i[o + 1] - i[o], a.height = n[s + 1] - n[s], this.texture.renderXY(a, i[o], n[s]);
            }
        }, t.prototype.resize = function(t, e) {
            this.localWidth = t, this.localHeight = e, this.renderTexture();
        }, t.prototype.destroy = function() {
            for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
            l.prototype.destroy.call(this, t[0]), this.texture.destroy(!0), this.texture = null, 
            this.baseTexture = null, this.baseFrame = null;
        }, t.prototype.createTexturePart = function(t, e, i, n) {
            var s = new PIXI.Rectangle(this.baseFrame.x + this.texture.frame.x + t, this.baseFrame.y + this.texture.frame.y + e, Math.max(i, 1), Math.max(n, 1));
            return new Phaser.Sprite(this.game, 0, 0, new PIXI.Texture(this.baseTexture, s));
        }, t;
    }(Phaser.Sprite);
    t.NineSlice = e;
}(PhaserNineSlice || (PhaserNineSlice = {})), function(h) {
    var t = function(n) {
        function t(t, e) {
            var i = n.call(this, t, e) || this;
            return i.addNineSliceCache(), i.addNineSliceFactory(), i.addNineSliceLoader(), i;
        }
        return __extends(t, n), t.prototype.addNineSliceLoader = function() {
            Phaser.Loader.prototype.nineSlice = function(t, e, i, n, s, o) {
                var a = {
                    top: i
                };
                n && (a.left = n), s && (a.right = s), o && (a.bottom = o), this.addToFileList("image", t, e), 
                this.game.cache.addNineSlice(t, a);
            };
        }, t.prototype.addNineSliceFactory = function() {
            Phaser.GameObjectFactory.prototype.nineSlice = function(t, e, i, n, s, o, a) {
                void 0 === a && (a = this.world);
                var r = new h.NineSlice(this.game, t, e, i, n, s, o);
                return a.add(r);
            }, Phaser.GameObjectCreator.prototype.nineSlice = function(t, e, i, n, s, o) {
                return new h.NineSlice(this.game, t, e, i, n, s, o);
            };
        }, t.prototype.addNineSliceCache = function() {
            Phaser.Cache.prototype.nineSlice = {}, Phaser.Cache.prototype.addNineSlice = function(t, e) {
                this.nineSlice[t] = e;
            }, Phaser.Cache.prototype.getNineSlice = function(t) {
                var e = this.nineSlice[t];
                return e;
            };
        }, t;
    }(Phaser.Plugin);
    h.NineSlicePlugin = t;
}(PhaserNineSlice || (PhaserNineSlice = {}));

var SnapAd, ProfanityFilter = function() {
    function t() {
        this.exclude = [], t._instance = this;
    }
    return t.getInstance = function() {
        return t._instance || new t(), t._instance;
    }, t.prototype.isProfane = function(e) {
        return 0 < bad_words.filter(function(t) {
            return new RegExp("\\b" + t.replace(/(\W)/g, "\\$1") + "\\b", "gi").test(e);
        }).length || !1;
    }, t;
}(), bad_words = [ "ahole", "anus", "ash0le", "ash0les", "asholes", "ass", "Ass Monkey", "Assface", "assh0le", "assh0lez", "asshole", "assholes", "assholz", "asswipe", "azzhole", "bassterds", "bastard", "bastards", "bastardz", "basterds", "basterdz", "Biatch", "bitch", "bitches", "Blow Job", "boffing", "butthole", "buttwipe", "c0ck", "c0cks", "c0k", "Carpet Muncher", "cawk", "cawks", "Clit", "cnts", "cntz", "cock", "cockhead", "cock-head", "cocks", "CockSucker", "cock-sucker", "crap", "cum", "cunt", "cunts", "cuntz", "dick", "dild0", "dild0s", "dildo", "dildos", "dilld0", "dilld0s", "dominatricks", "dominatrics", "dominatrix", "dyke", "enema", "f u c k", "f u c k e r", "fag", "fag1t", "faget", "fagg1t", "faggit", "faggot", "fagg0t", "fagit", "fags", "fagz", "faig", "faigs", "fart", "flipping the bird", "fuck", "fucker", "fuckin", "fucking", "fucks", "Fudge Packer", "fuk", "Fukah", "Fuken", "fuker", "Fukin", "Fukk", "Fukkah", "Fukken", "Fukker", "Fukkin", "g00k", "God-damned", "h00r", "h0ar", "h0re", "hells", "hoar", "hoor", "hoore", "jackoff", "jap", "japs", "jerk-off", "jisim", "jiss", "jizm", "jizz", "knob", "knobs", "knobz", "kunt", "kunts", "kuntz", "Lezzian", "Lipshits", "Lipshitz", "masochist", "masokist", "massterbait", "masstrbait", "masstrbate", "masterbaiter", "masterbate", "masterbates", "Motha Fucker", "Motha Fuker", "Motha Fukkah", "Motha Fukker", "Mother Fucker", "Mother Fukah", "Mother Fuker", "Mother Fukkah", "Mother Fukker", "mother-fucker", "Mutha Fucker", "Mutha Fukah", "Mutha Fuker", "Mutha Fukkah", "Mutha Fukker", "n1gr", "nastt", "nigger;", "nigur;", "niiger;", "niigr;", "orafis", "orgasim;", "orgasm", "orgasum", "oriface", "orifice", "orifiss", "packi", "packie", "packy", "paki", "pakie", "paky", "pecker", "peeenus", "peeenusss", "peenus", "peinus", "pen1s", "penas", "penis", "penis-breath", "penus", "penuus", "Phuc", "Phuck", "Phuk", "Phuker", "Phukker", "polac", "polack", "polak", "Poonani", "pr1c", "pr1ck", "pr1k", "pusse", "pussee", "pussy", "puuke", "puuker", "qweir", "recktum", "rectum", "retard", "sadist", "scank", "schlong", "screwing", "semen", "sex", "sexy", "Sh!t", "sh1t", "sh1ter", "sh1ts", "sh1tter", "sh1tz", "shit", "shits", "shitter", "Shitty", "Shity", "shitz", "Shyt", "Shyte", "Shytty", "Shyty", "skanck", "skank", "skankee", "skankey", "skanks", "Skanky", "slag", "slut", "sluts", "Slutty", "slutz", "son-of-a-bitch", "tit", "turd", "va1jina", "vag1na", "vagiina", "vagina", "vaj1na", "vajina", "vullva", "vulva", "w0p", "wh00r", "wh0re", "whore", "xrated", "xxx", "b!+ch", "bitch", "blowjob", "clit", "arschloch", "fuck", "shit", "ass", "asshole", "b!tch", "b17ch", "b1tch", "bastard", "bi+ch", "boiolas", "buceta", "c0ck", "cawk", "chink", "cipa", "clits", "cock", "cum", "cunt", "dildo", "dirsa", "ejakulate", "fatass", "fcuk", "fuk", "fux0r", "hoer", "hore", "jism", "kawk", "l3itch", "l3i+ch", "masturbate", "masterbat*", "masterbat3", "motherfucker", "s.o.b.", "mofo", "nazi", "nigga", "nigger", "nutsack", "phuck", "pimpis", "pusse", "pussy", "scrotum", "sh!t", "shemale", "shi+", "sh!+", "slut", "smut", "teets", "tits", "boobs", "b00bs", "teez", "testical", "testicle", "titt", "w00se", "jackoff", "wank", "whoar", "whore", "*damn", "*dyke", "*fuck*", "*shit*", "@$$", "amcik", "andskota", "arse*", "assrammer", "ayir", "bi7ch", "bitch*", "bollock*", "breasts", "butt-pirate", "cabron", "cazzo", "chraa", "chuj", "Cock*", "cunt*", "d4mn", "daygo", "dego", "dick*", "dike*", "dupa", "dziwka", "ejackulate", "Ekrem*", "Ekto", "enculer", "faen", "fag*", "fanculo", "fanny", "feces", "feg", "Felcher", "ficken", "fitt*", "Flikker", "foreskin", "Fotze", "Fu(*", "fuk*", "futkretzn", "gook", "guiena", "h0r", "h4x0r", "hell", "helvete", "hoer*", "honkey", "Huevon", "hui", "injun", "jizz", "kanker*", "kike", "klootzak", "kraut", "knulle", "kuk", "kuksuger", "Kurac", "kurwa", "kusi*", "kyrpa*", "lesbo", "mamhoon", "masturbat*", "merd*", "mibun", "monkleigh", "mouliewop", "muie", "mulkku", "muschi", "nazis", "nepesaurio", "nigger*", "orospu", "paska*", "perse", "picka", "pierdol*", "pillu*", "pimmel", "piss*", "pizda", "poontsee", "poop", "porn", "p0rn", "pr0n", "preteen", "pula", "pule", "puta", "puto", "qahbeh", "queef*", "rautenberg", "schaffer", "scheiss*", "schlampe", "schmuck", "screw", "sh!t*", "sharmuta", "sharmute", "shipal", "shiz", "skribz", "skurwysyn", "sphencter", "spic", "spierdalaj", "splooge", "suka", "b00b*", "testicle*", "titt*", "twat", "vittu", "wank*", "wetback*", "wichser", "wop*", "yed", "zabourah" ], BannerAd = function(t, e) {
    this.isVisble = !1, this.appID = t, this.unitID = e;
}, AdMobCordovaBanner = function(n) {
    function t(t, e) {
        var i = n.call(this, t, e) || this;
        return i.isVisble = !1, document.addEventListener("onAdFailLoad", function(t) {
            this.onAdFailLoad(t);
        }.bind(i)), i;
    }
    return __extends(t, n), t.prototype.show_ad = function(t, e, i) {
        void 0 === i && (i = void 0), Utils.androidColoredLog("Android Banner: Try Show Ad"), 
        this.adDetail = e, this.availbleSpace = t, this.createAdControl(e);
    }, t.prototype.createAdControl = function(t) {
        this.get_dpi();
        var e = this.availbleSpace.x, i = this.availbleSpace.y;
        this.availbleSpace.snap && (this.availbleSpace.snap === SnapAd.Bottom && (i = this.availbleSpace.y + this.availbleSpace.height - t.height), 
        this.availbleSpace.snap === SnapAd.Top && (i = this.availbleSpace.y));
        var n = this.get_dpi();
        this.availbleSpace.x, this.availbleSpace.width, t.width, this.availbleSpace.y, this.availbleSpace.height, 
        t.height;
        AmazingWrapper.showBannerAd(e, i, this.availbleSpace.width, this.availbleSpace.height);
    }, t.prototype.onAdFailLoadCallback = function() {
        Utils.androidColoredLog("Android Banner: onAdFailLoad; Play crosspromo ads"), AmazingGame.getInstance().amazingAdProvider.BannerController.show_amazing_ad_as_fallback();
    }, t.prototype.get_dpi = function() {
        return AmazingGame.getInstance().device.pixelRatio;
    }, t.prototype.remove_ad_control = function() {
        try {
            this.isVisble = !1, AmazingWrapper.hideBanner();
        } catch (t) {}
    }, t;
}(BannerAd), AdMobCordovaProvider = function(n) {
    function t(t, e, i) {
        return n.call(this, t, e, i) || this;
    }
    return __extends(t, n), t.prototype.init = function() {
        AmazingWrapper.loadVideo(), document.addEventListener("onAdClosed", function() {
            Utils.androidColoredLog("Video Ad Closed"), this.onAdClosed();
        }.bind(this));
    }, t.prototype.show_ad = function(t) {
        this.resumeCallback = t, Utils.androidColoredLog("Show new Ad"), AmazingWrapper.showVideo();
    }, t.prototype.onAdFailLoadCallback = function() {
        this.isAdAvaible = !1, this.videoControler.onContentResumed.dispatch(), this.resumeCallback && this.resumeCallback.apply(null), 
        Utils.androidColoredLog("Video Load Fail");
    }, t.prototype.onAdReadyCallback = function() {
        this.isAdAvaible = !0, Utils.androidColoredLog("Video Ad Ready");
    }, t.prototype.onAdClosedCallback = function() {
        Utils.androidColoredLog("Video Ad Closed"), this.videoControler.onContentResumed.dispatch(), 
        this.resumeCallback.apply(null), AmazingGame.getInstance().sound.mute = !1, this.isAdAvaible = !1;
    }, t.prototype.onAdRewarded = function() {}, t;
}(VideoAdProvider), AdMobRewardProvider = function(n) {
    function t(t, e, i) {
        return n.call(this, t, e, i) || this;
    }
    return __extends(t, n), t.prototype.init = function() {
        AmazingWrapper.loadReward(), document.addEventListener("onAdClosed", function() {
            this.onAdClosed();
        }.bind(this));
    }, t.prototype.show_ad = function(t) {
        this.resumeCallback = t, AmazingWrapper.showReward();
    }, t.prototype.onAdFailLoadCallback = function() {
        this.isAdAvaible = !1;
    }, t.prototype.onAdReadyCallback = function() {
        this.isAdAvaible = !0;
    }, t.prototype.onAdClosedCallback = function() {
        this.videoControler.onContentResumed.dispatch(), this.resumeCallback.apply(null), 
        AmazingGame.getInstance().sound.mute = !1, this.isAdAvaible = !1;
    }, t.prototype.onAdRewarded = function() {}, t;
}(VideoAdProvider), AmazingAddButton = function(o) {
    function a(t, e, i) {
        var n, s = o.call(this, t, e, i, "ad1", "ad1", a.click) || this;
        return s.dic = ((n = {}).amazingfreecell = "freecell", n.amazingspider = "spider", 
        n.amazingsolitaire = "klondike", n.amazingbubbleconnect = "bubbleconnect", n.amazingwordsearch = "wordsearch", 
        n.amazingwordfresh = "wordfresh", n.amazingbubblebreaker = "bubblebreaker", n.amazingsquares = "squares", 
        n), s.visible = !1, s.alpha = 0, s;
    }
    return __extends(a, o), a.prototype.load = function() {
        var s = this, o = AmazingGame.getInstance();
        o.amazingAd.initialized ? (o.amazingAdProvider.sendRequest("320x120"), o.amazingAd.get_ad("320x120", function(t) {
            var e = "https://config.amazinghedgehog.com/" + (a.CURRENT_BANNER_AD = t).sourceUrl.split("/")[3] + "/web/96.png";
            if (Utils.androidColoredLog("RECT AD-------------------"), Utils.androidColoredLog(e), 
            null != a.CURRENT_BANNER_AD) {
                s.visible = !0, s.alpha = .001, AmazingGame.getInstance().cache.checkImageKey(t.sourceUrl) ? (s.visible = !0, 
                s.loadTexture(e), s.set_all_frames(e), s.game.add.tween(s).to({
                    alpha: 1
                }, Phaser.Timer.SECOND, Phaser.Easing.Quadratic.In, !0, .25 * Phaser.Timer.SECOND)) : Utils.download_image_from_url(e, e, function(t) {
                    s.loadTexture(e), s.set_all_frames(e), s.game.add.tween(s).to({
                        alpha: 1
                    }, Phaser.Timer.SECOND, Phaser.Easing.Quadratic.In, !0, .25 * Phaser.Timer.SECOND);
                }.bind(this, e), function() {
                    s.visible = !1;
                }), o.amazingAdProvider.sendImpression(a.CURRENT_BANNER_AD);
                var i = a.CURRENT_BANNER_AD.sourceUrl.split("/"), n = i[i.length - 2];
                i[i.length - 1];
                gameanalytics.GameAnalytics.addDesignEvent("button:ad:impression" + n);
            }
        }.bind(this), function() {})) : s.visible = !1;
    }, a.click = function(t) {
        AmazingGame.getInstance().amazingAdProvider.open_ad_depends_on_platform(a.CURRENT_BANNER_AD.promoteUrl), 
        AmazingGame.getInstance().amazingAdProvider.sendImpression(a.CURRENT_BANNER_AD);
        var e = a.CURRENT_BANNER_AD.sourceUrl.split("/"), i = e[e.length - 2];
        e[e.length - 1];
        gameanalytics.GameAnalytics.addDesignEvent("button:ad:click" + i);
    }, a;
}(ScaleButton), AmazingAdControl = function() {
    function t() {}
    return t.prototype.init = function() {
        this.adContainer = document.createElement("div"), this.adContainer.setAttribute("id", "amazingAdContainer"), 
        this.adContainer.style.position = "absolute", this.adContainer.style.width = "100%", 
        this.adContainer.style.height = "100%", this.adContainer.style.backgroundRepeat = "no-repeat", 
        this.adContainer.onclick = function() {
            AmazingGame.getInstance().amazingAdProvider.open_ad_depends_on_platform(this.adDto.promoteUrl), 
            AmazingGame.getInstance().amazingAdProvider.sendClick(this.adDto);
        }.bind(this), document.body.appendChild(this.adContainer);
    }, t.prototype.loadAd = function() {
        this.image = new Image(), this.image.src = this.adDto.sourceUrl, this.hidden = !1, 
        this.image.onload = function() {
            this.hidden || (this.adContainer.style.background = "url('" + this.image.src + "')", 
            this.adContainer.style.visibility = "visible", this.adContainer.style.opacity = "1", 
            this.adContainer.style.transition = "opacity 1s", this.adContainer.style.backgroundSize = "cover", 
            AmazingGame.getInstance().amazingAdProvider.sendImpression(this.adDto));
        }.bind(this), this.adContainer.style.background = "none", this.adContainer.style.width = this.width + "px", 
        this.adContainer.style.height = this.height + "px", this.adContainer.style.backgroundSize = "cover", 
        this.adContainer.style.cursor = "pointer", this.adContainer.style.left = this.x + "px", 
        this.adContainer.style.top = this.y + "px", document.body.removeChild(this.adContainer), 
        document.body.appendChild(this.adContainer);
    }, t.prototype.hide = function() {
        void 0 !== this.image && (this.image.onload = null, this.image = void 0), this.adContainer.style.visibility = "hidden", 
        this.adContainer.style.opacity = "0", this.hidden = !0;
    }, t;
}(), AmazingBannerAd = function(e) {
    function t() {
        var t = null !== e && e.apply(this, arguments) || this;
        return t.showAdCounter = 0, t;
    }
    return __extends(t, e), t.prototype.show_ad = function(t, e, i) {
        void 0 === this.amazingAdControl && (this.amazingAdControl = new AmazingAdControl(), 
        this.amazingAdControl.init()), this.amazingAdControl.adDto = i, this.adDetail = e, 
        this.availbleSpace = t, this.isVisble = !0, this.createAdControl(this.adDetail);
    }, t.prototype.get_dpi = function() {
        return AmazingGame.getInstance().device.pixelRatio;
    }, t.prototype.onAdFailLoadCallback = function() {}, t.prototype.createAdControl = function(t) {
        this.showAdCounter++;
        var e = this.get_dpi();
        this.amazingAdControl.width = t.width / e, this.amazingAdControl.height = t.height / e;
        var i = 1, n = this.availbleSpace.width / t.width, s = this.availbleSpace.height / t.height, o = t.width, a = t.height;
        i = Math.min(n, s), i = Math.min(1.5, i), this.availbleSpace.scaleToFitDown ? (this.amazingAdControl.width *= i, 
        this.amazingAdControl.height *= i, o *= i, a *= i) : 1 < e && t.width * i <= this.availbleSpace.width && t.height * i <= this.availbleSpace.height && (this.amazingAdControl.width *= i, 
        this.amazingAdControl.height *= i, o *= i, a *= i);
        var r = (this.availbleSpace.x + (this.availbleSpace.width - o) / 2) / e, h = (this.availbleSpace.y + (this.availbleSpace.height - a) / 2) / e;
        this.availbleSpace.snap && (this.availbleSpace.snap === SnapAd.Bottom && (h = (this.availbleSpace.y + this.availbleSpace.height - a) / e), 
        this.availbleSpace.snap === SnapAd.Top && (h = this.availbleSpace.y), this.availbleSpace.snap === SnapAd.Left && (r = this.availbleSpace.x)), 
        this.amazingAdControl.x = r, this.amazingAdControl.y = h, this.amazingAdControl.loadAd();
    }, t.prototype.remove_ad_control = function() {
        try {
            this.isVisble = !1, null != this.amazingAdControl && this.amazingAdControl.hide();
        } catch (t) {}
    }, t;
}(BannerAd), AmazingCanvasImage = function() {
    function t() {}
    return t.prototype.init = function() {
        var t = this;
        this.image = new ScaleButton(AmazingGame.getInstance(), 0, 0, "ad.png", "", function() {
            AmazingGame.getInstance().amazingAdProvider.open_ad_depends_on_platform(t.adDto.promoteUrl), 
            AmazingGame.getInstance().amazingAdProvider.sendClick(t.adDto);
        }, this), this.image.visible = !1, AmazingGame.getInstance().stage.add(this.image);
    }, t.prototype.loadAd = function() {
        var e = this;
        this.image.visible = !1, this.hidden = !1, AmazingGame.getInstance().cache.checkImageKey(this.adDto.sourceUrl) ? (e.image.loadTexture(this.adDto.sourceUrl), 
        AmazingGame.getInstance().world.bringToTop(e.image), e.image.visible = !0) : Utils.download_image_from_url(this.adDto.sourceUrl, this.adDto.sourceUrl, function(t) {
            e.hidden || (e.image.loadTexture(this.adDto.sourceUrl), AmazingGame.getInstance().world.bringToTop(e.image), 
            e.image.visible = !0);
        }.bind(this)), this.image.width = this.width, this.image.height = this.height, this.image.set_scale(this.scale), 
        this.image.position.x = this.x + this.width / 2, this.image.position.y = this.y + this.height / 2;
    }, t.prototype.hide = function() {
        void 0 !== this.image && (this.image.visible = !1), this.hidden = !0;
    }, t;
}(), AmazingCanvasBannerAd = function(e) {
    function t() {
        var t = null !== e && e.apply(this, arguments) || this;
        return t.showAdCounter = 0, t;
    }
    return __extends(t, e), t.prototype.show_ad = function(t, e, i) {
        void 0 === this.amazingAdControl && (this.amazingAdControl = new AmazingCanvasImage(), 
        this.amazingAdControl.init()), this.amazingAdControl.adDto = i, this.adDetail = e, 
        this.availbleSpace = t, this.isVisble = !0, this.createAdControl(this.adDetail);
    }, t.prototype.get_dpi = function() {
        return AmazingGame.getInstance().device.pixelRatio;
    }, t.prototype.onAdFailLoadCallback = function() {}, t.prototype.createAdControl = function(t) {
        this.showAdCounter++;
        this.amazingAdControl.width = t.width / 1, this.amazingAdControl.height = t.height / 1;
        var e = 1, i = this.availbleSpace.width / t.width, n = this.availbleSpace.height / t.height, s = t.width, o = t.height;
        1 < window.devicePixelRatio && (e = Math.min(i, n), e = Math.min(1.5, e)), this.availbleSpace.scaleToFitDown ? this.amazingAdControl.scale = .5 : this.amazingAdControl.scale = 1, 
        t.width * e <= this.availbleSpace.width && t.height * e <= this.availbleSpace.height && (this.amazingAdControl.width *= e, 
        this.amazingAdControl.height *= e, s *= e, o *= e, this.amazingAdControl.scale = e);
        var a = this.availbleSpace.x + (this.availbleSpace.width - s) / 2, r = this.availbleSpace.y + (this.availbleSpace.height - o) / 2;
        this.availbleSpace.snap && (this.availbleSpace.snap === SnapAd.Bottom && (r = (this.availbleSpace.y + this.availbleSpace.height - o) / 1), 
        this.availbleSpace.snap === SnapAd.Top && (r = this.availbleSpace.y), this.availbleSpace.snap === SnapAd.Left && (a = this.availbleSpace.x)), 
        this.amazingAdControl.x = a, this.amazingAdControl.y = r, this.amazingAdControl.loadAd();
    }, t.prototype.remove_ad_control = function() {
        try {
            this.isVisble = !1, null != this.amazingAdControl && this.amazingAdControl.hide();
        } catch (t) {}
    }, t;
}(BannerAd);

!function(t) {
    t[t.None = 0] = "None", t[t.Bottom = 1] = "Bottom", t[t.Left = 2] = "Left", t[t.Center = 3] = "Center", 
    t[t.Right = 4] = "Right", t[t.Top = 5] = "Top";
}(SnapAd || (SnapAd = {}));

var AdType, AdDetail = function() {
    function t(t, e, i, n) {
        this.maxDownScale = 1, this.scaleToFitDown = !1, this.x = t, this.y = e, this.width = i, 
        this.height = n;
    }
    return t.prototype.toString = function() {
        return "X: " + this.x + "Y: " + this.y + "Width: " + this.width + "Height: " + this.height;
    }, t;
}(), LARGE_FLAG_BANNER = new AdDetail(0, 0, 300, 600), FLAG_BANNER = new AdDetail(0, 0, 160, 600), RECT_BANNER = new AdDetail(0, 0, 300, 250), HUGE_BANNER = new AdDetail(0, 0, 728, 90), BILLBOARD = new AdDetail(0, 0, 970, 250), MEDIUM_BANNER = new AdDetail(0, 0, 320, 100), SMALL_BANNER = new AdDetail(0, 0, 320, 50), SMALL_RECTANGLE = new AdDetail(0, 0, 125, 125), BannerController = function() {
    function t() {
        this.refreshTime = 1e3, this.lastRefresh = 0, this.isLastCrossPromo = !1, this.initialized = !1, 
        this.bannerAds = {}, this.initialized = !0;
    }
    return t.prototype.update = function() {
        this.showingAd && Date.now().valueOf() - this.lastRefresh > this.refreshTime && (this.remove_ad_control(), 
        this.showAd(this.currentAds, this.isLastCrossPromo), this.lastRefresh = Date.now().valueOf());
    }, t.prototype.add_banner_ad = function(t, e) {
        this.bannerAds[t] = e;
    }, t.prototype.showAd = function(t, e) {
        void 0 === e && (e = !1), this.currentAds = t, this.isLastCrossPromo = e, Constants.COMPILE_PLATFORM, 
        Platform.WEB, !e && this.showProviderAd() || this.showCrossPromoAd();
    }, t.prototype.showProviderAd = function() {
        var t = AmazingGame.getInstance().device.pixelRatio, e = !1;
        Constants.COMPILE_PLATFORM === Platform.WEB && (t = 1);
        for (var i = 0; i < this.currentAds.length; i++) {
            for (var n = this.currentAds[i], s = 0; s < n.second.length; s++) if (this.check_ads_fit(n.first, n.second[s], t)) {
                this.requestForProvider(n.first, n.second[s]), e = !0;
                break;
            }
            if (e) break;
        }
        return e;
    }, t.prototype.showCrossPromoAd = function() {
        for (var t = !1, e = 0; e < this.currentAds.length; e++) {
            var i = this.currentAds[e];
            if (Constants.IS_GAME_DISTRIBUTION) for (var n = 0; n < i.second.length; n++) if (this.check_ads_fit_for_gd(i.first, i.second[n], this.get_dpi())) {
                this.showingAd = !0, this.showGDBanner(i.first, i.second[n]), t = !0;
                break;
            }
            if (RemoteConfig.PLAY_BANNER_CROSS_PROMO && !t) for (n = 0; n < i.second.length; n++) if (this.check_ads_fit(i.first, i.second[n], 1)) {
                this.requestForCrossPromo(i.first, i.second[n]), t = !0;
                break;
            }
            if (t) break;
        }
        return t;
    }, t.prototype.requestForProvider = function(i, n) {
        var s = this;
        this.showingAd = !0;
        var o = this.getBestCrossPoromoAdDetail(), a = new AmazingAd.AdDto();
        a.promoteUrl = "", a.provider = "default", a.sourceUrl = "";
        var r = !1;
        this.isAdSenseSize(n) && (r = !0);
        var t = o.second.width, e = o.second.height;
        r && (t = 728, e = 90), AmazingGame.getInstance().amazingAdProvider.sendRequest(n.width + "x" + n.height), 
        AmazingGame.getInstance().amazingAd.get_ad(t + "x" + e, function(t) {
            if (this.currentAdDto = r ? a : t, "default" === t.provider) {
                var e = "admob";
                Constants.COMPILE_PLATFORM !== Platform.UWP && Constants.COMPILE_PLATFORM !== Platform.UWP_MOBILE || (e = "vungle"), 
                Constants.COMPILE_PLATFORM === Platform.AMAZON && (e = "amazon"), IS_AMAZING && (e = "google"), 
                this.showingAd && (s.currentBanner = this.bannerAds[e], s.currentBanner.show_ad(i, n, void 0));
            } else s.showCrossPromoBanner(o.first, o.second);
            s.lastRefresh = Date.now().valueOf();
        }.bind(this), function() {});
    }, t.prototype.getBestCrossPoromoAdDetail = function() {
        for (var t = 0; t < this.currentAds.length; t++) for (var e = this.currentAds[t], i = 0; i < e.second.length; i++) if (this.check_ads_fit(e.first, e.second[i], 1)) return new Pair(e.first, e.second[i]);
    }, t.prototype.requestForCrossPromo = function(e, i) {
        var n = this;
        this.showingAd = !0, RemoteConfig.PLAY_BANNER_CROSS_PROMO && (AmazingGame.getInstance().amazingAdProvider.sendRequest(i.width + "x" + i.height), 
        AmazingGame.getInstance().amazingAd.get_ad(i.width + "x" + i.height, function(t) {
            this.currentAdDto = t, n.showCrossPromoBanner(e, i), n.lastRefresh = Date.now().valueOf();
        }.bind(this), function() {}));
    }, t.prototype.showGDBanner = function(t, e) {
        this.showingAd && (this.currentBanner = this.bannerAds.gd, this.currentBanner.show_ad(t, e, this.currentAdDto)), 
        this.lastRefresh = Date.now().valueOf();
    }, t.prototype.showCrossPromoBanner = function(t, e) {
        this.showingAd && (RemoteConfig.PLAY_BANNER_CROSS_PROMO ? this.currentBanner = this.bannerAds.amazing : this.currentBanner = void 0, 
        this.currentBanner && this.currentBanner.show_ad(t, e, this.currentAdDto)), this.lastRefresh = Date.now().valueOf();
    }, t.prototype.show_amazing_ad_as_fallback = function() {
        var t = this.getBestCrossPoromoAdDetail();
        this.currentBanner = this.bannerAds.amazing, this.currentBanner.show_ad(t.first, t.second, this.currentAdDto);
    }, t.prototype.remove_ad_control = function() {
        null != this.currentBanner && this.currentBanner.remove_ad_control(), this.lastRefresh = Date.now().valueOf(), 
        this.showingAd = !1;
    }, t.prototype.check_ads_fit = function(t, e, i) {
        return void 0 === i && (i = 1), e.width * i <= t.width && e.height * i <= t.height;
    }, t.prototype.check_ads_fit_for_gd = function(t, e, i) {
        return void 0 === i && (i = 1), (160 === e.width || 728 === e.width || 300 === e.width) && e.width * i <= t.width && e.height * i <= t.height;
    }, t.prototype.get_dpi = function() {
        return AmazingGame.getInstance().device.pixelRatio;
    }, t.prototype.isAdSenseSize = function(t) {
        return 970 === t.width || (300 === t.width && 600 === t.height || (320 === t.width && 50 === t.height || 125 === t.width && 125 === t.height));
    }, t;
}(), GameDisttribution = function(s) {
    function t(t, e, i) {
        var n = s.call(this, t, e, i) || this;
        return n.name = "gd-video", n;
    }
    return __extends(t, s), t.prototype.init = function() {
        this.isAdAvaible = !0;
        var t, e, i, n, s = this;
        window.GD_OPTIONS = {
            debug: !1,
            gameId: this.AppKey,
            onEvent: function(t) {
                switch (t.name) {
                  case "SDK_GAME_START":
                    null != s.resumeCallback && (AmazingGame.getInstance().sound.mute = !1, s.videoControler.onContentResumed.dispatch(), 
                    s.resumeCallback.apply(null), s.isAdAvaible = !0, s.videoControler.RewardAds && 0 < s.videoControler.RewardAds.length && s.videoControler.RewardAds[0].init());
                }
            }
        }, t = document, e = "gamedistribution-jssdk", n = t.getElementsByTagName("script")[0], 
        t.getElementById(e) || ((i = t.createElement("script")).id = e, i.src = "https://html5.api.gamedistribution.com/main.min.js", 
        n.parentNode.insertBefore(i, n));
    }, t.prototype.show_ad = function(t) {
        this.resumeCallback = t, gdsdk.showBanner();
    }, t.prototype.onAdReadyCallback = function() {}, t.prototype.onAdClosedCallback = function() {}, 
    t.prototype.onAdFailLoadCallback = function() {
        this.isAdAvaible = !1;
    }, t.prototype.onAdRewarded = function() {}, t;
}(VideoAdProvider), GameMonetization = function(s) {
    function t(t, e, i) {
        var n = s.call(this, t, e, i) || this;
        return n.name = "gm-video", n;
    }
    return __extends(t, s), t.prototype.init = function() {
        this.isAdAvaible = !0;
        var t, e, i, n = this;
        window.SDK_OPTIONS = {
            debug: !1,
            gameId: this.AppKey,
            onEvent: function(t) {
                switch (t.name) {
                  case "SDK_GAME_START":
                    null != n.resumeCallback && (AmazingGame.getInstance().sound.mute = !1, n.videoControler.onContentResumed.dispatch(), 
                    n.resumeCallback.apply(null), n.isAdAvaible = !0, n.videoControler.RewardAds && 0 < n.videoControler.RewardAds.length && n.videoControler.RewardAds[0].init());
                }
            }
        }, t = document, e = "gamemonetize-sdk", i = t.getElementsByTagName("script")[0], 
        t.getElementById(e) || ((t = t.createElement("script")).id = e, t.src = "patch/js/gm-sdk.js", 
        i.parentNode.insertBefore(t, i));
    }, t.prototype.show_ad = function(t) {
        this.resumeCallback = t, "undefined" != typeof sdk && "undefined" !== sdk.showBanner && sdk.showBanner();
    }, t.prototype.onAdReadyCallback = function() {}, t.prototype.onAdClosedCallback = function() {}, 
    t.prototype.onAdFailLoadCallback = function() {
        this.isAdAvaible = !1;
    }, t.prototype.onAdRewarded = function() {}, t;
}(VideoAdProvider), GDBannerAd = function(n) {
    function t(t, e) {
        var i = n.call(this, t, e) || this;
        return i.isVisble = !1, i;
    }
    return __extends(t, n), t.prototype.show_ad = function(t, e, i) {
        this.remove_ad_control(), this.adDetail = e, this.availbleSpace = t, null != this.adContainer && this.remove_ad_control(), 
        this.adContainer = document.createElement("div"), this.adContainer.setAttribute("id", "adContainer"), 
        this.adContainer.style.position = "absolute", this.createAdControl(e);
    }, t.prototype.get_dpi = function() {
        return AmazingGame.getInstance().device.pixelRatio;
    }, t.prototype.onAdFailLoadCallback = function() {
        this.remove_ad_control(), AmazingGame.getInstance().amazingAdProvider.BannerController.show_amazing_ad_as_fallback();
    }, t.prototype.createAdControl = function(t) {
        this.adContainer;
        var e = this.get_dpi();
        this.adContainer.style.width = t.width + "px", this.adContainer.style.height = t.height + "px";
        var i = (this.availbleSpace.x + (this.availbleSpace.width - t.width * e) / 2) / e, n = (this.availbleSpace.y + (this.availbleSpace.height - t.height * e) / 2) / e;
        this.adContainer.style.top = n + "px", this.adContainer.style.left = i + "px", this.adContainer = document.body.appendChild(this.adContainer), 
        this.isVisble = !0;
        var s = this;
        try {
            gdsdk.showAd(gdsdk.AdType.Display, {
                containerId: "adContainer"
            }).then(function() {}).catch(function(t) {
                s.onAdFailLoadCallback();
            });
        } catch (t) {
            s.onAdFailLoadCallback();
        }
    }, t.prototype.remove_ad_control = function() {
        try {
            null != this.adContainer && (document.body.removeChild(this.adContainer), this.adContainer = null, 
            this.isVisble = !1);
        } catch (t) {}
    }, t;
}(BannerAd), GoogleAdSenseBanner = function(s) {
    function t(t, e) {
        var i = s.call(this, t, e) || this;
        i.isVisble = !1, i.adContainerWrapper = document.createElement("div"), i.adContainerWrapper.setAttribute("id", "adContainerWrapper"), 
        i.adContainerWrapper.style.position = "absolute", i.adContainer = document.createElement("div"), 
        i.adContainer.setAttribute("id", "adContainer"), i.adContainerWrapper = document.body.appendChild(i.adContainerWrapper), 
        i.adContainerWrapper.appendChild(i.adContainer);
        var n = document.createElement("script");
        return n.async = !0, n.src = 'patch/js/null.js?pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9003877865320415" crossorigin="anonymous"', 
        i.adContainer.appendChild(n), i;
    }
    return __extends(t, s), t.prototype.show_ad = function(t, e, i) {
        this.remove_ad_control(), this.adDetail = e, this.availbleSpace = t, null != this.adContainer && this.remove_ad_control(), 
        this.createAdControl(e);
    }, t.prototype.get_dpi = function() {
        return devicePixelRatio;
    }, t.prototype.onAdFailLoadCallback = function() {
        this.remove_ad_control(), AmazingGame.getInstance().amazingAdProvider.BannerController.show_amazing_ad_as_fallback();
    }, t.prototype.createAdControl = function(t) {
        var e = this.get_dpi();
        for (this.adContainerWrapper.style.display = ""; this.adContainer.firstChild; ) this.adContainer.removeChild(this.adContainer.lastChild);
        this.adContainerWrapper.style.width = t.width + "px", this.adContainerWrapper.style.height = t.height + "px", 
        this.adContainer.style.width = t.width + "px", this.adContainer.style.height = t.height + "px";
        var i = (this.availbleSpace.x + (this.availbleSpace.width - t.width) / 2) / e, n = (this.availbleSpace.y + (this.availbleSpace.height - t.height) / 2) / e;
        this.availbleSpace.snap === SnapAd.Left && (i = this.availbleSpace.x), this.adContainerWrapper.style.top = n + "px", 
        this.adContainerWrapper.style.left = i + "px", this.isVisble = !0;
        var s = "width:" + t.width / e + "px; height:" + t.height / e + "px;";
        this.adContainer.style.display = "";
        var o = document.createElement("ins");
        o.className = "adsbygoogle", o.style = "display: inline-block;" + s + " border: 1px solid black", 
        o.setAttribute("data-ad-client", "ca-pub-9003877865320415"), o.setAttribute("data-ad-slot", "4610308903"), 
        -1 < window.location.href.indexOf("localhost") && o.setAttribute("data-ad-test", "on"), 
        this.adContainer.appendChild(o), (window.adsbygoogle = window.adsbygoogle || []).push({});
        adConfig = function(t) {
            adsbygoogle.push(t);
        };
    }, t.prototype.remove_ad_control = function() {
        try {
            null != this.adContainer && (this.adContainerWrapper.style.display = "none", this.adContainer.style.display = "none", 
            this.isVisble = !1);
        } catch (t) {}
    }, t;
}(BannerAd), GoogleInterstitial = function(s) {
    function t(t, e, i) {
        var n = s.call(this, t, e, i) || this;
        return n.name = "gd-reward", n;
    }
    return __extends(t, s), t.prototype.init = function() {
        this.preloadAd();
    }, t.prototype.preloadAd = function() {
        adConfig({
            sound: "on",
            preloadAdBreaks: "on"
        }), this.isAdAvaible = !0;
    }, t.prototype.show_ad = function(t) {
        var e = this;
        this.resumeCallback = t, adBreak({
            type: "next",
            name: "play-game",
            beforeAd: function() {
                AmazingGame.getInstance().prepare_ad_show();
            },
            afterAd: function() {
                e.onAdClosedCallback();
            }
        });
    }, t.prototype.onAdReadyCallback = function() {}, t.prototype.onAdClosedCallback = function() {
        this.videoControler.onContentResumed.dispatch(), this.resumeCallback.apply(null), 
        AmazingGame.getInstance().sound.mute = !1, this.isAdAvaible = !0;
    }, t.prototype.onAdFailLoadCallback = function() {
        this.isAdAvaible = !1;
    }, t.prototype.onAdRewarded = function() {}, t;
}(VideoAdProvider), GoogleReward = function(s) {
    function t(t, e, i) {
        var n = s.call(this, t, e, i) || this;
        return n.name = "google-reward", n;
    }
    return __extends(t, s), t.prototype.init = function() {
        this.preloadAd();
    }, t.prototype.preloadAd = function() {
        adConfig({
            sound: "on",
            preloadAdBreaks: "on"
        }), this.isAdAvaible = !0;
    }, t.prototype.show_ad = function(t) {
        var e = this;
        this.resumeCallback = t, adBreak({
            type: "reward",
            name: "amazing_reward" + Utils.randomInt(0, 100),
            beforeReward: function(t) {
                AmazingGame.getInstance().prepare_ad_show(), t();
            },
            afterAd: function() {
                e.onAdClosedCallback();
            },
            adDismissed: function() {
                e.onAdClosedCallback();
            },
            adViewed: function() {
                e.onAdRewarded();
            },
            adBreakDone: function() {
                e.onAdClosedCallback();
            }
        });
    }, t.prototype.onAdReadyCallback = function() {}, t.prototype.onAdClosedCallback = function() {
        this.videoControler.onContentResumed.dispatch(), AmazingGame.getInstance().sound.mute = !1, 
        this.isAdAvaible = !0;
    }, t.prototype.onAdFailLoadCallback = function() {
        this.isAdAvaible = !1;
    }, t.prototype.onAdRewarded = function() {
        this.videoControler.onContentResumed.dispatch(), this.resumeCallback.apply(null), 
        AmazingGame.getInstance().sound.mute = !1, this.isAdAvaible = !0;
    }, t;
}(VideoAdProvider), IOSBannerAdMob = function(n) {
    function t(t, e) {
        var i = n.call(this, t, e) || this;
        return i.isVisble = !1, document.addEventListener("onAdFailLoad", function(t) {
            this.onAdFailLoad(t);
        }.bind(i)), i;
    }
    return __extends(t, n), t.prototype.show_ad = function(t, e, i) {
        void 0 === i && (i = void 0), this.adDetail = e, this.availbleSpace = t, this.createAdControl(e);
    }, t.prototype.createAdControl = function(t) {
        var e = this.availbleSpace.x, i = this.availbleSpace.y, n = AmazingGame.getInstance().device.pixelRatio;
        this.availbleSpace.x, this.availbleSpace.width, t.width, this.availbleSpace.y, this.availbleSpace.height, 
        t.height;
        e = (this.availbleSpace.x + (this.availbleSpace.width - t.width * n) / 2) / n, i = (this.availbleSpace.y + (this.availbleSpace.height - t.height * n) / 2) / n, 
        this.availbleSpace.snap && (this.availbleSpace.snap === SnapAd.Bottom && (i = (this.availbleSpace.y + this.availbleSpace.height - t.height * n) / n), 
        this.availbleSpace.snap === SnapAd.Top && (i = this.availbleSpace.y)), this.isVisble = !0, 
        CrossPlatformTools.sendIOSRequest("showBanner", "&x=" + e + "&y=" + i + "&width=" + this.adDetail.width + "&height=" + this.adDetail.height);
    }, t.prototype.get_dpi = function() {
        return AmazingGame.getInstance().device.pixelRatio;
    }, t.prototype.onAdFailLoadCallback = function() {
        AmazingGame.getInstance().amazingAdProvider.BannerController.show_amazing_ad_as_fallback();
    }, t.prototype.remove_ad_control = function() {
        try {
            this.isVisble = !1, CrossPlatformTools.sendIOSRequest("removeBanner", "");
        } catch (t) {}
    }, t;
}(BannerAd), IOSRewardAdMob = function(n) {
    function t(t, e, i) {
        return n.call(this, t, e, i) || this;
    }
    return __extends(t, n), t.prototype.init = function() {
        CrossPlatformTools.sendIOSRequest("loadReward", ""), document.addEventListener("onAdClosed", function() {
            this.onAdClosed();
        }.bind(this));
    }, t.prototype.show_ad = function(t) {
        this.resumeCallback = t, CrossPlatformTools.sendIOSRequest("showReward", "");
    }, t.prototype.onAdFailLoadCallback = function() {
        this.isAdAvaible = !1;
    }, t.prototype.onAdReadyCallback = function() {
        this.isAdAvaible = !0;
    }, t.prototype.onAdClosedCallback = function() {
        this.videoControler.onContentResumed.dispatch(), this.resumeCallback && this.resumeCallback.apply(null), 
        AmazingGame.getInstance().sound.mute = !1, this.isAdAvaible = !1, CrossPlatformTools.sendIOSRequest("loadReward", "");
    }, t.prototype.onAdRewarded = function() {}, t;
}(VideoAdProvider), IOSVideoAdMob = function(n) {
    function t(t, e, i) {
        return n.call(this, t, e, i) || this;
    }
    return __extends(t, n), t.prototype.onAdRewarded = function() {
        throw new Error("Method not implemented.");
    }, t.prototype.init = function() {
        CrossPlatformTools.sendIOSRequest("loadVideo", ""), document.addEventListener("onAdClosed", function() {
            this.onAdClosed();
        }.bind(this));
    }, t.prototype.show_ad = function(t) {
        this.resumeCallback = t, CrossPlatformTools.sendIOSRequest("showVideo", "");
    }, t.prototype.onAdFailLoadCallback = function() {
        this.videoControler.onContentResumed.dispatch(), this.resumeCallback && this.resumeCallback.apply(null), 
        AmazingGame.getInstance().sound.mute = !1, this.isAdAvaible = !1, CrossPlatformTools.sendIOSRequest("loadVideo", "");
    }, t.prototype.onAdReadyCallback = function() {
        this.isAdAvaible = !0;
    }, t.prototype.onAdClosedCallback = function() {
        this.videoControler.onContentResumed.dispatch(), this.resumeCallback && this.resumeCallback.apply(null), 
        AmazingGame.getInstance().sound.mute = !1, this.isAdAvaible = !1, CrossPlatformTools.sendIOSRequest("loadVideo", "");
    }, t;
}(VideoAdProvider), UWPWebViewBanner = function(n) {
    function t(t, e) {
        var i = n.call(this, t, e) || this;
        return i.isVisble = !1, document.addEventListener("onAdFailLoad", function(t) {
            this.onAdFailLoad(t);
        }.bind(i)), i;
    }
    return __extends(t, n), t.prototype.show_ad = function(t, e, i) {
        void 0 === i && (i = void 0), this.adDetail = e, this.availbleSpace = t, this.createAdControl(e);
    }, t.prototype.createAdControl = function(t) {
        var e = this.availbleSpace.x, i = this.availbleSpace.y, n = window.devicePixelRatio;
        this.availbleSpace.x, this.availbleSpace.width, t.width, this.availbleSpace.y, this.availbleSpace.height, 
        t.height;
        e = this.availbleSpace.x / n + (this.availbleSpace.width - t.width * n) / 2 / n, 
        i = this.availbleSpace.y / n + (this.availbleSpace.height - t.height * n) / 2 / n, 
        e = Math.floor(e), i = Math.floor(i);
        var s = Math.floor(this.adDetail.width), o = Math.floor(this.adDetail.height);
        this.isVisble = !0, CrossPlatformTools.sendUWPRequest("showBanner", e + ";" + i + ";" + s + ";" + o);
    }, t.prototype.onAdFailLoadCallback = function() {
        AmazingGame.getInstance().amazingAdProvider.BannerController.show_amazing_ad_as_fallback(), 
        Utils.androidColoredLog("Android Banner: onAdFailLoad; Play crosspromo ads");
    }, t.prototype.get_dpi = function() {
        return AmazingGame.getInstance().device.pixelRatio;
    }, t.prototype.remove_ad_control = function() {
        try {
            CrossPlatformTools.sendUWPRequest("removeBanner", ""), this.isVisble = !1;
        } catch (t) {}
    }, t;
}(BannerAd), UWPWebViewInterstatial = function(n) {
    function t(t, e, i) {
        return n.call(this, t, e, i) || this;
    }
    return __extends(t, n), t.prototype.onAdRewarded = function() {
        throw new Error("Method not implemented.");
    }, t.prototype.init = function() {
        this.isAdAvaible = !1;
    }, t.prototype.show_ad = function(t) {
        this.resumeCallback = t, CrossPlatformTools.sendUWPRequest("showVideo", this.name);
    }, t.prototype.onAdFailLoadCallback = function() {
        this.isAdAvaible = !1;
    }, t.prototype.onAdReadyCallback = function() {
        this.isAdAvaible = !0;
    }, t.prototype.onAdClosedCallback = function() {
        this.videoControler.onContentResumed.dispatch(), this.resumeCallback.apply(null), 
        AmazingGame.getInstance().sound.mute = !1, this.isAdAvaible = !1, CrossPlatformTools.sendUWPRequest("loadvideo", this.name);
    }, t;
}(VideoAdProvider);

!function(t) {
    t[t.GoogleAdSense = 0] = "GoogleAdSense", t[t.LifeStreet = 1] = "LifeStreet", t[t.Facebook = 2] = "Facebook", 
    t[t.GoogleAdMob = 3] = "GoogleAdMob", t[t.GoogleAds = 4] = "GoogleAds", t[t.UWP = 5] = "UWP", 
    t[t.GameDistribution = 6] = "GameDistribution", t[t.AmazonMobile = 7] = "AmazonMobile", 
    t[t.GameMonetization = 8] = "GameMonetization";
}(AdType || (AdType = {}));

var WordGame, Direction, VideoController = function() {
    function t() {
        this.onContentResumed = new Phaser.Signal(), this.onContentPause = new Phaser.Signal(), 
        this.isAdPlaying = !1, this.lastPlayingAdTime = 0, this.VideoAds = [], this.RewardAds = [], 
        this.onContentResumed.add(function() {
            AmazingGame.getInstance().stopAdShowing();
        });
    }
    return t.prototype.add_videoAds = function(t) {
        void 0 !== t && (t.videoControler = this, (Constants.COMPILE_PLATFORM !== Platform.WEB || Constants.IS_GAME_DISTRIBUTION || Constants.IS_GAME_MONETIZATION || IS_AMAZING) && t.init(), 
        this.VideoAds.push(t));
    }, t.prototype.add_rewardAds = function(t, e) {
        void 0 === e && (e = !0), void 0 !== t && (t.videoControler = this, (Constants.COMPILE_PLATFORM !== Platform.WEB || Constants.IS_GAME_DISTRIBUTION || Constants.IS_GAME_MONETIZATION || IS_AMAZING) && e && t.init(), 
        this.RewardAds.push(t));
    }, t.prototype.show_ad = function(t) {
        RemoteConfig.PLAY_ADS && 0 < this.VideoAds.length && (this.lastPlayingAdTime = AmazingGame.getInstance().time.now, 
        Constants.COMPILE_PLATFORM === Platform.UWP && Constants.IS_UWP_WEBVIEW ? this.playAd(t, this.getNamedVideo("vungle")) : this.playAd(t, this.VideoAds[0]));
    }, t.prototype.playAd = function(t, e) {
        e.isAdAvaible ? (IS_AMAZING || AmazingGame.getInstance().prepare_ad_show(), e.show_ad(t)) : "vungle" === e.name && this.playMicrosoftBackfill(t);
    }, t.prototype.playMicrosoftBackfill = function(t) {
        this.playAd(t, this.getNamedVideo("microsoft"));
    }, t.prototype.show_reward_ad = function(t) {
        if (RemoteConfig.PLAY_ADS && 0 < this.RewardAds.length) {
            var e = this.RewardAds[0];
            e.isAdAvaible && (AmazingGame.getInstance().prepare_ad_show(), e.show_ad(t));
        }
    }, t.prototype.isAdAvaible = function() {
        for (var t = 0; t < this.VideoAds.length; t++) if (this.VideoAds[t].isAdAvaible) return !0;
        return !1;
    }, t.prototype.isRewardAvaible = function() {
        if (this.RewardAds && 0 < this.RewardAds.length) return this.RewardAds[0].isAdAvaible;
    }, t.prototype.getNamedVideo = function(t) {
        for (var e = 0; e < this.VideoAds.length; e++) if (this.VideoAds[e].name === t) return this.VideoAds[e];
    }, t.prototype.canPlayAdWithTimeBreak = function(t) {
        return 0 <= this.lastPlayingAdTime && AmazingGame.getInstance().time.now - this.lastPlayingAdTime >= t;
    }, t;
}(), InputPopUp = function() {
    function t() {
        var i = this;
        this.popUp = document.querySelector(".bg-modal");
        var n = this;
        this.profanityInfo = document.createElement("div"), this.profanityInfo.innerHTML = "Please use proper name.", 
        this.profanityInfo.style.fontSize = "18px", this.profanityInfo.style.color = "#F74300", 
        this.profanityInfo.style.marginTop = "10px", this.profanityInfo.style.display = "none", 
        document.getElementsByClassName("modal-contents")[0].insertBefore(this.profanityInfo, document.getElementsByClassName("buttons")[0]), 
        document.querySelector(".close").addEventListener("click", function() {
            n.popUp.style.display = "none", n.profanityInfo.style.display = "none", n.cancelCallback(), 
            document.removeEventListener("keydown", i.keyboardInput), AmazingGame.getInstance().on_resize();
        }), document.getElementById("btnOK").addEventListener("click", function() {
            try {
                var t = document.getElementById("name").value;
                if (ProfanityFilter.getInstance().isProfane(t)) n.profanityInfo.style.display = "block"; else {
                    n.profanityInfo.style.display = "none", n.popUp.style.display = "none";
                    var e = document.getElementById("name").value;
                    n.submitCallback(e), document.removeEventListener("keydown", i.keyboardInput), AmazingGame.getInstance().on_resize();
                }
            } catch (t) {}
        }), document.getElementById("btnCancel").addEventListener("click", function() {
            n.popUp.style.display = "none", n.profanityInfo.style.display = "none", n.cancelCallback(), 
            document.removeEventListener("keydown", i.keyboardInput), AmazingGame.getInstance().on_resize();
        });
    }
    return t.getInstance = function() {
        return this._instance || (this._instance = new t()), t._instance;
    }, t.prototype.keyboardInput = function(t) {
        13 === t.keyCode && (t.preventDefault(), document.getElementById("btnOK").click());
    }, t.prototype.show = function(t, e, i) {
        document.addEventListener("keydown", this.keyboardInput), this.cancelCallback = t, 
        this.submitCallback = e, this.popUp.style.display = "flex", document.getElementById("name").value = i;
    }, t;
}(), PausePopUp = function(e) {
    function t() {
        return null !== e && e.apply(this, arguments) || this;
    }
    return __extends(t, e), t.prototype.init = function() {
        e.prototype.init.call(this), this.showTween = !1, this.background.visible = !1, 
        this.showfade = !0, this.showBannerAd = !1;
    }, t.prototype.update = function() {
        if (this.game.input.activePointer.isDown && this.dialogParent.menu.showingMenu) {
            this.background.getBounds().contains(this.game.input.activePointer.x, this.game.input.activePointer.y) && this.game.input.activePointer.x > this.menuComponent.transitionOffset && (this.dialogParent.toogle_menu(null), 
            Constants.IS_POKI && PokiSDK.gameplayStart());
        }
        null != this.menuComponent && (this.centerX = this.game.width / 2 - this.menuComponent.transitionOffset / 2);
    }, t.prototype.on_resize = function() {
        e.prototype.on_resize.call(this), null != this.menuComponent && this.game.isLandscape;
    }, t.prototype.onButtonClick = function(t) {
        e.prototype.onButtonClick.call(this, t), 0 === t.type ? this.close() : 1 === t.type && (this.close(), 
        this.dialogParent.new_game());
    }, t.prototype.back_press = function() {
        this.dialogParent.toogle_menu(void 0);
    }, t;
}(PopUp), PromoPopUp = function(i) {
    function t() {
        var t = null !== i && i.apply(this, arguments) || this;
        return t.CLOSE_BUTTON = "close", t.requestAdPortrait = !1, t.requestAd2Landscape = !1, 
        t.portraitDownloaded = !1, t.landscapeDownloaded = !1, t.requestNewAd = !1, t;
    }
    return __extends(t, i), t.prototype.init = function() {
        var t;
        i.prototype.init.call(this), this.designWidth = 1920, this.designHeight = 1080, 
        this.promoImageLandscape = this.game.add.sprite(1, -16, "banner1"), this.promoImageLandscape.smoothed = !0, 
        this.promoImageLandscape.anchor.set(.5), this.addChild(this.promoImageLandscape), 
        this.promoImageLandscape.visible = !1, this.promoImageLandscape.inputEnabled = !0, 
        this.promoImageLandscape.events.onInputUp.add(function() {
            this.open_in_store();
        }, this), this.promoImagePortrait = this.game.add.sprite(1, 40, "banner1"), this.promoImagePortrait.smoothed = !0, 
        this.promoImagePortrait.anchor.set(.5), this.addChild(this.promoImagePortrait), 
        this.promoImagePortrait.visible = !1, this.promoImagePortrait.inputEnabled = !0, 
        this.promoImagePortrait.events.onInputUp.add(function() {
            this.open_in_store();
        }, this), this.dialog = this.game.add.image(0, 0, Images.DLG_PROMO_LANDSCAPE), this.dialog.anchor.set(.5), 
        this.addChild(this.dialog), this.installButton = new ScaleButton(this.game, 0, 400, Images.BTN_PLAY_LANDSCAPE, null, this.onButtonClick, this), 
        this.addChild(this.installButton), this.buttonStar = this.game.add.image(this.installButton.left, this.installButton.top, Images.PROMO_STAR), 
        this.buttonStar.anchor.set(.5), this.addChild(this.buttonStar), this.addChild(this.checkOther = this.add_promo_label(0, -410, this.game.translate("check_other"))), 
        this.closeButton = new ScaleButton(this.game, 600, -430, Images.CLOSE_PROMO, null, this.onButtonClick, this), 
        this.closeButton.smoothed = !0, this.closeButton.key = this.CLOSE_BUTTON, Utils.center_objects([ this.closeButton ]), 
        this.addChild(this.closeButton);
        var e = "";
        Constants.IS_MOBILE_COMPILE_VERSION ? Constants.COMPILE_PLATFORM === Platform.UWP ? (t = this.game.add.image(0, 0, Atlases.EXTRAS, _EXTRAS.windows), 
        e = this.game.translate("store_download_microsoft")) : Constants.COMPILE_PLATFORM === Platform.ANDROID ? (t = this.game.add.image(0, 0, Atlases.EXTRAS, _EXTRAS.google), 
        e = this.game.translate("store_download_android")) : Constants.COMPILE_PLATFORM === Platform.AMAZON ? (t = this.game.add.image(0, 0, Atlases.EXTRAS, _EXTRAS.google), 
        e = this.game.translate("store_download_android")) : Constants.COMPILE_PLATFORM === Platform.IOS && (t = this.game.add.image(0, 0, Atlases.EXTRAS, _EXTRAS.apple), 
        e = this.game.translate("store_download_ios")) : GlobalVars.Platform === Platform.WEB_ANDROID ? (t = this.game.add.image(0, 0, Atlases.EXTRAS, _EXTRAS.google), 
        e = this.game.translate("store_download_android")) : GlobalVars.Platform === Platform.WEB_IOS ? (t = this.game.add.image(0, 0, Atlases.EXTRAS, _EXTRAS.apple), 
        e = this.game.translate("store_download_ios")) : (t = this.game.add.image(0, 0, Atlases.EXTRAS, _EXTRAS.windows), 
        e = this.game.translate("store_download_microsoft")), this.installButton.add_label(e, {
            font: "bold 48px" + Fonts.HELVETICA,
            fill: "white",
            align: "left"
        }), this.installButton.label.position.set(-this.installButton.width / 2 + 15, 2), 
        this.installButton.label.anchor.set(0, .5), this.installButton.label.setShadow(0, 4, "#000000"), 
        this.installButton.addChild(t), t.anchor.set(.5, .5), t.scale.set(.85), t.position.set(this.installButton.width / 2 - 15 - t.width / 2, 0), 
        this.requestNewAd = !0, this.showInstallPrompt = !1;
    }, t.prototype.set_platform = function(t) {
        var e = this;
        this.landscapeDownloaded = !1, this.portraitDownloaded = !1, this.download_advertising("1920x1080", function(t) {
            e.landscapeBannerAd = t, e.setImage(e.promoImageLandscape, e.landscapeBannerAd), 
            e.landscapeDownloaded = !0, Utils.androidColoredLog("Promo landscape downloaded");
        }, function() {}), this.download_advertising("1080x1920", function(t) {
            e.portraitBannerAd = t, e.setImage(e.promoImagePortrait, e.portraitBannerAd), e.portraitDownloaded = !0, 
            Utils.androidColoredLog("Promo portrait downloaded");
        }, function() {});
    }, t.prototype.setImage = function(e, i) {
        AmazingGame.getInstance().cache.checkImageKey(i.sourceUrl) ? (Utils.androidColoredLog("%c Load Image from cache: " + i.sourceUrl), 
        e.loadTexture(i.sourceUrl)) : Utils.download_image_from_url(i.sourceUrl, i.sourceUrl, function(t) {
            e.loadTexture(t), Utils.androidColoredLog("%c Download fresh Image from ad server: " + i.sourceUrl);
        }.bind(this, i.sourceUrl));
    }, t.prototype.show = function() {
        i.prototype.show.call(this), this.buttonStar.position.set(this.installButton.left + 10, this.installButton.top + 10), 
        this.buttonStar.alpha = 0, this.buttonStar.visible = !1;
        this.game.add.tween(this.buttonStar).to({
            angle: 1080
        }, 2250, null, !0, 750);
        gameanalytics.GameAnalytics.addDesignEvent("promopopup:impression:" + AmazingGame.getInstance().amazingAdProvider.getDetailedString(this.getCurrentBanner())), 
        this.on_resize();
    }, t.prototype.refresh = function() {
        var t;
        this.game.isLandscape || this.game.currentScene.isPortraitLocked ? (this.dialog.loadTexture(Images.DLG_PROMO_LANDSCAPE), 
        this.installButton.loadTexture(Images.BTN_PLAY_LANDSCAPE), this.promoImageLandscape.scale.set(.625), 
        this.promoImageLandscape.visible = !0, this.promoImagePortrait.visible = !1, this.checkOther.position.set(0, -410), 
        this.closeButton.position.set(600, -430), this.installButton.position.set(0, 400), 
        (t = this.installButton.getChildAt(1)).position.set(this.installButton.width / 2 - 15 - t.width / 2, 0), 
        this.installButton.label.fontSize = 48 * AmazingGame.getInstance().ratio + "px", 
        this.installButton.label.scale.set(1 / AmazingGame.getInstance().ratio), this.installButton.label.position.set(-this.installButton.width / 2 + 15, 2)) : (this.dialog.loadTexture(Images.DLG_PROMO_PORTRAIT), 
        this.installButton.loadTexture(Images.BTN_PLAY_PORTRAIT), this.promoImagePortrait.scale.set(.88), 
        this.promoImageLandscape.visible = !1, this.promoImagePortrait.visible = !0, this.installButton.position.set(0, 808), 
        this.checkOther.position.set(0, -860), this.closeButton.position.set(460, -870), 
        (t = this.installButton.getChildAt(1)).position.set(this.installButton.width / 2 - 15 - t.width / 2, 0), 
        this.installButton.label.fontSize = 38 * AmazingGame.getInstance().ratio + "px", 
        this.installButton.label.scale.set(1 / AmazingGame.getInstance().ratio), this.installButton.label.position.set(-this.installButton.width / 2 + 15, 2));
    }, t.prototype.download_advertising = function(t, e, i) {
        this.game.amazingAd.initialized && this.game.amazingAd.get_ad(t, function(t) {
            e(t);
        }.bind(this), function() {});
    }, t.prototype.set_advertising = function() {
        this.game.device.iOS ? this.set_platform(Platform.IOS) : this.game.device.windowsPhone ? this.set_platform(Platform.UWP_MOBILE) : this.game.device.android ? this.set_platform(Platform.ANDROID) : this.set_platform(Platform.WEB);
    }, t.prototype.on_resize = function() {
        i.prototype.on_resize.call(this), this.refresh();
    }, t.prototype.onButtonClick = function(t) {
        i.prototype.onButtonClick.call(this, t), t.key === this.CLOSE_BUTTON ? this.getNewAds() : (this.getNewAds(), 
        this.open_in_store()), this.close();
    }, t.prototype.open_in_store = function() {
        this.showed && (this.game.amazingAdProvider.open_ad_depends_on_platform(this.getCurrentBanner().promoteUrl), 
        gameanalytics.GameAnalytics.addDesignEvent("promopopup:click:" + AmazingGame.getInstance().amazingAdProvider.getDetailedString(this.getCurrentBanner())), 
        this.close());
    }, t.prototype.back_press = function() {
        this.getNewAds(), this.close();
    }, t.prototype.add_label = function(t, e, i, n, s) {
        void 0 === n && (n = 40), void 0 === s && (s = "white");
        var o = this.game.add.text(t, e, i, {
            font: n + "px Trebuchet MS",
            fill: s
        });
        return o.anchor.set(.5), o.align = "center", o.smoothed = !0, this.addChild(o), 
        o;
    }, t.prototype.independent_Update = function() {
        this.game.amazingAd.initialized && this.requestNewAd && (this.set_advertising(), 
        this.requestNewAd = !1);
    }, t.prototype.add_promo_label = function(t, e, i) {
        var n = AmazingGame.getInstance().device.pixelRatio, s = "bold " + 56 * n + "px" + Fonts.HELVETICA, o = this.game.add.text(t, e, i, {
            font: s,
            fill: "white",
            align: "left"
        });
        o.smoothed = !0, o.anchor.set(.5, .5), o.align = "center";
        var a = o.context.createLinearGradient(0, 0, 0, o.height);
        return a.addColorStop(0, "#ECF0BD"), a.addColorStop(1, "#FCBE2D"), o.fill = a, o.stroke = "#813A0E", 
        o.strokeThickness = 8, o.scale.set(1 / n), o;
    }, t.prototype.getCurrentBanner = function() {
        return this.game.isLandscape ? this.landscapeBannerAd : this.portraitBannerAd;
    }, t.prototype.getNewAds = function() {
        this.requestNewAd = !0, this.landscapeDownloaded = !1, this.portraitDownloaded = !1;
    }, t.prototype.canShow = function() {
        return this.landscapeDownloaded && this.portraitDownloaded;
    }, t;
}(PopUp), AmazingConsole = function() {
    function i() {}
    return i.Initialize = function() {
        var e = console.log;
        document.getElementById("log");
        console.log = function() {
            for (var t = 0; t < arguments.length; t++) "object" == typeof arguments[t] ? i.consoleList.push((JSON && JSON.stringify ? JSON.stringify(arguments[t], void 0, 2) : arguments[t]) + "<br />") : i.consoleList.push(arguments[t] + "<br />");
            e.apply(console, arguments);
        };
    }, i.Save = function() {
        var t = document.getElementById("linkID"), e = JSON.stringify(i.consoleList);
        t.href = "data:text/plain;base64," + i.b64EncodeUnicode(e), t.download = "console_" + new Date().toISOString() + ".txt", 
        t.click();
    }, i.b64EncodeUnicode = function(t) {
        return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g, function(t, e) {
            return String.fromCharCode(parseInt(e, 16));
        }));
    }, i.attachVorlon = function() {
        window.addScript("http://amazinghedgehog.com:1337/vorlon.js", Date.now(), function() {
            Utils.androidColoredLog("Attach Verlon Console");
        });
    }, i.consoleList = [], i;
}(), AmazingIntPoint = function() {
    function i(t, e) {
        void 0 === t && (t = 0), void 0 === e && (e = 0), this.x = t, this.y = e;
    }
    return Object.defineProperty(i.prototype, "x", {
        get: function() {
            return this._x;
        },
        set: function(t) {
            this._x = Math.floor(t);
        },
        enumerable: !0,
        configurable: !0
    }), Object.defineProperty(i.prototype, "y", {
        get: function() {
            return this._y;
        },
        set: function(t) {
            this._y = Math.floor(t);
        },
        enumerable: !0,
        configurable: !0
    }), i.add = function(t, e) {
        return new i(t.x + e.x, t.y + e.y);
    }, i.subtract = function(t, e) {
        return new i(t.x - e.x, t.y - e.y);
    }, i.abs = function(t) {
        return new i(Math.abs(t.x), Math.abs(t.y));
    }, i.prototype.equals = function(t) {
        return this.x === t.x && this.y === t.y;
    }, i.prototype.add = function(t) {
        return i.add(this, t);
    }, i.prototype.subtract = function(t) {
        return i.subtract(this, t);
    }, i.prototype.abs = function() {
        return i.abs(this);
    }, i.prototype.getHash = function() {
        return this.x + "x" + this.y;
    }, i.createFromPlain = function(t) {
        var e = new i();
        return e.x = t._x, e.y = t._y, e;
    }, i;
}(), AmazingIntPoint3d = function() {
    function i(t, e, i) {
        void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), this.x = t, 
        this.y = e, this.z = i;
    }
    return Object.defineProperty(i.prototype, "x", {
        get: function() {
            return this._x;
        },
        set: function(t) {
            this._x = Math.floor(t);
        },
        enumerable: !0,
        configurable: !0
    }), Object.defineProperty(i.prototype, "y", {
        get: function() {
            return this._y;
        },
        set: function(t) {
            this._y = Math.floor(t);
        },
        enumerable: !0,
        configurable: !0
    }), Object.defineProperty(i.prototype, "z", {
        get: function() {
            return this._y;
        },
        set: function(t) {
            this._z = Math.floor(t);
        },
        enumerable: !0,
        configurable: !0
    }), i.add = function(t, e) {
        return new i(t.x + e.x, t.y + e.y, t.z + e.z);
    }, i.subtract = function(t, e) {
        return new i(t.x - e.x, t.y - e.y, t.z - e.z);
    }, i.abs = function(t) {
        return new i(Math.abs(t.x), Math.abs(t.y), Math.abs(t.z));
    }, i.prototype.equals = function(t) {
        return this.x === t.x && this.y === t.y && this.z === t.z;
    }, i.prototype.add = function(t) {
        return i.add(this, t);
    }, i.prototype.subtract = function(t) {
        return i.subtract(this, t);
    }, i.prototype.abs = function() {
        return i.abs(this);
    }, i.prototype.getHash = function() {
        return this.x + "x" + this.y + "x" + this.z;
    }, i;
}(), AmazingSet = function() {
    function t() {
        for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
        if (this.data = [], null != t && null != t) if (t instanceof Array) for (var i = 0; i < t.length; i++) this.add(t[i]); else this.add(t);
    }
    return t.prototype.add = function(t) {
        this.has(t) || this.data.push(t);
    }, t.prototype.has = function(t) {
        return 0 <= this.data.indexOf(t);
    }, t.prototype.remove = function(t) {
        var e = this.data.indexOf(t);
        0 <= e && this.data.splice(e);
    }, t.prototype.clear = function() {
        this.data = [];
    }, Object.defineProperty(t.prototype, "size", {
        get: function() {
            return this.data.length;
        },
        enumerable: !0,
        configurable: !0
    }), t.prototype.get = function(t) {
        return t < 0 || t >= this.size ? null : this.data[t];
    }, t;
}(), GeometricUtils = function() {
    function t() {}
    return t.rectanglesIntersects = function(t, e) {
        return Phaser.Rectangle.intersects(new Phaser.Rectangle(t.x, t.y, t.width, t.height), new Phaser.Rectangle(e.x, e.y, e.width, e.height));
    }, t.getLocalPosition = function(t, e) {
        var i = new Phaser.Point(), n = t.worldTransform, s = 1 / (n.a * n.d + n.c * -n.b);
        return i.setTo(n.d * s * e.x + -n.c * s * e.y + (n.ty * n.c - n.tx * n.d) * s, n.a * s * e.y + -n.b * s * e.x + (-n.ty * n.a + n.tx * n.b) * s);
    }, t;
}(), GridHelper = function() {
    function n() {}
    return n.getRowsCount = function(t) {
        return t[0].length;
    }, n.getColsCount = function(t) {
        return t.length;
    }, n.getRowElements = function(t, e) {
        for (var i = [], n = 0; n < e.length; n++) i.push(e[n][t]);
        return i;
    }, n.getColElements = function(t, e) {
        return e[t];
    }, n.isInsideBounds = function(t, e) {
        return !(e.x < 0 || e.y < 0) && (!(e.x >= t.length) && !(e.y >= t[e.x].length));
    }, n.isInsideBoundsXY = function(t, e, i) {
        return !(e < 0 || i < 0) && (!(e >= t.length) && !(i >= t[e].length));
    }, n.isColInsideBounds = function(t, e) {
        return !(e < 0) && !(e >= t.length);
    }, n.isRowInsideBounds = function(t, e) {
        return !(e < 0) && !(e >= t[0].length);
    }, n.findAbove = function(t, e) {
        for (var i = t.y - 1; 0 <= i; i--) if (null != e[t.x][i]) return e[t.x][i];
        return null;
    }, n.isColumnEmpty = function(t, e) {
        for (var i = 0; i < e[t].length; i++) if (null != e[t][i] || null != e[t][i]) return !1;
        return !0;
    }, n.isRowEmpty = function(t, e) {
        for (var i = 0; i < e.length; i++) if (null != e[i][t] || null != e[i][t]) return !1;
        return !0;
    }, n.isColumnFull = function(t, e) {
        for (var i = 0; i < e[t].length; i++) if (null == e[t][i] || null == e[t][i]) return !1;
        return !0;
    }, n.isRowFull = function(t, e) {
        for (var i = 0; i < e.length; i++) if (null == e[i][t] || null == e[i][t]) return !1;
        return !0;
    }, n.countFullRows = function(t) {
        for (var e = 0, i = 0; i < n.getRowsCount(t); i++) n.isRowFull(i, t) && e++;
        return e;
    }, n.countFullCols = function(t) {
        for (var e = 0, i = 0; i < n.getColsCount(t); i++) n.isColumnFull(i, t) && e++;
        return e;
    }, n.getFullRowsIndex = function(t) {
        for (var e = [], i = 0; i < n.getRowsCount(t); i++) n.isRowFull(i, t) && e.push(i);
        return e;
    }, n.getFullColsIndex = function(t) {
        for (var e = [], i = 0; i < n.getColsCount(t); i++) n.isColumnFull(i, t) && e.push(i);
        return e;
    }, n.isRightSideEmpty = function(t, e) {
        for (var i = t + 1; i < e.length; i++) for (var n = 0; n < e[i].length; n++) if (null != e[i][n] || null != e[i][n]) return !1;
        return !0;
    }, n.isLeftSideEmpty = function(t, e) {
        for (var i = t - 1; 0 <= i; i--) for (var n = 0; n < e[i].length; n++) if (null != e[i][n] || null != e[i][n]) return !1;
        return !0;
    }, n.getNextRightSideNotEmptyColumnIndex = function(t, e) {
        for (var i = t + 1; i < e.length; i++) for (var n = 0; n < e[i].length; n++) if (null != e[i][n] || null != e[i][n]) return i;
        return -1;
    }, n.getNextLeftSideNotEmptyColumnIndex = function(t, e) {
        for (var i = t - 1; 0 <= i; i--) for (var n = 0; n < e[i].length; n++) if (null != e[i][n] || null != e[i][n]) return i;
        return -1;
    }, n.isGridEmpty = function(t) {
        for (var e = 0; e < t.length; e++) for (var i = 0; i < t[e].length; i++) if (null != t[e][i] || null != t[e][i]) return !1;
        return !0;
    }, n.countNotEmpty = function(t) {
        for (var e = 0, i = 0; i < t.length; i++) for (var n = 0; n < t[i].length; n++) null == t[i][n] && null == t[i][n] || e++;
        return e;
    }, n.initEmptyGrid = function(t, e) {
        var i = [];
        i = [];
        for (var n = 0; n < t; n++) {
            i.push([]);
            for (var s = 0; s < e; s++) i[n].push(null);
        }
        return i;
    }, n.rotateClockwise90 = function(t) {
        for (var e = this.initEmptyGrid(t[0].length, t.length), i = 0; i < t.length; i++) for (var n = 0; n < t[i].length; n++) e[t[i].length - n - 1][i] = t[i][n];
        return e;
    }, n.rotateClockwise180 = function(t) {
        for (var e = this.initEmptyGrid(t.length, t[0].length), i = 0; i < t.length; i++) for (var n = 0; n < t[i].length; n++) e[t.length - i - 1][t[i].length - n - 1] = t[i][n];
        return e;
    }, n.rotateClockwise270 = function(t) {
        for (var e = this.initEmptyGrid(t[0].length, t.length), i = 0; i < t.length; i++) for (var n = 0; n < t[i].length; n++) e[t[i].length - n - 1][t.length - i - 1] = t[i][n];
        return e;
    }, n.mirrorVertically = function(t) {
        for (var e = this.initEmptyGrid(t.length, t[0].length), i = 0; i < t.length; i++) for (var n = 0; n < t[i].length; n++) e[t.length - i - 1][n] = t[i][n];
        return e;
    }, n.mirrorHorizontally = function(t) {
        for (var e = this.initEmptyGrid(t.length, t[0].length), i = 0; i < t.length; i++) for (var n = 0; n < t[i].length; n++) e[i][t[i].length - n - 1] = t[i][n];
        return e;
    }, n.isNeighborhood = function(t, e) {
        return !(t.x !== e.x + 1 && t.x !== e.x - 1 || t.y !== e.y + 1 && t.y !== e.y - 1);
    }, n;
}(), GroupObjectPool = function(n) {
    function s(t, e) {
        var i = n.call(this, t, t.world, e) || this;
        return i.game = t, s.ObjectPoolList.push(i), i;
    }
    return __extends(s, n), s.prototype.add_object_to_pool = function(t) {
        this.add(t), t.visible = !1, t.kill();
    }, s.prototype.count_live = function() {
        return this.children.length;
    }, s.prototype.destroy = function() {
        for (var t = 0; t < this.children.length; t++) this.children[t].destroy();
    }, s.prototype.create = function(t, e, i) {
        this.children.length <= 3 && gameanalytics.GameAnalytics.addErrorEvent(gameanalytics.EGAErrorSeverity.Warning, "OBJECT_POOL " + this.getInfo());
        var n = this.getFirstDead(!0);
        return n.position.set(t, e), n.alpha = 1, n.visible = !0, n.scale.set(1), n.angle = 0, 
        n;
    }, s.prototype.getInfo = function() {
        return this.name + " Free: " + this.count_live() + " Total: ";
    }, s.ObjectPoolList = [], s;
}(Phaser.Group), HashChain = function() {
    function t() {
        this.chain = [];
    }
    return t.prototype.push = function(t) {
        if (null != t && null != t) {
            for (var e = 0; e < this.chain.length; e++) if (t.getHash() === this.chain[e].getHash()) return;
            this.chain.push(t);
        }
    }, t.prototype.pushMany = function(t) {
        var e, i;
        try {
            for (var n = __values(t), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                this.push(o);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.toArray = function() {
        return this.chain;
    }, t.prototype.contains = function(t) {
        var e, i;
        try {
            for (var n = __values(this.chain), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                if (t.getHash() === o.getHash()) return !0;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return !1;
    }, t.prototype.length = function() {
        return this.chain.length;
    }, t;
}(), HashKeyedCollection = function() {
    function t() {
        this._items = {}, this._count = 0;
    }
    return t.prototype.containsKey = function(t) {
        return this._items.hasOwnProperty(t.getHash());
    }, t.prototype.count = function() {
        return this._count;
    }, t.prototype.add = function(t, e) {
        this._items.hasOwnProperty(t.getHash()) || (this._count++, this._items[t.getHash()] = new Pair(t, e));
    }, t.prototype.set = function(t, e) {
        this._items.hasOwnProperty(t.getHash()) && (this._items[t.getHash()] = new Pair(t, e));
    }, t.prototype.remove = function(t) {
        var e = this._items[t.getHash()];
        return delete this._items[t.getHash()], this._count--, e.second;
    }, t.prototype.item = function(t) {
        return this._items[t.getHash()].second;
    }, t.prototype.keys = function() {
        var t = [];
        for (var e in this._items) this._items.hasOwnProperty(e) && t.push(this._items[e].first);
        return t;
    }, t.prototype.values = function() {
        var t = [];
        for (var e in this._items) this._items.hasOwnProperty(e) && t.push(this._items[e].second);
        return t;
    }, t;
}(), HttpUtils = function() {
    function t() {}
    return t.download_url = function(t, e) {
        var i = new XMLHttpRequest();
        i.onreadystatechange = function() {
            4 === i.readyState && e(i.responseText);
        }, i.open("GET", t, !0), i.timeout = 2e3, i.send();
    }, t.request = function(t, e, i) {
        var n = new XMLHttpRequest();
        n.onreadystatechange = function() {
            4 === n.readyState && 200 == n.status && i(n.responseText);
        }, n.open("POST", t, !0), n.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        try {
            var s = "";
            for (var o in e) e.hasOwnProperty(o) && (s += o + "=" + e[o] + "&");
            n.send(s);
        } catch (t) {}
    }, t.get = function(t, e) {
        var i = new XMLHttpRequest();
        i.onreadystatechange = function() {
            4 === i.readyState && 200 == i.status && e(i.responseText);
        }, i.open("GET", t, !0);
        try {
            i.send();
        } catch (t) {}
    }, t.post = function(t, e, i) {
        var n = new XMLHttpRequest();
        n.open("POST", t, !0), n.setRequestHeader("Content-type", "application/json"), n.onreadystatechange = function() {
            4 === n.readyState && 200 == n.status && i(n.responseText);
        };
        try {
            var s = JSON.stringify(e);
            n.send(s);
        } catch (t) {}
    }, t.postScreenshot = function(t, e, i) {
        var n = new XMLHttpRequest();
        n.onreadystatechange = function() {
            4 === n.readyState && 200 == n.status && i(n.responseText);
        }, n.open("POST", t, !0), n.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        try {
            var s = JSON.stringify(e);
            n.send(s);
        } catch (t) {}
    }, t.parseQueryString = function(t) {
        t || (t = window.location.search.substring(1));
        var s = {};
        return t.split("&").forEach(function(t) {
            var e = t.split("="), i = decodeURIComponent(e[0]), n = decodeURIComponent(1 < e.length ? e[1] : "");
            s[i] = n;
        }), s;
    }, t;
}(), IdentifyingChain = function() {
    function t() {
        this.chain = [];
    }
    return t.prototype.push = function(t) {
        if (null != t && null != t) {
            for (var e = 0; e < this.chain.length; e++) if (t.id === this.chain[e].id) return;
            this.chain.push(t);
        }
    }, t.prototype.pushMany = function(t) {
        var e, i;
        try {
            for (var n = __values(t), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                this.push(o);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.toArray = function() {
        return this.chain;
    }, t.prototype.contains = function(t) {
        var e, i;
        try {
            for (var n = __values(this.chain), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                if (t.id === o.id) return !0;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return !1;
    }, t.prototype.length = function() {
        return this.chain.length;
    }, t;
}(), NumberComparator = function() {
    function t() {}
    return t.prototype.compare = function(t, e) {
        return t === e ? 0 : 0 < t - e ? 1 : -1;
    }, t;
}(), ObjectPool = function(n) {
    function s(t, e) {
        var i = n.call(this, t, t.world, e) || this;
        return i.game = t, s.ObjectPoolList.push(i), i;
    }
    return __extends(s, n), s.prototype.add_object_to_pool = function(t) {
        this.add(t), t.visible = !1, t.inputEnabled = !1, t.kill();
    }, s.prototype.count_live = function() {
        return this.children.length;
    }, s.prototype.destroy = function() {
        for (var t = 0; t < this.children.length; t++) this.children[t].destroy();
    }, s.prototype.create = function(t, e, i) {
        this.children.length <= 3 && gameanalytics.GameAnalytics.addErrorEvent(gameanalytics.EGAErrorSeverity.Warning, "OBJECT_POOL " + this.getInfo());
        var n = this.getFirstDead(!0);
        return n.reset(t, e, 0), n.position.set(t, e), n.alpha = 1, n.visible = !0, n.scale.set(1), 
        n.angle = 0, n;
    }, s.prototype.getInfo = function() {
        return this.name + " Free: " + this.count_live() + " Total: ";
    }, s.ObjectPoolList = [], s;
}(Phaser.SpriteBatch), Pair = function() {
    function t(t, e) {
        this.first = t, this.second = e;
    }
    return t.prototype.equals = function(t) {
        return this.first === t.first && this.second === t.second;
    }, t;
}(), ParticleTimedEmmiter = function(n) {
    function t(t, e) {
        var i = n.call(this, t) || this;
        return i.posX = 0, i.posY = 0, i.offsetX = 0, i.offsetY = 0, i.playEvery = .1, i.playEveryTimer = 0, 
        i.tint = 16777215, i.stopPlaying = !1, i.debugPos = void 0, i.emmitName = e, i;
    }
    return __extends(t, n), t.prototype.setConfig = function(t) {
        this.config = t;
    }, t.prototype.update = function() {
        return this.stopPlaying ? 0 === this.alive && (this.enabled = !0, this.paused = !0) : (this.playEveryTimer += this.game.time.elapsed / 1e3, 
        this.fallowFor && (this.posX = this.fallowFor.position.x + this.offsetX, this.posY = this.fallowFor.position.y + this.offsetY), 
        this.playEveryTimer >= this.playEvery && (this.playEveryTimer = 0, this.playParticles())), 
        null != this.debugPos && this.debug(this.debugPos.x, this.debugPos.y), n.prototype.update.call(this);
    }, t.prototype.playParticles = function() {
        var e, t, i = this.emit(this.emmitName, this.posX, this.posY, this.config), n = Phaser.Color.hexToRGBArray(this.tint);
        if (i) try {
            for (var s = __values(i), o = s.next(); !o.done; o = s.next()) {
                o.value.color.setColor(n[0] * Utils.randomInt(200, 255), n[1] * Utils.randomInt(200, 255), n[2] * Utils.randomInt(200, 255), 1);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (t = s.return) && t.call(s);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t;
}(Phaser.ParticleStorm.Emitter), SnapManager = function() {
    function t() {}
    return t.snapToCenter = function(t, e, i) {
        return void 0 === i && (i = 1), new Phaser.Point(AmazingGame.getInstance().width / 2 / i + t, AmazingGame.getInstance().height / 2 / i + e);
    }, t.snapTop = function(t) {
        return t - AmazingGame.getInstance().borderHeight / AmazingGame.getInstance().ratio;
    }, t.snapBottom = function(t) {
        return t + AmazingGame.getInstance().borderHeight / AmazingGame.getInstance().ratio;
    }, t.snapLeft = function(t) {
        return t - AmazingGame.getInstance().borderWidth / AmazingGame.getInstance().ratio;
    }, t.snapRight = function(t) {
        return t + AmazingGame.getInstance().borderWidth / AmazingGame.getInstance().ratio;
    }, t.snapCenterX = function(t) {
        return AmazingGame.getInstance().width / 2 / AmazingGame.getInstance().ratio + t;
    }, t.getBorderWidth = function() {
        return AmazingGame.getInstance().borderWidth / AmazingGame.getInstance().ratio;
    }, t.getBorderHeight = function() {
        return AmazingGame.getInstance().borderHeight / AmazingGame.getInstance().ratio;
    }, t;
}(), SpriteUtils = function() {
    function t() {}
    return t.create_centered_sprite = function(t, e, i) {
        var n = AmazingGame.getInstance().add.sprite(0, 0, i);
        return n.anchor.set(.5), n;
    }, t.create_rectangle = function(t, e, i, n, s) {
        void 0 === s && (s = 1);
        var o = t.make.graphics(0, 0);
        o.beginFill(n, s).drawRect(0, 0, e, i).endFill();
        var a = o.generateTexture();
        return o.destroy(!0), a;
    }, t.create_round_rectangle = function(t, e, i, n, s, o) {
        void 0 === s && (s = 1), void 0 === o && (o = 15);
        var a = t.make.graphics(0, 0);
        a.beginFill(n, s).drawRoundedRect(0, 0, e, i, o).endFill();
        var r = a.generateTexture();
        return a.destroy(!0), r;
    }, t.create_circle = function(t, e, i, n) {
        void 0 === n && (n = 1);
        var s = t.make.graphics(0, 0);
        s.beginFill(i, n).drawCircle(0, 0, e).endFill();
        var o = s.generateTexture();
        return s.destroy(!0), o;
    }, t.create_sprite_from_texture = function(t, e, i) {
        var n = AmazingGame.getInstance().add.sprite(t, e);
        return n.setTexture(i), n.anchor.set(.5), n;
    }, t.get_frame_name = function(t) {
        var e = t.split("/");
        return e[e.length - 1] + ".png";
    }, t.load_on_request = function(t, e, i) {
        AmazingGame.getInstance().load.reset();
        for (var n = 0; n < t.length; n++) AmazingGame.getInstance().load.image(t[n], e[n]);
        AmazingGame.getInstance().load.onLoadComplete.add(i), AmazingGame.getInstance().load.start();
    }, t.load_atlass_on_request = function(t, e, i, n) {
        AmazingGame.getInstance().load.reset();
        for (var s = 0; s < t.length; s++) AmazingGame.getInstance().load.atlas(t[s], e[s], i[s]);
        AmazingGame.getInstance().load.onLoadComplete.add(n), AmazingGame.getInstance().load.start();
    }, t;
}(), StringKeyedCollection = function() {
    function t() {
        this._items = {}, this._count = 0;
    }
    return t.prototype.containsKey = function(t) {
        return this._items.hasOwnProperty(t);
    }, t.prototype.count = function() {
        return this._count;
    }, t.prototype.add = function(t, e) {
        this._items.hasOwnProperty(t) || (this._count++, this._items[t] = e);
    }, t.prototype.set = function(t, e) {
        this._items.hasOwnProperty(t) && (this._items[t] = e);
    }, t.prototype.remove = function(t) {
        var e = this._items[t];
        return delete this._items[t], this._count--, e;
    }, t.prototype.item = function(t) {
        return this._items[t];
    }, t.prototype.keys = function() {
        var t = [];
        for (var e in this._items) this._items.hasOwnProperty(e) && t.push(e);
        return t;
    }, t.prototype.values = function() {
        var t = [];
        for (var e in this._items) this._items.hasOwnProperty(e) && t.push(this._items[e]);
        return t;
    }, t;
}(), StringUtils = function() {
    function i() {}
    return i.toCamelCase = function(t) {
        return t.replace(/[^A-Za-z0-9]/g, " ").replace(/^\w|[A-Z]|\b\w|\s+/g, function(t, e) {
            return 0 == +t || "-" === t || "." === t ? "" : 0 === e ? t.toLowerCase() : t.toUpperCase();
        });
    }, i.toPascalCase = function(t) {
        var e = i.toCamelCase(t);
        return e[0].toUpperCase() + e.substr(1);
    }, i.changeWordColorInSentance = function(t, e) {
        var i = t.indexOf("<c>"), n = t.indexOf("</c>");
        return new Trio(i - 1, n - 3, e);
    }, i.clearFromColors = function(t) {
        return t = (t = t.replace("<c>", "")).replace("</c>", "");
    }, i;
}(), Trio = function() {
    function t(t, e, i) {
        this.first = t, this.second = e, this.third = i;
    }
    return t.prototype.equals = function(t) {
        return this.first === t.first && this.second === t.second && this.third === t.third;
    }, t;
}(), TypedEvent = function() {
    var i = this;
    this.listeners = [], this.listenersOncer = [], this.on = function(t) {
        return i.listeners.push(t), {
            dispose: function() {
                return i.off(t);
            }
        };
    }, this.once = function(t) {
        i.listenersOncer.push(t);
    }, this.off = function(t) {
        var e = i.listeners.indexOf(t);
        -1 < e && i.listeners.splice(e, 1);
    }, this.emit = function(e) {
        if (i.listeners.forEach(function(t) {
            return t(e);
        }), 0 < i.listenersOncer.length) {
            var t = i.listenersOncer;
            i.listenersOncer = [], t.forEach(function(t) {
                return t(e);
            });
        }
    }, this.pipe = function(e) {
        return i.on(function(t) {
            return e.emit(t);
        });
    };
}, Utils = function() {
    function i() {}
    return i.createCenteredImage = function(t, e, i, n, s, o) {
        void 0 === s && (s = void 0), void 0 === o && (o = 1);
        var a = AmazingGame.getInstance().add.image(t, e, i, n);
        return a.anchor.set(.5), a.scale.set(o), null != s && (a.tint = s), a;
    }, i.center_image = function(t) {
        return t.anchor.set(.5), t;
    }, i.center_objects = function(t) {
        for (var e = 0; e < t.length; e++) t[e].anchor.set(.5);
    }, i.round_position = function(t) {
        t.position.x = Math.round(t.position.x + .5), t.position.y = Math.round(t.position.y + .5);
    }, i.make_font_fit = function(t, e, i) {
        for (var n; t.width > e || t.height > i; ) {
            if ((n = parseInt(t.fontSize.toString().replace("px", ""), 10) - 1) < 10) {
                n = 10, t.fontSize = n;
                break;
            }
            t.fontSize = n;
        }
    }, i.RGBtoHEX = function(t, e, i) {
        return t << 16 | e << 8 | i;
    }, i.download_image_from_url = function(t, e, i, n) {
        void 0 === n && (n = void 0);
        var s = {
            type: "image",
            key: e,
            url: t,
            data: null,
            error: !1,
            loaded: !1
        };
        return s.data = new Image(), s.data.name = s.key, s.data.onload = function() {
            s.loaded = !0, AmazingGame.getInstance().cache.addImage(s.key, s.url, s.data), i("params");
        }.bind(this), s.data.onerror = function() {
            s.error = !0, n && n();
        }, s.data.crossOrigin = "", s.data.src = s.url, s;
    }, i.loadResource = function(t, e, i) {
        AmazingGame.getInstance().load.text(t, e + "?v=" + Constants.APP_VERSION), AmazingGame.getInstance().load.start(), 
        AmazingGame.getInstance().load.onLoadComplete.addOnce(function() {
            i && i();
        });
    }, i.loadResourceImage = function(t, e, i) {
        AmazingGame.getInstance().load.image(t, e + "?v=" + Constants.APP_VERSION), AmazingGame.getInstance().load.start(), 
        AmazingGame.getInstance().load.onLoadComplete.addOnce(function() {
            i && i();
        });
    }, i.secondsToTimeFormat = function(t) {
        var e = new Date(null);
        return e.setSeconds(t), e.toISOString().substr(14, 5);
    }, i.translate_dialog_coordinates = function(t, e) {
        return new Phaser.Point(i.translate_dialog_X(t), i.translate_dialog_Y(e));
    }, i.translate_dialog_X = function(t) {
        return t - Constants.WIDTH / 2;
    }, i.translate_dialog_Y = function(t) {
        return t - Constants.HEIGHT / 2;
    }, i.translate_dialog_X_portrait = function(t) {
        return t - Constants.HEIGHT / 2;
    }, i.translate_dialog_Y_portrait = function(t) {
        return t - Constants.WIDTH / 2;
    }, i.switch_input = function(t, e) {
        for (var i in t) if (t.hasOwnProperty(i) && t[i].children) for (var n = 0; n < t[i].children.length; n++) t[i].children[n] instanceof ScaleButton && (t[i].children[n].inputEnabled = e);
    }, i.brings_button_to_top = function(t) {
        for (var e in t) if (t.hasOwnProperty(e)) for (var i = 0; i < t[e].children.length; i++) t[e].children[i] instanceof ScaleButton && (t[e].children[i].bringToTop(), 
        AmazingGame.getInstance().world.bringToTop(t[e].children[i]));
    }, i.crop_font_size = function(t) {
        for (var e = 9999, i = 0; i < t.length; i++) t[i].fontSize < e && (e = t[i].fontSize);
        for (i = 0; i < t.length; i++) t[i].fontSize = e;
    }, i.randomInt = function(t, e) {
        return Math.floor(Math.random() * (e - t + 1)) + t;
    }, i.randomLetter = function() {
        return i.LETTERS.charAt(Math.floor(Math.random() * i.LETTERS.length));
    }, i.androidColoredLog = function(t, e) {
        void 0 === e && (e = "green");
    }, i.tweenTint = function(t, s, o, a, e, i, n) {
        void 0 === i && (i = 0), void 0 === n && (n = !1);
        var r = {
            step: 0
        }, h = t.add.tween(r).to({
            step: 100
        }, e, Phaser.Easing.Linear.None, !1, 0, i, n);
        h.onUpdateCallback(function() {
            var e, t;
            s.tint = Phaser.Color.interpolateColor(o, a, 100, r.step, 1);
            try {
                for (var i = __values(s.children), n = i.next(); !n.done; n = i.next()) {
                    n.value.tint = s.tint;
                }
            } catch (t) {
                e = {
                    error: t
                };
            } finally {
                try {
                    n && !n.done && (t = i.return) && t.call(i);
                } finally {
                    if (e) throw e.error;
                }
            }
        }), s.tint = o, h.start();
    }, i.shuffleArray = function(t) {
        for (var e = t.length - 1; 0 < e; e--) {
            var i = Math.floor(Math.random() * (e + 1)), n = t[e];
            t[e] = t[i], t[i] = n;
        }
        return t;
    }, i.arrayMax = function(t) {
        return t.reduce(function(t, e) {
            return Math.max(t, e);
        });
    }, i.arrayMin = function(t) {
        return t.reduce(function(t, e) {
            return Math.min(t, e);
        });
    }, i.getChildAsName = function(t, e) {
        var i = 0, n = t.children, s = null;
        for (i = 0; i < n.length; i += 1) if (n[i].name === e) {
            s = n[i];
            break;
        }
        return s;
    }, i.getDaysDifference = function(t) {
        if (null == t) return 1e3;
        var e = new Date(t), i = new Date();
        return Math.floor((Date.UTC(i.getFullYear(), i.getMonth(), i.getDate()) - Date.UTC(e.getFullYear(), e.getMonth(), e.getDate())) / 864e5);
    }, i.LETTERS = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz", i;
}(), DEBUG = !1;

!function(t) {
    var e = function() {
        this.APP_VERSION = "1.0.0", this.PLATFORM = Platform.WEB, this.GD = !1, this.POKI = !1, 
        this.UWP_WEBVIEW = !1, this.GM = !1, this.GD = !1, this.GM = !1, this.UWP_WEBVIEW = !1;
    };
    t.CFG = e;
    var i = function(i) {
        function n() {
            var e = this;
            GlobalVars.AccentColor = "#002D5A", GlobalVars.TransitionColor = "#FFFFFF";
            var t = {
                width: Constants.WIDTH,
                height: Constants.HEIGHT,
                renderer: Phaser.WEBGL,
                parent: "content",
                resolution: 1,
                enableDebug: Constants.IS_DEBUG,
                transparent: !0,
                multiTexture: !0,
                antialias: !0,
                physicsConfig: null,
                preserveDrawingBuffer: !0,
                forceSetTimeOut: !1,
                backgroundColor: GlobalVars.AccentColor,
                state: null
            };
            return n.CFG.PLATFORM === Platform.ANDROID && (t.mspointer = !1), e = i.call(this, t) || this, 
            AmazingConsole.Initialize(), e.clearBeforeRender = !0, Phaser.Device.whenReady(function() {
                e.stage.disableVisibilityChange = !0;
                var t = e.device.desktop ? "click" : "touchstart";
                document.getElementById("content").addEventListener(t, function(t) {
                    e.gameResumed(t);
                });
            }), Constants.GAME_NAME = Strings.GAME_NAME, Constants.APP_VERSION = n.CFG.APP_VERSION, 
            Constants.COMPILE_PLATFORM = n.CFG.PLATFORM, Constants.IS_GAME_DISTRIBUTION = n.CFG.GD, 
            Constants.IS_GAME_MONETIZATION = n.CFG.GM, Constants.IS_UWP_WEBVIEW = n.CFG.UWP_WEBVIEW, 
            Constants.IS_POKI = n.CFG.POKI, Constants.IS_POKI = !0, RemoteConfig.fetch(), Constants.PORTRAIT_LOCKED = !0, 
            Constants.ADS_TESTING = !1, Constants.PLAY_ADS = !0, Constants.PLAY_BANNER_ADS = !0, 
            Constants.PLAY_CROSS_PROMOTION = !0, Constants.LANDSCAPE_LOCKED = !1, Constants.USE_ANALYTICS = !0, 
            Constants.GAME_KEY = "e903c23977405643cf122bb2b7abffec", Constants.GAME_SECRET = "3e6361ec1de9f028efa98d54c65b7200ea802c01", 
            Constants.GOOGLE_ANALYTICS = "UA-102496985-9", (DISABLE_ADS_PROMO_INSTALL_FOR_LICENSE || Constants.IS_POKI) && (Constants.PLAY_ADS = !1, 
            Constants.PLAY_BANNER_ADS = !1, Constants.PLAY_CROSS_PROMOTION = !1, Constants.SHOW_INSTALL_PROMPT = !1, 
            Constants.USE_ADS_FRAMEWORK = !1, Constants.PLAY_BANNER_CROSS_PROMO = !1), Constants.ADS_TESTING || (Constants.ANDROID_MOBILE_APP_ID = "ca-app-pub-9003877865320415~6216217542", 
            Constants.ANDROID_ADMOB_INTERSATIAL = "ca-app-pub-9003877865320415/3945277422", 
            Constants.ANDROID_ADMOB_BANNER = "ca-app-pub-9003877865320415/5449930789", Constants.ANDROID_ADMOB_REWARDED = "ca-app-pub-9003877865320415/4246846555", 
            Constants.IOS_MOBILE_APP_ID = "ca-app-pub-9003877865320415~1156103183", Constants.IOS_ADMOB_INTERSATIAL = "ca-app-pub-9003877865320415/7146796461", 
            Constants.IOS_ADMOB_REWARDED = "ca-app-pub-9003877865320415/3913020351", Constants.IOS_ADMOB_BANNER = "ca-app-pub-9003877865320415/9964531493", 
            Constants.UWP_BANNER_APPLICATION_ID = "9nnbjqrb715j", Constants.UWP_BANNER_ADD_UNIT_ID = "1100054653", 
            Constants.UWP_VIDEO_APPLICATION_ID = "9nnbjqrb715j", Constants.UWP_VIDEO_ADD_UNIT_ID = "1100054654", 
            Constants.GAME_DISTRIBUTION_ID = "5fbc550071dc4d648c23557a02436da3", Constants.USER_DISTRIBUTION_ID = "5fbc550071dc4d648c23557a02436da3"), 
            Constants.GOOGLE_AD_SENSE_KEY = "https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dlinear&correlator=", 
            RemoteConfig.ASK_REVIEW_PER_GAME_SESSION = 4, RemoteConfig.SHOW_PROMO_DIALOG = 6, 
            RemoteConfig.SHOW_PROMO_DIALOG_WEB = 3, e.addScene("boot", new Boot()), e.addScene("preloader", new Preloader()), 
            e.addScene("mainmenu", new MainMenu()), e.addScene("gamescene", new GameScene()), 
            Constants.IS_POKI ? e.InitializePOKI() : e.runScene(Boot.Name), e;
        }
        return __extends(n, i), n.prototype.InitializePOKI = function() {
            var t = this;
            PokiSDK.init().then(function() {
                t.runScene(Boot.Name);
            }).catch(function() {
                t.runScene(Boot.Name);
            }), -1 < window.location.href.indexOf("localhost") && PokiSDK.setDebug(!0);
            var e, i, n = [ "top", "indexOf", "aHR0cHM6Ly9wb2tpLmNvbS9zaXRlbG9jaw==", "hostname", "length", "location", "LnBva2ktZ2RuLmNvbQ==", "href" ];
            e = n, i = 430, function(t) {
                for (;--t; ) e.push(e.shift());
            }(++i);
            var r = function(t) {
                return n[t -= 0];
            };
            !function() {
                /*
                for (var t = [ "bG9jYWxob3N0", "LnBva2kuY29t", r("0x0") ], e = !1, i = window[r("0x7")][r("0x5")], n = 0; n < t[r("0x6")]; n++) {
                    var s = atob(t[n]);
                    if (-1 !== i[r("0x3")](s, i.length - s.length)) {
                        e = !0;
                        break;
                    }
                }
                if (!e) {
                    var o = r("0x4"), a = atob(o);
                    window.location[r("0x1")] = a, window[r("0x2")][r("0x7")] !== window[r("0x7")] && (window[r("0x2")][r("0x7")] = window[r("0x7")]);
                }*/
            }();
        }, n.prototype.save_settings = function() {
            GameSettings.getInstance().save();
        }, n.prototype.load_settings = function() {
            GameSettings.getInstance().load();
        }, n.prototype.enablePWA = function() {}, n.CFG = new e(), n;
    }(AmazingGame);
    t.Game = i;
}(WordGame || (WordGame = {})), window.onbeforeunload = function(t) {
    GameSettings.getInstance().save();
}, function(t) {
    t[t.center = 0] = "center", t[t.top = 1] = "top", t[t.bottom = 2] = "bottom", t[t.left = 4] = "left", 
    t[t.right = 8] = "right", t[t.topLeft = 5] = "topLeft", t[t.topRight = 9] = "topRight", 
    t[t.bottomLeft = 6] = "bottomLeft", t[t.bottomRight = 10] = "bottomRight";
}(Direction || (Direction = {}));

var BoardState, BoardUtils = function() {
    function i() {}
    return i.getDirection = function(t) {
        var e = i.getAngle(t);
        return e < 22.5 ? Direction.right : e < 67.5 ? Direction.bottomRight : e < 112.5 ? Direction.bottom : e < 157.5 ? Direction.bottomLeft : e < 202.5 ? Direction.left : e < 247.5 ? Direction.topLeft : e < 292.5 ? Direction.top : e < 337.5 ? Direction.topRight : Direction.right;
    }, i.directionValue = function(t) {
        var e = new Phaser.Point(0, 0);
        return t !== Direction.right && t !== Direction.topRight && t !== Direction.bottomRight || (e.x = 1), 
        t !== Direction.left && t !== Direction.topLeft && t !== Direction.bottomLeft || (e.x = -1), 
        t !== Direction.top && t !== Direction.topRight && t !== Direction.topLeft || (e.y = -1), 
        t !== Direction.bottom && t !== Direction.bottomLeft && t !== Direction.bottomRight || (e.y = 1), 
        Phaser.Point.normalize(e);
    }, i.absoluteDirection = function(t) {
        var e = new Phaser.Point(0, 0);
        return (t & Direction.right) != Direction.center ? e.x = 1 : (t & Direction.left) != Direction.center && (e.x = -1), 
        (t & Direction.top) != Direction.center ? e.y = -1 : (t & Direction.bottom) != Direction.center && (e.y = 1), 
        t == Direction.center ? new Phaser.Point(1, 0) : e;
    }, i.dot = function(t, e) {
        return t.x * e.x + t.y * e.y;
    }, i.getAngle = function(t) {
        var e = 57.29578 * Math.atan2(t.y, t.x);
        return e < 0 && (e += 360), e;
    }, i;
}(), BannerLayoutController = function() {
    function t(t) {
        this.refreshAdTimer = 0, this.gameScene = t, this.game = this.gameScene.game;
    }
    return t.prototype.showBanner = function() {
        if (Constants.PLAY_BANNER_ADS && !Constants.IS_POKI) {
            var t = this.getBannerAreaWithAdDetails();
            Constants.COMPILE_PLATFORM === Platform.ANDROID && this.gameScene.game.isLandscape ? this.game.amazingAdProvider.BannerController.showAd(t, !0) : this.game.amazingAdProvider.BannerController.showAd(t, !1);
        }
    }, t.prototype.getBannerAreaWithAdDetails = function() {
        AmazingGame.getInstance().device.pixelRatio;
        var t = [];
        if (this.gameScene.game.isLandscape) {
            n = this.gameScene.gameLayer.right * AmazingGame.getInstance().ratio + AmazingGame.getInstance().borderWidth + 35, 
            s = this.gameScene.gameLayer.bottom * AmazingGame.getInstance().ratio + +AmazingGame.getInstance().borderHeight + 35, 
            o = this.game.height - s;
            o = this.game.height - s, (i = new AdDetail(0, s, this.game.width, o)).snap = SnapAd.Bottom, 
            s = this.gameScene.gameLayer.top * AmazingGame.getInstance().ratio + AmazingGame.getInstance().borderHeight + 35;
            var e = new AdDetail(n, s, this.game.width - n, this.game.height - s - o);
            n = 0, o = this.game.height - s;
            new AdDetail(n, s, this.gameScene.gameLayer.left * AmazingGame.getInstance().ratio + AmazingGame.getInstance().borderWidth, o);
            t.push(new Pair(e, [ LARGE_FLAG_BANNER, RECT_BANNER, FLAG_BANNER ])), t.push(new Pair(i, [ HUGE_BANNER, SMALL_BANNER ]));
        } else {
            this.gameScene.ballsLayer;
            var i, n = this.gameScene.gameLayer.right * AmazingGame.getInstance().ratio + AmazingGame.getInstance().borderWidth, s = this.gameScene.gameLayer.bottom * AmazingGame.getInstance().ratio + +AmazingGame.getInstance().borderHeight, o = this.game.height - s;
            o = this.game.height - s, (i = new AdDetail(0, s, this.game.width, o)).snap = SnapAd.Bottom, 
            Constants.COMPILE_PLATFORM === Platform.ANDROID || Constants.COMPILE_PLATFORM === Platform.IOS ? t.push(new Pair(i, [ HUGE_BANNER, SMALL_BANNER ])) : t.push(new Pair(i, [ BILLBOARD, HUGE_BANNER, MEDIUM_BANNER, SMALL_BANNER ]));
        }
        return t;
    }, t.prototype.setupIOSBanners = function() {}, t.prototype.setupAndroidBanners = function() {}, 
    t.prototype.setupUWPBanners = function() {}, t.prototype.setupWebBanners = function() {}, 
    t.prototype.reset = function() {
        this.game.amazingAdProvider.remove_banner(), this.refreshAdTimer = 0;
    }, t.prototype.update = function() {
        null != this.gameScene.activeDialog || this.game.isGamePaused || this.game.isTransitioning() || Constants.PLAY_BANNER_CROSS_PROMO && (this.refreshAdTimer += this.game.time.elapsedMS / 1e3, 
        2 <= this.refreshAdTimer && (this.game.amazingAdProvider.BannerController.showingAd ? this.gameScene.menu.isOpened || this.gameScene.menu.isShowed || this.game.amazingAdProvider.BannerController.update() : this.gameScene.menu.isOpened || this.gameScene.menu.isShowed || this.game.amazingAdProvider.VideoController && this.game.amazingAdProvider.VideoController.isAdPlaying || this.showBanner(), 
        this.refreshAdTimer = 0));
    }, t.prototype.renderDebug = function() {}, t;
}();

!function(t) {
    t[t.Idle = 0] = "Idle", t[t.Removing = 1] = "Removing", t[t.Move = 2] = "Move";
}(BoardState || (BoardState = {}));

var WordDirection, BoardController = function() {
    function t(t) {
        this.BALL_SIZE = 130, this.state = BoardState.Idle, this.isTouchDown = !1, this.gameScene = t;
    }
    return t.prototype.initialize = function(t, e) {
        this.ballsMap = {}, this.width = t, this.height = e, this.recarculateBallsSize();
        for (var i = this.gameScene.gameLogic, n = 0; n < i.width; n++) for (var s = 0; s < i.height; s++) {
            var o = i.grid[n][s];
            null != o && null != o && (this.ballsMap.hasOwnProperty(o.id), this.ballsMap[o.id] = this.createBall(n, s, !1, i.grid[n][s]));
        }
        this.state = BoardState.Idle;
    }, t.prototype.spawnNewBubbles = function(t) {
        var e, i;
        try {
            for (var n = __values(t), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                null != o && null != o && (this.ballsMap[o.id] = this.createBall(o.position.x, o.position.y, !1, o), 
                this.ballsMap[o.id].initEffect(this.getScale()), this.ballsMap[o.id].moveFromTopWithoutDelay());
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.restoreBoardFromSaveState = function() {
        for (var t in this.ballsMap) {
            var e = this.ballsMap[t];
            e.scale.set(1), e.alpha = 1, e.x = this.getPositionX(e.bubble.position.x) + this.BALL_SIZE / 2, 
            e.y = this.getPositionY(e.bubble.position.y) + this.BALL_SIZE / 2;
        }
    }, t.prototype.processTouchDown = function(t, e) {
        if (this.allBubblesAreIdle() && this.state === BoardState.Idle) {
            var i = this.gameScene.gameLayer.toLocal(new Phaser.Point(t, e), this.gameScene.world), n = this.getGridPositionX(i.x), s = this.getGridPositionY(i.y);
            if (GridHelper.isInsideBounds(this.gameScene.gameLogic.grid, new AmazingIntPoint(n, s))) {
                this.isTouchDown = !0;
                var o = this.gameScene.gameLogic, a = new AmazingIntPoint(n, s);
                if (GameSettings.getInstance().applicationData.tutorialInProgress && !this.gameScene.tutorialController.canSelectBall(n, s)) return;
                if (o.canSelect(a) && o.select(a)) {
                    var r = o.grid[n][s];
                    this.ballsMap[r.id].selectEffect(), this.gameScene.selectionController.addSelection(this.ballsMap[r.id]), 
                    this.gameScene.gameScreenFrameController.setColor(BallView.GetTintForBall(this.ballsMap[r.id])), 
                    this.gameScene.gameScreenFrameController.setSelectedBubbles(o.currentSelection.length), 
                    AudioManager.getInstance().play_effect("sounds/pop1", .8);
                }
            }
        }
    }, t.prototype.processTouchMove = function(t, e) {
        if (this.isTouchDown) {
            if (this.allBubblesAreIdle()) {
                var i = this.gameScene.gameLayer.toLocal(new Phaser.Point(t, e), this.gameScene.world), n = this.getGridPositionX(i.x), s = this.getGridPositionY(i.y);
                if (GridHelper.isInsideBounds(this.gameScene.gameLogic.grid, new AmazingIntPoint(n, s))) {
                    var o = this.gameScene.gameLogic, a = new AmazingIntPoint(n, s), r = o.grid[n][s];
                    AmazingGame.getInstance().ratio, AmazingGame.getInstance().borderWidth, AmazingGame.getInstance().borderHeight;
                    if (this.gameScene.selectionController.updateLineDrawing(i.x, i.y), GameSettings.getInstance().applicationData.tutorialInProgress && !this.gameScene.tutorialController.canSelectBall(a.x, a.y)) return;
                    if (o.canSelect(a)) {
                        if (o.select(a)) {
                            this.ballsMap[r.id].selectEffect(o.selectionToBubbleArray().length), this.gameScene.selectionController.addSelection(this.ballsMap[r.id]), 
                            this.gameScene.gameScreenFrameController.setSelectedBubbles(o.currentSelection.length), 
                            5 === o.currentSelection.length && o.currentSelection[0].equals(o.currentSelection[4]) && (this.gameScene.gameScreenFrameController.setSelectedBubbles(20), 
                            this.gameScene.gameScreenFrameController.setBombFrame(), AudioManager.getInstance().play_effect(Sounds.BOMB_SPAWN, .7));
                            var h = Phaser.Math.clamp(o.currentSelection.length, 1, 7);
                            AudioManager.getInstance().play_effect("sounds/pop" + h, .7);
                        }
                    } else 2 <= o.currentSelection.length && a.equals(o.currentSelection[o.currentSelection.length - 2]) && (o.unselectLast(), 
                    this.gameScene.selectionController.removeLastSelection(), this.gameScene.gameScreenFrameController.setSelectedBubblesFromUnselect(o.currentSelection.length));
                }
            }
        } else {
            i = this.gameScene.gameLayer.toLocal(new Phaser.Point(t, e), this.gameScene.world), 
            n = this.getGridPositionX(i.x), s = this.getGridPositionY(i.y);
            if (GridHelper.isInsideBounds(this.gameScene.gameLogic.grid, new AmazingIntPoint(n, s))) {
                o = this.gameScene.gameLogic, a = new AmazingIntPoint(n, s), r = o.grid[n][s];
                var l = this.ballsMap[r.id];
                this.lastHovered !== l && (this.lastHovered = l, this.lastHovered && this.lastHovered.hoverEffect());
            }
        }
    }, t.prototype.processTouchUp = function(t, e) {
        if (this.isTouchDown) {
            this.isTouchDown = !1;
            var i = this.gameScene.gameLogic;
            if (GameSettings.getInstance().applicationData.tutorialInProgress && !this.gameScene.tutorialController.canDoTutorialMove(i.selectionToBubbleArray())) return this.gameScene.selectionController.clear(), 
            this.gameScene.gameScreenFrameController.reset(), void i.cleanSelection();
            this.executionResult = i.executeSelection(), this.executionResult && (this.processExecutionResult(this.executionResult), 
            this.gameScene.game.time.events.add(100, function() {
                AudioManager.getInstance().play_effect(Sounds.REMOVE_BUBBLES, .7);
            }), GameSettings.getInstance().applicationData.tutorialInProgress && this.gameScene.tutorialController.finishStep()), 
            this.gameScene.selectionController.clear(), this.gameScene.gameScreenFrameController.reset();
        }
    }, t.prototype.isBoardBounds = function(t, e) {
        return 0 <= t && t < this.width && 0 <= e && e < this.height;
    }, t.prototype.createBall = function(t, e, i, n) {
        void 0 === i && (i = !0);
        var s = this.gameScene.addBallToBoard();
        return s.init(this.getPositionX(n.position.x) + this.BALL_SIZE / 2, this.getPositionY(n.position.y) + this.BALL_SIZE / 2, n), 
        s;
    }, t.prototype.getPositionX = function(t) {
        var e = this.gameScene.boardPositionLeft;
        return t * this.BALL_SIZE + e - this.BALL_SIZE / 2;
    }, t.prototype.getPositionY = function(t) {
        var e = this.gameScene.boardPositionTop;
        return t * this.BALL_SIZE + e - this.BALL_SIZE / 2;
    }, t.prototype.getGridPositionX = function(t) {
        var e = this.BALL_SIZE, i = (this.gameScene.boardPositionLeft, AmazingGame.getInstance().ratio, 
        AmazingGame.getInstance().borderWidth);
        i = this.gameScene.gameLayer.toLocal(new Phaser.Point(t, 0), this.gameScene.world).x;
        this.gameScene.gameLayer.position.x;
        return Math.floor((t + this.BALL_SIZE / 2) / e);
    }, t.prototype.getGridPositionY = function(t) {
        var e = this.BALL_SIZE, i = (this.gameScene.world.toGlobal(new PIXI.Point(0, t)).y, 
        230 * AmazingGame.getInstance().ratio + AmazingGame.getInstance().borderHeight);
        this.gameScene.gameLayer.position.y;
        return Math.floor((t + this.BALL_SIZE / 2) / e);
    }, t.prototype.playInitAnimation = function() {
        for (var t in this.ballsMap) this.ballsMap[t].initEffect(this.getScale()), this.ballsMap[t].enterEffectMoveFromTop();
    }, t.prototype.moveBalls = function() {
        var e, t;
        this.setState(BoardState.Move), this.refreshBallsBombCounters();
        for (var i = [], n = 0; n < this.executionResult.movedBubbles.length; n++) for (var s = 0; s < this.executionResult.movedBubbles[n].length; s++) i.push(this.executionResult.movedBubbles[n][s]);
        try {
            for (var o = __values(i), a = o.next(); !a.done; a = o.next()) {
                var r = a.value, h = this.getPositionX(r.position.x) + this.BALL_SIZE / 2, l = this.getPositionY(r.position.y) + this.BALL_SIZE / 2;
                this.ballsMap[r.id].moveTo(h, l, 0, BallView.FALLING_TIME / 2);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (t = o.return) && t.call(o);
            } finally {
                if (e) throw e.error;
            }
        }
        this.spawnNewBubbles(this.executionResult.newBubbles);
    }, t.prototype.getRandomBalls = function() {
        for (var t = [], e = 0; e < this.gameScene.gameLogic.grid.length; e++) for (var i = 0; i < this.gameScene.gameLogic.grid[e].length; i++) this.gameScene.game.rnd.realInRange(0, 1) < .1 && this.ballsMap[this.gameScene.gameLogic.grid[e][i].id] && t.push(this.ballsMap[this.gameScene.gameLogic.grid[e][i].id]);
        return t;
    }, t.prototype.highlightSquareBombBubbles = function() {
        var e, t, i = this.getRandomBalls();
        try {
            for (var n = __values(i), s = n.next(); !s.done; s = n.next()) {
                s.value.selectEffect();
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (t = n.return) && t.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.removeBombBubbles = function(t) {
        for (var e = 0; e < t.length; e++) {
            var i = this.ballsMap[t[e].id];
            i && !i.isPowerUp() && (this.ballsMap[t[e].id].removeEffect(375, !0), delete this.ballsMap[t[e].id]);
        }
    }, t.prototype.removeFromMap = function(t) {
        for (var e = 0; e < t.length; e++) {
            this.ballsMap[t[e].id] && delete this.ballsMap[t[e].id];
        }
    }, t.prototype.removeAsNormal = function(n, s) {
        void 0 === s && (s = !1);
        for (var t = function(t) {
            var e = o.ballsMap[n[t].id];
            if (e && (!e.isPowerUp() || e.isWildcard())) {
                var i = o.ballsMap[n[t].id];
                o.gameScene.game.time.events.add(50 * t, function() {
                    i.removeEffect(0, !1, s);
                }), delete o.ballsMap[n[t].id];
            }
        }, o = this, e = 0; e < n.length; e++) t(e);
    }, t.prototype.checkArrayContainsBonus = function(t, e) {
        var i, n;
        try {
            for (var s = __values(e.keys()), o = s.next(); !o.done; o = s.next()) {
                var a = o.value;
                if (this.checkListContainsPowerUp(t, e.get(a))) return !0;
            }
        } catch (t) {
            i = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (n = s.return) && n.call(s);
            } finally {
                if (i) throw i.error;
            }
        }
        return !1;
    }, t.prototype.checkListContainsPowerUp = function(t, e) {
        return !!e.next && (e.powerup.id === t.id || this.checkListContainsPowerUp(t, e.next));
    }, t.prototype.populateNextPowerUpBubbles = function(t) {
        var e, i;
        if (t.children) try {
            for (var n = __values(t.children), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                o.bubble.powerup && o.bubble.powerup != BUBBLE_WILD_CARD && this.nextBubbleNodes.push(o);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.fireBonus = function(t) {
        var e = t.bubble;
        e && (e.powerup === POWERUP_REMOVE_COLOR ? this.executeBombPowerUp(t, this.executionResult, this.isSpawnedPowerUp(this.executionResult, t)) : e.powerup === POWERUP_HORIZONTAL_LINE ? this.executeHorizontalPowerUp(t, this.executionResult, this.isSpawnedPowerUp(this.executionResult, t)) : e.powerup === POWERUP_VERTICAL_LINE ? this.executeVerticalPowerUp(t, this.executionResult, this.isSpawnedPowerUp(this.executionResult, t)) : -1 === e.powerup ? this.executeWilrdcardlPowerUp(t, this.executionResult) : e.powerup === POWERUP_BOMB && this.executeCountedBomb(t, this.executionResult));
    }, t.prototype.startFireBonuses = function(t) {
        var e, i, n = this;
        this.nextBubbleNodes = [];
        try {
            for (var s = __values(t), o = s.next(); !o.done; o = s.next()) {
                var a = o.value;
                this.populateNextPowerUpBubbles(a), this.fireBonus(a);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (i = s.return) && i.call(s);
            } finally {
                if (e) throw e.error;
            }
        }
        this.canRemoveNextBonuses() && this.gameScene.game.time.events.add(350, function(t) {
            return n.startFireNextBonuses();
        }, this);
    }, t.prototype.startFireNextBonuses = function() {
        this.startFireBonuses(this.nextBubbleNodes), this.setState(BoardState.Removing);
    }, t.prototype.processExecutionResult = function(t) {
        if (0 < t.firedPowerups.length) {
            var e = this.executionResult.removedBubbles.filter(function(t) {
                return t.isSelected && !t.powerup;
            });
            this.showScoreForBubble(e[e.length - 1], this.gameScene.gameLogic.getPointsForSelection(t)), 
            this.startFireBonuses(t.firedPowerups), this.removeAsNormal(this.executionResult.removedBubbles.filter(function(t) {
                return t.isSelected && 0 === t.powerup;
            }));
        } else this.showScoreForBubble(t.removedBubbles[t.removedBubbles.length - 1], this.gameScene.gameLogic.getPointsForSelection(t)), 
        this.removeAsNormal(this.executionResult.removedBubbles);
        this.setState(BoardState.Removing);
    }, t.prototype.showScoreForBubble = function(t, e) {
        if (t && this.ballsMap.hasOwnProperty(t.id)) {
            var i = this.ballsMap[t.id];
            0 < e && this.gameScene.showScore(e, i.position.x, i.position.y, BallView.GetTintForBall(i), i.bubble.value === BUBBLE_WILD_CARD);
        }
    }, t.prototype.executeBombPowerUp = function(t, e, i) {
        var n, s;
        if (this.ballsMap.hasOwnProperty(t.bubble.id)) {
            var o = this.ballsMap[t.bubble.id];
            if (i) for (var a = 0; a < e.selectedBubbles.length - 1; a++) {
                var r = this.ballsMap[e.selectedBubbles[a].id];
                r.isPowerUp() && !r.isWildcard() || r.moveToPowerUp(o.x, o.y, 150, 350);
            }
            o.changeToBombPowerUp(!0);
            var h = [];
            try {
                for (var l = __values(t.children), c = l.next(); !c.done; c = l.next()) {
                    var u = c.value;
                    u.bubble.powerup && u.bubble.powerup !== BUBBLE_WILD_CARD || h.push(u.bubble);
                }
            } catch (t) {
                n = {
                    error: t
                };
            } finally {
                try {
                    c && !c.done && (s = l.return) && s.call(l);
                } finally {
                    if (n) throw n.error;
                }
            }
            var d = this.getBubbleViewArrayFromDicionary(h);
            this.showScoreForBubble(t.bubble, this.gameScene.gameLogic.getPointsForPowerup(t.bubble, e)), 
            AudioManager.getInstance().play_effect(Sounds.COLOR_REMOVE, .7), o.fireBombEffect(d), 
            this.removeBombBubbles(h), this.removeFromMap([ t.bubble ]);
        }
    }, t.prototype.executeHorizontalPowerUp = function(e, t, i) {
        var n, s;
        if (this.ballsMap.hasOwnProperty(e.bubble.id)) {
            AudioManager.getInstance().play_effect(Sounds.HORIZONTAL, .7), this.gameScene.game.time.events.add(400, function() {
                AudioManager.getInstance().play_effect(Sounds.HORIZONTAL, .7);
            });
            var o = this.ballsMap[e.bubble.id];
            if (i) for (var a = 0; a < t.selectedBubbles.length - 1; a++) {
                var r = this.ballsMap[t.selectedBubbles[a].id];
                r && (r.isPowerUp() && !r.isWildcard() || r.moveToPowerUp(o.x, o.y, 150, 350));
            }
            o.changeToHorizontalPowerUp(!0);
            var h = [];
            try {
                for (var l = __values(e.children), c = l.next(); !c.done; c = l.next()) {
                    var u = c.value;
                    u.bubble.powerup && u.bubble.powerup !== BUBBLE_WILD_CARD || h.push(u.bubble);
                }
            } catch (t) {
                n = {
                    error: t
                };
            } finally {
                try {
                    c && !c.done && (s = l.return) && s.call(l);
                } finally {
                    if (n) throw n.error;
                }
            }
            this.showScoreForBubble(e.bubble, this.gameScene.gameLogic.getPointsForPowerup(e.bubble, t)), 
            this.removeBombBubbles(h), this.executionResult.spawnedPowerups.find(function(t) {
                return t.id === e.bubble.id;
            }) || this.removeFromMap([ e.bubble ]);
        }
    }, t.prototype.executeVerticalPowerUp = function(e, t, i) {
        var n, s;
        if (this.ballsMap.hasOwnProperty(e.bubble.id)) {
            AudioManager.getInstance().play_effect(Sounds.HORIZONTAL, .7), this.gameScene.game.time.events.add(400, function() {
                AudioManager.getInstance().play_effect(Sounds.HORIZONTAL, .7);
            });
            var o = this.ballsMap[e.bubble.id];
            if (i) for (var a = 0; a < t.selectedBubbles.length - 1; a++) {
                var r = this.ballsMap[t.selectedBubbles[a].id];
                r && (r.isPowerUp() && !r.isWildcard() || r.moveToPowerUp(o.x, o.y, 150, 500));
            }
            o.changeToVerticalPowerUp(!0);
            var h = [];
            try {
                for (var l = __values(e.children), c = l.next(); !c.done; c = l.next()) {
                    var u = c.value;
                    u.bubble.powerup && u.bubble.powerup !== BUBBLE_WILD_CARD || h.push(u.bubble);
                }
            } catch (t) {
                n = {
                    error: t
                };
            } finally {
                try {
                    c && !c.done && (s = l.return) && s.call(l);
                } finally {
                    if (n) throw n.error;
                }
            }
            this.showScoreForBubble(e.bubble, this.gameScene.gameLogic.getPointsForPowerup(e.bubble, t)), 
            this.removeBombBubbles(h), this.executionResult.spawnedPowerups.find(function(t) {
                return t.id === e.bubble.id;
            }) || this.removeFromMap([ e.bubble ]);
        }
    }, t.prototype.executeWilrdcardlPowerUp = function(e, t) {
        var i, n;
        if (this.ballsMap.hasOwnProperty(e.bubble.id)) {
            AudioManager.getInstance().play_effect(Sounds.WILDCARD_SELECTION, .7), this.ballsMap[e.bubble.id].changeToWildcardPowerUp(!0);
            var s = [];
            try {
                for (var o = __values(e.children), a = o.next(); !a.done; a = o.next()) {
                    var r = a.value;
                    r.bubble.powerup && r.bubble.powerup !== BUBBLE_WILD_CARD || s.push(r.bubble);
                }
            } catch (t) {
                i = {
                    error: t
                };
            } finally {
                try {
                    a && !a.done && (n = o.return) && n.call(o);
                } finally {
                    if (i) throw i.error;
                }
            }
            this.removeAsNormal(this.executionResult.removedBubbles, !0), this.executionResult.spawnedPowerups.find(function(t) {
                return t.id === e.bubble.id;
            }) || this.removeFromMap([ e.bubble ]);
        }
    }, t.prototype.executeCountedBomb = function(t, e) {
        (AudioManager.getInstance().play_effect(Sounds.BOMB, .7), this.ballsMap.hasOwnProperty(t.bubble.id)) && (this.showScoreForBubble(t.bubble, this.gameScene.gameLogic.getPointsForBomb(t.bubble)), 
        this.ballsMap[t.bubble.id].fireCounterBomb(), this.removeFromMap([ t.bubble ]));
    }, t.prototype.getBubbleViewArrayFromDicionary = function(t) {
        var e, i, n = [], s = function(e) {
            t.some(function(t) {
                return t.id === e;
            }) && n.push(o.ballsMap[e]);
        }, o = this;
        try {
            for (var a = __values(Object.keys(this.ballsMap)), r = a.next(); !r.done; r = a.next()) {
                s(r.value);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                r && !r.done && (i = a.return) && i.call(a);
            } finally {
                if (e) throw e.error;
            }
        }
        return n;
    }, t.prototype.isSpawnedPowerUp = function(t, e) {
        return 0 < t.spawnedPowerups.filter(function(t) {
            return t.id === e.bubble.id;
        }).length;
    }, t.prototype.getSpawnedPowerUp = function(t) {
        if (0 < t.spawnedPowerups.length && 0 !== t.spawnedPowerups[0].powerup) return t.spawnedPowerups[0];
    }, t.prototype.checkIsLinePowerUp = function(t) {
        return 4 <= t.length;
    }, t.prototype.gameOver = function() {
        var e, t, i = [], n = {};
        for (var s in this.ballsMap) {
            (o = this.ballsMap[s]).isBomb() && 0 === CountersHelper.getCurrentCounter(o.bubble.id) && (i.push(o), 
            n[o.bubble.id] = []);
        }
        for (var s in this.ballsMap) {
            var o;
            if ((o = this.ballsMap[s]).isBomb()) o.bombGameOverEffect(); else {
                var a = Utils.randomInt(0, i.length - 1);
                i[a].bubble && n[i[a].bubble.id].push(o);
            }
        }
        try {
            for (var r = __values(i), h = r.next(); !h.done; h = r.next()) {
                s = h.value;
                this.ballsMap[s.bubble.id].fireGameOverEffect(Utils.shuffleArray(n[s.bubble.id]));
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                h && !h.done && (t = r.return) && t.call(r);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.refreshBallsBombCounters = function() {
        for (var t in this.ballsMap) this.ballsMap[t].refreshBomb();
    }, t.prototype.removeAllBalls = function() {
        for (var t in this.ballsMap) this.ballsMap[t].remove(), delete this.ballsMap[t];
        this.ballsMap = {};
    }, t.prototype.allBubblesAreIdle = function() {
        for (var t = 0; t < this.gameScene.ballsLayer.children.length; t++) if (!this.gameScene.ballsLayer.getChildAt(t).isIdle()) return !1;
        return !0;
    }, t.prototype.on_resize = function() {
        for (var t in this.ballsMap) {
            var e = this.ballsMap[t];
            e.clearTweens(), e.setState(BallState.Idle), e.x = this.getPositionX(e.bubble.position.x) + this.BALL_SIZE / 2, 
            e.y = this.getPositionY(e.bubble.position.y) + this.BALL_SIZE / 2;
        }
    }, t.prototype.recarculateBallsSize = function() {
        this.width, this.height;
        this.BALL_SIZE = 231;
    }, t.prototype.getScale = function() {
        return 1;
    }, t.prototype.canRemoveNextBonuses = function() {
        return this.nextBubbleNodes && 0 < this.nextBubbleNodes.length;
    }, t.prototype.startIdle = function() {
        this.executionResult = void 0, this.setState(BoardState.Idle), this.gameScene.gameLogic.isMovePossible() || this.reshuffleBoard();
    }, t.prototype.reshuffleBoard = function() {
        for (var t in this.gameScene.gameLogic.reshuffleGrid(), this.ballsMap) {
            var e = this.ballsMap[t];
            this.gameScene.ballPool.add_object_to_pool(e);
        }
        this.ballsMap = {};
        for (var i = 0; i < this.gameScene.gameLogic.width; i++) for (var n = 0; n < this.gameScene.gameLogic.height; n++) {
            var s = this.gameScene.gameLogic.grid[i][n];
            null != s && null != s && (this.ballsMap.hasOwnProperty(s.id), this.ballsMap[s.id] = this.createBall(i, n, !1, this.gameScene.gameLogic.grid[i][n]));
        }
        this.restoreBoardFromSaveState(), this.gameScene.showInfo(this.gameScene.game.translate("board_reshuffle"));
    }, t.prototype.setState = function(t) {
        this.state = t;
    }, t.prototype.griddistance = function(t, e, i, n) {
        var s = Math.abs(i - t), o = Math.abs(n - e), a = Math.min(s, o), r = a, h = Math.max(s, o) - a;
        return Math.round(Math.sqrt(2) * r + h);
    }, t.prototype.disableBoardForTutorial = function() {
        for (var t in this.ballsMap) {
            this.ballsMap[t].alpha = .25;
        }
    }, t.prototype.enableBoardForTutorial = function() {
        for (var t in this.ballsMap) {
            this.ballsMap[t].alpha = 1;
        }
    }, t.prototype.refreshBubblesViewForTutorial = function(t) {
        var e, i, n = this.getBubblesViewForAmazingPoints(t);
        try {
            for (var s = __values(n), o = s.next(); !o.done; o = s.next()) {
                o.value.refreshForTutorial();
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (i = s.return) && i.call(s);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.getBubblesViewForAmazingPoints = function(t) {
        var e, i, n = [];
        try {
            try {
                for (var s = __values(t), o = s.next(); !o.done; o = s.next()) {
                    var a = o.value, r = this.gameScene.gameLogic.grid[a.x][a.y];
                    n.push(this.ballsMap[r.id]);
                }
            } catch (t) {
                e = {
                    error: t
                };
            } finally {
                try {
                    o && !o.done && (i = s.return) && i.call(s);
                } finally {
                    if (e) throw e.error;
                }
            }
        } catch (t) {}
        return n;
    }, t.prototype.enableBubbles = function(t) {
        var e, i, n = this.getBubblesViewForAmazingPoints(t);
        try {
            for (var s = __values(n), o = s.next(); !o.done; o = s.next()) {
                o.value.alpha = 1;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (i = s.return) && i.call(s);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t;
}(), EffectController = function(n) {
    function t(t, e) {
        var i = n.call(this, t, t.world, "EffectController") || this;
        return i.HORIZONTAL_LINE_POOL = 10, i.linesBomb = [], i.game = t, i.gameScene = e, 
        i.initialize(), i;
    }
    return __extends(t, n), t.prototype.initialize = function() {
        this.horizontalLinePool = new ObjectPool(this.game, "horizontalLinePool");
        for (var t = 0; t < this.HORIZONTAL_LINE_POOL; t++) {
            var e = this.game.add.image(0, 0, SpriteSheets.HORIZONTAL_ANIMATION.Name);
            e.animations.add("run"), this.horizontalLinePool.add_object_to_pool(e);
        }
    }, t.prototype.playHorizontalLineEffect = function(t, e) {
        void 0 === e && (e = 500);
        var i = this.horizontalLinePool.create(t.x, t.y, void 0);
        i.tint = BallView.GetTintForBall(t), i.animations.play("run", 40, !1), this.playLineEffect(i, t, e);
    }, t.prototype.playVerticalLineEffect = function(t, e) {
        void 0 === e && (e = 500);
        var i = this.horizontalLinePool.create(t.x, t.y, void 0);
        i.angle = 90, i.tint = BallView.GetTintForBall(t), i.animations.play("run", 40, !1), 
        this.playLineEffect(i, t, e);
    }, t.prototype.playLineEffect = function(t, e, i) {
        var n = this;
        void 0 === i && (i = 500), t.tint = BallView.GetTintForBall(e), t.anchor.set(.5), 
        t.scale.set(1), this.addChild(t), this.game.add.tween(t.scale).to({
            x: 5,
            y: 1
        }, i, Phaser.Easing.Linear.None, !0, 0).onComplete.addOnce(function() {
            n.horizontalLinePool.add_object_to_pool(t);
        }), this.game.add.tween(t).to({
            alpha: 0
        }, 100, Phaser.Easing.Cubic.Out, !0, i - 100);
    }, t.prototype.blinkSprite = function(e) {
        var i = 0, n = 10;
        !function t() {
            i++;
            if (i < n) return e.visible = !e.visible, void e.game.time.events.add(75, function() {
                t();
            });
        }();
    }, t;
}(Phaser.Group), GameScreenFrameController = function(n) {
    function t(t, e) {
        var i = n.call(this, t, t.world, "SelectionController") || this;
        return i.LINE_BREAK = 3, i.thicknes = 6, i.selectedBubbles = 0, i.selectedEmaBubbles = 0, 
        i.game = t, i.gameScene = e, i.currentColor = Utils.RGBtoHEX(127, 127, 127), i;
    }
    return __extends(t, n), t.prototype.initialize = function() {
        this.topLine = new Phaser.Image(this.game, 0, 0, Images.PIXEL), this.bottomLine = new Phaser.Image(this.game, 0, 0, Images.PIXEL), 
        this.leftTopLine = new Phaser.Image(this.game, 0, 0, Images.PIXEL), this.rightTopLine = new Phaser.Image(this.game, 0, 0, Images.PIXEL), 
        this.leftBottomLine = new Phaser.Image(this.game, 0, 0, Images.PIXEL), this.rightBottomLine = new Phaser.Image(this.game, 0, 0, Images.PIXEL), 
        this.addChild(this.bottomLine), this.addChild(this.topLine), this.addChild(this.leftTopLine), 
        this.addChild(this.rightTopLine), this.addChild(this.leftBottomLine), this.addChild(this.rightBottomLine), 
        this.screenFrame = new Phaser.Sprite(this.game, 0, 0, Images.PIXEL), this.screenFrame.alpha = .5, 
        this.addChild(this.screenFrame);
    }, t.prototype.update = function() {
        var t = AmazingGame.getInstance().isLandscape, e = t ? 960 : 540, i = t ? 615 : 960, n = 6 * this.gameScene.boardController.BALL_SIZE * this.gameScene.gameLayer.scale.y + 10, s = 6 * this.gameScene.boardController.BALL_SIZE * this.gameScene.gameLayer.scale.y + 10;
        Math.abs(this.selectedBubbles - this.selectedEmaBubbles) < .5 ? this.selectedEmaBubbles = this.selectedBubbles : this.selectedEmaBubbles += .05 * (this.selectedBubbles - this.selectedEmaBubbles);
        var o = this.selectedEmaBubbles / this.LINE_BREAK, a = s * Phaser.Math.clamp(o, 0, 1);
        if (this.topLine.width = a, this.topLine.height = this.thicknes, this.topLine.anchor.set(.5, .5), 
        this.topLine.position.set(e, i - n / 2), this.topLine.tint = this.currentColor, 
        this.bottomLine.width = a, this.bottomLine.height = this.thicknes, this.bottomLine.anchor.set(.5, .5), 
        this.bottomLine.position.set(e, i + n / 2), this.bottomLine.tint = this.currentColor, 
        this.selectedEmaBubbles >= this.LINE_BREAK) {
            o = Phaser.Math.clamp((this.selectedEmaBubbles - this.LINE_BREAK) / this.LINE_BREAK, 0, 1);
            var r = window.innerHeight * o / AmazingGame.getInstance().ratio;
            if (1 === o) ;
            this.leftTopLine.width = this.thicknes, this.leftTopLine.height = r / 2, this.leftTopLine.anchor.set(.5, 0), 
            this.leftTopLine.position.set(e - s / 2 + this.thicknes / 2, i - n / 2), this.leftTopLine.tint = this.currentColor, 
            this.rightTopLine.width = this.thicknes, this.rightTopLine.height = r / 2, this.rightTopLine.anchor.set(.5, 0), 
            this.rightTopLine.position.set(e + s / 2 - this.thicknes / 2, i - n / 2), this.rightTopLine.tint = this.currentColor, 
            this.leftBottomLine.width = this.thicknes, this.leftBottomLine.height = r / 2, this.leftBottomLine.anchor.set(.5, 1), 
            this.leftBottomLine.position.set(e - s / 2 + this.thicknes / 2, i + n / 2), this.leftBottomLine.tint = this.currentColor, 
            this.rightBottomLine.width = this.thicknes, this.rightBottomLine.height = r / 2, 
            this.rightBottomLine.anchor.set(.5, 1), this.rightBottomLine.position.set(e + s / 2 - +this.thicknes / 2, i + n / 2), 
            this.rightBottomLine.tint = this.currentColor;
        } else this.leftTopLine.height = 0, this.rightTopLine.height = 0, this.leftBottomLine.height = 0, 
        this.rightBottomLine.height = 0;
    }, t.prototype.setColor = function(t) {
        this.currentColor = t;
    }, t.prototype.setSelectedBubbles = function(t) {
        this.selectedBubbles = t;
    }, t.prototype.setSelectedBubblesFromUnselect = function(t) {
        this.selectedBubbles = t, this.selectedEmaBubbles = this.selectedBubbles, this.disableFrame();
    }, t.prototype.setBombFrame = function() {
        var t = AmazingGame.getInstance().isLandscape, e = t ? 960 : 540, i = t ? 615 : 960, n = 6 * this.gameScene.boardController.BALL_SIZE * this.gameScene.gameLayer.scale.y + 10, s = 6 * this.gameScene.boardController.BALL_SIZE * this.gameScene.gameLayer.scale.y + 10;
        this.gameScene.getTopSpace();
        this.gameScene.game.isLandscape, this.screenFrame.visible = !0, this.screenFrame.tint = this.currentColor, 
        this.screenFrame.width = s, this.screenFrame.height = s, this.screenFrame.position.x = e - s / 2, 
        this.screenFrame.position.y = i - n / 2, this.screenFrame.alpha = 0, this.game.add.tween(this.screenFrame).to({
            alpha: .5
        }, 500, Phaser.Easing.Cubic.Out, !0);
    }, t.prototype.reset = function() {
        this.selectedBubbles = 0, this.disableFrame();
    }, t.prototype.tweenTint = function(t, e, i, n) {
        var s = {
            step: 0
        }, o = this.game.add.tween(s).to({
            step: 100
        }, n);
        o.onUpdateCallback(function() {
            t.tint = Phaser.Color.interpolateColor(e, i, 100, s.step);
        }), t.tint = e, o.start();
    }, t.prototype.disableFrame = function() {
        var t = this;
        this.game && (this.game.tweens.removeFrom(this.screenFrame), this.game.add.tween(this.screenFrame).to({
            alpha: 0
        }, 500, Phaser.Easing.Cubic.Out, !0).onComplete.add(function() {
            t.screenFrame.visible = !1;
        }, this));
    }, t;
}(Phaser.Group), ParticleController = function() {
    function t(t) {
        this.ROW_EXPLOSION = "rowexplosion", this.EXTRA_BONUS = "extraBonus", this.BIG_BOMB = "bigbomb", 
        this.SPLIT_ROW = "splitrow", this.modelui = t, this.manager = this.modelui.game.plugins.plugins.filter(function(t) {
            return t instanceof Phaser.ParticleStorm;
        })[0];
    }
    return t.prototype.initialize = function() {
        var t = {
            lifespan: {
                min: 350,
                max: 500
            },
            image: [ Atlases.GAME ],
            frame: [ "bomb.png", "color.png", "horizontal.png" ],
            scale: {
                initial: 0,
                value: .4,
                control: "yoyo"
            },
            rotation: {
                delta: 6
            },
            vx: {
                min: -4.5,
                max: 4.5
            },
            vy: {
                min: -4.5,
                max: 4.5
            },
            alpha: {
                initial: 0,
                value: 1,
                control: "linear"
            },
            blendMode: "MULTIPLY"
        }, e = {
            lifespan: {
                min: 350,
                max: 500
            },
            image: [ Atlases.GAME ],
            frame: [ "bomb.png", "color.png", "horizontal.png" ],
            scale: {
                initial: 0,
                value: .4,
                control: "yoyo"
            },
            rotation: {
                delta: 6
            },
            vx: {
                min: -4.5,
                max: 4.5
            },
            vy: {
                min: -4.5,
                max: 4.5
            },
            alpha: {
                initial: 0,
                value: 1,
                control: "linear"
            }
        }, i = {
            lifespan: {
                min: 350,
                max: 500
            },
            image: [ Atlases.GAME ],
            frame: [ "ball.png" ],
            scale: {
                initial: 0,
                value: .4,
                control: "yoyo"
            },
            rotation: {
                delta: 6
            },
            vx: {
                min: -4.5,
                max: 4.5
            },
            vy: {
                min: -2,
                max: 2
            }
        }, n = {
            lifespan: {
                min: 500,
                max: 1e3
            },
            image: [ Atlases.GAME ],
            frame: [ "ball.png" ],
            velocity: {
                initial: {
                    min: 10,
                    max: 14
                },
                radial: {
                    arcStart: -45,
                    arcEnd: 45
                }
            },
            vx: {
                control: [ {
                    x: -1,
                    y: -1
                }, {
                    x: 1,
                    y: 1
                } ]
            },
            vy: {
                delta: .5
            },
            scale: {
                min: .1,
                max: .25
            },
            alpha: {
                value: 1,
                control: [ {
                    x: 0,
                    y: 1
                }, {
                    x: .75,
                    y: 1
                }, {
                    x: 1,
                    y: 0
                } ]
            }
        };
        this.manager.addData("bigBombMultiply", t), this.manager.addData("bigbomb", e), 
        this.manager.addData("wildcard", i), this.manager.addData("stars", n), this.emitter = this.manager.createEmitter(), 
        this.emitter.addToWorld(this.modelui.particleLayer);
    }, t.prototype.playExplodeEffect = function(t, e, i) {
        var n, s, o;
        o = GameTheme.IsDarkTheme() ? this.emitter.emit("bigbomb", t, e, {
            total: 24,
            zone: this.manager.createCircleZone(64),
            setColor: !0
        }) : this.emitter.emit("bigBombMultiply", t, e, {
            total: 24,
            zone: this.manager.createCircleZone(64),
            setColor: !0
        });
        var a = Phaser.Color.hexToRGBArray(i);
        try {
            for (var r = __values(o), h = r.next(); !h.done; h = r.next()) {
                h.value.color.setColor(240 * a[0], 240 * a[1], 240 * a[2], 1);
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                h && !h.done && (s = r.return) && s.call(r);
            } finally {
                if (n) throw n.error;
            }
        }
    }, t.prototype.playExplodeWildcardEffect = function(t, e, i) {
        for (var n = GameTheme.GetCurretnBallsTheme().length, s = this.emitter.emit("wildcard", t, e, {
            total: n,
            zone: this.manager.createCircleZone(96),
            setColor: !0
        }), o = 0; o < s.length; o++) {
            var a = Phaser.Color.getRGB(GameTheme.GetCurretnBallsTheme()[o]);
            s[o].color.setColor(a.r, a.g, a.b, 1);
        }
    }, t.prototype.playStarsEffect = function(t, e, i) {
        for (var n = this.emitter.emit("stars", t, e, {
            total: 6,
            zone: this.manager.createCircleZone(24),
            setColor: !0
        }), s = 0; s < n.length; s++) {
            var o = Phaser.Color.getRGB(i);
            n[s].color.setColor(o.r, o.g, o.b, 1);
        }
    }, t.prototype.playGameOver = function(t, e, i) {
        i && (this.manager.dataList.gameover.frame = i), this.emitter.emit("gameover", t, e, {
            frequency: 1e3
        });
    }, t.prototype.playGameOverBackgroundEffect = function(t, e, i) {
        this.pixelEmmiter.emit("combo", t - 750, e - 750, {
            total: 5,
            zone: this.manager.createRectangleZone(1500, 1500)
        });
    }, t.prototype.playComboLabelParticles = function(t, e) {
        this.pixelEmmiter.emit("combo", t - 750, e - 75, {
            total: 5,
            zone: this.manager.createRectangleZone(1500, 150)
        });
    }, t.prototype.initGameOverEmmiter = function(t) {
        this.gameOverEmmiter = this.manager.createEmitter(), this.gameOverEmmiter.addToWorld(t), 
        this.gameOverEmmiter.force.y = .1;
    }, t.prototype.playGameOverFrameEffect = function(t, e) {
        this.gameOverEmmiter.emit("dialogStars", t, e, {
            total: 20,
            zone: this.manager.createRectangleZone(300, 100)
        });
    }, t.prototype.render = function() {
        this.emitter.debug(0, 522);
    }, t;
}(), ParticlesController = function() {
    function t(t) {
        this.gameScene = t, this.wordEmmiter = this.gameScene.game.add.emitter(200, 200, 200), 
        this.wordEmmiter.makeParticles(Atlases.UI, "star.png"), this.wordSparklesEmmiter = this.gameScene.game.add.emitter(200, 200, 200), 
        this.wordSparklesEmmiter.makeParticles([ Images.PARTICLE_STAR ]), this.gameScene.particleLayer.add(this.wordEmmiter), 
        this.gameScene.particleLayer.add(this.wordSparklesEmmiter);
    }
    return t.prototype.playBonusWord = function(t, e, i) {
        this.wordEmmiter.x = t, this.wordEmmiter.y = e, this.wordEmmiter.maxParticleScale = 2, 
        this.wordEmmiter.maxParticleSpeed.set(400, 400), this.wordEmmiter.minParticleSpeed.set(-400, -400), 
        this.wordEmmiter.width = 500, this.wordEmmiter.start(!0, 1e3, null, 40);
    }, t.prototype.startSparkles = function(t, e, i) {
        this.wordSparklesEmmiter.x = t, this.wordSparklesEmmiter.y = e, this.wordSparklesEmmiter.maxParticleScale = 1.1, 
        this.wordSparklesEmmiter.minParticleScale = .1, this.wordSparklesEmmiter.width = 1.5 * i.width, 
        this.wordSparklesEmmiter.start(!1, 1e3, 10), this.currentLabel = i, this.wordSparklesEmmiter.on = !0;
    }, t.prototype.update = function() {
        this.wordEmmiter.forEachAlive(function(t) {
            t.alpha = t.lifespan / this.wordEmmiter.lifespan, t.scale.set(t.lifespan / this.wordEmmiter.lifespan);
        }, this), this.currentLabel ? (this.wordSparklesEmmiter.emitY = this.currentLabel.y, 
        this.wordSparklesEmmiter.forEachAlive(function(t) {
            t.tint = Utils.RGBtoHEX(254, 165, 2), t.alpha = t.lifespan / this.wordSparklesEmmiter.lifespan;
        }, this)) : this.wordSparklesEmmiter.on = !1;
    }, t;
}(), PostRenderEffectController = function(n) {
    function t(t, e) {
        var i = n.call(this, t, t.world, "EffectController") || this;
        return i.SELECTION_POOL = 25, i.RING_POOL = 50, i.game = t, i.gameScene = e, i.initialize(), 
        i;
    }
    return __extends(t, n), t.prototype.initialize = function() {
        this.selectionPool = new ObjectPool(this.game, "selectionPool"), this.ringAnimPool = new ObjectPool(this.game, "ringAnimPool");
        for (var t = 0; t < this.SELECTION_POOL; t++) {
            var e = this.game.add.image(0, 0, Atlases.GAME, "ball.png");
            this.selectionPool.add_object_to_pool(e);
        }
        for (t = 0; t < this.RING_POOL; t++) {
            (e = this.game.add.image(0, 0, Atlases.RING_ANIM)).animations.add("run"), this.ringAnimPool.add_object_to_pool(e);
        }
    }, t.prototype.playSelection = function(t) {
        var e = this, i = this.selectionPool.create(t.x, t.y, void 0);
        i.frameName = t.frameName, i.anchor.set(t.anchor.x, t.anchor.y), i.tint = BallView.GetTintForBall(t), 
        i.scale.set(0), i.blendMode = Phaser.blendModes.MULTIPLY, this.addChild(i), this.game.add.tween(i).to({
            alpha: 0
        }, 200, Phaser.Easing.Quadratic.Out, !0, 150), this.game.add.tween(i.scale).to({
            x: 1,
            y: 1
        }, 350, Phaser.Easing.Quadratic.Out, !0, 0).onComplete.addOnce(function() {
            e.selectionPool.add_object_to_pool(i);
        });
    }, t.prototype.playWildcardSelection = function(t) {
        var e = this, i = this.selectionPool.create(t.x, t.y, void 0);
        i.frameName = "wildcard.png", i.anchor.set(t.anchor.x, t.anchor.y), i.tint = 16777215, 
        i.scale.set(0), i.blendMode = Phaser.blendModes.OVERLAY, this.addChild(i), this.game.add.tween(i).to({
            alpha: 0
        }, 425, Phaser.Easing.Quadratic.Out, !0, 150), this.game.add.tween(i.scale).to({
            x: 1.75,
            y: 1.75
        }, 250, Phaser.Easing.Quadratic.Out, !0, 0).onComplete.addOnce(function() {
            e.game.add.tween(i.scale).to({
                x: .75,
                y: .75
            }, 175, Phaser.Easing.Quadratic.In, !0, 0).onComplete.addOnce(function() {
                e.selectionPool.add_object_to_pool(i);
            });
        });
    }, t.prototype.playRingAnim = function(t, e, i) {
        var n = this;
        void 0 === e && (e = 500);
        var s = this.ringAnimPool.create(t.x, t.y, void 0);
        s.anchor.set(.5), s.tint = BallView.GetTintForBall(t), s.animations.play("run", 12, !1), 
        this.addChild(s), this.game.add.tween(s).to({
            alpha: 0
        }, 1150, Phaser.Easing.Quadratic.In, !0, 150).onComplete.addOnce(function() {
            n.ringAnimPool.add_object_to_pool(s);
        }), this.game.add.tween(s.scale).to({
            x: 1.75,
            y: 1.75
        }, 1300, Phaser.Easing.Quadratic.Out, !0, 0), this.game.time.events.add(600, function() {
            Utils.tweenTint(n.game, s, s.tint, i, 300);
        });
    }, t.prototype.tweenTint = function(t, e, i, n) {
        var s = {
            step: 0
        }, o = this.game.add.tween(s).to({
            step: 100
        }, n);
        o.onUpdateCallback(function() {
            t.tint = Phaser.Color.interpolateColor(e, i, 100, s.step);
        }), t.tint = e, o.start();
    }, t;
}(Phaser.Group), PreRenderEffectController = function(n) {
    function t(t, e) {
        var i = n.call(this, t, t.world, "EffectController") || this;
        return i.SELECTION_POOL = 25, i.FIRE_BOMB_POOL = 35, i.CHANGE_TO_POWERUP = 35, i.game = t, 
        i.gameScene = e, i.initialize(), i;
    }
    return __extends(t, n), t.prototype.initialize = function() {
        this.selectionPool = new ObjectPool(this.game, "selectionPool"), this.fireBomb = new ObjectPool(this.game, "fireBomb"), 
        this.powerUpPool = new ObjectPool(this.game, "powerUpPool"), this.powerUpPoolCircle = new ObjectPool(this.game, "powerUpPoolCircle");
        for (var t = 0; t < this.SELECTION_POOL; t++) {
            var e = this.game.add.image(0, 0, Atlases.GAME, "ball.png");
            this.selectionPool.add_object_to_pool(e);
        }
        for (t = 0; t < this.FIRE_BOMB_POOL; t++) {
            var i = new Line(this.game, 0, 0, Atlases.GAME, "line.png");
            this.fireBomb.add_object_to_pool(i);
        }
        for (t = 0; t < this.CHANGE_TO_POWERUP; t++) {
            e = this.game.add.image(0, 0, Images.PARTICLE_RING);
            this.powerUpPool.add_object_to_pool(e);
        }
        for (t = 0; t < this.CHANGE_TO_POWERUP; t++) {
            e = this.game.add.image(0, 0, Atlases.GAME, "effect_bomb.png");
            this.powerUpPoolCircle.add_object_to_pool(e);
        }
    }, t.prototype.playSelection = function(t, e, i) {
        var n = this;
        void 0 === e && (e = 900);
        var s = this.selectionPool.create(t.x, t.y, void 0);
        s.anchor.set(t.anchor.x, t.anchor.y), s.tint = BallView.GetTintForBall(t), s.scale.set(1), 
        this.addChild(s), i && (1 === i ? s.tint = GameTheme.GetCurretnBallsTint(7) : 2 === i && (s.tint = GameTheme.GetCurretnBallsTint(3)), 
        3 === i ? s.tint = GameTheme.GetCurretnBallsTint(6) : 4 === i && (s.tint = GameTheme.GetCurretnBallsTint(2)), 
        s.blendMode = Phaser.blendModes.MULTIPLY), this.game.add.tween(s).to({
            alpha: 0
        }, e, Phaser.Easing.Quadratic.Out, !0, 0), this.game.add.tween(s.scale).to({
            x: 3,
            y: 3
        }, e, Phaser.Easing.Quadratic.Out, !0, 0).onComplete.addOnce(function() {
            n.selectionPool.add_object_to_pool(s);
        }), t.isWildcard();
    }, t.prototype.fireBombEffect = function(i, t) {
        var e, n, s = this, o = function(t) {
            var e = a.fireBomb.create(i.x, i.y, void 0);
            e.redraw(i.x, i.y, t.x, t.y, .5, BallView.GetTintForBall(i)), e.playBombEffect(), 
            a.addChild(e), a.game.add.tween(e).to({
                alpha: 1
            }, 150, Phaser.Easing.Linear.None, !0, 0).onComplete.addOnce(function() {
                s.game.add.tween(e).to({
                    alpha: 0
                }, 350, Phaser.Easing.Cubic.Out, !0, 0).onComplete.addOnce(function() {
                    s.fireBomb.add_object_to_pool(e);
                }, s);
            }, a);
        }, a = this;
        try {
            for (var r = __values(t), h = r.next(); !h.done; h = r.next()) {
                o(h.value);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                h && !h.done && (n = r.return) && n.call(r);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.fireGameOverEffect = function(i, t) {
        var e, n, s = this, o = function(t) {
            var e = a.fireBomb.create(i.x, i.y, void 0);
            e.redraw(i.x, i.y, t.x, t.y, .5, Utils.RGBtoHEX(83, 97, 108)), e.playBombEffect(), 
            a.addChild(e), a.game.add.tween(e).to({
                alpha: 1
            }, 150, Phaser.Easing.Linear.None, !0, 0).onComplete.addOnce(function() {
                s.game.add.tween(e).to({
                    alpha: 0
                }, 350, Phaser.Easing.Cubic.Out, !0, 0).onComplete.addOnce(function() {
                    s.fireBomb.add_object_to_pool(e);
                }, s);
            }, a);
        }, a = this;
        try {
            for (var r = __values(t), h = r.next(); !h.done; h = r.next()) {
                o(h.value);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                h && !h.done && (n = r.return) && n.call(r);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.changeToPowerUp = function(t, e) {
        var i = this;
        void 0 === e && (e = 500);
        var n = this.powerUpPool.create(t.x, t.y, void 0);
        n.tint = BallView.GetTintForBall(t), n.anchor.set(.5), n.scale.set(3 * t.scale.x), 
        this.addChild(n), this.game.add.tween(n.scale).to({
            x: 1,
            y: 1
        }, e, Phaser.Easing.Cubic.Out, !0, 0).onComplete.addOnce(function() {}), this.game.add.tween(n).to({
            alpha: .5
        }, e / 2, Phaser.Easing.Cubic.Out, !0, 0).onComplete.addOnce(function() {
            i.game.add.tween(n).to({
                alpha: 0
            }, e / 2, Phaser.Easing.Cubic.Out, !0, 0).onComplete.addOnce(function() {
                i.powerUpPool.add_object_to_pool(n);
            });
        });
    }, t.prototype.changeToPowerUpCircle = function(t, e) {
        var i = this;
        void 0 === e && (e = 500);
        var n = this.powerUpPoolCircle.create(t.x, t.y, void 0);
        n.tint = BallView.GetTintForBall(t), n.anchor.set(.5), n.scale.set(.5 * t.scale.x), 
        this.addChild(n), this.game.add.tween(n.scale).to({
            x: .75,
            y: .75
        }, e, Phaser.Easing.Cubic.Out, !0, 0).onComplete.addOnce(function() {}), this.game.add.tween(n).to({
            alpha: .5
        }, e / 2, Phaser.Easing.Cubic.Out, !0, 0).onComplete.addOnce(function() {
            i.game.add.tween(n).to({
                alpha: 0
            }, e / 2, Phaser.Easing.Cubic.Out, !0, 0).onComplete.addOnce(function() {
                i.powerUpPoolCircle.add_object_to_pool(n);
            });
        });
    }, t.prototype.tweenTint = function(t, e, i, n) {
        var s = {
            step: 0
        }, o = this.game.add.tween(s).to({
            step: 100
        }, n);
        o.onUpdateCallback(function() {
            t.tint = Phaser.Color.interpolateColor(e, i, 100, s.step);
        }), t.tint = e, o.start();
    }, t;
}(Phaser.Group), SelectionController = function(n) {
    function t(t, e) {
        var i = n.call(this, t, t.world, "SelectionController") || this;
        return i.LINE_POLL = 50, i.lines = [], i.bubbles = [], i.game = t, i.gameScene = e, 
        i.initialize(), i;
    }
    return __extends(t, n), t.prototype.initialize = function() {
        this.linePool = new ObjectPool(this.game, "linePool");
        for (var t = 0; t < this.LINE_POLL; t++) {
            var e = new Line(this.game, 0, 0, Atlases.GAME, "line.png");
            this.linePool.add_object_to_pool(e);
        }
    }, t.prototype.addSelection = function(t) {
        if (this.bubbles[this.bubbles.length - 1] !== t) {
            var e, i = !1;
            if (-1 !== this.bubbles.indexOf(t) && 5 === this.bubbles.length) {
                if (this.bubbles[0] !== t) return;
                i = !0;
            }
            if (this.bubbles.push(t), e = this.bubbles[this.bubbles.length - 1], 1 < this.bubbles.length) {
                var n = this.bubbles[this.bubbles.length - 2];
                this.currentLine.redraw(n.x, n.y, e.x, e.y, .75, GameTheme.GetCurretnBallsTint(n.bubble.value)), 
                this.playSelectionEffect();
            }
            t.isWildcard() ? (this.currentLine = this.linePool.create(0, 0, null), this.currentLine.frameName = "wildcard_line.png", 
            this.addChild(this.currentLine), this.currentLine.redraw(e.x, e.y, e.x, e.y, .75, Utils.RGBtoHEX(255, 255, 255))) : (this.currentLine = this.linePool.create(0, 0, null), 
            this.currentLine.frameName = "line.png", this.addChild(this.currentLine), this.currentLine.redraw(e.x, e.y, e.x, e.y, .75, GameTheme.GetCurretnBallsTint(e.bubble.value))), 
            i && (this.linePool.add_object_to_pool(this.currentLine), this.currentLine = void 0);
        }
    }, t.prototype.removeLastSelection = function() {
        if (1 < this.children.length) {
            var t = this.getChildAt(this.children.length - 2);
            this.linePool.add_object_to_pool(t), this.bubbles.splice(this.bubbles.length - 1, 1);
        }
    }, t.prototype.updateLineDrawing = function(t, e) {
        if (this.currentLine) {
            var i = this.bubbles[this.bubbles.length - 1];
            this.currentLine.redraw(i.x, i.y, t, e, .75, GameTheme.GetCurretnBallsTint(i.bubble.value)), 
            "wildcard_line.png" !== this.currentLine.frameName || i.isWildcard() || (this.currentLine.frameName = "line.png"), 
            "line.png" === this.currentLine.frameName && i.isWildcard() && (this.currentLine.frameName = "wildcard_line.png");
        }
    }, t.prototype.clear = function() {
        for (var t = this.children.length - 1; 0 <= t; t--) this.linePool.add_object_to_pool(this.children[t]);
        this.currentLine && this.linePool.add_object_to_pool(this.currentLine), this.lines = [], 
        this.currentLine = void 0, this.bubbles = [];
    }, t.prototype.playSelectionEffect = function() {
        var t = this, e = this.linePool.create(0, 0, null);
        e.frameName = this.currentLine.frameName, e.redraw(this.currentLine.x1, this.currentLine.y1, this.currentLine.x2, this.currentLine.y2, this.currentLine.thicknes, this.currentLine.tint), 
        e.scale.set(this.currentLine.scale.x), this.gameScene.prerenderEffectController.addChild(e), 
        this.game.add.tween(e).to({
            alpha: 0
        }, 600, Phaser.Easing.Quadratic.Out, !0, 0), this.game.add.tween(e.scale).to({
            x: 1.5,
            y: 1.5
        }, 600, Phaser.Easing.Quadratic.Out, !0, 0).onComplete.addOnce(function() {
            t.linePool.add_object_to_pool(e);
        });
    }, t.prototype.tweenTint = function(t, e, i, n) {
        var s = {
            step: 0
        }, o = this.game.add.tween(s).to({
            step: 100
        }, n);
        o.onUpdateCallback(function() {
            t.tint = Phaser.Color.interpolateColor(e, i, 100, s.step);
        }), t.tint = e, o.start();
    }, t;
}(Phaser.Group), ThemeController = function() {
    function n() {}
    return n.setTheme = function(t, e, i) {
        void 0 === i && (i = void 0), GameSettings.getInstance().applicationData.themeIndex != t && (GameSettings.getInstance().applicationData.themeIndex = t, 
        n.refreshThemeIndex(e), 1 == GameSettings.getInstance().applicationData.themeIndex ? n.setBackground(1, e) : n.setBackground(0, e)), 
        null != i && i();
    }, n.setBackground = function(t, e, i) {
        void 0 === i && (i = void 0), GameSettings.getInstance().applicationData.backgroundIndex != t && (GameSettings.getInstance().applicationData.backgroundIndex = t, 
        n.refreshBackgroundIndex(e), null != i && i());
    }, n.getThemeIndex = function() {
        return GameSettings.getInstance().applicationData.themeIndex + 1;
    }, n.getBackgroundIndex = function() {
        return GameSettings.getInstance().applicationData.backgroundIndex + 1;
    }, n.getBackgroundName = function(t) {
        return "bg_" + n.getBackgroundIndex();
    }, n.refreshThemeIndex = function(t) {
        t instanceof GameScene && t.refreshTheme();
    }, n.refreshBackgroundIndex = function(t) {
        t instanceof GameScene && (t.swap_background(), t.refresh_background());
    }, n;
}(), TutorialController = function(a) {
    function t(t) {
        var e = a.call(this, t.game) || this;
        return e.gameScene = t, e.tutorialState = 0, e.canRequestForNextStep = !1, e.showTutorialHand = !1, 
        e.stateTimer = 0, e.stateTime = 1e4, e.FADE_IN_OUT = 350, e.canRequestForNextStep = !0, 
        e.visible = !1, e;
    }
    return __extends(t, a), t.prototype.initialize = function() {
        this.tutorialHand = this.game.add.image(0, 0, Atlases.GAME, "tut_hand.png"), this.add(this.tutorialHand), 
        this.tutorialDescriptionBG = new PhaserNineSlice.NineSlice(this.game, 960, 200, Atlases.UI, "nineslice.png", 1080, 170, {
            top: 84,
            bottom: 84,
            left: 84,
            right: 84
        }), this.tutorialDescriptionBG.anchor.set(.5);
        var t = new BMFLabel(this.game, 0, 0, Fonts.RUBIKREGULAR55, AmazingGame.getInstance().translate("tutorial_1"), 55, 1e3, 200, {
            translationID: "tutorial_1"
        });
        t.tint = 31683, t.align = "center", t.setVerticalandHorizontalCenter(), this.tutorialDescriptionBG.addChild(t), 
        this.add(this.tutorialDescriptionBG);
    }, t.prototype.showTutorial = function(t, e, i) {
        var n = this;
        void 0 === i && (i = !1), this.visible = !0, this.alpha = 0;
        var s = this.game.add.tween(this);
        s.to({
            alpha: 1
        }, 500, Phaser.Easing.Quadratic.In, !0), i && s.onComplete.add(function() {
            n.game.add.tween(n).to({
                alpha: 0
            }, 4e3, Phaser.Easing.Quadratic.Out, !0, 600).onComplete.add(function() {
                n.visible = !1;
            });
        });
    }, t.prototype.hideTutorial = function() {
        var t = this;
        this.game.add.tween(this).to({
            alpha: 0
        }, 350, Phaser.Easing.Quadratic.Out, !0).onComplete.addOnce(function() {
            t.visible = !1;
        });
    }, t.prototype.onResize = function() {
        AmazingGame.getInstance().isLandscape ? this.tutorialDescriptionBG.position.set(960, SnapManager.snapTop(85)) : this.tutorialDescriptionBG.position.set(540, SnapManager.snapTop(120)), 
        this.currentBallPoints && this.createHandWaypoints(this.gameScene.boardController.getBubblesViewForAmazingPoints(this.currentBallPoints));
    }, t.prototype.update = function() {
        if (a.prototype.update.call(this), this.currentPath && 0 != this.tutorialState && this.showTutorialHand) {
            this.stateTimer += this.game.time.elapsed;
            var t = this.stateTimer / this.stateTime, e = this.currentPath.map(function(t) {
                return t.x;
            }), i = this.currentPath.map(function(t) {
                return t.y;
            }), n = Phaser.Math.linearInterpolation(e, t), s = Phaser.Math.linearInterpolation(i, t);
            this.tutorialHand.position.set(n, s);
            var o = 1;
            this.stateTimer <= this.FADE_IN_OUT && (o = this.stateTimer / this.FADE_IN_OUT), 
            this.stateTimer >= this.stateTime - this.FADE_IN_OUT && (o = (this.stateTime - this.stateTimer) / this.FADE_IN_OUT), 
            this.tutorialHand.alpha = o, this.stateTimer >= this.stateTime && (this.stateTimer = 0);
        }
    }, t.prototype.doNext = function() {
        0 === this.tutorialState ? this.doStep1() : 1 === this.tutorialState ? this.doStep2() : 2 === this.tutorialState ? this.doStep3() : 3 === this.tutorialState ? this.doStep4() : 4 === this.tutorialState ? this.doStep5() : 5 === this.tutorialState ? this.doStep6() : 6 === this.tutorialState ? this.doStep7() : this.tutorialState;
    }, t.prototype.doStep1 = function() {
        this.tutorialState = 1, this.gameScene.boardController.disableBoardForTutorial(), 
        GameSettings.getInstance().applicationData.tutorialIndex = 1, this.canRequestForNextStep = !1, 
        this.showTutorial(540, 960), this.currentBallPoints = this.gameScene.gameLogic.getRandomThreeStepMove(), 
        this.gameScene.boardController.enableBubbles(this.currentBallPoints), this.createHandWaypoints(this.gameScene.boardController.getBubblesViewForAmazingPoints(this.currentBallPoints)), 
        this.showTutorialHand = !0, this.tutorialDescriptionBG.getChildAt(0).setTranslation({
            translationID: "tutorial_1"
        }), this.tutorialDescriptionBG.getChildAt(0).setText(AmazingGame.getInstance().translate("tutorial_1")), 
        this.stateTime = 2e3;
    }, t.prototype.doStep2 = function() {
        GameSettings.getInstance().applicationData.tutorialIndex = 2, this.tutorialState = 2, 
        this.gameScene.boardController.disableBoardForTutorial(), this.currentBallPoints = this.gameScene.gameLogic.getRandomBombMove(), 
        this.gameScene.boardController.enableBubbles(this.currentBallPoints), this.createHandWaypoints(this.gameScene.boardController.getBubblesViewForAmazingPoints(this.currentBallPoints)), 
        this.showTutorialHand = !0, this.canRequestForNextStep = !1, this.showTutorial(540, 960), 
        this.tutorialDescriptionBG.getChildAt(0).setTranslation({
            translationID: "tutorial_2"
        }), this.tutorialDescriptionBG.getChildAt(0).setText(AmazingGame.getInstance().translate("tutorial_2"));
    }, t.prototype.doStep3 = function() {
        this.tutorialState = 3, this.gameScene.boardController.disableBoardForTutorial(), 
        GameSettings.getInstance().applicationData.tutorialIndex = 3, this.currentBallPoints = this.gameScene.gameLogic.getRandomHorizontalMove(), 
        this.gameScene.boardController.enableBubbles(this.currentBallPoints), this.createHandWaypoints(this.gameScene.boardController.getBubblesViewForAmazingPoints(this.currentBallPoints)), 
        this.showTutorialHand = !0, this.canRequestForNextStep = !1, this.showTutorial(540, 960), 
        this.tutorialDescriptionBG.getChildAt(0).setTranslation({
            translationID: "tutorial_3"
        }), this.tutorialDescriptionBG.getChildAt(0).setText(AmazingGame.getInstance().translate("tutorial_3"));
    }, t.prototype.doStep4 = function() {
        this.tutorialState = 4, this.gameScene.boardController.disableBoardForTutorial(), 
        this.currentBallPoints = this.gameScene.gameLogic.getRandomWildCartMove(), this.gameScene.boardController.enableBubbles(this.currentBallPoints), 
        this.createHandWaypoints(this.gameScene.boardController.getBubblesViewForAmazingPoints(this.currentBallPoints)), 
        this.showTutorialHand = !0, GameSettings.getInstance().applicationData.tutorialIndex = 4, 
        this.canRequestForNextStep = !1, this.showTutorial(540, 960), this.tutorialDescriptionBG.getChildAt(0).setTranslation({
            translationID: "tutorial_4"
        }), this.tutorialDescriptionBG.getChildAt(0).setText(AmazingGame.getInstance().translate("tutorial_4"));
    }, t.prototype.doStep5 = function() {
        this.tutorialState = 5, this.gameScene.boardController.disableBoardForTutorial(), 
        this.currentBallPoints = this.gameScene.gameLogic.getRandomMoveWithWildCart(), this.gameScene.boardController.refreshBubblesViewForTutorial(this.currentBallPoints), 
        this.gameScene.boardController.enableBubbles(this.currentBallPoints), this.createHandWaypoints(this.gameScene.boardController.getBubblesViewForAmazingPoints(this.currentBallPoints)), 
        this.showTutorialHand = !0, GameSettings.getInstance().applicationData.tutorialIndex = 5, 
        this.canRequestForNextStep = !1, this.showTutorial(540, 960), this.tutorialDescriptionBG.getChildAt(0).setTranslation({
            translationID: "tutorial_5"
        }), this.tutorialDescriptionBG.getChildAt(0).setText(AmazingGame.getInstance().translate("tutorial_5"));
    }, t.prototype.doStep6 = function() {
        this.tutorialState = 6, this.gameScene.boardController.disableBoardForTutorial(), 
        this.currentBallPoints = this.gameScene.gameLogic.getRandomRemoveBombMove(), this.gameScene.boardController.refreshBubblesViewForTutorial(this.currentBallPoints), 
        this.gameScene.boardController.enableBubbles(this.currentBallPoints), this.createHandWaypoints(this.gameScene.boardController.getBubblesViewForAmazingPoints(this.currentBallPoints)), 
        this.showTutorialHand = !0, GameSettings.getInstance().applicationData.tutorialIndex = 6, 
        this.canRequestForNextStep = !1, this.showTutorial(540, 960), this.tutorialDescriptionBG.getChildAt(0).setTranslation({
            translationID: "tutorial_6"
        }), this.tutorialDescriptionBG.getChildAt(0).setText(AmazingGame.getInstance().translate("tutorial_6"));
    }, t.prototype.doStep7 = function() {
        this.game.tweens.removeFrom(this), this.tutorialState = 7, this.showTutorialHand = !1, 
        GameSettings.getInstance().applicationData.tutorialIndex = 7, this.tutorialDescriptionBG.getChildAt(0).setTranslation({
            translationID: "tutorial_7"
        }), this.tutorialDescriptionBG.getChildAt(0).setText(AmazingGame.getInstance().translate("tutorial_7")), 
        this.showTutorial(540, 960, !0), this.finishTutorial(), this.canRequestForNextStep = !1, 
        this.tutorialHand.visible = !1;
    }, t.prototype.finishStep = function() {
        this.canRequestForNextStep = !0, this.gameScene.boardController.enableBoardForTutorial(), 
        this.hideTutorial();
    }, t.prototype.finishTutorial = function() {
        this.game.tweens.removeFrom(this), this.tutorialState = 0, GameSettings.getInstance().applicationData.tutorialAsked = !0, 
        GameSettings.getInstance().applicationData.tutorialInProgress = !1, GameSettings.getInstance().applicationData.tutorialPassed = !0, 
        GameSettings.getInstance().applicationData.tutorialIndex = 0, GameSettings.getInstance().save();
    }, t.prototype.createHandWaypoints = function(t) {
        var e, i;
        this.currentPath = [], this.stateTimer = 0, this.stateTime = 500 * t.length;
        try {
            for (var n = __values(t), s = n.next(); !s.done; s = n.next()) {
                var o = s.value, a = this.game.world.toLocal(o.position, this.gameScene.gameLayer), r = this.toLocal(a, this.game.world);
                this.currentPath.push(new Phaser.Point(r.x, r.y));
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.RestoreTutorial = function() {
        this.tutorialState = GameSettings.getInstance().applicationData.tutorialIndex, this.tutorialState -= 1, 
        this.tutorialState < 0 && (this.tutorialState = 0), this.doNext();
    }, t.prototype.canSelectBall = function(e, i) {
        return 0 === this.tutorialState || (7 === this.tutorialState || (!this.currentBallPoints || (!!this.currentBallPoints.some(function(t) {
            return t.x === e && t.y === i;
        }) || void 0)));
    }, t.prototype.canDoTutorialMove = function(t) {
        return 1 === this.tutorialState ? 2 <= t.length : 2 === this.tutorialState ? 5 <= t.length : 3 === this.tutorialState ? 4 <= t.length : 4 === this.tutorialState ? 5 <= t.length : 5 === this.tutorialState ? 3 <= t.length : 6 === this.tutorialState && 2 <= t.length;
    }, t;
}(Phaser.Group), TutorialHelper = function() {
    function s() {}
    return s.show = function() {
        Constants.COMPILE_PLATFORM && (AmazingGame.getInstance().stage.disableVisibilityChange = !0);
        var t = document.createElement("iframe");
        t.id = "tutorialframe", t.src = "tutorial/tutorial.html?v=" + Date.now(), t.style.width = "100%", 
        t.style.height = "100%", t.style.right = "0", t.style.left = "0", t.style.bottom = "0", 
        t.style.top = "0", t.frameBorder = "0", t.scrolling = "yes", t.style.overflow = "scroll", 
        t.style.position = "absolute", t.style.border = "none", t.style.backgroundColor = "rgba(0,0,0,0.9)", 
        document.body.appendChild(t), t.onload = function() {
            (s.closeButton = document.createElement("img")).src = "assets/close.png", s.closeButton.id = "closeButton", 
            s.closeButton.style.position = "fixed", s.closeButton.style.marginRight = "15px", 
            s.closeButton.style.marginTop = "25px";
            AmazingGame.getInstance().width, AmazingGame.getInstance().width;
            s.resize_closeButton(), s.closeButton.style.cursor = "pointer", t.contentWindow.onresize = function() {
                s.resize_closeButton(), AmazingGame.getInstance().on_resize();
            }, document.body.appendChild(s.closeButton), s.closeButton.onmouseover = function() {
                s.closeButton.style.transform = "scaleX(1.1) scaleY(1.1)";
            }, s.closeButton.onmouseleave = function() {
                s.closeButton.style.transform = "scaleX(1) scaleY(1)";
            }, s.closeButton.onclick = function() {
                s.hide();
            }, t.contentWindow.document.getElementsByClassName("rightfoother")[0].innerHTML = " ver. " + Constants.APP_VERSION, 
            s.replaceTag(t, "%Main_Title1%", AmazingGame.getInstance().translate("instruction_main_title")), 
            s.replaceTag(t, "%Title1%", AmazingGame.getInstance().translate("instruction_title_1")), 
            s.replaceTag(t, "%Content1%", AmazingGame.getInstance().translate("instruction_content_1")), 
            s.replaceTag(t, "%Title2%", AmazingGame.getInstance().translate("instruction_title_2")), 
            s.replaceTag(t, "%Content2%", AmazingGame.getInstance().translate("instruction_content_2")), 
            s.replaceTag(t, "%Title3%", AmazingGame.getInstance().translate("instruction_title_3")), 
            s.replaceTag(t, "%Content3_1%", AmazingGame.getInstance().translate("instruction_content_3_1")), 
            s.replaceTag(t, "%Content3_2%", AmazingGame.getInstance().translate("instruction_content_3_2")), 
            s.replaceTag(t, "%Content3_3%", AmazingGame.getInstance().translate("instruction_content_3_3"));
        }, s.TutorialOpened = !0, gameanalytics.GameAnalytics.addDesignEvent("tutorial:open");
    }, s.replaceTag = function(t, e, i) {
        t.contentWindow.document.getElementsByClassName(e)[0].innerHTML = i.replace(/\n/g, "<br>");
    }, s.resize_closeButton = function() {
        var t = (AmazingGame.getInstance().width - .9 * AmazingGame.getInstance().width) / 2, e = Math.min(54, t / AmazingGame.getInstance().device.pixelRatio), i = Math.min(54, t / AmazingGame.getInstance().device.pixelRatio), n = 0;
        Constants.COMPILE_PLATFORM === Platform.WEB && AmazingGame.getInstance().device.desktop && (n = 14), 
        s.closeButton.style.top = t / 2 / AmazingGame.getInstance().device.pixelRatio - i / 2 + "px", 
        s.closeButton.style.right = t / 2 / AmazingGame.getInstance().device.pixelRatio + n - e / 2 + "px", 
        s.closeButton.style.width = e + "px", s.closeButton.style.height = i + "px";
    }, s.hide = function() {
        var t = document.getElementById("tutorialframe");
        t && document.body.removeChild(t);
        var e = document.getElementById("closeButton");
        e && document.body.removeChild(e), s.TutorialOpened = !1, Constants.COMPILE_PLATFORM && (AmazingGame.getInstance().stage.disableVisibilityChange = !1);
    }, s.TutorialOpened = !1, s.tutorialInitialized = !1, s;
}(), CustomMenu = function(n) {
    function t(t, e) {
        var i = n.call(this, t, t.world, e) || this;
        return i.BASE_OFFSET = 622, i.SCALE = 1, i.transitionTime = .15, i.transitionTimer = 0, 
        i.transitionOffset = 430, i.menuCenterX = 200, i.isOpened = !1, i.isShowed = !1, 
        i.game = t, i.amazingGame = AmazingGame.getInstance(), i.inputEnableChildren = !0, 
        i;
    }
    return __extends(t, n), Object.defineProperty(t.prototype, "isWebMobile", {
        get: function() {
            return GlobalVars.Platform === Platform.WEB_IOS || GlobalVars.Platform === Platform.WEB_ANDROID || (GlobalVars.Platform === Platform.UWP || GlobalVars.Platform === Platform.UWP_MOBILE) && Constants.COMPILE_PLATFORM !== Platform.UWP;
        },
        enumerable: !0,
        configurable: !0
    }), Object.defineProperty(t.prototype, "labelPos", {
        get: function() {
            return 100 * this.SCALE;
        },
        enumerable: !0,
        configurable: !0
    }), t.prototype.initialize = function() {
        var t = this;
        this.set_background(), this.scrollGroup = new ScrollGroup(this.game);
        if (this.btnHome = this.addMenuButton(Atlases.UI2, "btnblue.png", this.amazingGame.translate("menu_home").toLocaleUpperCase(), 100, "ickhome.png", 31684, 16777215, Atlases.UI2), 
        this.btnHome.bmfLabel.setMaxSize(370, 38), this.btnHome.bmfLabel.setTranslation({
            translationID: "menu_home",
            isUpperCase: !0
        }), this.btnNewGame = this.addMenuButton(Atlases.UI2, "btngreen.png", this.amazingGame.translate("menu_newgame").toLocaleUpperCase(), 100, "ickplay.png", 53416, 16777215, Atlases.UI2), 
        this.btnNewGame.bmfLabel.setMaxSize(370, 38), this.btnNewGame.bmfLabel.setTranslation({
            translationID: "menu_newgame",
            isUpperCase: !0
        }), this.btnThemes = this.addMenuButton(Atlases.UI2, "btnblue.png", this.amazingGame.translate("menu_themes").toLocaleUpperCase(), 100, "ickthemes.png", 31684, 16777215, Atlases.UI2), 
        this.btnThemes.bmfLabel.setMaxSize(370, 38), this.btnThemes.bmfLabel.setTranslation({
            translationID: "menu_themes",
            isUpperCase: !0
        }), this.addAdvertising(10), this.btnSound = this.addMenuButton(Atlases.UI2, "btnblue.png", this.amazingGame.translate("menu_sound_effects").toLocaleUpperCase(), 64, "icksound.png", 31684, 16777215, Atlases.UI2), 
        this.addCheckBox(this.btnSound, 31684), this.btnSound.bmfLabel.setMaxSize(340, 38), 
        this.btnSound.bmfLabel.setTranslation({
            translationID: "menu_sound_effects",
            isUpperCase: !0
        }), this.btnMusic = this.addMenuButton(Atlases.UI2, "btnblue.png", this.amazingGame.translate("menu_music").toLocaleUpperCase(), 64, "ickmusic.png", 31684, 16777215, Atlases.UI2), 
        this.addCheckBox(this.btnMusic, 31684), this.btnMusic.bmfLabel.setMaxSize(340, 38), 
        this.btnMusic.bmfLabel.setTranslation({
            translationID: "menu_music",
            isUpperCase: !0
        }), DISABLE_LINKS_FOR_LICENSE || Constants.IS_POKI || (this.btnMoreGames = this.addMenuButton(Atlases.UI2, "btnblue.png", this.amazingGame.translate("menu_more_games").toLocaleUpperCase(), 64, "ickmore.png", 31684, 16777215, Atlases.UI2), 
        this.btnMoreGames.bmfLabel.setMaxSize(370, 38), this.btnMoreGames.bmfLabel.setTranslation({
            translationID: "menu_more_games",
            isUpperCase: !0
        }), this.btnPrivatePolicy = this.addMenuButton(Atlases.UI2, "btnblue.png", this.amazingGame.translate("menu_private_policy").toLocaleUpperCase(), 64, "ickprivacy.png", 31684, 16777215, Atlases.UI2), 
        this.btnPrivatePolicy.bmfLabel.setMaxSize(370, 38), this.btnPrivatePolicy.bmfLabel.setTranslation({
            translationID: "menu_private_policy",
            isUpperCase: !0
        })), !DISABLE_ADS_PROMO_INSTALL_FOR_LICENSE && !Constants.IS_POKI) {
            if (Constants.IS_MOBILE_COMPILE_VERSION) this.btnRate = this.addMenuButton(Atlases.UI2, "btnred.png", this.amazingGame.translate("menu_review_game").toUpperCase(), 64, "ickreview.png", 16727911, 16777215, Atlases.UI2); else {
                var e = "menu_get_for_windows", i = "ick_windows.png";
                GlobalVars.Platform === Platform.WEB_IOS ? (e = "menu_get_for_ios", i = "ick_phone.png") : GlobalVars.Platform === Platform.WEB_ANDROID ? (e = "menu_get_for_android", 
                i = "ick_google.png") : GlobalVars.Platform !== Platform.UWP && GlobalVars.Platform !== Platform.UWP_MOBILE || Constants.COMPILE_PLATFORM === Platform.UWP || (e = "menu_get_for_windows", 
                i = "ick_windows.png"), this.btnPlatformDownload = this.addMenuButton(Atlases.UI2, "btngreen.png", this.amazingGame.translate(e).toUpperCase(), 64, i, 53416), 
                this.btnPlatformDownload.bmfLabel.setTranslation({
                    translationID: e,
                    isUpperCase: !0
                }), this.btnPlatformDownload.getChildAt(1).scale.set(.75, .75), this.btnPlatformDownload.bmfLabel.setMaxSize(370, 38), 
                GlobalVars.Platform === Platform.WEB_IOS && (this.btnPlatformDownload.getChildAt(1).tint = 1363358);
            }
            DISABLE_LINKS_FOR_LICENSE || (this.tw = this.addMenuButton(Atlases.UI2, "btntw.png", "", 100), 
            this.fb = this.addMenuButton(Atlases.UI2, "btnfb.png", "", 100));
        }
        this.game.world.remove(this), this.showingMenu = !1, this.amazingGame.translation.addListener(function() {
            t.uniformButtons();
        }), this.uniformButtons();
    }, t.prototype.uniformButtons = function() {
        Constants.IS_MOBILE_COMPILE_VERSION ? BMFLabel.UniformTextSizesForButtons([ this.btnHome, this.btnNewGame, this.btnThemes, this.btnSound, this.btnMusic, this.btnMoreGames, this.btnPrivatePolicy, this.btnRate ]) : Constants.IS_POKI ? BMFLabel.UniformTextSizesForButtons([ this.btnHome, this.btnNewGame, this.btnThemes, this.btnSound, this.btnMusic, this.btnMoreGames, this.btnPrivatePolicy ]) : BMFLabel.UniformTextSizesForButtons([ this.btnHome, this.btnNewGame, this.btnThemes, this.btnSound, this.btnMusic, this.btnMoreGames, this.btnPrivatePolicy, this.btnPlatformDownload ]);
    }, t.prototype.create_scroll_bar = function() {
        this.scrollBar = new ScrollBar(this.game, 6, this.game.height, Utils.RGBtoHEX(86, 86, 86), Utils.RGBtoHEX(255, 255, 255)), 
        this.addChild(this.scrollBar);
    }, t.prototype.set_background = function() {
        this.background = this.game.add.sprite(0, 0, Images.PIXEL), this.background.width = this.transitionOffset, 
        this.background.height = 1600, this.add(this.background), this.overlay = this.game.add.image(0, 0, Atlases.UI2, "bgmenu.png"), 
        this.addChild(this.overlay), this.overlay.anchor.set(0, 0), this.logo = this.game.add.image(442, 10, Atlases.UI2, "menulogo.png"), 
        this.addChild(this.logo), this.logo.anchor.set(.5, .5);
    }, t.prototype.update = function() {
        if (n.prototype.update.call(this), this.SCALE = this.getMenuScale(), this.overlay.scale.set(this.SCALE), 
        this.transitionOffset = this.BASE_OFFSET * this.SCALE, this.background.width = this.transitionOffset, 
        this.background.height = this.game.height, GameTheme.IsDarkTheme() ? (this.background.tint = Utils.RGBtoHEX(0, 0, 0), 
        this.downloadLabel && (this.downloadLabel.tint = 16777215)) : (this.background.tint = Utils.RGBtoHEX(255, 255, 255), 
        this.downloadLabel && (this.downloadLabel.tint = 11173329)), this.transitionTimer <= this.transitionTime) if (this.showingMenu) {
            this.transitionTimer += this.game.time.elapsed / 1e3;
            var t = this.transitionTimer / this.transitionTime, e = Phaser.Easing.Cubic.InOut(t) * this.transitionOffset;
            this.game.world.pivot.x = -e, this.game.world.pivot.x = Phaser.Math.clamp(this.game.world.pivot.x, -this.transitionOffset, 0), 
            this.transitionTimer >= this.transitionTime && (this.isShowed = !0, this.scrollGroup.start(), 
            this.game.world.pivot.x = -this.transitionOffset, this.position.x = -this.transitionOffset);
        } else {
            this.transitionTimer += this.game.time.elapsed / 1e3;
            t = this.transitionTimer / this.transitionTime;
            var i = this.transitionOffset - Phaser.Easing.Quadratic.Out(t) * this.transitionOffset;
            i = Phaser.Math.clamp(i, 0, this.transitionOffset), this.game.world.pivot.x = -i, 
            this.game.world.pivot.x = Phaser.Math.clamp(this.game.world.pivot.x, -this.transitionOffset, 0), 
            this.transitionTimer >= this.transitionTime && (this.isOpened = !1, this.visible = !1, 
            this.game.world.remove(this), this.game.world.pivot.x = 0);
        }
        this.game.world.bringToTop(this.gameScene.menuButton);
    }, t.prototype.toogle = function() {
        if (this.showingMenu = !this.showingMenu, this.transitionTimer = 0, this.isShowed = !1, 
        this.on_resize(), this.showingMenu && !this.isOpened) {
            if (gameanalytics.GameAnalytics.addDesignEvent("menu:open"), this.refresh(), this.visible = !0, 
            this.game.world.add(this), this.isOpened = !0, this.scrollGroup.y = 0, null != this.adButton) {
                this.adButton.alpha = 0, this.downloadLabel.alpha = 0;
                var e = this;
                this.amazingGame.amazingAd.initialized ? (e.amazingGame.amazingAdProvider.sendRequest("320x120"), 
                this.amazingGame.amazingAd.get_ad("320x120", function(t) {
                    e.currentBannerAd = t, null != e.currentBannerAd && (AmazingGame.getInstance().cache.checkImageKey(t.sourceUrl) ? (e.adButton.loadTexture(t.sourceUrl), 
                    e.adButton.set_all_frames(t.sourceUrl), e.game.add.tween(e.adButton).to({
                        alpha: 1
                    }, Phaser.Timer.SECOND, Phaser.Easing.Quadratic.In, !0, .25 * Phaser.Timer.SECOND), 
                    e.game.add.tween(e.downloadLabel).to({
                        alpha: 1
                    }, Phaser.Timer.SECOND, Phaser.Easing.Quadratic.In, !0, .25 * Phaser.Timer.SECOND)) : Utils.download_image_from_url(t.sourceUrl, t.sourceUrl, function(t) {
                        e.adButton.loadTexture(t), e.adButton.set_all_frames(t), e.game.add.tween(e.adButton).to({
                            alpha: 1
                        }, Phaser.Timer.SECOND, Phaser.Easing.Quadratic.In, !0, .25 * Phaser.Timer.SECOND), 
                        e.game.add.tween(e.downloadLabel).to({
                            alpha: 1
                        }, Phaser.Timer.SECOND, Phaser.Easing.Quadratic.In, !0, .25 * Phaser.Timer.SECOND);
                    }.bind(this, t.sourceUrl)), e.amazingGame.amazingAdProvider.sendImpression(this.currentBannerAd));
                }.bind(this), function() {})) : (this.adButton.visible = !1, this.downloadLabel.visible = !1);
            }
        } else this.scrollGroup.stop();
    }, t.prototype.refresh = function() {
        this.SCALE = this.getMenuScale(), this.overlay.scale.set(this.SCALE), this.transitionOffset = this.BASE_OFFSET * this.SCALE, 
        this.background.width = this.transitionOffset, this.background.height = this.game.height, 
        this.game.world.pivot.x = -this.BASE_OFFSET * this.SCALE, this.position.x = -this.BASE_OFFSET * this.SCALE, 
        this.updateContentUI(), this.refreshButtons();
    }, t.prototype.refreshButtons = function() {
        this.toogleButton(this.btnSound, GameSettings.getInstance().soundEnabled), this.toogleButton(this.btnMusic, GameSettings.getInstance().musicEnabled);
    }, t.prototype.on_resize = function() {
        this.isOpened && this.refresh();
    }, t.prototype.addMenuButton = function(t, e, i, n, s, o, a, r) {
        void 0 === r && (r = Atlases.MENU_COMPONENT);
        var h = new ScaleButton(this.game, 100, n, t, e, this.onButtonClick, this);
        if (i && (h.addBMFLabel(i, Fonts.RUBIKREGULAR40, 38), h.bmfLabel.setAlignLeft(), 
        h.bmfLabel.position.x = -165, h.bmfLabel.position.y = 0, o && (h.bmfLabel.tint = o)), 
        s) {
            var l = this.game.add.image(-200, 0, r, s);
            l.anchor.set(.5), l.smoothed = !0, h.addChild(l), a && (l.tint = a);
        }
        return this.addChild(h), h;
    }, t.prototype.updateContentUI = function() {
        var t = 80 * this.SCALE, e = this.overlay.top + 70 * this.SCALE, i = this.transitionOffset / 2;
        this.btnHome.position.set(i, e), this.btnHome.set_scale(1 * this.SCALE), e += t, 
        this.btnNewGame.position.set(i, e), this.btnNewGame.set_scale(1 * this.SCALE), e += t, 
        this.btnThemes.position.set(i, e), this.btnThemes.set_scale(1 * this.SCALE), this.downloadLabel && (e += t, 
        this.downloadLabel.position.set(i, e - 5 * this.SCALE), this.downloadLabel.scale.set(this.SCALE, this.SCALE)), 
        this.adButton && (e += t, this.adButton.position.set(i, e), this.adButton.set_scale(this.SCALE)), 
        this.btnRate && (e += 1.75 * t, this.btnRate.position.set(i, e), this.btnRate.set_scale(1 * this.SCALE)), 
        this.btnPlatformDownload && (e += 1.75 * t, this.btnPlatformDownload.position.set(i, e), 
        this.btnPlatformDownload.set_scale(1 * this.SCALE)), e += 1.25 * t, this.btnSound.position.set(i, e), 
        this.btnSound.set_scale(1 * this.SCALE), e += t, this.btnMusic.position.set(i, e), 
        this.btnMusic.set_scale(1 * this.SCALE), this.btnMoreGames && (e += t, this.btnMoreGames.position.set(i, e), 
        this.btnMoreGames.set_scale(1 * this.SCALE)), this.btnPrivatePolicy && (e += t, 
        this.btnPrivatePolicy.position.set(i, e), this.btnPrivatePolicy.set_scale(1 * this.SCALE));
        var n = this.game.height;
        this.logo.position.x = i - 90, this.logo.position.y = n - 60 * this.SCALE, this.logo.scale.set(this.SCALE), 
        this.tw && (this.tw.position.x = i + 180 * this.SCALE, this.fb.position.x = i + 90 * this.SCALE, 
        this.fb.position.y = n - 60 * this.SCALE, this.tw.position.y = n - 60 * this.SCALE, 
        this.tw.set_scale(this.SCALE), this.fb.set_scale(this.SCALE)), this.isWebMobile;
    }, t.prototype.addAdvertising = function(t) {
        Constants.PLAY_CROSS_PROMOTION && !Constants.IS_POKI && (this.adButton = new ScaleButton(this.game, this.menuCenterX, t + 20, "ad1", "ad1", this.onButtonClick, this), 
        this.adButton.anchor.set(.5, .5), this.adButton.set_scale(1), this.adButton.name = "addbutton", 
        this.addChild(this.adButton), this.downloadLabel = new BMFLabel(this.game, 0, 0, Fonts.RUBIKREGULAR40, this.amazingGame.translate("menu_download_other_game"), 28), 
        this.downloadLabel.setMaxSize(480, 30), this.downloadLabel.setVerticalandHorizontalCenter(), 
        this.downloadLabel.setTranslation({
            translationID: "menu_download_other_game",
            isUpperCase: !0
        }), this.downloadLabel.tint = 11173329, this.addChild(this.downloadLabel));
    }, t.prototype.addCheckBox = function(t, e) {
        var i = this.game.add.image(190, 0, Atlases.MENU_COMPONENT, "ick_non_check.png");
        i.anchor.set(.5), i.scale.set(.85), e && (i.tint = e), t.addChild(i);
    }, t.prototype.toogleButton = function(t, e) {
        t.children[2].frameName = e ? "ick_check.png" : "ick_non_check.png";
    }, t.prototype.onButtonClick = function(t) {
        this.isShowed && (t === this.btnHome ? (this.gameScene.toogle_menu(null), AmazingGame.getInstance().runScene(MainMenu.Name, !0), 
        gameanalytics.GameAnalytics.addDesignEvent("menu:home")) : t === this.btnNewGame ? (this.gameScene.toogle_menu(null), 
        GameSettings.getInstance().applicationData.tutorialPassed = !0, this.gameScene.open_popup(ConfirmNewGame.NAME), 
        gameanalytics.GameAnalytics.addDesignEvent("menu:newgame")) : t === this.btnThemes ? (this.gameScene.toogle_menu(null), 
        this.gameScene.open_popup(ThemeDialog.NAME), gameanalytics.GameAnalytics.addDesignEvent("menu:themes")) : t === this.adButton ? (this.amazingGame.amazingAdProvider.open_ad_depends_on_platform(this.currentBannerAd.promoteUrl), 
        this.amazingGame.amazingAdProvider.sendClick(this.currentBannerAd)) : t === this.btnRate ? (this.amazingGame.PlatformProvider.review_game(), 
        gameanalytics.GameAnalytics.addDesignEvent("menu:rate")) : t === this.btnSound ? (GameSettings.getInstance().soundEnabled = !GameSettings.getInstance().soundEnabled, 
        this.refreshButtons(), GameSettings.getInstance().save(), gameanalytics.GameAnalytics.addDesignEvent("menu:sound")) : t === this.btnMusic ? (GameSettings.getInstance().musicEnabled = !GameSettings.getInstance().musicEnabled, 
        this.refreshButtons(), GameSettings.getInstance().musicEnabled ? AudioManager.getInstance().play_background() : AudioManager.getInstance().stop_background(), 
        GameSettings.getInstance().save(), gameanalytics.GameAnalytics.addDesignEvent("menu:music")) : t === this.btnMoreGames ? (this.amazingGame.PlatformProvider.open_more_games(), 
        gameanalytics.GameAnalytics.addDesignEvent("menu:moregames")) : t === this.btnPrivatePolicy ? (this.amazingGame.PlatformProvider.open_link(Constants.PRIVATE_POLICY), 
        gameanalytics.GameAnalytics.addDesignEvent("menu:private")) : t === this.fb ? (this.amazingGame.PlatformProvider.open_link(Constants.FACEBOOK_LINK), 
        gameanalytics.GameAnalytics.addDesignEvent("menu:fb")) : t === this.tw ? (this.amazingGame.PlatformProvider.open_link(Constants.TWITTER_LINK), 
        gameanalytics.GameAnalytics.addDesignEvent("menu:tw")) : t === this.btnPlatformDownload && (AmazingGame.getInstance().PlatformProvider.openThisAppFromWebView(), 
        gameanalytics.GameAnalytics.addDesignEvent("menu:download")), AudioManager.getInstance().play_button(), 
        this.gameScene.refresh_ui());
    }, t.prototype.getMenuScale = function() {
        var t = Math.min(2, this.game.height / 1080), e = Math.min(1.4, this.game.width / (this.BASE_OFFSET + 120));
        return this.gameScene.game.isLandscape ? t : this.game.width / this.game.device.pixelRatio < this.BASE_OFFSET ? e : t;
    }, t;
}(Phaser.Group), Atlases = function() {
    function t() {}
    return t.MENU_SHEET = "menu", t.MENU_COMPONENT = "menusheet", t.UI = "ui", t.UI2 = "ui2", 
    t.THEMES = "themes", t.LEADERBOARD = "leaderboard", t.EXIT_DIALOG = "exitdialog", 
    t.GAME = "game", t.EXTRAS = "extras", t.RING_ANIM = "ring_anim", t.preloadList = [], 
    t.list = [ t.MENU_COMPONENT, t.MENU_SHEET, t.UI, t.UI2, t.THEMES, t.LEADERBOARD, t.EXIT_DIALOG, t.GAME, t.EXTRAS, t.RING_ANIM ], 
    t;
}(), _EXITDIALOG = {
    btn_no: "btn_no.png",
    btn_try: "btn_try.png",
    btn_yes: "btn_yes.png",
    dlg_exit: "dlg_exit.png"
}, _EXTRAS = {
    apple: "apple.png",
    btnmenu: "btnmenu.png",
    btnmenuoverlay: "btnmenuoverlay.png",
    btnwheeloff: "btnwheeloff.png",
    btnwheelon: "btnwheelon.png",
    dlg_theme_1: "dlg_theme_1.png",
    dlg_theme_2: "dlg_theme_2.png",
    google: "google.png",
    ick_google: "ick_google.png",
    "ick_google@2x": "ick_google@2x.png",
    ick_non_check: "ick_non_check.png",
    ick_phone: "ick_phone.png",
    "ick_phone@2x": "ick_phone@2x.png",
    ick_windows: "ick_windows.png",
    "ick_windows@2x": "ick_windows@2x.png",
    logo: "logo.png",
    windows: "windows.png"
}, _GAME = {
    0: "0.png",
    1: "1.png",
    2: "2.png",
    3: "3.png",
    4: "4.png",
    5: "5.png",
    6: "6.png",
    7: "7.png",
    8: "8.png",
    9: "9.png",
    ball: "ball.png",
    blue_1: "blue_1.png",
    blue_2: "blue_2.png",
    blue_3: "blue_3.png",
    blue_4: "blue_4.png",
    blue_5: "blue_5.png",
    bomb: "bomb.png",
    bomb_info: "bomb_info.png",
    color: "color.png",
    corner: "corner.png",
    effect_bomb: "effect_bomb.png",
    effect_line: "effect_line.png",
    emptycorner: "emptycorner.png",
    green_1: "green_1.png",
    green_2: "green_2.png",
    green_3: "green_3.png",
    green_4: "green_4.png",
    green_5: "green_5.png",
    horizontal: "horizontal.png",
    line: "line.png",
    orange_1: "orange_1.png",
    orange_2: "orange_2.png",
    orange_3: "orange_3.png",
    orange_4: "orange_4.png",
    orange_5: "orange_5.png",
    pink_1: "pink_1.png",
    pink_2: "pink_2.png",
    pink_3: "pink_3.png",
    pink_4: "pink_4.png",
    pink_5: "pink_5.png",
    purple_1: "purple_1.png",
    purple_2: "purple_2.png",
    purple_3: "purple_3.png",
    purple_4: "purple_4.png",
    purple_5: "purple_5.png",
    summerboard: "summerboard.png",
    turkus_1: "turkus_1.png",
    turkus_2: "turkus_2.png",
    turkus_3: "turkus_3.png",
    turkus_4: "turkus_4.png",
    turkus_5: "turkus_5.png",
    tut_hand: "tut_hand.png",
    vertical: "vertical.png",
    wildcard: "wildcard.png",
    wildcard_line: "wildcard_line.png",
    yellow_1: "yellow_1.png",
    yellow_2: "yellow_2.png",
    yellow_3: "yellow_3.png",
    yellow_4: "yellow_4.png",
    yellow_5: "yellow_5.png"
}, _LEADERBOARD = {
    btn_findme: "btn_findme.png",
    btn_monthly: "btn_monthly.png",
    btn_overall: "btn_overall.png",
    btn_rename: "btn_rename.png",
    btn_weekly: "btn_weekly.png",
    dlg_leaderboard: "dlg_leaderboard.png"
}, _MENU = {
    btncontinue: "btncontinue.png",
    btnfb: "btnfb.png",
    btnplay: "btnplay.png",
    btnrank: "btnrank.png",
    btnsettings: "btnsettings.png",
    btnstats: "btnstats.png",
    btntheme: "btntheme.png",
    btntw: "btntw.png",
    hedgehog: "hedgehog.png",
    logo: "logo.png"
}, _MENUSHEET = {
    apple: "apple.png",
    exitbutton: "exitbutton.png",
    fbbutton: "fbbutton.png",
    google: "google.png",
    ick_back: "ick_back.png",
    "ick_back@2x": "ick_back@2x.png",
    ick_check: "ick_check.png",
    "ick_check@2x": "ick_check@2x.png",
    ick_feedback: "ick_feedback.png",
    "ick_feedback@2x": "ick_feedback@2x.png",
    ick_games: "ick_games.png",
    "ick_games@2x": "ick_games@2x.png",
    ick_google: "ick_google.png",
    "ick_google@2x": "ick_google@2x.png",
    ick_hard: "ick_hard.png",
    "ick_hard@2x": "ick_hard@2x.png",
    ick_help: "ick_help.png",
    "ick_help@2x": "ick_help@2x.png",
    ick_home: "ick_home.png",
    "ick_home@2x": "ick_home@2x.png",
    ick_ios: "ick_ios.png",
    ick_lap: "ick_lap.png",
    ick_menu: "ick_menu.png",
    "ick_menu@2x": "ick_menu@2x.png",
    ick_more: "ick_more.png",
    "ick_more@2x": "ick_more@2x.png",
    ick_music: "ick_music.png",
    "ick_music@2x": "ick_music@2x.png",
    ick_non_check: "ick_non_check.png",
    "ick_non_check@2x": "ick_non_check@2x.png",
    ick_phone: "ick_phone.png",
    "ick_phone@2x": "ick_phone@2x.png",
    ick_refresh: "ick_refresh.png",
    "ick_refresh@2x": "ick_refresh@2x.png",
    ick_relax: "ick_relax.png",
    "ick_relax@2x": "ick_relax@2x.png",
    ick_review: "ick_review.png",
    "ick_review@2x": "ick_review@2x.png",
    ick_share: "ick_share.png",
    "ick_share@2x": "ick_share@2x.png",
    ick_sound: "ick_sound.png",
    "ick_sound@2x": "ick_sound@2x.png",
    ick_windows: "ick_windows.png",
    "ick_windows@2x": "ick_windows@2x.png",
    spinner: "spinner.png",
    theme: "theme.png",
    "theme@2x": "theme@2x.png",
    twitterbutton: "twitterbutton.png",
    windows: "windows.png"
}, _RING_ANIM = {
    "Symbol 10000": "Symbol 10000",
    "Symbol 10001": "Symbol 10001",
    "Symbol 10002": "Symbol 10002",
    "Symbol 10003": "Symbol 10003",
    "Symbol 10004": "Symbol 10004",
    "Symbol 10005": "Symbol 10005",
    "Symbol 10006": "Symbol 10006",
    "Symbol 10007": "Symbol 10007",
    "Symbol 10008": "Symbol 10008",
    "Symbol 10009": "Symbol 10009",
    "Symbol 10010": "Symbol 10010"
}, _UI = {
    bgdialog: "bgdialog.png",
    btnblue: "btnblue.png",
    btnbluesmall: "btnbluesmall.png",
    btnclose: "btnclose.png",
    btncontinue: "btncontinue.png",
    btnDarkBlue: "btnDarkBlue.png",
    btngreen: "btngreen.png",
    btnLightBlue: "btnLightBlue.png",
    btnmenu: "btnmenu.png",
    btnnewgame: "btnnewgame.png",
    btnplay: "btnplay.png",
    btnRateUs: "btnRateUs.png",
    btnRed: "btnRed.png",
    dot: "dot.png",
    dotsmoll: "dotsmoll.png",
    nineslice: "nineslice.png",
    tgloff: "tgloff.png",
    tglon: "tglon.png"
}, _UI2 = {
    bgmenu: "bgmenu.png",
    btnblue: "btnblue.png",
    btnfb: "btnfb.png",
    btngreen: "btngreen.png",
    btnmenu: "btnmenu.png",
    btnmenu_back: "btnmenu_back.png",
    btnred: "btnred.png",
    btntw: "btntw.png",
    ickdifficulty: "ickdifficulty.png",
    ickhome: "ickhome.png",
    ickmore: "ickmore.png",
    ickmusic: "ickmusic.png",
    ickplay: "ickplay.png",
    ickprivacy: "ickprivacy.png",
    ickreview: "ickreview.png",
    icksound: "icksound.png",
    ickthemes: "ickthemes.png",
    menulogo: "menulogo.png"
}, Colors = function() {
    function s() {}
    return s.random = function() {
        var t = s.THEMES_ARRAY[0];
        return t[Math.floor(Math.random() * t.length)];
    }, s.getRandomPastel = function() {
        var t = s.random(), e = (Utils.randomInt(0, 256) + t[0]) / 2, i = (Utils.randomInt(0, 256) + t[1]) / 2, n = (Utils.randomInt(0, 256) + t[2]) / 2;
        return 1 === GameSettings.getInstance().applicationData.themeIndex && (e = i = n = (Utils.randomInt(0, 127) + t[0]) / 2), 
        "rgb(" + Math.round(e) + "," + Math.round(i) + "," + Math.round(n) + ")";
    }, s.BONUS_LINE_COLOR = "#" + Phaser.Color.componentToHex(Utils.RGBtoHEX(252, 183, 39)), 
    s.THEMES_ARRAY = [ s.THEME1 = [ [ 109, 220, 253 ], [ 236, 161, 244 ], [ 197, 144, 255 ], [ 251, 149, 150 ], [ 172, 180, 214 ] ], s.THEME2 = [ [ 64, 64, 64 ], [ 76, 76, 76 ], [ 96, 96, 96 ], [ 128, 128, 128 ] ], s.THEME3 = [ [ 37, 126, 196 ], [ 30, 123, 161 ], [ 187, 129, 193 ], [ 122, 126, 205 ], [ 167, 90, 121 ], [ 85, 15, 51 ] ], s.THEME4 = [ [ 247, 178, 70 ], [ 247, 229, 147 ], [ 200, 246, 148 ], [ 126, 246, 204 ], [ 100, 206, 247 ], [ 149, 166, 244 ] ], s.THEME5 = [ [ 242, 238, 216 ], [ 254, 185, 232 ], [ 242, 238, 216 ], [ 254, 185, 232 ] ], s.THEME6 = [ [ 48, 190, 254 ], [ 195, 248, 255 ], [ 240, 231, 130 ] ] ], 
    s;
}(), DISABLE_ADS_PROMO_INSTALL_FOR_LICENSE = !1, DISABLE_LINKS_FOR_LICENSE = !1, IS_4BALANCE = !1, IS_HAPPY_TUBE = !1, IS_CRAZY_GAMES = !1, IS_AMAZING = !0, Constants = function() {
    function t() {}
    return Object.defineProperty(t, "IS_MOBILE_COMPILE_VERSION", {
        get: function() {
            return t.COMPILE_PLATFORM === Platform.UWP || t.COMPILE_PLATFORM === Platform.ANDROID || t.COMPILE_PLATFORM === Platform.IOS;
        },
        enumerable: !0,
        configurable: !0
    }), Object.defineProperty(t, "IS_MOBILE_WEB_VERSION", {
        get: function() {
            return GlobalVars.Platform === Platform.WEB || GlobalVars.Platform === Platform.ANDROID || GlobalVars.Platform === Platform.IOS || GlobalVars.Platform === Platform.UWP_MOBILE;
        },
        enumerable: !0,
        configurable: !0
    }), t.DISABLE_LINKS = function() {
        return t.IS_POKI;
    }, t.IS_GAME_DISTRIBUTION = !1, t.IS_GAME_MONETIZATION = !1, t.IS_POKI = !0, t.IS_AMAZING = !1, 
    t.IS_BLUR = !1, t.IS_KONGREGATE = !1, t.IS_UWP_WEBVIEW = !1, t.IS_NON_EXCLUSIVE = !1, 
    t.APP_VERSION = "1.0.0", t.APP_KEY = "375F703F-2BBB-477A-90BA-F2EAC231B8D1", t.COMPILE_PLATFORM = Platform.WEB, 
    t.WIDTH = 1920, t.HEIGHT = 1080, t.SAVE_AREA_TOP = 0, t.SAVE_AREA_BOTTOM = 0, t.GAME_NAME = "Amazing Bubble Connect", 
    t.CONFIG_GAME_NAME = "amazingbubbleconnect", t.ENGINE_VERSION = "1.0.0", t.READ_SERVER_SETTINGS = !1, 
    t.SAVE_SERVER_SETTINGS = !1, t.ROTATE_LOGO = !1, t.IS_DEBUG = !1, t.IS_SCREENSHOT_MODE = !1, 
    t.SHOW_DEBUG_CONSOLE = !1, t.ADS_TESTING = !1, t.IS_ADVANCED_DEBUG = !1, t.USE_ANALYTICS = !1, 
    t.IS_FONT_DEBUG = !1, t.LANDSCAPE_LOCKED = !1, t.PORTRAIT_LOCKED = !1, t.PLAY_ADS = !0, 
    t.PLAY_BANNER_ADS = !0, t.PLAY_CROSS_PROMOTION = !0, t.PLAY_BANNER_CROSS_PROMO = !0, 
    t.SHOW_INSTALL_PROMPT = !0, t.USE_ADS_FRAMEWORK = !0, t.GAME_DISTRIBUTION_ID = "5eade0fe867a461aaabb71a87a2efc8a", 
    t.USER_DISTRIBUTION_ID = "728A509E-960C-417F-B752-F0DEBB768976-s1", t.GAME_MONETIZATION_ID = "69sbn7id0yzwwrawqhypq3zeb4q2zsl6", 
    t.USER_MONETIZATION_ID = "69sbn7id0yzwwrawqhypq3zeb4q2zsl6", t.GAME_KEY = "ce176361cc9f7537cecf574b56b92ae0", 
    t.GAME_SECRET = "a82868a2c701aadde6ac5e56920e847e61f73340", t.GOOGLE_ANALYTICS = "UA-102496985-9", 
    t.FACEBOOK_LINK = "https://www.facebook.com/amazinghedgehogstudio", t.TWITTER_LINK = "https://twitter.com/hedgehogamazing", 
    t.IOS_APP_ID = "id1464228524", t.ANDROID_APP_ID = "com.amazinghedgehog.amazingbubbleconnect", 
    t.AMAZON_APP_ID = "com.amazinghedgehog.amazingbubbleconnect", t.UWP_APP_ID = "9nnbjqrb715j", 
    t.FACEBOOK_ID = "https://www.facebook.com/amazinghedgehogstudio", t.UWP_REVIEW = "9nnbjqrb715j", 
    t.IOS_REVIEW = "id1464228524", t.ANDROID_REVIEW = "com.amazinghedgehog.amazingbubbleconnect", 
    t.AMAZON_REVIEW = "com.amazinghedgehog.amazingbubbleconnect", t.CHROME_REVIEW = "chrome review", 
    t.CHROME_STORE_LINK = "https://chrome.google.com/webstore/detail/amazing-cat/fmcmmboogcbikkkagcjcopebjfdocpoa", 
    t.UWP_VIDEO_ADD_UNIT_ID = "test", t.UWP_VIDEO_APPLICATION_ID = "d25517cb-12d4-4699-8bdc-52040c712cab", 
    t.UWP_BANNER_ADD_UNIT_ID = "test", t.UWP_BANNER_APPLICATION_ID = "3f83fe91-d6be-434d-a0ae-7351c5a997f1", 
    t.ANDROID_MOBILE_APP_ID = "ca-app-pub-3940256099942544~3347511713", t.IOS_MOBILE_APP_ID = "ca-app-pub-9003877865320415~9883919028", 
    t.IOS_FACEBOOK_INTERSATIAL = "", t.ANDROID_FACEBOOK_INTERSATIAL = "", t.AMAZON_INTERSATIAL = "ca-app-pub-3940256099942544/1033173712", 
    t.IOS_ADMOB_INTERSATIAL = "ca-app-pub-3940256099942544/1033173712", t.ANDROID_ADMOB_INTERSATIAL = "ca-app-pub-3940256099942544/1033173712", 
    t.IOS_ADMOB_REWARDED = "ca-app-pub-3940256099942544/1033173712", t.ANDROID_ADMOB_REWARDED = "ca-app-pub-3940256099942544/5224354917", 
    t.AMAZON_BANNER = "ca-app-pub-3940256099942544/6300978111", t.ANDROID_ADMOB_BANNER = "ca-app-pub-3940256099942544/6300978111", 
    t.IOS_ADMOB_BANNER = "ca-app-pub-3940256099942544/2934735716", t.GOOGLE_AD_SENSE_KEY_SKIPABLE = "https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dskippablelinear&correlator=", 
    t.GOOGLE_AD_SENSE_KEY = "https://pubads.g.doubleclick.net/gampad/ads?sz=400x300|640x480|1x1&iu=/21636755718/amazing_cat&ciu_szs=4x1,6x1,1x1,-1x-2,-1x-1,88x31,120x20,120x30,120x60,120x90,120x240,120x600,125x125,160x600,168x28,168x42,180x150,200x200,216x36,216x54,234x60,240x400,250x250,300x50,300x75,300x100,300x250,300x600,320x50,320x480,336x280,468x60,480x320,728x90,768x1024,970x90,1024x768&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=[referrer_url]&description_url=[description_url]&correlator=[timestamp]", 
    t.GOOGLE_AD_SENSE_ID = "", t.LIFE_STREET_KEY = "", t.LIFE_STREET_ID = "", t.MORE_GAMES = "https://amazinghedgehog.com", 
    t.PRIVATE_POLICY = "https://amazinghedgehog.com/privacy_policy.html", t.TWITTER_SHARE = "https://twitter.com/share?", 
    t.TWITTER_URL = "&url=https://amazinghedgehog.com", t.TWITTER_TEXT = "&text=", t;
}(), Fonts = function() {
    function t() {}
    return t.MULTI_LOCALIZE = {
        rubik_medium_32: [ "en", "kr" ],
        rubik_regular_35: [ "en", "kr" ],
        rubik_regular_40: [ "en", "kr" ],
        rubik_regular_55: [ "en", "kr" ],
        rubik_regular_72: [ "en", "kr" ]
    }, t.HELVETICA = '"Helvetica Neue", Helvetica, "Arial Unicode MS", Arial, sans-serif', 
    t.RUBIKMEDIUM24 = "rubik_medium_24", t.RUBIKMEDIUM32 = "rubik_medium_32", t.RUBIKREGULAR35 = "rubik_regular_35", 
    t.RUBIKREGULAR40 = "rubik_regular_40", t.RUBIKREGULAR55 = "rubik_regular_55", t.RUBIKREGULAR72 = "rubik_regular_72", 
    t.DIGITALDISPLAY48 = "digital_display_48", t.DIGITALDISPLAY62 = "digital_display_62", 
    t.DIGITALDISPLAY72 = "digital_display_72", t.DIGITALDISPLAY62OUTLINE = "digital_display_62_outline", 
    t.DIGITALDISPLAY62OUTLINEWHITE = "digital_display_62_outline_white", t.RUBIKMEDIUM50 = "rubikmedium50", 
    t.RUBIKMEDIUM72 = "rubikmedium72", t.preloadList = [], t.list = [ t.RUBIKMEDIUM50, t.RUBIKMEDIUM72, t.RUBIKMEDIUM24, t.RUBIKMEDIUM32, t.RUBIKREGULAR35, t.RUBIKREGULAR40, t.RUBIKREGULAR55, t.RUBIKREGULAR72, t.DIGITALDISPLAY48, t.DIGITALDISPLAY62, t.DIGITALDISPLAY72, t.DIGITALDISPLAY62OUTLINE, t.DIGITALDISPLAY62OUTLINEWHITE ], 
    t;
}(), Images = function() {
    function t() {}
    return t.LOGO = "logo", t.ALPHA_LOGO = "alpha_logo", t.PRELOAD = "preload", t.PRELOAD_BACK = "preloadback", 
    t.PRELOAD_TOP = "preloadtop", t.PRELOAD_BG = "bg_land", t.FAVICON = "favicon", t.FAVICON2x = "favicon@2x", 
    t.DIALOG_BG = "dialog_bg", t.GAME_BACKGROUND = "game/background", t.PROMO_STAR = "promo/star", 
    t.PIXEL = "game/linepix", t.DARK_PIXEL = "game/darkpixel", t.LINE = "game/line", 
    t.ICON = "web/72", t.ICON_2X = "web/144", t.STARS = "promo/stars", t.CLOSE = "promo/btn_close_install", 
    t.CLOSE_PROMO = "promo/btn_close_promo", t.DLG_PROMO_LANDSCAPE = "promo/dlg_landscape", 
    t.DLG_PROMO_PORTRAIT = "promo/dlg_portrait", t.BTN_PLAY_LANDSCAPE = "promo/btn_play_landscape", 
    t.BTN_PLAY_PORTRAIT = "promo/btn_play_portrait", t.PARTICLE_DOT = "particles/dot", 
    t.PARTICLE_STAR = "particles/star", t.PARTICLE_CIRCLE = "particles/circle", t.PARTICLE_RING = "particles/ring", 
    t.preloadList = [ t.LOGO, t.PRELOAD, t.PRELOAD_BACK, t.PRELOAD_TOP ], t.list = [ t.DIALOG_BG, t.FAVICON, t.FAVICON2x, t.GAME_BACKGROUND, t.PROMO_STAR, t.PIXEL, t.DARK_PIXEL, t.ALPHA_LOGO, t.LINE, t.ICON, t.ICON_2X, t.STARS, t.CLOSE, t.CLOSE_PROMO, t.DLG_PROMO_LANDSCAPE, t.DLG_PROMO_PORTRAIT, t.BTN_PLAY_LANDSCAPE, t.BTN_PLAY_PORTRAIT, t.PARTICLE_DOT, t.PARTICLE_STAR, t.PARTICLE_CIRCLE, t.PARTICLE_RING ], 
    t;
}(), RemoteConfig = function() {
    function n() {}
    return n.fetch = function() {
        var i = this, t = "web";
        IS_CRAZY_GAMES && (t = "web_crazygames"), Constants.IS_GAME_MONETIZATION && (t = "web_game_monetization"), 
        IS_AMAZING && (t = "web_amazing"), Constants.COMPILE_PLATFORM === Platform.ANDROID ? t = "android" : Constants.COMPILE_PLATFORM === Platform.IOS ? t = "ios" : Constants.COMPILE_PLATFORM === Platform.UWP && (t = "uwp");
        var e = "https://config.amazinghedgehog.com/amazingbubbleconnect/" + t + ".json?d=" + Date.now();
        HttpUtils.get(e, function(t) {
            var e = JSON.parse(t);
            i.remoteConfig = e, n.initiaize(e);
        }), Constants.IS_POKI && (this.SHOW_INSTALL_PROMPT = !1, this.USE_ADS_FRAMEWORK = !1, 
        this.SHOW_AMAZING_BUTTON = !1, this.PLAY_BANNER_ADS = !1, this.PLAY_BANNER_DIALOG_ADS = !1, 
        this.PLAY_CROSS_PROMOTION = !1, this.PLAY_BANNER_CROSS_PROMO = !1, this.BTN_MAIN_MENU_SHOW_MORE_GAMES = !1);
    }, n.initiaize = function(t) {
        this.SHOW_AMAZING_BUTTON = t.showAmazingButton, this.PLAY_BANNER_ADS = t.playBannerAds, 
        this.PLAY_BANNER_DIALOG_ADS = t.playBannerDialogAds, this.PLAY_CROSS_PROMOTION = t.playCrossPromoPromotion, 
        this.PLAY_BANNER_CROSS_PROMO = t.playBannerCrossPromo, void 0 !== t.gameScreenPlayVideoEvery && (this.GAME_SCREEN_SHOW_VIDEO_ADS_EVERY = t.gameScreenPlayVideoEvery), 
        void 0 !== t.mainMenuPlayVideoEvery && (this.MAINMENU_SHOW_VIDEO_ADS_EVERY = t.mainMenuPlayVideoEvery), 
        void 0 !== t.playVideoAdEvery && (this.VIDEO_ADD_MIN_TIME = t.playVideoAdEvery), 
        void 0 !== t.btnMainMenuShowMoreGames && (this.BTN_MAIN_MENU_SHOW_MORE_GAMES = t.btnMainMenuShowMoreGames), 
        Constants.IS_POKI && (this.SHOW_INSTALL_PROMPT = !1, this.USE_ADS_FRAMEWORK = !1, 
        this.SHOW_AMAZING_BUTTON = !1, this.PLAY_BANNER_ADS = !1, this.PLAY_BANNER_DIALOG_ADS = !1, 
        this.PLAY_CROSS_PROMOTION = !1, this.PLAY_BANNER_CROSS_PROMO = !1, this.BTN_MAIN_MENU_SHOW_MORE_GAMES = !1);
    }, n.ASK_REVIEW_PER_GAME_SESSION = 4, n.ASK_REVIEW_PER_MENU_ENTER = 4, n.SHOW_PROMO_DIALOG = 1, 
    n.SHOW_PROMO_DIALOG_WEB = 1, n.GAME_SCREEN_SHOW_VIDEO_ADS_EVERY = 3, n.MAINMENU_SHOW_VIDEO_ADS_EVERY = 3, 
    n.BTN_MAIN_MENU_SHOW_MORE_GAMES = !1, n.PLAY_ADS = !0, n.PLAY_BANNER_ADS = !0, n.PLAY_BANNER_DIALOG_ADS = !0, 
    n.PLAY_CROSS_PROMOTION = !0, n.PLAY_BANNER_CROSS_PROMO = !0, n.SHOW_INSTALL_PROMPT = !0, 
    n.USE_ADS_FRAMEWORK = !0, n.OPEN_THANKS_PAGE = !0, n.SHOW_AMAZING_BUTTON = !1, n.VIDEO_ADD_MIN_TIME = 18e4, 
    n.SHOW_VIDEO_ADS_EVERY = 2, n.HINTS_FOR_ADS = 5, n;
}(), Sounds = function() {
    function t() {}
    return t.BACKGROUND = "sounds/background", t.CLICK = "sounds/button", t.BOMB = "sounds/bomb", 
    t.CREATE_BOMB = "sounds/create_bomb", t.GAME_OVER = "sounds/gameover", t.HORIZONTAL = "sounds/horizontal", 
    t.REMOVE_BUBBLES = "sounds/remove_bubbles", t.WILDCARD_SELECTION = "sounds/wildcard_selection", 
    t.BOMB_SPAWN = "sounds/bomb_spawn", t.WILDCARD_TAP = "sounds/wildcard_tap", t.COLOR_REMOVE = "sounds/color_remove", 
    t.POP1 = "sounds/pop1", t.POP2 = "sounds/pop2", t.POP3 = "sounds/pop3", t.POP4 = "sounds/pop4", 
    t.POP5 = "sounds/pop5", t.POP6 = "sounds/pop6", t.POP7 = "sounds/pop7", t.preloadList = [], 
    t.list = [ t.BACKGROUND, t.CLICK, t.BOMB, t.CREATE_BOMB, t.GAME_OVER, t.HORIZONTAL, t.REMOVE_BUBBLES, t.WILDCARD_SELECTION, t.BOMB_SPAWN, t.WILDCARD_TAP, t.COLOR_REMOVE, t.POP1, t.POP2, t.POP3, t.POP4, t.POP5, t.POP6, t.POP7 ], 
    t;
}(), Triple = function() {}, SpriteSheets = function() {
    function t() {}
    return t.EXPLODE_ANIMATION = {
        Name: "expolde_anim",
        Width: 160,
        Height: 160,
        FrameCount: 15
    }, t.HORIZONTAL_ANIMATION = {
        Name: "horiz_anim",
        Width: 510,
        Height: 160,
        FrameCount: 15
    }, t.BOMB_ANIMATION = {
        Name: "bomb_explo",
        Width: 160,
        Height: 160,
        FrameCount: 15
    }, t.preloadList = [], t.list = [ t.EXPLODE_ANIMATION, t.HORIZONTAL_ANIMATION, t.BOMB_ANIMATION ], 
    t;
}(), Strings = function() {
    function t() {}
    return t.GAME_NAME = "Amazing Bubble Connect", t.AMAZING_START_PHRASES = [ "Initialize Assets Module...", "Initialize Amazing Game Module...", "Loading Amazing Assets...", "Loading Amazing Audio...", "Loading Amazing Animations...", "Starting Amazing Solitaire..." ], 
    t;
}(), WordsearchRank = function() {}, DebugScene = function(i) {
    function e(t) {
        var e = i.call(this, t) || this;
        return e.graphics = new Phaser.Graphics(t), e.addChild(e.graphics), e;
    }
    return __extends(e, i), e.init = function(t) {
        return e.instance = new e(t);
    }, e.prototype.start = function() {
        this.graphics.clear();
    }, e.prototype.renderScaleButton = function(t, e, i) {
        void 0 === e && (e = 1626375), void 0 === i && (i = .5);
        t.getBounds();
        if (t.bmfLabel) {
            t.bmfLabel.maxWidth || (e = 15078182);
            var n = t.bmfLabel.maxWidth ? t.bmfLabel.maxWidth : t.bmfLabel.width, s = t.bmfLabel.maxHeight ? t.bmfLabel.maxHeight : t.bmfLabel.height, o = 0, a = 0;
            n *= t.bmfLabel.worldScale.x, s *= t.bmfLabel.worldScale.y, 1 === t.bmfLabel.anchor.x && (o = n), 
            .5 === t.bmfLabel.anchor.x && (o = n / 2), 1 === t.bmfLabel.anchor.y && (a = s), 
            .5 === t.bmfLabel.anchor.y && (a = s / 2), t.bmfLabel.parent instanceof PopUp && (a = s / 2);
            var r = new Phaser.Rectangle(t.bmfLabel.worldPosition.x - o, t.bmfLabel.worldPosition.y - a, n, s);
            this.renderRect(r, e, i);
        }
    }, e.prototype.renderBMFLabel = function(t, e, i) {
        if (void 0 === e && (e = 1626375), void 0 === i && (i = .5), t) {
            t.maxWidth || (e = 15078182);
            var n = t.maxWidth ? t.maxWidth : t.width, s = t.maxHeight ? t.maxHeight : t.height, o = 0, a = 0;
            n *= t.worldScale.x, s *= t.worldScale.y, 1 === t.anchor.x && (o = n), .5 === t.anchor.x && (o = n / 2), 
            1 === t.anchor.y && (a = s), .5 === t.anchor.y && (a = s / 2);
            var r = new Phaser.Rectangle(t.worldPosition.x - o, t.worldPosition.y - a, n, s);
            this.renderRect(r, e, i);
        }
    }, e.prototype.renderRect = function(t, e, i) {
        void 0 === e && (e = 1626375), void 0 === i && (i = .5), this.graphics.beginFill(e, i), 
        this.graphics.drawRect(t.left, t.top, t.width, t.height), this.graphics.endFill();
    }, e.prototype.renderScene = function(t) {
        var e, i, n, s, o, a;
        if (this.start(), t.activeDialog) {
            var r = t.activeDialog;
            try {
                for (var h = __values(r.children), l = h.next(); !l.done; l = h.next()) {
                    (g = l.value) instanceof ScaleButton && this.renderScaleButton(g), g instanceof BMFLabel && this.renderBMFLabel(g), 
                    g instanceof Phaser.Group && this.renderGroup(g);
                }
            } catch (t) {
                e = {
                    error: t
                };
            } finally {
                try {
                    l && !l.done && (i = h.return) && i.call(h);
                } finally {
                    if (e) throw e.error;
                }
            }
        } else {
            try {
                for (var c = __values(t.layers[0].children), u = c.next(); !u.done; u = c.next()) {
                    (g = u.value) instanceof Phaser.Group && this.renderGroup(g), g instanceof ScaleButton && this.renderScaleButton(g), 
                    g instanceof BMFLabel && this.renderBMFLabel(g);
                }
            } catch (t) {
                n = {
                    error: t
                };
            } finally {
                try {
                    u && !u.done && (s = c.return) && s.call(c);
                } finally {
                    if (n) throw n.error;
                }
            }
            try {
                for (var d = __values(t.layers[1].children), p = d.next(); !p.done; p = d.next()) {
                    var g;
                    (g = p.value) instanceof Phaser.Group && this.renderGroup(g), g instanceof ScaleButton && this.renderScaleButton(g), 
                    g instanceof BMFLabel && this.renderBMFLabel(g);
                }
            } catch (t) {
                o = {
                    error: t
                };
            } finally {
                try {
                    p && !p.done && (a = d.return) && a.call(d);
                } finally {
                    if (o) throw o.error;
                }
            }
        }
    }, e.prototype.renderGroup = function(t) {
        var e, i;
        try {
            for (var n = __values(t.children), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                o instanceof ScaleButton && this.renderScaleButton(o), o instanceof BMFLabel && this.renderBMFLabel(o), 
                o instanceof Phaser.Group && this.renderGroup(o);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
    }, e.prototype.clear = function() {
        this.graphics.clear();
    }, e.prototype.convert = function(t, e, i) {
        var n = i.toGlobal(new PIXI.Point(t, e)), s = this.toLocal(n, i);
        return [ s.x, s.y ];
    }, e.instance = null, e;
}(Phaser.Group), LOCAL_HISCORES_COUNT = 3, GameData = function() {
    this.roundScore = 0, this.roundTime = 0, this.bubblesRemoved = 0, this.bubblesRemovedType1 = 0, 
    this.bubblesRemovedType2 = 0, this.bubblesRemovedType3 = 0, this.bubblesRemovedType4 = 0, 
    this.bubblesRemovedType5 = 0, this.bubblesRemovedType6 = 0, this.grid = "", this.currentDifficulty = 0, 
    this.counters = "", this.gameInProgress = !1, this.tutorialInProgress = !1, this.tutorialIndex = 0, 
    this.startNewGameAfterInit = !1;
}, ApplicationData = function() {
    function i() {
        this.backgroundIndex = 0, this.themeIndex = 0, this.showTime = !0, this.runOnGameScreen = !1, 
        this.hardMode = !1, this.darkTheme = !1, this.hiscores = new LocalHiscores(), this.statistics = new Statistics(), 
        this.tutorialPassed = !1, this.tutorialAsked = !1, this.tutorialInProgress = !1, 
        this.tutorialIndex = 0;
    }
    return i.reproduce = function(t) {
        var e = new i();
        return e.backgroundIndex = t.backgroundIndex, e.themeIndex = t.themeIndex, e.runOnGameScreen = t.runOnGameScreen, 
        e.hardMode = t.hardMode, e.darkTheme = t.darkTheme, e.tutorialAsked = t.tutorialAsked, 
        e.tutorialPassed = t.tutorialPassed, e.tutorialInProgress = t.tutorialInProgress, 
        e.tutorialIndex = t.tutorialIndex, e.statistics = Statistics.reproduce(t.statistics), 
        e.hiscores = LocalHiscores.reprocude(t.hiscores), e;
    }, i.prototype.resetStatistics = function() {
        this.statistics = new Statistics();
    }, i.prototype.resetHiscores = function() {
        this.hiscores = new LocalHiscores();
    }, i;
}(), Statistics = function() {
    function i() {
        this.totalTime = 0, this.bestScore = 0, this.gamesPlayed = 0, this.totalBubblesRemoved = 0, 
        this.totalScore = 0;
    }
    return i.reproduce = function(t) {
        var e = new i();
        return null != t && null != t && (e.bestScore = t.bestScore, e.gamesPlayed = t.gamesPlayed, 
        e.totalBubblesRemoved = t.totalBubblesRemoved, e.totalScore = t.totalScore, e.totalTime = t.totalTime), 
        e;
    }, i.prototype.add = function(t, e, i) {
        this.totalTime += t, this.bestScore < e && (this.bestScore = e), this.gamesPlayed++, 
        this.totalBubblesRemoved += i, this.totalScore += e;
    }, i.prototype.averageTime = function() {
        return this.gamesPlayed <= 0 ? 0 : this.totalTime / this.gamesPlayed;
    }, i.prototype.averageScore = function() {
        return this.gamesPlayed <= 0 ? 0 : this.totalScore / this.gamesPlayed;
    }, i.prototype.averageBubblesRemoved = function() {
        return this.gamesPlayed <= 0 ? 0 : this.totalBubblesRemoved / this.gamesPlayed;
    }, i;
}(), Hiscore = function() {
    this.score = 0, this.name = "", this.date = new Date();
}, LocalHiscores = function() {
    function i() {
        this.hiscores = [], this.name = "";
    }
    return i.reprocude = function(t) {
        var e = new i();
        return null != t && null != t && (e.hiscores = t.hiscores), e;
    }, i.prototype.init = function(t) {
        this.name = t;
    }, i.prototype.add = function(t) {
        this.addHiscore({
            name: this.name,
            score: t,
            date: new Date()
        });
    }, i.prototype.addHiscore = function(t) {
        if (this.hiscores.length <= 0) this.hiscores.push(t); else {
            for (var e = !1, i = 0; i < this.hiscores.length; i++) if (t.score > this.hiscores[i].score) {
                this.hiscores.splice(i, 0, t), e = !0;
                break;
            }
            this.hiscores.length < LOCAL_HISCORES_COUNT && !e && this.hiscores.push(t), this.hiscores.length > LOCAL_HISCORES_COUNT && this.hiscores.pop();
        }
    }, i;
}(), GameTheme = function() {
    function e() {}
    return e.GetCurretnBallsTheme = function() {
        return 0 === GameSettings.getInstance().applicationData.themeIndex ? e.ORIGINAL_BALLS_COLORS : 1 === GameSettings.getInstance().applicationData.themeIndex ? e.SUMMER_BALLS_COLORS : e.TEXTURED_BALLS_COLORS;
    }, e.IsDarkTheme = function() {
        return GameSettings.getInstance().applicationData.darkTheme;
    }, e.IsSummerTheme = function() {
        return 1 === GameSettings.getInstance().applicationData.themeIndex;
    }, e.GetCurretnBallsTint = function(t) {
        return t = 0 < t ? t - 1 : t, e.GetCurretnBallsTheme()[t];
    }, e.GetOverlayNameForBall = function(t) {
        switch (t) {
          case 0:
            return "yellow";

          case 1:
            return "pink";

          case 2:
            return "orange";

          case 3:
            return "turkus";

          case 4:
            return "green";

          case 5:
            return "purple";

          case 7:
            return "blue";

          default:
            return "yellow";
        }
    }, e.BLUE_GAME_ACCENT = Utils.RGBtoHEX(19, 103, 185), e.ORIGINAL_BALLS_COLORS = [ 16766590, 16755882, 16727911, 7394814, 53159, 11107792, 35945, 1264538 ], 
    e.SUMMER_BALLS_COLORS = [ 16768042, 16758194, 16738320, 447713, 10606137, 11220315, 47952, 31683 ], 
    e.TEXTURED_BALLS_COLORS = [ 16766720, 16750744, 16731648, 3002334, 52120, 9987787, 31573, 1271739 ], 
    e;
}(), BubbleCreator = function() {
    function n() {}
    return n.prototype.createBubble = function(t, e) {
        var i = new Bubble();
        return i.id = "b" + ++n.bubbleCounter, i.position = new AmazingIntPoint(t.x, t.y), 
        i.value = e, i;
    }, n.prototype.resetCounter = function() {
        n.bubbleCounter = 0;
    }, n.prototype.initCounter = function(t) {
        var e = +t.slice(1);
        n.bubbleCounter < e && (n.bubbleCounter = e);
    }, n.bubbleCounter = 0, n;
}(), BubbleTypeRules = function(t) {
    this.canBeSpownSpontaneously = !0, this.matchingRules = [], this.isSpecial = !1, 
    this.myType;
}, BubbleNode = function() {}, ExecutionResult = function() {}, BasicBubbleLogic = function(e) {
    function t() {
        var t = null !== e && e.apply(this, arguments) || this;
        return t.selectionPatterns = [], t.patternWasSelected = !1, t.currentSelection = [], 
        t.minSelectionExecution = -1, t.allowTranslation = !1, t.skipPowerupSpawn = !0, 
        t.preventedPowerupdFromSkipping = [], t;
    }
    return __extends(t, e), t.prototype.init = function(t, e, i, n, s) {
        void 0 === s && (s = []), this.neighborRule = t, this.gridSelectRule = e, this.removeRule = i, 
        this.algorithm = n, this.moveRules = s;
    }, t.prototype.initGrid = function(t, e, i) {
        void 0 === i && (i = !1), this.width = t, this.height = e, this.grid = this.algorithm.generate(this.width, this.height, i);
    }, t.prototype.canSelect = function(t) {
        return !this.patternWasSelected && (!(t.x >= this.width || t.y >= this.height) && (!(t.x < 0 || t.y < 0) && (null != this.grid[t.x][t.y] && null != this.grid[t.x][t.y] && (!(this.grid[t.x][t.y].isSelected && !this.checkTargetPatterns(t)) && this.gridSelectRule.test(this.grid[t.x][t.y], this.pointArrayToBubbleArray(this.currentSelection), this.pointArrayToBubbleArray(this.neighborRule.getNeighbors(t, this.grid)))))));
    }, t.prototype.checkTargetPatterns = function(t) {
        var e = this.currentSelection.slice();
        return e.push(t), this.checkPatterns(e);
    }, t.prototype.checkPatterns = function(t) {
        var e, i;
        try {
            for (var n = __values(this.selectionPatterns), s = n.next(); !s.done; s = n.next()) {
                if (s.value.isMatch(t)) return !0;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return !1;
    }, t.prototype.cleanSelection = function() {
        for (var t = 0; t < this.width; t++) for (var e = 0; e < this.height; e++) null != this.grid[t][e] && null != this.grid[t][e] && (this.grid[t][e].isSelected = !1);
        this.currentSelection = [], this.patternWasSelected = !1;
    }, t.prototype.select = function(t) {
        return !!this.canSelect(t) && (null != this.grid[t.x][t.y] && null != this.grid[t.x][t.y] && (this.currentSelection.push(t), 
        this.grid[t.x][t.y].isSelected = !0, this.checkPatterns(this.currentSelection) && (this.patternWasSelected = !0), 
        !0));
    }, t.prototype.unselectLast = function() {
        var e, t, i = this.currentSelection.pop();
        if (this.grid[i.x][i.y].isSelected = !1, this.patternWasSelected) try {
            for (var n = __values(this.currentSelection), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                this.grid[o.x][o.y].isSelected = !0;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (t = n.return) && t.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        this.patternWasSelected = !1;
    }, t.prototype.selectionToBubbleArray = function() {
        return this.pointArrayToBubbleArray(this.currentSelection);
    }, t.prototype.pointArrayToBubbleArray = function(t, e) {
        void 0 === e && (e = !0);
        for (var i = [], n = 0; n < t.length; n++) (!e || null != t[n] && null != this.grid[t[n].x][t[n].y]) && i.push(this.grid[t[n].x][t[n].y]);
        return i;
    }, t.prototype.bubbleArrayToPointArray = function(t, e) {
        void 0 === e && (e = !0);
        for (var i = [], n = 0; n < t.length; n++) e && null == t[n] || i.push(t[n].position);
        return i;
    }, t.prototype.collectPowerups = function(t) {
        var e, i, n = [];
        try {
            for (var s = __values(t), o = s.next(); !o.done; o = s.next()) {
                var a = o.value;
                null != a.powerup && null != a.powerup && 0 != a.powerup && n.push(a);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (i = s.return) && i.call(s);
            } finally {
                if (e) throw e.error;
            }
        }
        return n;
    }, t.prototype.isPowerup = function(t) {
        return 0 != t.powerup;
    }, t.prototype.executePowerups = function(t, e, i) {
        var n, s, o, a, r = new BubbleNode();
        if (r.bubble = t, r.children = [], !i.contains(t)) {
            var h = PowerupHelper.findPowerup(t.powerup);
            if (null != h) {
                var l = h.second.execute(t, this.grid), c = [];
                try {
                    for (var u = __values(l), d = u.next(); !d.done; d = u.next()) {
                        var p = d.value;
                        e.contains(p) || c.push(p);
                    }
                } catch (t) {
                    n = {
                        error: t
                    };
                } finally {
                    try {
                        d && !d.done && (s = u.return) && s.call(u);
                    } finally {
                        if (n) throw n.error;
                    }
                }
                e.pushMany(c), i.push(t);
                try {
                    for (var g = __values(c), m = g.next(); !m.done; m = g.next()) {
                        p = m.value;
                        r.children.push(this.executePowerups(p, e, i));
                    }
                } catch (t) {
                    o = {
                        error: t
                    };
                } finally {
                    try {
                        m && !m.done && (a = g.return) && a.call(g);
                    } finally {
                        if (o) throw o.error;
                    }
                }
            }
        }
        return r;
    }, t.prototype.executeSelection = function() {
        var e, t, i, n, s, o, a, r;
        if (1 < this.minSelectionExecution && this.currentSelection.length < this.minSelectionExecution) return this.cleanSelection(), 
        null;
        var h = new ExecutionResult();
        h.selectedBubbles = this.selectionToBubbleArray();
        var l = new IdentifyingChain(), c = this.selectionToBubbleArray(), u = !(h.spawnedPowerups = []);
        if (this.skipPowerupSpawn && 0 < h.selectedBubbles.length) {
            var d = h.selectedBubbles[h.selectedBubbles.length - 1].powerup;
            if (0 < d) {
                u = !0;
                try {
                    for (var p = __values(this.preventedPowerupdFromSkipping), g = p.next(); !g.done; g = p.next()) {
                        if (d === g.value) {
                            u = !1;
                            break;
                        }
                    }
                } catch (t) {
                    e = {
                        error: t
                    };
                } finally {
                    try {
                        g && !g.done && (t = p.return) && t.call(p);
                    } finally {
                        if (e) throw e.error;
                    }
                }
            }
        }
        if (!u) try {
            for (var m = __values(PowerupHelper.selectionSpawnRules), f = m.next(); !f.done; f = m.next()) {
                var y = f.value;
                if (y.second.checkoutCondition(h.selectedBubbles)) {
                    h.selectedBubbles[h.selectedBubbles.length - 1].powerup = y.second.powerupType, 
                    h.spawnedPowerups.push(h.selectedBubbles[h.selectedBubbles.length - 1]);
                    break;
                }
            }
        } catch (t) {
            i = {
                error: t
            };
        } finally {
            try {
                f && !f.done && (n = m.return) && n.call(m);
            } finally {
                if (i) throw i.error;
            }
        }
        l.pushMany(this.removeRule.bubblesToRemove(c, this.grid, this.neighborRule)), h.firedPowerups = [];
        var v = new IdentifyingChain(), b = this.collectPowerups(l.toArray());
        try {
            for (var _ = __values(b), S = _.next(); !S.done; S = _.next()) {
                var x = S.value;
                h.firedPowerups.push(this.executePowerups(x, l, v));
            }
        } catch (t) {
            s = {
                error: t
            };
        } finally {
            try {
                S && !S.done && (o = _.return) && o.call(_);
            } finally {
                if (s) throw s.error;
            }
        }
        h.removedBubbles = l.toArray();
        for (var w = [], A = 0; A < h.removedBubbles.length; A++) h.removedBubbles[A].preventFromRemoving && (h.removedBubbles[A].preventFromRemoving = !1, 
        w.push(A));
        try {
            for (var P = __values(w), C = P.next(); !C.done; C = P.next()) {
                A = C.value;
                h.removedBubbles.splice(A, 1);
            }
        } catch (t) {
            a = {
                error: t
            };
        } finally {
            try {
                C && !C.done && (r = P.return) && r.call(P);
            } finally {
                if (a) throw a.error;
            }
        }
        this.removeBubbles(this.bubbleArrayToPointArray(h.removedBubbles)), h.movedBubbles = [];
        for (A = 0; A < this.moveRules.length; A++) h.movedBubbles.push(this.moveRules[A].executeMove(this.grid));
        h.newBubbles = [];
        for (A = 0; A < this.grid.length; A++) for (var T = 0; T < this.grid[A].length; T++) if (null == this.grid[A][T] || null == this.grid[A][T]) {
            var E = this.spawnNext(A, T);
            this.grid[A][T] = E, h.newBubbles.push(E);
        }
        return this.cleanSelection(), this.scoreExecution(h), CountersHelper.tick(), h;
    }, t.prototype.spawnNext = function(t, e, i) {
        return void 0 === i && (i = !1), this.algorithm.next(t, e, i);
    }, t.prototype.removeBubbles = function(t) {
        for (var e = 0; e < t.length; e++) this.grid[t[e].x][t[e].y].preventFromRemoving ? this.grid[t[e].x][t[e].y].preventFromRemoving = !1 : this.grid[t[e].x][t[e].y] = null;
    }, t.prototype.getPoweupsOnBoard = function(t) {
        for (var e = [], i = 0; i < this.grid.length; i++) for (var n = 0; n < this.grid[i].length; n++) null != this.grid[i][n] && null != this.grid[i][n] && this.grid[i][n].powerup === t && e.push(this.grid[i][n]);
        return e;
    }, t.prototype.getBubblesOnBoard = function(t) {
        for (var e = [], i = 0; i < this.grid.length; i++) for (var n = 0; n < this.grid[i].length; n++) null != this.grid[i][n] && null != this.grid[i][n] && this.grid[i][n].value === t && e.push(this.grid[i][n]);
        return e;
    }, t.prototype.countPoweupsOnBoard = function(t) {
        for (var e = 0, i = 0; i < this.grid.length; i++) for (var n = 0; n < this.grid[i].length; n++) null != this.grid[i][n] && null != this.grid[i][n] && this.grid[i][n].powerup === t && e++;
        return e;
    }, t.prototype.countBubblesOnBoard = function(t) {
        for (var e = 0, i = 0; i < this.grid.length; i++) for (var n = 0; n < this.grid[i].length; n++) null != this.grid[i][n] && null != this.grid[i][n] && this.grid[i][n].value === t && e++;
        return e;
    }, t.prototype.translateToPortrait = function() {
        return this.width > this.height ? this.translate() : null;
    }, t.prototype.translateToLandscape = function() {
        return this.width < this.height ? this.translate() : null;
    }, t.prototype.translate = function() {
        if (this.allowTranslation) {
            var t = this.grid;
            this.initGrid(this.height, this.width);
            for (var e = 0; e < t.length; e++) for (var i = 0; i < t[e].length; i++) this.grid[i][e] = t[e][i], 
            null != this.grid[i][e] && null != this.grid[i][e] && (this.grid[i][e].position = new AmazingIntPoint(i, e));
            var n = new ExecutionResult();
            n.movedBubbles = [];
            for (e = 0; e < this.moveRules.length; e++) n.movedBubbles.push(this.moveRules[e].executeMove(this.grid));
            return n;
        }
        return null;
    }, t.prototype.serialize = function() {
        for (var t = this.width + ";" + this.height + ";" + this.allowTranslation, e = 0; e < this.grid.length; e++) for (var i = 0; i < this.grid[e].length; i++) t += ";" + (null != this.grid[e][i] && null != this.grid[e][i] ? this.grid[e][i].serialize() : "-");
        return t;
    }, t.prototype.parse = function(t) {
        var e = t.split(";");
        this.width = +e[0], this.height = +e[1], this.allowTranslation = "true" === e[2];
        var i = 3;
        this.grid = [];
        for (var n = 0; n < this.width; n++) {
            this.grid[n] = [];
            for (var s = 0; s < this.height; s++) "-" !== e[i] ? (this.grid[n][s] = new Bubble(), 
            this.grid[n][s].parse(e[i]), this.initCounter(this.grid[n][s].id)) : this.grid[n][s] = null, 
            i++;
        }
    }, t;
}(BubbleCreator), Bubble = function() {
    function t() {
        this.isSelected = !1, this.preventFromRemoving = !1, this._powerup = 0;
    }
    return Object.defineProperty(t.prototype, "value", {
        get: function() {
            return this._value;
        },
        set: function(t) {
            null != t && null != t && (this._value = t);
        },
        enumerable: !0,
        configurable: !0
    }), Object.defineProperty(t.prototype, "powerup", {
        get: function() {
            return this._powerup;
        },
        set: function(t) {
            null != t && null != t && (this._powerup = t);
        },
        enumerable: !0,
        configurable: !0
    }), t.prototype.canBeSelected = function() {
        return !0;
    }, t.prototype.serialize = function() {
        return this.id + "#" + this.value + "#" + this.position.x + "#" + this.position.y + "#" + this.powerup + "#" + this.preventFromRemoving;
    }, t.prototype.parse = function(t) {
        var e = t.split("#");
        this.id = e[0], this.value = +e[1], this.position = new AmazingIntPoint(+e[2], +e[3]), 
        this.powerup = +e[4], this.preventFromRemoving = "true" === e[5];
    }, t.prototype.getHash = function() {
        return this.id;
    }, t;
}(), BubbleRemoveRule = function() {}, BubbleTypeHelper = function() {
    function t() {}
    return t.clearRules = function() {
        this.rulesDictionary = [];
    }, t.addTypeRule = function(t) {
        var e = this.findRule(t.myType);
        null != e && null != e || (e = new Pair(t.myType, t), this.rulesDictionary.push(e));
    }, t.addMatchingRule = function(t, e) {
        var i = this.findRule(t);
        null != i && null != i || (i = new Pair(t, new BubbleTypeRules(t)), this.rulesDictionary.push(i)), 
        i.second.matchingRules.push(e);
    }, t.findRule = function(t) {
        var e, i;
        try {
            for (var n = __values(this.rulesDictionary), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                if (o.first === t) return o;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return null;
    }, t.isMatching = function(t, e) {
        var i, n, s, o;
        if (null == t || null == t || null == e || null == e) return !1;
        var a = this.findRule(t.value);
        try {
            for (var r = __values(a.second.matchingRules), h = r.next(); !h.done; h = r.next()) {
                if (h.value.test(e.value)) return !0;
            }
        } catch (t) {
            i = {
                error: t
            };
        } finally {
            try {
                h && !h.done && (n = r.return) && n.call(r);
            } finally {
                if (i) throw i.error;
            }
        }
        var l = this.findRule(e.value);
        try {
            for (var c = __values(l.second.matchingRules), u = c.next(); !u.done; u = c.next()) {
                if (u.value.test(t.value)) return !0;
            }
        } catch (t) {
            s = {
                error: t
            };
        } finally {
            try {
                u && !u.done && (o = c.return) && o.call(c);
            } finally {
                if (s) throw s.error;
            }
        }
        return t.value === e.value;
    }, t.getSpownableTypesPool = function(t) {
        var e, i;
        void 0 === t && (t = !1);
        var n = [];
        try {
            for (var s = __values(this.rulesDictionary), o = s.next(); !o.done; o = s.next()) {
                var a = o.value;
                a.second.canBeSpownSpontaneously && (t && a.second.isSpecial || n.push(a.first));
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (i = s.return) && i.call(s);
            } finally {
                if (e) throw e.error;
            }
        }
        return n;
    }, t.rulesDictionary = [], t;
}(), CountersHelper = function() {
    function t() {}
    return t.initCounter = function(t, e, i) {
        void 0 === e && (e = 0), void 0 === i && (i = !0), this.contains(t) || this.counters.push(new Trio(t, e, i));
    }, t.clear = function() {
        this.counters = [];
    }, t.tick = function() {
        var e, t;
        try {
            for (var i = __values(this.counters), n = i.next(); !n.done; n = i.next()) {
                var s = n.value;
                s.third ? s.second++ : 0 < s.second && s.second--;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                n && !n.done && (t = i.return) && t.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.getCurrentCounter = function(t) {
        for (var e = 0; e < this.counters.length; e++) if (this.counters[e].first === t) return this.counters[e].second;
        return -1;
    }, t.contains = function(t) {
        for (var e = 0; e < this.counters.length; e++) if (this.counters[e].first === t) return !0;
        return !1;
    }, t.remove = function(t) {
        for (var e = -1, i = 0; i < this.counters.length; i++) if (this.counters[i].first === t) {
            e = i;
            break;
        }
        -1 < e && this.counters.splice(e, 1);
    }, t.serialize = function() {
        var e, t, i = "";
        try {
            for (var n = __values(this.counters), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                i += o.first + "#" + o.second + "#" + o.third + ";";
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (t = n.return) && t.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return i.substring(0, i.length - 1);
    }, t.parse = function(t) {
        var e, i, n = t.split(";");
        try {
            for (var s = __values(n), o = s.next(); !o.done; o = s.next()) {
                var a = o.value.split("#");
                this.counters.push(new Trio(a[0], +a[1], "true" === a[2]));
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (i = s.return) && i.call(s);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.counters = [], t;
}(), GenerateAlgorithm = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e;
}(BubbleCreator), RandomGenerateAlgorithm = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.generate = function(t, e, i) {
        void 0 === i && (i = !1);
        var n = [], s = BubbleTypeHelper.getSpownableTypesPool();
        n = [];
        for (var o = 0; o < t; o++) {
            n.push([]);
            for (var a = 0; a < e; a++) n[o].push(this.createBubble(new AmazingIntPoint(o, a), s[Math.floor(Math.random() * s.length)]));
        }
        return n;
    }, e.prototype.next = function(t, e, i) {
        void 0 === i && (i = !1);
        var n = BubbleTypeHelper.getSpownableTypesPool(i);
        return this.createBubble(new AmazingIntPoint(t, e), n[Math.floor(Math.random() * n.length)]);
    }, e;
}(GenerateAlgorithm), CellularAutomataGenerateAlgorithm = function(o) {
    function t(t, e, i) {
        var n = o.call(this) || this;
        return n.neighbourRule = t, n.threshold = e, n.smoothing = i, n;
    }
    return __extends(t, o), t.prototype.generate = function(t, e, i) {
        void 0 === i && (i = !1);
        for (var n = o.prototype.generate.call(this, t, e, i), s = 0; s < this.smoothing; s++) this.smooth(n);
        return n;
    }, t.prototype.smooth = function(t) {
        for (var e, i, n = 0; n < t.length; n++) for (var s = 0; s < t[n].length; s++) {
            var o = this.neighbourRule.getNeighbors(new AmazingIntPoint(n, s), t), a = void 0, r = 0;
            try {
                for (var h = __values(o), l = h.next(); !l.done; l = h.next()) {
                    var c = l.value, u = t[c.x][c.y].value, d = this.countMathingTypeInArray(u, t, o);
                    r < d && (a = u, r = d);
                }
            } catch (t) {
                e = {
                    error: t
                };
            } finally {
                try {
                    l && !l.done && (i = h.return) && i.call(h);
                } finally {
                    if (e) throw e.error;
                }
            }
            r >= this.threshold && (t[n][s].value = a);
        }
    }, t.prototype.countMathingTypeInArray = function(t, e, i) {
        var n, s, o = 0;
        try {
            for (var a = __values(i), r = a.next(); !r.done; r = a.next()) {
                var h = r.value;
                e[h.x][h.y].value == t && o++;
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                r && !r.done && (s = a.return) && s.call(a);
            } finally {
                if (n) throw n.error;
            }
        }
        return o;
    }, t;
}(RandomGenerateAlgorithm), ProbabilityMatrixGenerateAlgorithm = function(e) {
    function t() {
        var t = null !== e && e.apply(this, arguments) || this;
        return t.matrix = [], t;
    }
    return __extends(t, e), t.prototype.generate = function(t, e, i) {
        void 0 === i && (i = !1);
        var n = [];
        n = [];
        for (var s = 0; s < t; s++) {
            n.push([]);
            for (var o = 0; o < e; o++) n[s].push(this.next(s, o, i));
        }
        return n;
    }, t.prototype.next = function(t, e, i) {
        var n, s;
        void 0 === i && (i = !1);
        var o = this.getProbabilityRange(i), a = Math.random() * o, r = 0;
        try {
            for (var h = __values(this.getRightMatrix(i)), l = h.next(); !l.done; l = h.next()) {
                var c = l.value;
                if (a <= (r += c.second)) return this.createBubble(new AmazingIntPoint(t, e), c.first);
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                l && !l.done && (s = h.return) && s.call(h);
            } finally {
                if (n) throw n.error;
            }
        }
        return null;
    }, t.prototype.getProbability = function(t) {
        var e, i;
        try {
            for (var n = __values(this.matrix), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                if (o.first === t) return o.second;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return 0;
    }, t.prototype.setProbability = function(t, e, i) {
        var n, s;
        void 0 === i && (i = !1), e < 0 && (e = 0);
        try {
            for (var o = __values(this.matrix), a = o.next(); !a.done; a = o.next()) {
                var r = a.value;
                if (r.first === t) return void (r.second = e);
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (s = o.return) && s.call(o);
            } finally {
                if (n) throw n.error;
            }
        }
        this.matrix.push(new Trio(t, e, i));
    }, t.prototype.getProbabilityRange = function(t) {
        var e, i, n = 0;
        try {
            for (var s = __values(this.matrix), o = s.next(); !o.done; o = s.next()) {
                var a = o.value;
                t && a.third || (n += a.second);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (i = s.return) && i.call(s);
            } finally {
                if (e) throw e.error;
            }
        }
        return n;
    }, t.prototype.getRightMatrix = function(t) {
        var e, i, n = [];
        try {
            for (var s = __values(this.matrix), o = s.next(); !o.done; o = s.next()) {
                var a = o.value;
                t && a.third || n.push(new Pair(a.first, a.second));
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (i = s.return) && i.call(s);
            } finally {
                if (e) throw e.error;
            }
        }
        return n;
    }, t;
}(GenerateAlgorithm), GridSelectRule = function() {}, AllNeighborsRule = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.test = function(t, e, i) {
        var n, s;
        if (e.length <= 0) return !0;
        try {
            for (var o = __values(i), a = o.next(); !a.done; a = o.next()) {
                var r = a.value;
                if (r.position.x == e[e.length - 1].position.x && r.position.y == e[e.length - 1].position.y) return !0;
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (s = o.return) && s.call(o);
            } finally {
                if (n) throw n.error;
            }
        }
        return !1;
    }, e;
}(GridSelectRule), MatchingNeighborsRule = function(n) {
    function t() {
        return null !== n && n.apply(this, arguments) || this;
    }
    return __extends(t, n), t.prototype.test = function(t, e, i) {
        return !!n.prototype.test.call(this, t, e, i) && (e.length <= 0 || BubbleTypeHelper.isMatching(t, e[e.length - 1]));
    }, t;
}(AllNeighborsRule), SingleClickRule = function(i) {
    function t(t) {
        void 0 === t && (t = 0);
        var e = i.call(this) || this;
        return e.matchingBubbleThreshold = t, e;
    }
    return __extends(t, i), t.prototype.test = function(t, e, i) {
        var n, s;
        if (0 < e.length) return !1;
        var o = 0;
        try {
            for (var a = __values(i), r = a.next(); !r.done; r = a.next()) {
                var h = r.value;
                BubbleTypeHelper.isMatching(t, h) && o++;
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                r && !r.done && (s = a.return) && s.call(a);
            } finally {
                if (n) throw n.error;
            }
        }
        return o >= this.matchingBubbleThreshold;
    }, t;
}(GridSelectRule);

!function(t) {
    t[t.Right = 0] = "Right", t[t.RightDown = 1] = "RightDown", t[t.Down = 2] = "Down", 
    t[t.LeftDown = 3] = "LeftDown", t[t.Left = 4] = "Left", t[t.LeftUp = 5] = "LeftUp", 
    t[t.Up = 6] = "Up", t[t.RightUp = 7] = "RightUp";
}(WordDirection || (WordDirection = {}));

var GameOverPopUpState, WordDirectionHelper = function() {
    function t() {}
    return t.GetDirectionVecror = function(t) {
        switch (t) {
          case WordDirection.Right:
            return new AmazingIntPoint(1, 0);

          case WordDirection.RightDown:
            return new AmazingIntPoint(1, 1);

          case WordDirection.Down:
            return new AmazingIntPoint(0, 1);

          case WordDirection.LeftDown:
            return new AmazingIntPoint(-1, 1);

          case WordDirection.Left:
            return new AmazingIntPoint(-1, 0);

          case WordDirection.LeftUp:
            return new AmazingIntPoint(-1, -1);

          case WordDirection.Up:
            return new AmazingIntPoint(0, -1);

          case WordDirection.RightUp:
            return new AmazingIntPoint(1, -1);

          default:
            return new AmazingIntPoint(0, 0);
        }
    }, t.ComputePoint = function(t, e, i) {
        return new AmazingIntPoint(t.x + e.x * (i - 1), t.y + e.y * (i - 1));
    }, t;
}(), StraightLineRule = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.test = function(t, e, i) {
        if (e.length <= 0) return !0;
        if (1 == e.length) {
            var n = Math.abs(t.position.x - e[e.length - 1].position.x), s = Math.abs(t.position.y - e[e.length - 1].position.y);
            return n <= 1 && s <= 1;
        }
        var o = e[e.length - 1].position.x - e[e.length - 2].position.x, a = e[e.length - 1].position.y - e[e.length - 2].position.y, r = t.position.x - e[e.length - 1].position.x, h = t.position.y - e[e.length - 1].position.y;
        return r == o && h == a;
    }, e;
}(GridSelectRule), MatchingRule = function() {}, AnyTypeRule = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.test = function(t) {
        return !0;
    }, e;
}(MatchingRule), NoMatchRule = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.test = function(t) {
        return !1;
    }, e;
}(MatchingRule), TargetTypeRule = function(i) {
    function t(t) {
        var e = i.call(this) || this;
        return e.myType = t, e;
    }
    return __extends(t, i), t.prototype.test = function(t) {
        return this.myType === t;
    }, t;
}(MatchingRule), MoveRule = function() {}, MoveColumnLeft = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.executeMove = function(t) {
        for (var e = new IdentifyingChain(), i = 0; i < t.length - 1; i++) {
            var n = GridHelper.getNextRightSideNotEmptyColumnIndex(i, t);
            if (GridHelper.isColumnEmpty(i, t) && -1 != n) for (var s = 0; s < t[i].length; s++) {
                var o = t[n][s];
                null != o && (t[i][s] = o, t[n][s] = null, o.position = new AmazingIntPoint(i, s), 
                e.push(o));
            }
        }
        return e.toArray();
    }, e;
}(MoveRule), MoveDown = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.executeMove = function(t) {
        for (var e = new IdentifyingChain(), i = t[0].length - 1; 0 <= i; i--) for (var n = 0; n < t.length; n++) if (null == t[n][i]) {
            var s = new AmazingIntPoint(n, i), o = GridHelper.findAbove(s, t);
            null != o && (t[n][i] = o, t[o.position.x][o.position.y] = null, o.position = s, 
            e.push(o));
        }
        return e.toArray();
    }, e;
}(MoveRule), NeighborRule = function() {}, HexNeighborRule = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.getNeighbors = function(t, e) {
        var i = [], n = new AmazingIntPoint(t.x - 1, t.y - 1);
        return GridHelper.isInsideBounds(e, n) && i.push(n), n = new AmazingIntPoint(t.x + 1, t.y - 1), 
        GridHelper.isInsideBounds(e, n) && i.push(n), n = new AmazingIntPoint(t.x + 2, t.y), 
        GridHelper.isInsideBounds(e, n) && i.push(n), n = new AmazingIntPoint(t.x + 1, t.y + 1), 
        GridHelper.isInsideBounds(e, n) && i.push(n), n = new AmazingIntPoint(t.x - 1, t.y + 1), 
        GridHelper.isInsideBounds(e, n) && i.push(n), n = new AmazingIntPoint(t.x - 2, t.y), 
        GridHelper.isInsideBounds(e, n) && i.push(n), i;
    }, e;
}(NeighborRule), HorizontalVerticalNeighborRule = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.getNeighbors = function(t, e) {
        var i = [], n = new AmazingIntPoint(t.x - 1, t.y);
        return GridHelper.isInsideBounds(e, n) && i.push(n), n = new AmazingIntPoint(t.x + 1, t.y), 
        GridHelper.isInsideBounds(e, n) && i.push(n), n = new AmazingIntPoint(t.x, t.y - 1), 
        GridHelper.isInsideBounds(e, n) && i.push(n), n = new AmazingIntPoint(t.x, t.y + 1), 
        GridHelper.isInsideBounds(e, n) && i.push(n), i;
    }, e;
}(NeighborRule), SquareNeighborRule = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.getNeighbors = function(t, e) {
        for (var i = [], n = -1; n <= 1; n++) for (var s = -1; s <= 1; s++) if (0 != n || 0 != s) {
            var o = new AmazingIntPoint(t.x + n, t.y + s);
            GridHelper.isInsideBounds(e, o) && i.push(o);
        }
        return i;
    }, e;
}(NeighborRule), PowerupHelper = function() {
    function t() {}
    return t.clearpowerups = function() {
        this.powerupRules = [];
    }, t.addPowerup = function(t, e) {
        var i = this.findPowerup(t);
        null != i && null != i || (i = new Pair(t, e), this.powerupRules.push(i));
    }, t.findPowerup = function(t) {
        var e, i;
        try {
            for (var n = __values(this.powerupRules), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                if (o.first === t) return o;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return null;
    }, t.addSelectionSpawnRule = function(t, e) {
        var i = this.findSelectionSpawnRule(t);
        null != i && null != i || (i = new Pair(t, e), this.selectionSpawnRules.push(i));
    }, t.findSelectionSpawnRule = function(t) {
        var e, i;
        try {
            for (var n = __values(this.selectionSpawnRules), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                if (o.first === t) return o;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (i = n.return) && i.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return null;
    }, t.powerupRules = [], t.selectionSpawnRules = [], t;
}(), PowerupRule = function() {}, BombPowerup = function(i) {
    function t(t) {
        void 0 === t && (t = 1);
        var e = i.call(this) || this;
        return e.power = 1, e.power = t, e;
    }
    return __extends(t, i), t.prototype.execute = function(t, e) {
        for (var i = [], n = -this.power; n <= this.power; n++) for (var s = -this.power; s <= this.power; s++) {
            var o = new AmazingIntPoint(t.position.x + n, t.position.y + s);
            GridHelper.isInsideBounds(e, o) && i.push(e[o.x][o.y]);
        }
        return i;
    }, t;
}(PowerupRule), ChangeBubbleTypePowerup = function(i) {
    function t(t) {
        var e = i.call(this) || this;
        return e.targerType = t, e;
    }
    return __extends(t, i), t.prototype.execute = function(t, e) {
        return t.value = this.targerType, t.powerup = -1, t.preventFromRemoving = !0, [];
    }, t;
}(PowerupRule), HorizontalLinePowerup = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.execute = function(t, e) {
        for (var i = [], n = 0; n < e.length; n++) i.push(e[n][t.position.y]);
        return i;
    }, e;
}(PowerupRule), RemoveColorPowerup = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.execute = function(t, e) {
        for (var i = [], n = 0; n < e.length; n++) for (var s = 0; s < e[n].length; s++) null != e[n][s] && null != e[n][s] && t.value === e[n][s].value && i.push(e[n][s]);
        return i;
    }, e;
}(PowerupRule), VerticalLinePowerup = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.execute = function(t, e) {
        for (var i = [], n = 0; n < e[t.position.x].length; n++) i.push(e[t.position.x][n]);
        return i;
    }, e;
}(PowerupRule), PowerupSelectionSpawnRule = function(t) {
    this.powerupType = t;
}, CountSpawnRule = function(n) {
    function t(t, e) {
        var i = n.call(this, t) || this;
        return i.count = e, i;
    }
    return __extends(t, n), t.prototype.checkoutCondition = function(t) {
        return t.length >= this.count;
    }, t;
}(PowerupSelectionSpawnRule), HorizontalLineSpawnRule = function(n) {
    function t() {
        return null !== n && n.apply(this, arguments) || this;
    }
    return __extends(t, n), t.prototype.checkoutCondition = function(t) {
        if (!n.prototype.checkoutCondition.call(this, t)) return !1;
        for (var e = t[0].position.y, i = 1; i < t.length; i++) if (e !== t[i].position.y) return !1;
        return !0;
    }, t;
}(CountSpawnRule), SquareSpawnRule = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.checkoutCondition = function(t) {
        return 5 == t.length && !!t[0].position.equals(t[4].position);
    }, e;
}(PowerupSelectionSpawnRule), VerticalLineSpawnRule = function(n) {
    function t() {
        return null !== n && n.apply(this, arguments) || this;
    }
    return __extends(t, n), t.prototype.checkoutCondition = function(t) {
        if (!n.prototype.checkoutCondition.call(this, t)) return !1;
        for (var e = t[0].position.x, i = 1; i < t.length; i++) if (e !== t[i].position.x) return !1;
        return !0;
    }, t;
}(CountSpawnRule), SameNeighbourRemoveRule = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.bubblesToRemove = function(t, e, i) {
        var n, s = [];
        n = new Array(e.length);
        for (var o = 0; o < n.length; o++) {
            n[o] = new Array(e[o].length);
            for (var a = 0; a < n[o].length; a++) n[o][a] = !1;
        }
        return s = s.concat(this.processGrid(t[0], t[0], e, i, n));
    }, e.prototype.processGrid = function(t, e, i, n, s) {
        var o, a, r = [];
        if (null != e && null != e && t.value === e.value && !s[e.position.x][e.position.y]) {
            s[e.position.x][e.position.y] = !0, r.push(e);
            var h = n.getNeighbors(e.position, i);
            try {
                for (var l = __values(h), c = l.next(); !c.done; c = l.next()) {
                    var u = c.value;
                    r = r.concat(this.processGrid(t, i[u.x][u.y], i, n, s));
                }
            } catch (t) {
                o = {
                    error: t
                };
            } finally {
                try {
                    c && !c.done && (a = l.return) && a.call(l);
                } finally {
                    if (o) throw o.error;
                }
            }
        }
        return r;
    }, e;
}(BubbleRemoveRule), SelectionRemoveRule = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.bubblesToRemove = function(t, e, i) {
        return t;
    }, e;
}(BubbleRemoveRule), SelectionPattern = function() {}, SquarePattern = function(t) {
    function e() {
        return null !== t && t.apply(this, arguments) || this;
    }
    return __extends(e, t), e.prototype.isMatch = function(t) {
        if (5 != t.length) return !1;
        if (!t[0].equals(t[4])) return !1;
        var e = t[0].subtract(t[1]).abs();
        return (1 === e.x && 0 === e.y || 0 === e.x && 1 === e.y) && 1 === (e = t[0].subtract(t[2]).abs()).x && 1 === e.y && (1 === (e = t[0].subtract(t[3]).abs()).x && 0 === e.y || 0 === e.x && 1 === e.y);
    }, e;
}(SelectionPattern), DISABLE_BOMB = !1, HORIZONTAL_PROBABILITY = .02, VERTICAL_PROBABILITY = .04, REMOVE_COLOR_PROPABILITY = .05, BOMB_FIRST_PROBABILITY = .25, BOMB_SECOND_PROBABILITY = .125, BOMB_THIRD_PROBABILITY = .0625, BOMB_FOURTH_PROBABILITY = 0, WILD_CARDS_SPAWN_PROBABILITY = .015, WILD_CARD_THRESHOLD = 5, BOARD_WIDTH = 6, BOARD_HEIGHT = 6, BUBBLE_WILD_CARD = 0, BUBBLE_1 = 1, BUBBLE_2 = 2, BUBBLE_3 = 3, BUBBLE_4 = 4, BUBBLE_5 = 5, BUBBLE_6 = 6, POWERUP_HORIZONTAL_LINE = 1, POWERUP_VERTICAL_LINE = 2, POWERUP_REMOVE_COLOR = 3, POWERUP_WILD_CARD = 4, POWERUP_BOMB = 5, THRESHOLD_1 = 3e3, THRESHOLD_2 = 1e4, THRESHOLD_3 = 25e3, THRESHOLD_4 = 4e4, POINTS_PER_BAL = 50, POWERUP_POINTS_MULITLAYER = 150, GameLogic = function(a) {
    function t() {
        var t = a.call(this) || this;
        return t.currentDifficulty = 0, t;
    }
    return __extends(t, a), t.prototype.initGame = function() {
        var t = new ProbabilityMatrixGenerateAlgorithm();
        t.setProbability(BUBBLE_WILD_CARD, WILD_CARDS_SPAWN_PROBABILITY, !0), t.setProbability(BUBBLE_1, 1), 
        t.setProbability(BUBBLE_2, 1), t.setProbability(BUBBLE_3, 0), t.setProbability(BUBBLE_4, 0), 
        t.setProbability(BUBBLE_5, 0), t.setProbability(BUBBLE_6, 0), this.init(new HorizontalVerticalNeighborRule(), new MatchingNeighborsRule(), new SelectionRemoveRule(), t), 
        this.moveRules.push(new MoveDown()), this.minSelectionExecution = 2, this.selectionPatterns.push(new SquarePattern()), 
        BubbleTypeHelper.clearRules(), BubbleTypeHelper.addMatchingRule(BUBBLE_WILD_CARD, new AnyTypeRule()), 
        BubbleTypeHelper.findRule(BUBBLE_WILD_CARD).second.canBeSpownSpontaneously = !1, 
        BubbleTypeHelper.findRule(BUBBLE_WILD_CARD).second.isSpecial = !0, BubbleTypeHelper.addMatchingRule(BUBBLE_1, new TargetTypeRule(BUBBLE_1)), 
        BubbleTypeHelper.addMatchingRule(BUBBLE_2, new TargetTypeRule(BUBBLE_2)), BubbleTypeHelper.addMatchingRule(BUBBLE_3, new TargetTypeRule(BUBBLE_3)), 
        BubbleTypeHelper.addMatchingRule(BUBBLE_4, new TargetTypeRule(BUBBLE_4)), BubbleTypeHelper.addMatchingRule(BUBBLE_5, new TargetTypeRule(BUBBLE_5)), 
        BubbleTypeHelper.addMatchingRule(BUBBLE_6, new TargetTypeRule(BUBBLE_6)), PowerupHelper.addPowerup(POWERUP_HORIZONTAL_LINE, new HorizontalLinePowerup()), 
        PowerupHelper.addPowerup(POWERUP_VERTICAL_LINE, new VerticalLinePowerup()), PowerupHelper.addPowerup(POWERUP_REMOVE_COLOR, new RemoveColorPowerup()), 
        PowerupHelper.addPowerup(POWERUP_WILD_CARD, new ChangeBubbleTypePowerup(BUBBLE_WILD_CARD)), 
        PowerupHelper.addSelectionSpawnRule(POWERUP_REMOVE_COLOR, new SquareSpawnRule(POWERUP_REMOVE_COLOR)), 
        PowerupHelper.addSelectionSpawnRule(POWERUP_WILD_CARD, new CountSpawnRule(POWERUP_WILD_CARD, WILD_CARD_THRESHOLD)), 
        PowerupHelper.addSelectionSpawnRule(POWERUP_HORIZONTAL_LINE, new HorizontalLineSpawnRule(POWERUP_HORIZONTAL_LINE, 4)), 
        PowerupHelper.addSelectionSpawnRule(POWERUP_VERTICAL_LINE, new VerticalLineSpawnRule(POWERUP_VERTICAL_LINE, 4)), 
        this.skipPowerupSpawn = !0, this.preventedPowerupdFromSkipping.push(POWERUP_BOMB), 
        this.initGrid(BOARD_WIDTH, BOARD_HEIGHT);
    }, t.prototype.newGame = function() {
        this.resetCounter(), this.algorithm.setProbability(BUBBLE_3, 0), this.algorithm.setProbability(BUBBLE_4, 0), 
        this.algorithm.setProbability(BUBBLE_5, 0), this.algorithm.setProbability(BUBBLE_6, 0), 
        CountersHelper.clear(), this.currentDifficulty = 0, this.initGrid(BOARD_WIDTH, BOARD_HEIGHT, !0), 
        GameSettings.getInstance().gameData.roundScore = 0, GameSettings.getInstance().gameData.bubblesRemoved = 0, 
        GameSettings.getInstance().gameData.bubblesRemovedType1 = 0, GameSettings.getInstance().gameData.bubblesRemovedType2 = 0, 
        GameSettings.getInstance().gameData.bubblesRemovedType3 = 0, GameSettings.getInstance().gameData.bubblesRemovedType4 = 0, 
        GameSettings.getInstance().gameData.bubblesRemovedType5 = 0, GameSettings.getInstance().gameData.bubblesRemovedType6 = 0;
    }, t.prototype.spawnNext = function(t, e) {
        var i = void 0;
        if ((i = GameSettings.getInstance().applicationData.tutorialInProgress ? a.prototype.spawnNext.call(this, t, e, !0) : a.prototype.spawnNext.call(this, t, e, !1)).value != BUBBLE_WILD_CARD && !GameSettings.getInstance().applicationData.tutorialInProgress) {
            var n = Math.random();
            if (n <= HORIZONTAL_PROBABILITY) i.powerup = POWERUP_HORIZONTAL_LINE; else if (n <= VERTICAL_PROBABILITY) i.powerup = POWERUP_VERTICAL_LINE; else if (n <= REMOVE_COLOR_PROPABILITY) i.powerup = POWERUP_REMOVE_COLOR; else {
                var s = this.countPoweupsOnBoard(POWERUP_BOMB);
                DISABLE_BOMB || (s < 1 && n <= BOMB_FIRST_PROBABILITY ? (i.powerup = POWERUP_BOMB, 
                CountersHelper.initCounter(i.id, this.getRandomBombCounter(), !1)) : s < 2 && n <= BOMB_SECOND_PROBABILITY ? (i.powerup = POWERUP_BOMB, 
                CountersHelper.initCounter(i.id, this.getRandomBombCounter(), !1)) : s < 3 && n <= BOMB_THIRD_PROBABILITY ? (i.powerup = POWERUP_BOMB, 
                CountersHelper.initCounter(i.id, this.getRandomBombCounter(), !1)) : s < 4 && n <= BOMB_FOURTH_PROBABILITY && (i.powerup = POWERUP_BOMB, 
                CountersHelper.initCounter(i.id, this.getRandomBombCounter(), !1)));
            }
        }
        return i;
    }, t.prototype.isGameOver = function() {
        var e, t, i = this.getPoweupsOnBoard(POWERUP_BOMB);
        try {
            for (var n = __values(i), s = n.next(); !s.done; s = n.next()) {
                var o = s.value, a = CountersHelper.getCurrentCounter(o.id);
                if (0 === a) return !0;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (t = n.return) && t.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return !1;
    }, t.prototype.getRandomBombCounter = function() {
        return this.currentDifficulty < 1 ? Utils.randomInt(6, 8) : this.currentDifficulty < 2 ? Utils.randomInt(8, 12) : this.currentDifficulty < 3 ? Utils.randomInt(10, 14) : this.currentDifficulty < 4 ? Utils.randomInt(13, 15) : this.currentDifficulty < 5 ? Utils.randomInt(15, 20) : 20;
    }, t.prototype.moderateDifficulty = function() {
        1 <= this.currentDifficulty && (this.algorithm.setProbability(BUBBLE_3, 1), 2 <= this.currentDifficulty && (this.algorithm.setProbability(BUBBLE_4, 1), 
        3 <= this.currentDifficulty && (this.algorithm.setProbability(BUBBLE_5, 1), 4 <= this.currentDifficulty && this.algorithm.setProbability(BUBBLE_6, 1))));
    }, t.prototype.getPointsForSelection = function(t) {
        return t.selectedBubbles.length * t.selectedBubbles.length * t.selectedBubbles.length;
    }, t.prototype.getPointsForBomb = function(t) {
        if (!this.bombScoreDic.containsKey(t)) {
            var e = 5 * Math.pow(2, this.currentDifficulty) * CountersHelper.getCurrentCounter(t.id);
            this.bombScoreDic.add(t, e);
        }
        return this.bombScoreDic.item(t);
    }, t.prototype.getPointsForPowerup = function(t, e) {
        var i = this.getPowerupLevel(t, e), n = this.getPowerupRemovedCount(t, e);
        return 150 * Math.pow(2, i - 1) + 30 * n * Math.pow(2, this.currentDifficulty);
    }, t.prototype.getPowerupLevel = function(t, e) {
        var i, n;
        try {
            for (var s = __values(e.firedPowerups), o = s.next(); !o.done; o = s.next()) {
                var a = o.value, r = this.getLevel(t, a);
                if (0 < r) return r;
            }
        } catch (t) {
            i = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (n = s.return) && n.call(s);
            } finally {
                if (i) throw i.error;
            }
        }
        return 0;
    }, t.prototype.getPowerupRemovedCount = function(t, e) {
        var i, n;
        try {
            for (var s = __values(e.firedPowerups), o = s.next(); !o.done; o = s.next()) {
                var a = o.value, r = this.getRemovedCount(t, a);
                if (0 < r) return r;
            }
        } catch (t) {
            i = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (n = s.return) && n.call(s);
            } finally {
                if (i) throw i.error;
            }
        }
        return 0;
    }, t.prototype.getLevel = function(t, e, i) {
        var n, s;
        if (void 0 === i && (i = 1), t.id === e.bubble.id) return i;
        try {
            for (var o = __values(e.children), a = o.next(); !a.done; a = o.next()) {
                var r = a.value, h = this.getLevel(t, r, i + 1);
                if (0 < h) return h;
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (s = o.return) && s.call(o);
            } finally {
                if (n) throw n.error;
            }
        }
        return 0;
    }, t.prototype.getRemovedCount = function(t, e) {
        var i, n;
        if (t.id === e.bubble.id) return e.children.length;
        try {
            for (var s = __values(e.children), o = s.next(); !o.done; o = s.next()) {
                var a = o.value, r = this.getLevel(t, a);
                if (0 < r) return r;
            }
        } catch (t) {
            i = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (n = s.return) && n.call(s);
            } finally {
                if (i) throw i.error;
            }
        }
        return 0;
    }, t.prototype.collectAllPowerupsNodesForScoring = function(t, e) {
        var i, n;
        try {
            for (var s = __values(t), o = s.next(); !o.done; o = s.next()) {
                var a = o.value;
                a.bubble.powerup !== POWERUP_REMOVE_COLOR && a.bubble.powerup !== POWERUP_HORIZONTAL_LINE && a.bubble.powerup !== POWERUP_VERTICAL_LINE || e.push(a.bubble), 
                void 0 !== a.children && null !== a.children && 0 < a.children.length && this.collectAllPowerupsNodesForScoring(a.children, e);
            }
        } catch (t) {
            i = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (n = s.return) && n.call(s);
            } finally {
                if (i) throw i.error;
            }
        }
    }, t.prototype.collectAllBombsForScoring = function(t, e) {
        var i, n;
        try {
            for (var s = __values(t), o = s.next(); !o.done; o = s.next()) {
                var a = o.value;
                a.bubble.powerup === POWERUP_BOMB && e.push(a.bubble), void 0 !== a.children && null !== a.children && 0 < a.children.length && this.collectAllBombsForScoring(a.children, e);
            }
        } catch (t) {
            i = {
                error: t
            };
        } finally {
            try {
                o && !o.done && (n = s.return) && n.call(s);
            } finally {
                if (i) throw i.error;
            }
        }
    }, t.prototype.scoreExecution = function(t) {
        var e, i, n, s, o, a;
        GameSettings.getInstance().gameData.bubblesRemoved += t.removedBubbles.length, GameSettings.getInstance().gameData.roundScore += this.getPointsForSelection(t);
        var r = new IdentifyingChain();
        this.collectAllPowerupsNodesForScoring(t.firedPowerups, r);
        try {
            for (var h = __values(r.toArray()), l = h.next(); !l.done; l = h.next()) {
                var c = l.value;
                GameSettings.getInstance().gameData.roundScore += this.getPointsForPowerup(c, t);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                l && !l.done && (i = h.return) && i.call(h);
            } finally {
                if (e) throw e.error;
            }
        }
        this.bombScoreDic = new HashKeyedCollection();
        var u = new IdentifyingChain();
        this.collectAllBombsForScoring(t.firedPowerups, u);
        try {
            for (var d = __values(u.toArray()), p = d.next(); !p.done; p = d.next()) {
                c = p.value;
                GameSettings.getInstance().gameData.roundScore += this.getPointsForBomb(c);
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                p && !p.done && (s = d.return) && s.call(d);
            } finally {
                if (n) throw n.error;
            }
        }
        try {
            for (var g = __values(t.removedBubbles), m = g.next(); !m.done; m = g.next()) {
                var f = m.value;
                f.value == BUBBLE_1 ? GameSettings.getInstance().gameData.bubblesRemovedType1++ : f.value == BUBBLE_2 ? GameSettings.getInstance().gameData.bubblesRemovedType2++ : f.value == BUBBLE_3 ? GameSettings.getInstance().gameData.bubblesRemovedType3++ : f.value == BUBBLE_4 ? GameSettings.getInstance().gameData.bubblesRemovedType4++ : f.value == BUBBLE_5 ? GameSettings.getInstance().gameData.bubblesRemovedType5++ : f.value == BUBBLE_6 && GameSettings.getInstance().gameData.bubblesRemovedType6++;
            }
        } catch (t) {
            o = {
                error: t
            };
        } finally {
            try {
                m && !m.done && (a = g.return) && a.call(g);
            } finally {
                if (o) throw o.error;
            }
        }
        this.currentDifficulty <= 0 && GameSettings.getInstance().gameData.roundScore > THRESHOLD_1 ? (this.currentDifficulty = 1, 
        this.moderateDifficulty()) : this.currentDifficulty <= 1 && GameSettings.getInstance().gameData.roundScore > THRESHOLD_2 ? (this.currentDifficulty = 2, 
        this.moderateDifficulty()) : this.currentDifficulty <= 2 && GameSettings.getInstance().gameData.roundScore > THRESHOLD_3 ? (this.currentDifficulty = 3, 
        this.moderateDifficulty()) : this.currentDifficulty <= 3 && GameSettings.getInstance().gameData.roundScore > THRESHOLD_4 && (this.currentDifficulty = 4, 
        this.moderateDifficulty());
    }, t.prototype.executeSelection = function() {
        var e, t, i = a.prototype.executeSelection.call(this);
        if (null != i && null != i) try {
            for (var n = __values(i.removedBubbles), s = n.next(); !s.done; s = n.next()) {
                var o = s.value;
                o.powerup == POWERUP_BOMB && CountersHelper.remove(o.id);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                s && !s.done && (t = n.return) && t.call(n);
            } finally {
                if (e) throw e.error;
            }
        }
        return i;
    }, t.prototype.isMovePossible = function() {
        for (var e, t, i = 0; i < this.grid.length - 1; i++) for (var n = 0; n < this.grid[i].length - 1; n++) {
            if (this.grid[i][n].value === BUBBLE_WILD_CARD) return !0;
            var s = this.neighborRule.getNeighbors(new AmazingIntPoint(i, n), this.grid);
            try {
                for (var o = __values(s), a = o.next(); !a.done; a = o.next()) {
                    var r = a.value;
                    if (this.grid[i][n].value === this.grid[r.x][r.y].value) return !0;
                }
            } catch (t) {
                e = {
                    error: t
                };
            } finally {
                try {
                    a && !a.done && (t = o.return) && t.call(o);
                } finally {
                    if (e) throw e.error;
                }
            }
        }
        return !1;
    }, t.prototype.reshuffleGrid = function() {
        CountersHelper.clear();
        for (var t = 0; t < this.width; t++) for (var e = 0; e < this.height; e++) this.grid[t][e] = this.spawnNext(t, e);
    }, t.prototype.getRandomBombMove = function() {
        for (var e, t, i = [], n = 0; n < this.grid.length - 1; n++) for (var s = 0; s < this.grid[n].length - 1; s++) i.push(new AmazingIntPoint(n, s));
        i = Utils.shuffleArray(i);
        try {
            for (var o = __values(i), a = o.next(); !a.done; a = o.next()) {
                var r = a.value, h = this.grid[r.x][r.y].value;
                if (this.grid[r.x + 1][r.y].value === h && this.grid[r.x + 1][r.y + 1].value === h && this.grid[r.x][r.y + 1].value === h) return [ new AmazingIntPoint(r.x, r.y), new AmazingIntPoint(r.x + 1, r.y), new AmazingIntPoint(r.x + 1, r.y + 1), new AmazingIntPoint(r.x, r.y + 1), new AmazingIntPoint(r.x, r.y) ];
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (t = o.return) && t.call(o);
            } finally {
                if (e) throw e.error;
            }
        }
        return null;
    }, t.prototype.getRandomHorizontalMove = function() {
        for (var e, t, i = [], n = 0; n < this.grid.length - 4; n++) for (var s = 0; s < this.grid[n].length; s++) i.push(new AmazingIntPoint(n, s));
        i = Utils.shuffleArray(i);
        try {
            for (var o = __values(i), a = o.next(); !a.done; a = o.next()) {
                var r = a.value, h = this.grid[r.x][r.y].value;
                if (this.grid[r.x + 1][r.y].value === h && this.grid[r.x + 2][r.y].value === h && this.grid[r.x + 3][r.y].value === h) return [ new AmazingIntPoint(r.x, r.y), new AmazingIntPoint(r.x + 1, r.y), new AmazingIntPoint(r.x + 2, r.y), new AmazingIntPoint(r.x + 3, r.y) ];
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (t = o.return) && t.call(o);
            } finally {
                if (e) throw e.error;
            }
        }
        return null;
    }, t.prototype.getRandomVerticalMove = function() {
        for (var e, t, i = [], n = 0; n < this.grid.length; n++) for (var s = 0; s < this.grid[n].length - 4; s++) i.push(new AmazingIntPoint(n, s));
        i = Utils.shuffleArray(i);
        try {
            for (var o = __values(i), a = o.next(); !a.done; a = o.next()) {
                var r = a.value, h = this.grid[r.x][r.y].value;
                if (this.grid[r.x][r.y + 1].value === h && this.grid[r.x][r.y + 2].value === h && this.grid[r.x][r.y + 3].value === h) return [ new AmazingIntPoint(r.x, r.y), new AmazingIntPoint(r.x, r.y + 1), new AmazingIntPoint(r.x, r.y + 2), new AmazingIntPoint(r.x, r.y + 3) ];
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (t = o.return) && t.call(o);
            } finally {
                if (e) throw e.error;
            }
        }
        return null;
    }, t.prototype.getRandomTwoStepMove = function() {
        for (var e, t, i = [], n = 0; n < this.grid.length - 1; n++) for (var s = 0; s < this.grid[n].length - 1; s++) i.push(new AmazingIntPoint(n, s));
        i = Utils.shuffleArray(i);
        try {
            for (var o = __values(i), a = o.next(); !a.done; a = o.next()) {
                var r = a.value, h = this.grid[r.x][r.y].value;
                if (this.grid[r.x + 1][r.y].value === h) return [ new AmazingIntPoint(r.x, r.y), new AmazingIntPoint(r.x + 1, r.y) ];
                if (this.grid[r.x][r.y + 1].value === h) return [ new AmazingIntPoint(r.x, r.y), new AmazingIntPoint(r.x, r.y + 1) ];
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (t = o.return) && t.call(o);
            } finally {
                if (e) throw e.error;
            }
        }
        return null;
    }, t.prototype.getRandomThreeStepMove = function() {
        for (var e, t, i = [], n = 0; n < this.grid.length - 1; n++) for (var s = 0; s < this.grid[n].length - 1; s++) i.push(new AmazingIntPoint(n, s));
        i = Utils.shuffleArray(i);
        try {
            for (var o = __values(i), a = o.next(); !a.done; a = o.next()) {
                var r = a.value, h = this.grid[r.x][r.y].value;
                if (this.grid[r.x + 1][r.y].value === h && this.grid[r.x + 1][r.y + 1].value === h) return [ new AmazingIntPoint(r.x, r.y), new AmazingIntPoint(r.x + 1, r.y), new AmazingIntPoint(r.x + 1, r.y + 1) ];
                if (this.grid[r.x][r.y + 1].value === h && this.grid[r.x + 1][r.y + 1].value === h) return [ new AmazingIntPoint(r.x, r.y), new AmazingIntPoint(r.x, r.y + 1), new AmazingIntPoint(r.x + 1, r.y + 1) ];
                if (this.grid[r.x + 1][r.y].value === h && this.grid[r.x + 2][r.y].value === h) return [ new AmazingIntPoint(r.x, r.y), new AmazingIntPoint(r.x + 1, r.y), new AmazingIntPoint(r.x + 2, r.y) ];
                if (this.grid[r.x][r.y + 1].value === h && this.grid[r.x][r.y + 2].value === h) return [ new AmazingIntPoint(r.x, r.y), new AmazingIntPoint(r.x, r.y + 1), new AmazingIntPoint(r.x, r.y + 2) ];
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (t = o.return) && t.call(o);
            } finally {
                if (e) throw e.error;
            }
        }
        return null;
    }, t.prototype.getRandomWildCartMove = function() {
        for (var e, t, i = [], n = 0; n < this.grid.length; n++) for (var s = 0; s < this.grid[n].length; s++) i.push(new AmazingIntPoint(n, s));
        i = Utils.shuffleArray(i);
        try {
            for (var o = __values(i), a = o.next(); !a.done; a = o.next()) {
                var r = a.value, h = new HashChain();
                h.push(r);
                var l = this.processWildCart(r, this.grid[r.x][r.y].value, h);
                if (null !== l) return l;
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                a && !a.done && (t = o.return) && t.call(o);
            } finally {
                if (e) throw e.error;
            }
        }
        return null;
    }, t.prototype.getRandomMoveWithWildCart = function() {
        for (var e, t, i, n, s = null, o = 0; o < this.grid.length; o++) {
            for (var a = 0; a < this.grid[o].length; a++) if (this.grid[o][a].value === BUBBLE_WILD_CARD) {
                s = new AmazingIntPoint(o, a);
                break;
            }
            if (null !== s) break;
        }
        if (null !== s) {
            var r = this.neighborRule.getNeighbors(s, this.grid);
            try {
                for (var h = __values(r), l = h.next(); !l.done; l = h.next()) {
                    var c = l.value;
                    try {
                        for (var u = __values(r), d = u.next(); !d.done; d = u.next()) {
                            var p = d.value;
                            if (!c.equals(p) && this.grid[c.x][c.y].value !== this.grid[p.x][p.y].value) return [ c, s, p ];
                        }
                    } catch (t) {
                        i = {
                            error: t
                        };
                    } finally {
                        try {
                            d && !d.done && (n = u.return) && n.call(u);
                        } finally {
                            if (i) throw i.error;
                        }
                    }
                }
            } catch (t) {
                e = {
                    error: t
                };
            } finally {
                try {
                    l && !l.done && (t = h.return) && t.call(h);
                } finally {
                    if (e) throw e.error;
                }
            }
            return this.grid[r[0].x][r[0].y].value = BUBBLE_1, this.grid[r[1].x][r[1].y].value = BUBBLE_2, 
            [ r[0], s, r[1] ];
        }
        return null;
    }, t.prototype.getRandomRemoveBombMove = function() {
        var t = this.getRandomThreeStepMove(), e = t[t.length - 1];
        return this.grid[e.x][e.y].powerup = POWERUP_BOMB, CountersHelper.initCounter(this.grid[e.x][e.y].id, this.getRandomBombCounter(), !1), 
        [ t[t.length - 2], t[t.length - 1] ];
    }, t.prototype.processWildCart = function(t, e, i) {
        var n, s, o = this.neighborRule.getNeighbors(t, this.grid);
        try {
            for (var a = __values(o), r = a.next(); !r.done; r = a.next()) {
                var h = r.value;
                if (!i.contains(h) && this.grid[h.x][h.y].value === e) {
                    var l = new HashChain();
                    if (l.pushMany(i.toArray()), l.push(h), l.length() >= WILD_CARD_THRESHOLD) return l.toArray();
                    var c = this.processWildCart(h, e, l);
                    if (null !== c) return c;
                }
            }
        } catch (t) {
            n = {
                error: t
            };
        } finally {
            try {
                r && !r.done && (s = a.return) && s.call(a);
            } finally {
                if (n) throw n.error;
            }
        }
        return null;
    }, t.prototype.endGame = function(t) {
        GameSettings.getInstance().applicationData.statistics.add(t, GameSettings.getInstance().gameData.roundScore, GameSettings.getInstance().gameData.bubblesRemoved), 
        GameSettings.getInstance().applicationData.hiscores.addHiscore({
            name: GameSettings.getInstance().playerName,
            score: GameSettings.getInstance().gameData.roundScore,
            date: new Date()
        });
    }, t.prototype.save = function(t) {
        t.currentDifficulty = this.currentDifficulty, t.grid = this.serialize(), t.counters = CountersHelper.serialize();
    }, t.prototype.load = function(t) {
        try {
            return this.initGame(), this.currentDifficulty = t.currentDifficulty, this.parse(t.grid), 
            CountersHelper.parse(t.counters), this.moderateDifficulty(), !0;
        } catch (t) {
            return !1;
        }
    }, t;
}(BasicBubbleLogic), menusheet = function() {
    function t() {}
    return t.APPLE = "apple", t.BUTTON = "button", t.CHROME = "chrome", t.CLOSE = "close", 
    t.DIALOG = "dialog", t.DOWNLOAD = "download", t.FAVICON = "favicon", t.FBBUTTON = "fbbutton", 
    t.GOOGLE = "google", t.ICK_BACK = "ick_back", t.ICK_CHECK = "ick_check", t.ICK_FEEDBACK = "ick_feedback", 
    t.ICK_GAMES = "ick_games", t.ICK_GOOGLE = "ick_google", t.ICK_HELP = "ick_help", 
    t.ICK_IOS = "ick_ios", t.ICK_LAP = "ick_lap", t.ICK_MENU = "ick_menu", t.ICK_MORE = "ick_more", 
    t.ICK_MUSIC = "ick_music", t.ICK_NON_CHECK = "ick_non_check", t.ICK_PHONE = "ick_phone", 
    t.ICK_REFRESH = "ick_refresh", t.ICK_REVIEW = "ick_review", t.ICK_SOUND = "ick_sound", 
    t.ICK_WINDOWS = "ick_windows", t.LABEL = "label", t.MENUBUTTONCLICK = "menubuttonclick", 
    t.STARS = "stars", t.TWITTERBUTTON = "twitterbutton", t.WINDOWS = "windows", t;
}(), Boot = function(i) {
    function t() {
        return i.call(this) || this;
    }
    return __extends(t, i), t.prototype.init = function() {
        i.prototype.init.call(this), this.game.input.maxPointers = 1, this.game.stage.setBackgroundColor(GlobalVars.AccentColor), 
        this.game.stage.disableVisibilityChange = !0, this.game.stage.smoothed = !0;
        var t = Date.now();
        if (window.addEventListener("beforeunload", function() {
            Constants.USE_ANALYTICS && gameanalytics.GameAnalytics.addDesignEvent("seesionend", (Date.now() - t) / 1e3), 
            this.game.amazingTracking.send_event("seesionend", {
                time: (Date.now() - t) / 1e3
            });
        }.bind(this)), this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL, this.scale.pageAlignHorizontally = !0, 
        this.scale.pageAlignVertically = !0, this.game.scale.windowConstraints.bottom = "visual", 
        this.game.stage.smoothed = !0, this.game.time.advancedTiming = !0, window.addEventListener("resize", function(t) {
            AmazingGame.getInstance().on_resize();
        }), this.game.on_resize(), this.game.canvas.oncontextmenu = function(t) {
            t.preventDefault();
        }, Constants.IS_MOBILE_COMPILE_VERSION ? GlobalVars.setup_platform(this.game.device.android, this.game.device.iOS, this.game.device.windows, this.game.device.windowsPhone, this.game.device.kindle) : GlobalVars.setup_web_platform(this.game.device.android || this.game.device.kindle, this.game.device.iOS, this.game.device.windowsPhone, this.game.device.chrome, this.game.device.chromeVersion, this.game.device.safari, this.game.device.firefox, this.game.device.opera), 
        Constants.USE_ANALYTICS) {
            var e = "";
            Constants.IS_BLUR && (e = "blur_"), IS_HAPPY_TUBE && (e = "happytube_"), IS_4BALANCE && (e = "4balance_"), 
            gameanalytics.GameAnalytics.setEnabledInfoLog(Constants.IS_DEBUG), gameanalytics.GameAnalytics.setEnabledVerboseLog(Constants.IS_DEBUG), 
            Constants.IS_MOBILE_COMPILE_VERSION ? gameanalytics.GameAnalytics.configureBuild(e + Platform[Constants.COMPILE_PLATFORM] + "_" + Constants.APP_VERSION) : gameanalytics.GameAnalytics.configureBuild(e + Platform[GlobalVars.Platform] + "_" + Constants.APP_VERSION), 
            gameanalytics.GameAnalytics.initialize(Constants.GAME_KEY, Constants.GAME_SECRET), 
            Constants.IS_DEBUG || (window.onerror = function(t, e, i, n, s) {
                var o = n ? "\ncolumn: " + n : "";
                o += s ? "\nerror: " + s : "", gameanalytics.GameAnalytics.addErrorEvent(gameanalytics.EGAErrorSeverity.Critical, "Error: " + t + "\nurl: " + e + "\nline: " + i + o);
                return !0;
            });
        }
    }, t.prototype.preload = function() {
        var e = this;
        i.prototype.preload.call(this), Images.preloadList.forEach(function(t) {
            e.game.load.image(t, "assets/" + t + ".png?v=" + Constants.APP_VERSION);
        }), this.game.load.image(Images.PRELOAD_BG, "assets/bg_land.png?v=" + Constants.APP_VERSION);
    }, t.prototype.create = function() {
        i.prototype.create.call(this), PopUp.SCALE_POP_IN = !0, Constants.IS_ADVANCED_DEBUG = !1, 
        this.game.runScene(Preloader.Name);
    }, t.Name = "boot", t;
}(Component), ConfirmNewGame = function(n) {
    function t() {
        var t = null !== n && n.apply(this, arguments) || this;
        return t.YES_BUTTON = "yesbutton", t.NO_BUTTON = "nobutton", t;
    }
    return __extends(t, n), t.prototype.init = function() {
        var t = this;
        n.prototype.init.call(this), this.designWidth = 860, this.designHeight = 860, this.dialogBackground = this.game.add.sprite(0, 0, Atlases.UI, "bgdialog.png"), 
        this.dialogBackground.anchor.set(.5, .5), this.addChild(this.dialogBackground);
        var e = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(237), Fonts.RUBIKREGULAR72, this.game.translate("confirm_new_game").toUpperCase(), 72);
        e.setTranslation({
            translationID: "confirm_new_game",
            isUpperCase: !0
        }), e.setMaxSize(690, 72), e.tint = 31684, e.setVerticalandHorizontalCenter(), this.addChild(e);
        var i = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(320), Fonts.RUBIKREGULAR55, this.game.translate("start_new_game_text").toUpperCase(), 55);
        i.setTranslation({
            translationID: "start_new_game_text",
            isUpperCase: !0
        }), i.setMaxSize(690, 480), i.tint = 31684, i.align = "center", i.setAlignCenter(), 
        this.addChild(i), this.yesbutton = new ScaleButton(this.game, Utils.translate_dialog_X(764), Utils.translate_dialog_Y(862), Atlases.UI, "btngreen.png", this.butonButtonClick, this), 
        this.yesbutton.addBMFLabel(this.game.translate("yes").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.yesbutton.bmfLabel.setTranslation({
            translationID: "yes",
            isUpperCase: !0
        }), this.yesbutton.bmfLabel.setMaxSize(300, 35), this.yesbutton.bmfLabel.tint = 53416, 
        this.yesbutton.name = this.YES_BUTTON, this.registerKeyboardButton(Phaser.KeyCode.SPACEBAR, this.yesbutton), 
        this.nobutton = new ScaleButton(this.game, Utils.translate_dialog_X(1154), Utils.translate_dialog_Y(862), Atlases.UI, "btnblue.png", this.butonButtonClick, this), 
        this.nobutton.addBMFLabel(this.game.translate("no").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.nobutton.bmfLabel.setTranslation({
            translationID: "no",
            isUpperCase: !0
        }), this.nobutton.bmfLabel.setMaxSize(300, 35), this.nobutton.bmfLabel.tint = 31684, 
        this.nobutton.name = this.NO_BUTTON, this.addChild(this.yesbutton), this.addChild(this.nobutton), 
        this.game.translation.addListener(function() {
            t.uniformButtons();
        }), this.uniformButtons();
    }, t.prototype.uniformButtons = function() {
        BMFLabel.UniformTextSizes([ this.yesbutton.bmfLabel, this.nobutton.bmfLabel ]);
    }, t.prototype.butonButtonClick = function(t) {
        if (n.prototype.onButtonClick.call(this, t), t.name === this.YES_BUTTON) {
            if (this.close(), GameSettings.getInstance().gameData) {
                var e = new WordsearchRank();
                e.userName = GameSettings.getInstance().playerName, e.score = GameSettings.getInstance().gameData.roundScore, 
                this.game.amazingRank.post_score_object(e, null, function(t) {});
            }
            this.dialogParent instanceof GameScene ? (this.dialogParent.gameLogic.endGame(GameSettings.getInstance().gameData.roundTime), 
            this.dialogParent.FinishTutorial(), GameSettings.getInstance().gameData = void 0, 
            this.dialogParent.new_game(), this.close()) : (GameSettings.getInstance().gameData.startNewGameAfterInit = !0, 
            this.game.runScene(GameScene.Name, !0));
        }
        t.name === this.NO_BUTTON && (this.dialogParent instanceof GameScene && Constants.IS_POKI && PokiSDK.gameplayStart(), 
        this.back_press());
    }, t.prototype.back_press = function() {
        this.close();
    }, t.NAME = "confirmnewgame", t;
}(PopUp), ConfirmResetStatistic = function(n) {
    function t() {
        var t = null !== n && n.apply(this, arguments) || this;
        return t.YES_BUTTON = "yes", t.NO_BUTTON = "no", t;
    }
    return __extends(t, n), t.prototype.init = function() {
        var t = this;
        n.prototype.init.call(this), this.designWidth = 860, this.designHeight = 860, this.dialogBackground = this.game.add.sprite(0, 0, Atlases.UI, "bgdialog.png"), 
        this.dialogBackground.anchor.set(.5, .5), this.addChild(this.dialogBackground);
        var e = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(198), Fonts.RUBIKREGULAR72, this.game.translate("confirm_reset_statistics").toUpperCase(), 72);
        e.setTranslation({
            translationID: "confirm_reset_statistics",
            isUpperCase: !0
        }), e.setMaxSize(690, 200), e.tint = 31684, e.setVerticalandHorizontalCenter(), 
        e.anchor.y = 0, this.addChild(e);
        var i = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(420), Fonts.RUBIKREGULAR55, this.game.translate("reset_statistics_text").toUpperCase(), 55);
        i.setTranslation({
            translationID: "reset_statistics_text",
            isUpperCase: !0
        }), i.setMaxSize(690, 360), i.tint = 31684, i.align = "center", i.setAlignCenter(), 
        this.addChild(i), this.yesbutton = new ScaleButton(this.game, Utils.translate_dialog_X(764), Utils.translate_dialog_Y(862), Atlases.UI, "btngreen.png", this.butonButtonClick, this), 
        this.yesbutton.addBMFLabel(this.game.translate("yes").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.yesbutton.bmfLabel.setTranslation({
            translationID: "yes",
            isUpperCase: !0
        }), this.yesbutton.bmfLabel.setMaxSize(300, 35), this.yesbutton.bmfLabel.tint = 53416, 
        this.yesbutton.name = this.YES_BUTTON, this.nobutton = new ScaleButton(this.game, Utils.translate_dialog_X(1154), Utils.translate_dialog_Y(862), Atlases.UI, "btnblue.png", this.butonButtonClick, this), 
        this.nobutton.addBMFLabel(this.game.translate("no").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.nobutton.bmfLabel.setTranslation({
            translationID: "no",
            isUpperCase: !0
        }), this.nobutton.bmfLabel.setMaxSize(300, 35), this.nobutton.bmfLabel.tint = 31684, 
        this.nobutton.name = this.NO_BUTTON, this.addChild(this.yesbutton), this.addChild(this.nobutton), 
        this.game.translation.addListener(function() {
            t.uniformButtons();
        }), this.uniformButtons();
    }, t.prototype.uniformButtons = function() {
        BMFLabel.UniformTextSizes([ this.yesbutton.bmfLabel, this.nobutton.bmfLabel ]);
    }, t.prototype.butonButtonClick = function(t) {
        n.prototype.onButtonClick.call(this, t), t.name === this.YES_BUTTON && (GameSettings.getInstance().applicationData.resetStatistics(), 
        this.close(), this.game.getScene(MainMenu.Name).open_popup(StatisticPopUp.NAME), 
        gameanalytics.GameAnalytics.addDesignEvent("statistics:reset:yes")), t.name === this.NO_BUTTON && (this.back_press(), 
        gameanalytics.GameAnalytics.addDesignEvent("statistics:reset:no"));
    }, t.prototype.back_press = function() {
        this.close(), this.game.getScene(MainMenu.Name).open_popup(StatisticPopUp.NAME);
    }, t.NAME = "confirmresetstatistics", t;
}(PopUp);

!function(t) {
    t[t.Score = 0] = "Score", t[t.Time = 1] = "Time", t[t.Bonus = 2] = "Bonus", t[t.StarAnimation = 3] = "StarAnimation", 
    t[t.Idle = 4] = "Idle";
}(GameOverPopUpState || (GameOverPopUpState = {}));

var ScoreType, GameOverPopUp = function(l) {
    function t() {
        var t = null !== l && l.apply(this, arguments) || this;
        return t.COUNT_SCORE_TIME = 1, t.COUNT_FINALL_SCORE_TIME = 2, t.NEW_GAME_BUTTON = "newgame", 
        t.MAIN_MENU_BUTTON = "mainmenu", t.totalScoreValue = 100, t.currentTotalScore = 100, 
        t.stateTimer = 0, t.scoreTimer = 0, t.records = [], t.isDownloading = !1, t.shouldGlobalShow = !1, 
        t;
    }
    return __extends(t, l), t.prototype.init = function() {
        l.prototype.init.call(this), this.designWidth = 860, this.designHeight = 860, this.dialogBackground = this.game.add.sprite(0, 0, Atlases.UI, "bgdialog.png"), 
        this.dialogBackground.anchor.set(.5, .5), this.addChild(this.dialogBackground);
        var t = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(206), Fonts.RUBIKREGULAR72, this.game.translate("congratulations").toUpperCase(), 72, 790, 72, {
            translationID: "congratulations",
            isUpperCase: !0
        });
        t.tint = 16727911, t.setVerticalandHorizontalCenter(), this.addChild(t);
        var e = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(295), Fonts.RUBIKMEDIUM32, this.game.translate("your_score").toUpperCase(), 32, 250, 32, {
            translationID: "your_score",
            isUpperCase: !0
        });
        e.tint = 31683, e.setVerticalandHorizontalCenter(), this.addChild(e), this.scoreLabel = new BMFLabel(AmazingGame.getInstance(), Utils.translate_dialog_X(960), Utils.translate_dialog_Y(380), Fonts.DIGITALDISPLAY62, "123456789", 127, 500, 127), 
        this.scoreLabel.tint = 53159, this.scoreLabel.setAlignRight(), this.scoreLabel.setVerticalCenter(), 
        this.scoreLabel.setVerticalandHorizontalCenter(), this.addChild(this.scoreLabel);
        var i = new ScaleButton(this.game, Utils.translate_dialog_X(1153), Utils.translate_dialog_Y(862), Atlases.UI, "btnnewgame.png", this.butonButtonClick, this);
        i.addBMFLabel(this.translate("new_game"), Fonts.RUBIKREGULAR40, 40, 32, 0, 53159, !0, {
            translationID: "new_game"
        }), i.bmfLabel.setVerticalandHorizontalCenter(), i.bmfLabel.setMaxSize(215, 32), 
        i.name = this.NEW_GAME_BUTTON, i.anchor.set(.5), this.registerKeyboardButton(Phaser.KeyCode.SPACEBAR, i), 
        this.addChild(i);
        var n = new ScaleButton(this.game, Utils.translate_dialog_X(764), Utils.translate_dialog_Y(862), Atlases.UI, "btnmenu.png", this.butonButtonClick, this);
        if (n.addBMFLabel(this.translate("menu"), Fonts.RUBIKREGULAR40, 40, 32, 0, 31683, !0, {
            translationID: "menu"
        }), n.bmfLabel.setVerticalandHorizontalCenter(), n.bmfLabel.setMaxSize(215, 32), 
        n.name = this.MAIN_MENU_BUTTON, n.anchor.set(.5), this.addChild(n), this.bubblesRemovedType1Lbl = new BMFLabel(AmazingGame.getInstance(), -250, Utils.translate_dialog_Y(560), Fonts.RUBIKMEDIUM32, "123", 30), 
        this.bubblesRemovedType1Lbl.tint = 31684, this.bubblesRemovedType1Lbl.setVerticalandHorizontalCenter(), 
        this.addChild(this.bubblesRemovedType1Lbl), this.bubblesRemovedType2Lbl = new BMFLabel(AmazingGame.getInstance(), -150, Utils.translate_dialog_Y(560), Fonts.RUBIKMEDIUM32, "123", 30), 
        this.bubblesRemovedType2Lbl.tint = 31684, this.bubblesRemovedType2Lbl.setVerticalandHorizontalCenter(), 
        this.addChild(this.bubblesRemovedType2Lbl), this.bubblesRemovedType3Lbl = new BMFLabel(AmazingGame.getInstance(), -50, Utils.translate_dialog_Y(560), Fonts.RUBIKMEDIUM32, "123", 30), 
        this.bubblesRemovedType3Lbl.tint = 31684, this.bubblesRemovedType3Lbl.setVerticalandHorizontalCenter(), 
        this.addChild(this.bubblesRemovedType3Lbl), this.bubblesRemovedType4Lbl = new BMFLabel(AmazingGame.getInstance(), 50, Utils.translate_dialog_Y(560), Fonts.RUBIKMEDIUM32, "123", 30), 
        this.bubblesRemovedType4Lbl.tint = 31684, this.bubblesRemovedType4Lbl.setVerticalandHorizontalCenter(), 
        this.addChild(this.bubblesRemovedType4Lbl), this.bubblesRemovedType5Lbl = new BMFLabel(AmazingGame.getInstance(), 150, Utils.translate_dialog_Y(560), Fonts.RUBIKMEDIUM32, "123", 30), 
        this.bubblesRemovedType5Lbl.tint = 31684, this.bubblesRemovedType5Lbl.setVerticalandHorizontalCenter(), 
        this.addChild(this.bubblesRemovedType5Lbl), this.bubblesRemovedType6Lbl = new BMFLabel(AmazingGame.getInstance(), 250, Utils.translate_dialog_Y(560), Fonts.RUBIKMEDIUM32, "123", 30), 
        this.bubblesRemovedType6Lbl.tint = 31684, this.bubblesRemovedType6Lbl.setVerticalandHorizontalCenter(), 
        this.addChild(this.bubblesRemovedType6Lbl), this.bubblesRemovedType1Img = this.game.add.image(-250, Utils.translate_dialog_Y(510), Atlases.UI, "dot.png"), 
        this.bubblesRemovedType1Img.anchor.set(.5), this.bubblesRemovedType1Img.tint = GameTheme.GetCurretnBallsTint(BUBBLE_1), 
        this.addChild(this.bubblesRemovedType1Img), this.bubblesRemovedType2Img = this.game.add.image(-150, Utils.translate_dialog_Y(510), Atlases.UI, "dot.png"), 
        this.bubblesRemovedType2Img.anchor.set(.5), this.bubblesRemovedType2Img.tint = GameTheme.GetCurretnBallsTint(BUBBLE_2), 
        this.addChild(this.bubblesRemovedType2Img), this.bubblesRemovedType3Img = this.game.add.image(-50, Utils.translate_dialog_Y(510), Atlases.UI, "dot.png"), 
        this.bubblesRemovedType3Img.anchor.set(.5), this.bubblesRemovedType3Img.tint = GameTheme.GetCurretnBallsTint(BUBBLE_3), 
        this.addChild(this.bubblesRemovedType3Img), this.bubblesRemovedType4Img = this.game.add.image(50, Utils.translate_dialog_Y(510), Atlases.UI, "dot.png"), 
        this.bubblesRemovedType4Img.anchor.set(.5), this.bubblesRemovedType4Img.tint = GameTheme.GetCurretnBallsTint(BUBBLE_4), 
        this.addChild(this.bubblesRemovedType4Img), this.bubblesRemovedType5Img = this.game.add.image(150, Utils.translate_dialog_Y(510), Atlases.UI, "dot.png"), 
        this.bubblesRemovedType5Img.anchor.set(.5), this.bubblesRemovedType5Img.tint = GameTheme.GetCurretnBallsTint(BUBBLE_5), 
        this.addChild(this.bubblesRemovedType5Img), this.bubblesRemovedType6Img = this.game.add.image(250, Utils.translate_dialog_Y(510), Atlases.UI, "dot.png"), 
        this.bubblesRemovedType6Img.anchor.set(.5), this.bubblesRemovedType6Img.tint = GameTheme.GetCurretnBallsTint(BUBBLE_6), 
        this.addChild(this.bubblesRemovedType6Img), this.globalRank = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(785), Fonts.RUBIKMEDIUM32, "", 32, 760, 32), 
        this.globalRank.tint = 16755110, this.globalRank.setVerticalandHorizontalCenter(), 
        this.globalRank.alpha = 0, this.addChild(this.globalRank), !IS_4BALANCE) for (var s = 0; s < LOCAL_HISCORES_COUNT; s++) {
            var o = new BMFLabel(this.game, Utils.translate_dialog_X(620), Utils.translate_dialog_Y(638 + 50 * s), Fonts.RUBIKMEDIUM50, "", 38);
            o.setAlignLeft(), o.tint = 31683, o.setVerticalandHorizontalCenter(), o.setMaxSize(50, 38);
            var a = new BMFLabel(this.game, Utils.translate_dialog_X(660), Utils.translate_dialog_Y(638 + 50 * s), Fonts.RUBIKMEDIUM50, "", 38);
            a.setAlignLeft(), a.setVerticalCenter(), a.setMaxSize(280, 50), a.tint = 31683;
            var r = new BMFLabel(this.game, Utils.translate_dialog_X(1304), Utils.translate_dialog_Y(638 + 50 * s), Fonts.RUBIKMEDIUM50, "", 38);
            r.setAlignRight(), r.setVerticalCenter(), r.setMaxSize(120, 38), r.tint = 31683;
            var h = this.game.add.group();
            this.addChild(h), h.addChild(o), h.addChild(a), h.addChild(r), this.records.push(new Trio(o, a, r));
        }
    }, t.prototype.show = function() {
        var i = this;
        if (l.prototype.show.call(this), this.bubblesRemovedType1Lbl.text = "0", this.bubblesRemovedType2Lbl.text = "0", 
        this.bubblesRemovedType3Lbl.text = "0", this.bubblesRemovedType4Lbl.text = "0", 
        this.bubblesRemovedType5Lbl.text = "0", this.bubblesRemovedType6Lbl.text = "0", 
        this.globalRank.alpha = 0, !IS_4BALANCE) {
            for (var t = 0; t < LOCAL_HISCORES_COUNT; t++) {
                this.records[t].second.setMaxSize(520, 50);
                var e = this.records[t].first.parent;
                e.alpha = 0, this.game.add.tween(e).to({
                    alpha: 1
                }, 300, Phaser.Easing.Sinusoidal.InOut, !0, 1750 + 1e3 * t);
            }
            this.game.amazingRank.pageSize = 1, this.game.amazingRank.get_my_overall_rank(function(t) {
                if (0 < t.length) {
                    var e = i.translate("you_are_on").replace("{counter}", (t[0].rank + 1).toString());
                    i.globalRank.text = e, i.globalRank.alpha = 1;
                }
            });
        }
        this.stateTimer = 0, this.scoreTimer = 0, this.gameOverDialogState = GameOverPopUpState.Score;
    }, t.prototype.on_resize = function() {
        l.prototype.on_resize.call(this);
    }, t.prototype.playBubblesAnimation = function() {
        var e, t, i = this, n = [ this.bubblesRemovedType1Img, this.bubblesRemovedType2Img, this.bubblesRemovedType3Img, this.bubblesRemovedType4Img, this.bubblesRemovedType5Img, this.bubblesRemovedType6Img ], s = function(t) {
            var e = o.game.add.image(t.position.x, t.position.y, Atlases.UI, "dot.png");
            e.anchor.set(.5), e.blendMode = Phaser.blendModes.SOFT_LIGHT, e.tint = t.tint, e.scale.set(0), 
            o.addChild(e), o.game.add.tween(e).to({
                alpha: 0
            }, 750, Phaser.Easing.Quadratic.In, !0, 0).onComplete.addOnce(function() {
                i.remove(e);
            }), o.game.add.tween(e.scale).to({
                x: 3.75,
                y: 3.75
            }, 750, Phaser.Easing.Quadratic.In, !0, 0).onComplete.addOnce(function() {});
        }, o = this;
        try {
            for (var a = __values(n), r = a.next(); !r.done; r = a.next()) {
                s(r.value);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                r && !r.done && (t = a.return) && t.call(a);
            } finally {
                if (e) throw e.error;
            }
        }
    }, t.prototype.update = function() {
        if (l.prototype.update.call(this), this.stateTimer += this.game.time.elapsed / 1e3, 
        this.scoreTimer += this.game.time.elapsed / 1e3, this.gameOverDialogState === GameOverPopUpState.Score) {
            var t = Phaser.Math.clamp(0, 1, this.stateTimer / this.COUNT_SCORE_TIME);
            this.scoreLabel.text = Math.round(GameSettings.getInstance().gameData.roundScore * t).toString(), 
            this.bubblesRemovedType1Lbl.text = Math.round(GameSettings.getInstance().gameData.bubblesRemovedType1 * t).toString(), 
            this.bubblesRemovedType2Lbl.text = Math.round(GameSettings.getInstance().gameData.bubblesRemovedType2 * t).toString(), 
            this.bubblesRemovedType3Lbl.text = Math.round(GameSettings.getInstance().gameData.bubblesRemovedType3 * t).toString(), 
            this.bubblesRemovedType4Lbl.text = Math.round(GameSettings.getInstance().gameData.bubblesRemovedType4 * t).toString(), 
            this.bubblesRemovedType5Lbl.text = Math.round(GameSettings.getInstance().gameData.bubblesRemovedType5 * t).toString(), 
            this.bubblesRemovedType6Lbl.text = Math.round(GameSettings.getInstance().gameData.bubblesRemovedType6 * t).toString(), 
            1 <= this.stateTimer && (this.playBubblesAnimation(), this.gameOverDialogState = GameOverPopUpState.Idle, 
            this.stateTimer = 0);
        }
    }, t.prototype.butonButtonClick = function(t) {
        l.prototype.onButtonClick.call(this, t), t.name === this.NEW_GAME_BUTTON ? (this.close(), 
        this.game.getScene("gamescene").new_game()) : t.name === this.MAIN_MENU_BUTTON && (this.close(), 
        AmazingGame.getInstance().runScene(MainMenu.Name, !0));
    }, t.prototype.back_press = function() {
        this.close(), this.game.getScene("gamescene").new_game();
    }, t.prototype.lerp = function(t, e, i) {
        return t + (e - t) * (i = 1 < (i = i < 0 ? 0 : i) ? 1 : i);
    }, t.prototype.playStarAnimation = function(t, e, i, n, s) {
        void 0 === s && (s = 1);
    }, t.prototype.SetHighscores = function() {
        if (!IS_4BALANCE) for (var t = 0; t < GameSettings.getInstance().applicationData.hiscores.hiscores.length; t++) this.records[t].first.text = "" + (t + 1), 
        this.records[t].second.text = GameSettings.getInstance().applicationData.hiscores.hiscores[t].name, 
        this.records[t].third.text = "" + GameSettings.getInstance().applicationData.hiscores.hiscores[t].score;
    }, t.NAME = "gameoverpopup", t;
}(PopUp), ReviewDialog = function(n) {
    function t() {
        var t = null !== n && n.apply(this, arguments) || this;
        return t.REVIEW_BUTTON = "review", t.CLOSE_BUTTON = "close", t;
    }
    return __extends(t, n), t.prototype.init = function() {
        n.prototype.init.call(this), this.designWidth = 860, this.designHeight = 860, this.dialogBackground = this.game.add.sprite(0, 0, Atlases.UI, "bgdialog.png"), 
        this.dialogBackground.anchor.set(.5, .5), this.addChild(this.dialogBackground), 
        this.btnClose = new ScaleButton(this.game, Utils.translate_dialog_X(1264), Utils.translate_dialog_Y(236), Atlases.UI, "btnclose.png", this.onButtonClick, this), 
        this.btnClose.anchor.set(.5), this.btnClose.name = this.CLOSE_BUTTON, this.addChild(this.btnClose);
        var t = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(198), Fonts.RUBIKREGULAR72, this.game.translate("do_you_like").toUpperCase(), 72);
        t.setTranslation({
            translationID: "do_you_like",
            isUpperCase: !0
        }), t.setMaxSize(490, 200), t.tint = 31684, t.setVerticalandHorizontalCenter(), 
        t.anchor.y = 0, this.addChild(t);
        var e = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(710), Fonts.RUBIKREGULAR40, this.game.translate("please_leave_nice").toUpperCase(), 40);
        e.setTranslation({
            translationID: "please_leave_nice",
            isUpperCase: !0
        }), e.setMaxSize(710, 45), e.tint = 31684, e.setVerticalandHorizontalCenter(), e.anchor.y = 0, 
        this.addChild(e), this.btnReview = new ScaleButton(this.game, 0, Utils.translate_dialog_Y(855), Atlases.UI, "btnRateUs.png", this.onButtonClick, this), 
        this.btnReview.addBMFLabel(this.game.translate("rateus").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.btnReview.bmfLabel.setTranslation({
            translationID: "rateus",
            isUpperCase: !0
        }), this.btnReview.bmfLabel.tint = 53159, this.btnReview.bmfLabel.setMaxSize(250, 35), 
        this.btnReview.name = this.REVIEW_BUTTON, this.addChild(this.btnReview);
        var i = this.game.add.sprite(0, 0, Atlases.MENU_SHEET, "logo.png");
        i.anchor.setTo(.5, .5), this.addChild(i);
    }, t.prototype.onButtonClick = function(t) {
        n.prototype.onButtonClick.call(this, t), t.name === this.REVIEW_BUTTON ? (AmazingGame.getInstance().PlatformProvider.review_game(), 
        gameanalytics.GameAnalytics.addDesignEvent("review:" + Platform[Constants.COMPILE_PLATFORM]), 
        this.close()) : t.name === this.CLOSE_BUTTON && this.back_press();
    }, t.prototype.back_press = function() {
        this.close();
    }, t.NAME = "reviewdialog", t;
}(PopUp);

!function(t) {
    t[t.Daily = 0] = "Daily", t[t.Weekly = 1] = "Weekly", t[t.Monthly = 2] = "Monthly", 
    t[t.Overall = 3] = "Overall";
}(ScoreType || (ScoreType = {}));

var GameStateMachine, StartState, EndState, ScorePopUp = function(h) {
    function t() {
        var t = null !== h && h.apply(this, arguments) || this;
        return t.RECORDS = 8, t.scoreType = ScoreType.Overall, t.CLOSE_BUTTON = "closebutton", 
        t.WEEKLY = "weekly", t.MONTHLY = "monthly", t.OVERALL = "overall", t.FIND = "find", 
        t.RENAME = "rename", t.isFoundMe = !1, t.isDownloading = !1, t.records = [], t;
    }
    return __extends(t, h), t.prototype.init = function() {
        var t = this;
        h.prototype.init.call(this), this.designWidth = 860, this.designHeight = 860, this.dialogBackground = this.game.add.image(0, 0, Atlases.UI, "bgdialog.png"), 
        this.dialogBackground.anchor.set(.5, .5), this.addChild(this.dialogBackground);
        var e = new ScaleButton(this.game, Utils.translate_dialog_X(1264), Utils.translate_dialog_Y(236), Atlases.UI, "btnclose.png", this.onButtonClick, this);
        e.name = this.CLOSE_BUTTON, this.registerKeyboardButton(Phaser.KeyCode.SPACEBAR, e), 
        this.addChild(e);
        for (var i = Utils.translate_dialog_Y(300), n = 0; n < this.RECORDS; n++) {
            var s = new BMFLabel(this.game, -375, i + 45 * n, Fonts.RUBIKMEDIUM32, "", 38);
            s.tint = 31684, s.setMaxSize(150, 38);
            var o = new BMFLabel(this.game, -215, i + 45 * n, Fonts.RUBIKMEDIUM32, "", 38);
            o.tint = 31684, o.setMaxSize(405, 38);
            var a = new BMFLabel(this.game, 375, i + 45 * n, Fonts.RUBIKMEDIUM32, "", 38);
            a.tint = 31684, a.setMaxSize(165, 38), a.anchor.set(1, 0), this.records.push(new Trio(s, o, a)), 
            this.addChild(s), this.addChild(o), this.addChild(a);
        }
        this.weekely = new ScaleButton(this.game, -250, Utils.translate_dialog_Y(780), Atlases.UI, "btnbluesmall.png", this.onButtonClick, this), 
        this.weekely.addBMFLabel(this.game.translate("weekely").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.weekely.bmfLabel.setTranslation({
            translationID: "weekely",
            isUpperCase: !0
        }), this.weekely.bmfLabel.tint = 31684, this.weekely.bmfLabel.setMaxSize(200, 35), 
        this.weekely.name = this.WEEKLY, this.weekely.anchor.set(.5), this.addChild(this.weekely), 
        this.monthly = new ScaleButton(this.game, 0, Utils.translate_dialog_Y(780), Atlases.UI, "btnbluesmall.png", this.onButtonClick, this), 
        this.monthly.addBMFLabel(this.game.translate("monthly").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.monthly.bmfLabel.setTranslation({
            translationID: "monthly",
            isUpperCase: !0
        }), this.monthly.bmfLabel.tint = 31684, this.monthly.bmfLabel.setMaxSize(200, 35), 
        this.monthly.name = this.MONTHLY, this.monthly.anchor.set(.5), this.addChild(this.monthly), 
        this.overall = new ScaleButton(this.game, 250, Utils.translate_dialog_Y(780), Atlases.UI, "btnbluesmall.png", this.onButtonClick, this), 
        this.overall.addBMFLabel(this.game.translate("overall").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.overall.bmfLabel.setTranslation({
            translationID: "overall",
            isUpperCase: !0
        }), this.overall.bmfLabel.tint = 31684, this.overall.bmfLabel.setMaxSize(200, 35), 
        this.overall.anchor.set(.5), this.overall.name = this.OVERALL, this.addChild(this.overall), 
        this.findMe = new ScaleButton(this.game, -125, Utils.translate_dialog_Y(880), Atlases.UI, "btnbluesmall.png", this.onButtonClick, this), 
        this.findMe.addBMFLabel(this.game.translate("findMe").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.findMe.bmfLabel.setTranslation({
            translationID: "findMe",
            isUpperCase: !0
        }), this.findMe.bmfLabel.tint = 31684, this.findMe.bmfLabel.setMaxSize(200, 35), 
        this.findMe.name = this.FIND, this.findMe.anchor.set(.5), this.addChild(this.findMe), 
        this.changeName = new ScaleButton(this.game, 125, Utils.translate_dialog_Y(880), Atlases.UI, "btnbluesmall.png", this.onButtonClick, this), 
        this.changeName.addBMFLabel(this.game.translate("rename").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.changeName.bmfLabel.setTranslation({
            translationID: "rename",
            isUpperCase: !0
        }), this.changeName.bmfLabel.tint = 31684, this.changeName.bmfLabel.setMaxSize(200, 35), 
        this.changeName.name = this.RENAME, this.changeName.anchor.set(.5), this.addChild(this.changeName);
        var r = new BMFLabel(this.game, -350, Utils.translate_dialog_Y(237), Fonts.RUBIKREGULAR72, this.game.translate("rankings").toUpperCase(), 72);
        r.setTranslation({
            translationID: "rankings",
            isUpperCase: !0
        }), r.tint = 31684, r.setMaxSize(570, 72), r.setVerticalandHorizontalCenter(), r.setAlignLeft(), 
        this.addChild(r), this.downloadingLabel = new BMFLabel(this.game, 0, Utils.translate_dialog_Y(700), Fonts.RUBIKREGULAR35, this.game.translate("downloading"), 35), 
        this.downloadingLabel.setTranslation({
            translationID: "downloading"
        }), this.downloadingLabel.tint = 16731648, this.downloadingLabel.setVerticalandHorizontalCenter(), 
        this.downloadingLabel.visible = !1, this.downloadingLabel.setMaxSize(560, 38), this.addChild(this.downloadingLabel), 
        this.inputPopUp = new InputPopUp(), this.game.translation.addListener(function() {
            t.uniformButtons();
        }), this.uniformButtons();
    }, t.prototype.uniformButtons = function() {
        BMFLabel.UniformTextSizes([ this.weekely.bmfLabel, this.monthly.bmfLabel, this.overall.bmfLabel, this.findMe.bmfLabel, this.changeName.bmfLabel ]);
    }, t.prototype.getWeeklyTopScore = function() {
        var e = this;
        this.clearRows(), this.downloadingLabel.visible = this.isDownloading = !0, this.game.amazingRank.pageSize = 8, 
        this.game.amazingRank.get_top_weekly_rank(function(t) {
            e.fillRanksWithData(t);
        });
    }, t.prototype.getMothlyTopScore = function() {
        var e = this;
        this.clearRows(), this.downloadingLabel.visible = this.isDownloading = !0, this.game.amazingRank.pageSize = 8, 
        this.game.amazingRank.get_top_monthly_rank(function(t) {
            e.fillRanksWithData(t);
        });
    }, t.prototype.getOverallTopScore = function() {
        var e = this;
        this.clearRows(), this.downloadingLabel.visible = this.isDownloading = !0, this.game.amazingRank.pageSize = 8, 
        this.game.amazingRank.get_top_overall_rank(function(t) {
            e.fillRanksWithData(t);
        });
    }, t.prototype.getWeeklyMyScore = function() {
        var e = this;
        this.clearRows(), this.downloadingLabel.visible = this.isDownloading = !0, this.game.amazingRank.pageSize = 8, 
        this.game.amazingRank.get_my_weekly_rank(function(t) {
            e.fillRanksWithData(t);
        });
    }, t.prototype.getMothlyMyScore = function() {
        var e = this;
        this.clearRows(), this.downloadingLabel.visible = this.isDownloading = !0, this.game.amazingRank.pageSize = 8, 
        this.game.amazingRank.get_my_monthly_rank(function(t) {
            e.fillRanksWithData(t);
        });
    }, t.prototype.getOverallMyScore = function() {
        var e = this;
        this.clearRows(), this.downloadingLabel.visible = this.isDownloading = !0, this.game.amazingRank.pageSize = 8, 
        this.game.amazingRank.get_my_overall_rank(function(t) {
            e.fillRanksWithData(t);
        });
    }, t.prototype.fillRanksWithData = function(t) {
        this.downloadingLabel.visible = this.isDownloading = !1;
        for (var e = 0; e < this.records.length; e++) this.records[e].first.setText((t[e].rank + 1).toString()), 
        this.records[e].second.setText(t[e].data.userName), this.records[e].third.setText(t[e].data.score), 
        t[e].data.userId === this.game.amazingRank.userId && (this.records[e].first.tint = 53416, 
        this.records[e].second.tint = 53416, this.records[e].third.tint = 53416);
    }, t.prototype.clearRows = function() {
        for (var t = 0; t < this.records.length; t++) this.records[t].first.setText(""), 
        this.records[t].second.setText(""), this.records[t].third.setText(""), this.records[t].first.tint = 31684, 
        this.records[t].second.tint = 31684, this.records[t].third.tint = 31684;
    }, t.prototype.show = function() {
        h.prototype.show.call(this), this.getOverallTopScore();
    }, t.prototype.refreshToggles = function() {}, t.prototype.onButtonClick = function(t) {
        var n = this;
        if (h.prototype.onButtonClick.call(this, t), t.name === this.CLOSE_BUTTON) this.close(); else if (t.name === this.WEEKLY) this.isDownloading || (this.isFoundMe = !1, 
        this.scoreType = ScoreType.Weekly, this.getWeeklyTopScore()); else if (t.name === this.MONTHLY) this.isDownloading || (this.isFoundMe = !1, 
        this.scoreType = ScoreType.Monthly, this.getMothlyTopScore()); else if (t.name === this.OVERALL) this.isDownloading || (this.isFoundMe = !1, 
        this.scoreType = ScoreType.Overall, this.getOverallTopScore()); else if (t.name === this.FIND) {
            if (!this.isDownloading) switch (this.isFoundMe = !0, this.scoreType) {
              case ScoreType.Daily:
                break;

              case ScoreType.Weekly:
                this.getWeeklyMyScore();
                break;

              case ScoreType.Monthly:
                this.getMothlyMyScore();
                break;

              case ScoreType.Overall:
                this.getOverallMyScore();
            }
        } else t.name === this.RENAME && this.inputPopUp.show(function() {}, function(t) {
            GameSettings.getInstance().playerName = t, GameSettings.getInstance().save();
            var e = new WordsearchRank();
            e.userName = GameSettings.getInstance().playerName;
            var i = n;
            n.game.amazingRank.change_name(e, function(t) {
                i.isFoundMe = !0, i.getOverallMyScore();
            });
        }, GameSettings.getInstance().playerName);
    }, t.prototype.on_resize = function() {
        h.prototype.on_resize.call(this);
    }, t.prototype.add_promo_label = function(t, e, i) {
        var n = "bold 42px" + Fonts.HELVETICA, s = this.game.add.text(t, e, i, {
            font: n,
            fill: "white",
            align: "left"
        });
        s.smoothed = !0, s.anchor.set(.5, .5), s.align = "center";
        var o = s.context.createLinearGradient(0, 0, 0, s.height);
        return o.addColorStop(0, "#FFFF70"), o.addColorStop(1, "#B6892F"), s.fill = o, s.stroke = "#9F4224", 
        s.strokeThickness = 4, this.addChild(s), s;
    }, t.NAME = "scorepopup", t;
}(PopUp), SettingsPopUp = function(o) {
    function t() {
        var t = null !== o && o.apply(this, arguments) || this;
        return t.CLOSE_BUTTON = "closebutton", t.SOUND_BUTTON = "sound", t.MUSIC_BUTTON = "time", 
        t.LIKE_BUTTON = "like", t.RATE_BUTTON = "reate", t.FOLLOW_BUTTON = "follow", t.CONTACT_BUTTON = "contact", 
        t;
    }
    return __extends(t, o), t.prototype.init = function() {
        var t = this;
        o.prototype.init.call(this), this.designWidth = 860, this.designHeight = 860, this.dialogBackground = this.game.add.image(0, 0, Atlases.UI, "bgdialog.png"), 
        this.dialogBackground.anchor.set(.5, .5), this.addChild(this.dialogBackground);
        var e = new BMFLabel(this.game, -350, Utils.translate_dialog_Y(237), Fonts.RUBIKREGULAR72, this.game.translate("settings").toUpperCase(), 72);
        e.setTranslation({
            translationID: "settings",
            isUpperCase: !0
        }), e.tint = 31684, e.setMaxSize(570, 72), e.setVerticalandHorizontalCenter(), e.setAlignLeft(), 
        this.addChild(e);
        var i = new ScaleButton(this.game, Utils.translate_dialog_X(1264), Utils.translate_dialog_Y(236), Atlases.UI, "btnclose.png", this.butonButtonClick, this);
        i.name = this.CLOSE_BUTTON, this.registerKeyboardButton(Phaser.KeyCode.SPACEBAR, i), 
        this.addChild(i);
        var n = {
            on_txt: "tglon.png",
            off_txt: "tgloff.png",
            on_str: this.game.translate("on").toUpperCase(),
            off_str: this.game.translate("off").toUpperCase(),
            size: 35,
            offset: 5,
            font: Fonts.RUBIKREGULAR35,
            on_tint: 51606,
            off_tint: 15342628,
            default_tint: 3881787
        }, s = 0;
        DISABLE_LINKS_FOR_LICENSE && (s = 140), this.soundLabel = new BMFLabel(this.game, Utils.translate_dialog_X(600), Utils.translate_dialog_Y(337 + s), Fonts.RUBIKREGULAR35, this.game.translate("soundeffects").toUpperCase(), 35), 
        this.soundLabel.setTranslation({
            translationID: "soundeffects",
            isUpperCase: !0
        }), this.soundLabel.tint = 31684, this.soundLabel.setAlignLeft(), this.soundLabel.setMaxSize(400, 38), 
        this.soundLabel.anchor.y = .5, this.addChild(this.soundLabel), this.soundToggle = new ToggleButton(this.game, Atlases.UI, n, this.butonButtonClick, this), 
        this.soundToggle.position.set(Utils.translate_dialog_X(1180), Utils.translate_dialog_Y(337 + s)), 
        this.soundToggle.name = this.SOUND_BUTTON, this.soundToggle.anchor.set(.5), this.addChild(this.soundToggle), 
        this.musicLabel = new BMFLabel(this.game, Utils.translate_dialog_X(600), Utils.translate_dialog_Y(437 + s), Fonts.RUBIKREGULAR35, this.game.translate("music").toUpperCase(), 35), 
        this.musicLabel.setTranslation({
            translationID: "music",
            isUpperCase: !0
        }), this.musicLabel.tint = 31684, this.musicLabel.setAlignLeft(), this.musicLabel.setMaxSize(400, 38), 
        this.musicLabel.anchor.y = .5, this.addChild(this.musicLabel), this.musicToggle = new ToggleButton(this.game, Atlases.UI, n, this.butonButtonClick, this), 
        this.musicToggle.position.set(Utils.translate_dialog_X(1180), Utils.translate_dialog_Y(437 + s)), 
        this.musicToggle.name = this.MUSIC_BUTTON, this.musicToggle.anchor.set(.5), this.addChild(this.musicToggle), 
        this.verLabel = new BMFLabel(this.game, 300, Utils.translate_dialog_Y(900), Fonts.RUBIKMEDIUM24, "ver." + Constants.APP_VERSION, 24), 
        this.verLabel.tint = 11525345, this.verLabel.setMaxSize(200, 24), this.verLabel.setAlignRight(), 
        this.addChild(this.verLabel), DISABLE_LINKS_FOR_LICENSE || Constants.IS_POKI || (this.fb = new ScaleButton(this.game, -250, Utils.translate_dialog_Y(572), Atlases.UI, "btnDarkBlue.png", this.butonButtonClick, this), 
        this.fb.addBMFLabel(this.game.translate("likeus").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.fb.bmfLabel.setTranslation({
            translationID: "likeus",
            isUpperCase: !0
        }), this.fb.bmfLabel.tint = 1603569, this.fb.bmfLabel.setMaxSize(200, 35), this.fb.name = this.LIKE_BUTTON, 
        this.addChild(this.fb), this.follow = new ScaleButton(this.game, 0, Utils.translate_dialog_Y(572), Atlases.UI, "btnLightBlue.png", this.butonButtonClick, this), 
        this.follow.addBMFLabel(this.game.translate("followus").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.follow.bmfLabel.setTranslation({
            translationID: "followus",
            isUpperCase: !0
        }), this.follow.bmfLabel.tint = 2007023, this.follow.bmfLabel.setMaxSize(200, 35), 
        this.follow.name = this.FOLLOW_BUTTON, this.addChild(this.follow), this.contact = new ScaleButton(this.game, 250, Utils.translate_dialog_Y(572), Atlases.UI, "btnRed.png", this.butonButtonClick, this), 
        this.contact.addBMFLabel(this.game.translate("contact").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.contact.bmfLabel.setTranslation({
            translationID: "contact",
            isUpperCase: !0
        }), this.contact.bmfLabel.tint = 16727911, this.contact.bmfLabel.setMaxSize(200, 35), 
        this.contact.name = this.CONTACT_BUTTON, this.addChild(this.contact), this.rate = new ScaleButton(this.game, 0, Utils.translate_dialog_Y(705), Atlases.UI, "btnRateUs.png", this.butonButtonClick, this), 
        this.rate.addBMFLabel(this.game.translate("rateus").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.rate.bmfLabel.setTranslation({
            translationID: "rateus",
            isUpperCase: !0
        }), this.rate.bmfLabel.tint = 53159, this.rate.bmfLabel.setMaxSize(250, 35), this.rate.name = this.RATE_BUTTON, 
        this.addChild(this.rate)), Constants.PLAY_CROSS_PROMOTION && !Constants.IS_POKI && (this.adButton = new ScaleButton(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(820), "ad1", "ad1", this.butonButtonClick, this), 
        this.adButton.anchor.set(.5, .5), this.adButton.name = "addbutton", this.addChild(this.adButton)), 
        this.game.translation.addListener(function() {
            t.uniformButtons(), t.uniformLabels();
        }), this.uniformButtons(), this.uniformLabels();
    }, t.prototype.uniformButtons = function() {
        DISABLE_LINKS_FOR_LICENSE || Constants.IS_POKI || BMFLabel.UniformTextSizes([ this.fb.bmfLabel, this.follow.bmfLabel, this.contact.bmfLabel, this.rate.bmfLabel ]);
    }, t.prototype.uniformLabels = function() {
        BMFLabel.UniformTextSizes([ this.soundLabel, this.musicLabel ]);
    }, t.prototype.show = function() {
        o.prototype.show.call(this), this.refreshToggles(), Constants.PLAY_CROSS_PROMOTION && !Constants.IS_POKI && null != this.adButton && (this.adButton.alpha = 0, 
        AmazingGame.getInstance().amazingAd.initialized ? AmazingGame.getInstance().amazingAd.get_ad("728x90", function(t) {
            this.currentBannerAd = t, null != this.currentBannerAd && (AmazingGame.getInstance().cache.checkImageKey(t.sourceUrl) ? (this.adButton.loadTexture(t.sourceUrl), 
            this.adButton.set_all_frames(t.sourceUrl), this.game.add.tween(this.adButton).to({
                alpha: 1
            }, Phaser.Timer.SECOND, Phaser.Easing.Quadratic.In, !0, .25 * Phaser.Timer.SECOND)) : Utils.download_image_from_url(t.sourceUrl, t.sourceUrl, function(t) {
                this.adButton.loadTexture(t), this.adButton.set_all_frames(t), this.game.add.tween(this.adButton).to({
                    alpha: 1
                }, Phaser.Timer.SECOND, Phaser.Easing.Quadratic.In, !0, .25 * Phaser.Timer.SECOND);
            }.bind(this, t.sourceUrl)));
        }.bind(this), function() {}) : this.adButton.visible = !1);
    }, t.prototype.refreshToggles = function() {
        this.soundToggle.setToggleState(GameSettings.getInstance().soundEnabled), this.musicToggle.setToggleState(GameSettings.getInstance().musicEnabled);
    }, t.prototype.butonButtonClick = function(t) {
        o.prototype.onButtonClick.call(this, t), t.name === this.CLOSE_BUTTON ? this.close() : t.name === this.MUSIC_BUTTON ? (GameSettings.getInstance().musicEnabled = !GameSettings.getInstance().musicEnabled, 
        GameSettings.getInstance().musicEnabled ? AudioManager.getInstance().play_background() : AudioManager.getInstance().stop_background(), 
        GameSettings.getInstance().save(), this.refreshToggles()) : t.name === this.SOUND_BUTTON ? (GameSettings.getInstance().soundEnabled = !GameSettings.getInstance().soundEnabled, 
        GameSettings.getInstance().save(), this.refreshToggles()) : "addbutton" === t.name ? AmazingGame.getInstance().amazingAdProvider.open_ad_depends_on_platform(this.currentBannerAd.promoteUrl) : t.name === this.LIKE_BUTTON ? AmazingGame.getInstance().PlatformProvider.open_link(Constants.FACEBOOK_LINK) : t.name === this.FOLLOW_BUTTON ? AmazingGame.getInstance().PlatformProvider.open_link(Constants.TWITTER_LINK) : t.name === this.CONTACT_BUTTON ? AmazingGame.getInstance().PlatformProvider.contact() : t.name === this.RATE_BUTTON && AmazingGame.getInstance().PlatformProvider.review_game();
    }, t.NAME = "settingspopup", t;
}(PopUp), StatisticPopUp = function(o) {
    function t() {
        var t = null !== o && o.apply(this, arguments) || this;
        return t.CLOSE_BUTTON = "closebutton", t.RESET_BUTTON = "resetbutton", t;
    }
    return __extends(t, o), t.prototype.init = function() {
        var t = this;
        o.prototype.init.call(this), this.designWidth = 860, this.designHeight = 860, this.dialogBackground = this.game.add.image(0, 0, Atlases.UI, "bgdialog.png"), 
        this.dialogBackground.anchor.set(.5, .5), this.addChild(this.dialogBackground);
        var e = new BMFLabel(this.game, -350, Utils.translate_dialog_Y(237), Fonts.RUBIKREGULAR72, this.game.translate("statistics").toUpperCase(), 72);
        e.tint = 31684, e.setVerticalandHorizontalCenter(), e.setMaxSize(570, 72), e.setAlignLeft(), 
        this.addChild(e);
        var i = new ScaleButton(this.game, Utils.translate_dialog_X(1264), Utils.translate_dialog_Y(236), Atlases.UI, "btnclose.png", this.butonButtonClick, this);
        i.name = this.CLOSE_BUTTON, this.registerKeyboardButton(Phaser.KeyCode.SPACEBAR, i), 
        this.addChild(i);
        var n = new ScaleButton(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(862), Atlases.UI, "btnblue.png", this.butonButtonClick, this);
        n.addBMFLabel(this.game.translate("reset").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        n.bmfLabel.tint = 31684, n.bmfLabel.setMaxSize(300, 35), n.name = this.RESET_BUTTON, 
        this.addChild(n), this.recordMap = new StringKeyedCollection(), this.labelMap = new StringKeyedCollection();
        var s = 350;
        this.createStatisticRecord("played", this.game.translate("played_games"), "", s, {
            translationID: "played",
            isUpperCase: !0
        }), s += 70, this.createStatisticRecord("removed", this.game.translate("removed_bubbles"), "", s, {
            translationID: "removed",
            isUpperCase: !0
        }), s += 70, this.createStatisticRecord("bestscore", this.game.translate("best_score"), "", s, {
            translationID: "bestscore",
            isUpperCase: !0
        }), s += 70, this.createStatisticRecord("avgscore", this.game.translate("average_score"), "", s, {
            translationID: "avgscore",
            isUpperCase: !0
        }), s += 70, this.createStatisticRecord("totaltime", this.game.translate("total_time"), "", s, {
            translationID: "totaltime",
            isUpperCase: !0
        }), s += 70, this.createStatisticRecord("avgtime", this.game.translate("average_time"), "", s, {
            translationID: "avgtime",
            isUpperCase: !0
        }), this.game.translation.addListener(function() {
            t.uniformLabels();
        }), this.uniformLabels();
    }, t.prototype.show = function() {
        o.prototype.show.call(this), this.recordMap.item("played").setText(GameSettings.getInstance().applicationData.statistics.gamesPlayed.toString()), 
        this.recordMap.item("removed").setText(GameSettings.getInstance().applicationData.statistics.totalBubblesRemoved.toString()), 
        this.recordMap.item("bestscore").setText(GameSettings.getInstance().applicationData.statistics.bestScore.toString()), 
        this.recordMap.item("totaltime").setText(Utils.secondsToTimeFormat(GameSettings.getInstance().applicationData.statistics.totalTime).toString()), 
        this.recordMap.item("avgtime").setText(GameSettings.getInstance().applicationData.statistics.averageTime().toFixed(2).toString()), 
        this.recordMap.item("avgscore").setText(GameSettings.getInstance().applicationData.statistics.averageScore().toFixed(2).toString()), 
        this.uniformLabels();
    }, t.prototype.uniformLabels = function() {
        BMFLabel.UniformTextSizes(this.labelMap.values().concat(this.recordMap.values()));
    }, t.prototype.createStatisticRecord = function(t, e, i, n, s) {
        var o = new BMFLabel(this.game, -350, Utils.translate_dialog_Y(n), Fonts.RUBIKREGULAR55, e, 55);
        o.setTranslation(s), o.setAlignLeft(), o.setVerticalCenter(), o.tint = 31684, o.setMaxSize(440, 55), 
        this.addChild(o), this.labelMap.add(t, o);
        var a = new BMFLabel(this.game, Utils.translate_dialog_X(1300), Utils.translate_dialog_Y(n), Fonts.RUBIKREGULAR55, i, 55);
        a.setAlignRight(), a.setVerticalCenter(), a.tint = 31684, a.setMaxSize(220, 55), 
        this.addChild(a), this.recordMap.add(t, a);
    }, t.prototype.butonButtonClick = function(t) {
        o.prototype.onButtonClick.call(this, t), t.name === this.CLOSE_BUTTON ? this.close() : t.name === this.RESET_BUTTON && (this.close(), 
        this.game.getScene(MainMenu.Name).open_popup(ConfirmResetStatistic.NAME));
    }, t.NAME = "statspopup", t;
}(PopUp), ThemeDialog = function(n) {
    function t() {
        var t = null !== n && n.apply(this, arguments) || this;
        return t.SELECT_BUTTON = "select", t.CLOSE_BUTTON = "close", t.ORIGINAL_BUTTON = "original", 
        t.SUMMER_BUTTON = "summer", t.TEXTURED_BUTTON = "textured", t.MONOCHROME_BUTTON = "monochrome", 
        t.currentTheme = 1, t;
    }
    return __extends(t, n), t.prototype.init = function() {
        var t = this;
        n.prototype.init.call(this), this.designWidth = 860, this.designHeight = 860, this.dialogBackground = this.game.add.sprite(0, 0, Atlases.UI, "bgdialog.png"), 
        this.dialogBackground.anchor.set(.5, .5), this.addChild(this.dialogBackground), 
        this.addChild(this.btnSelect = new ScaleButton(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(862), Atlases.UI, "btngreen.png", this.onButtonClick, this)), 
        this.btnSelect.addBMFLabel(this.game.translate("select").toUpperCase(), Fonts.RUBIKREGULAR35, 35, null, null, null, !1, {
            translationID: "select",
            isUpperCase: !0
        }), this.btnSelect.bmfLabel.tint = 53416, this.btnSelect.bmfLabel.setMaxSize(300, 35), 
        this.btnSelect.anchor.set(.5), this.btnSelect.name = this.SELECT_BUTTON, this.addChild(this.btnClose = new ScaleButton(this.game, Utils.translate_dialog_X(1264), Utils.translate_dialog_Y(236), Atlases.UI, "btnclose.png", this.onButtonClick, this)), 
        this.btnClose.anchor.set(.5), this.btnClose.name = this.CLOSE_BUTTON, this.registerKeyboardButton(Phaser.KeyCode.SPACEBAR, this.btnClose), 
        this.addChild(this.btnOriginal = new ScaleButton(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(371), Atlases.UI, "btnblue.png", this.onButtonClick, this)), 
        this.btnOriginal.addBMFLabel(this.game.translate("original").toUpperCase(), Fonts.RUBIKREGULAR35, 35, -100, null, null, !1, {
            translationID: "original",
            isUpperCase: !0
        }), this.btnOriginal.bmfLabel.tint = 53416, this.btnOriginal.bmfLabel.setMaxSize(250, 35), 
        this.btnOriginal.bmfLabel.setAlignLeft(), this.btnOriginal.anchor.set(.5), this.btnOriginal.name = this.ORIGINAL_BUTTON, 
        this.dotOriginal = this.game.add.image(-130, 0, Atlases.UI, "dot.png"), this.dotOriginal.anchor.set(.5), 
        this.dotOriginal.tint = 53416, this.btnOriginal.addChild(this.dotOriginal), this.childDotOriginal = this.game.add.image(1, 0, Atlases.UI, "dotsmoll.png"), 
        this.childDotOriginal.anchor.set(.5), this.dotOriginal.addChild(this.childDotOriginal), 
        this.addChild(this.btnSummer = new ScaleButton(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(483), Atlases.UI, "btnblue.png", this.onButtonClick, this)), 
        this.btnSummer.addBMFLabel(this.game.translate("summer").toUpperCase(), Fonts.RUBIKREGULAR35, 35, -100, null, null, !1, {
            translationID: "summer",
            isUpperCase: !0
        }), this.btnSummer.bmfLabel.tint = 16731648, this.btnSummer.bmfLabel.setMaxSize(250, 35), 
        this.btnSummer.bmfLabel.setAlignLeft(), this.btnSummer.anchor.set(.5), this.btnSummer.name = this.SUMMER_BUTTON, 
        this.dotSummer = this.game.add.image(-130, 0, Atlases.UI, "dot.png"), this.dotSummer.anchor.set(.5), 
        this.dotSummer.tint = 16731648, this.btnSummer.addChild(this.dotSummer), this.childDotSummer = this.game.add.image(1, 0, Atlases.UI, "dotsmoll.png"), 
        this.childDotSummer.anchor.set(.5), this.dotSummer.addChild(this.childDotSummer), 
        this.addChild(this.btnTextured = new ScaleButton(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(596), Atlases.UI, "btnblue.png", this.onButtonClick, this)), 
        this.btnTextured.addBMFLabel(this.game.translate("textured").toUpperCase(), Fonts.RUBIKREGULAR35, 35, -100, null, null, !1, {
            translationID: "textured",
            isUpperCase: !0
        }), this.btnTextured.bmfLabel.tint = 31684, this.btnTextured.bmfLabel.setMaxSize(250, 35), 
        this.btnTextured.bmfLabel.setAlignLeft(), this.btnTextured.anchor.set(.5), this.btnTextured.name = this.TEXTURED_BUTTON, 
        this.dotTextured = this.game.add.image(-130, 0, Atlases.UI, "dot.png"), this.dotTextured.anchor.set(.5), 
        this.dotTextured.tint = 31684, this.btnTextured.addChild(this.dotTextured), this.childDotTextured = this.game.add.image(1, 0, Atlases.UI, "dotsmoll.png"), 
        this.childDotTextured.anchor.set(.5), this.dotTextured.addChild(this.childDotTextured);
        var e = {
            on_txt: "tglon.png",
            off_txt: "tgloff.png",
            on_str: this.game.translate("on").toUpperCase(),
            off_str: this.game.translate("off").toUpperCase(),
            size: 35,
            offset: 10,
            font: Fonts.RUBIKREGULAR35,
            on_tint: 51606,
            off_tint: 15342628,
            default_tint: 3881787
        };
        this.darkMode = new ToggleButton(this.game, Atlases.UI, e, this.onButtonClick, this), 
        this.darkMode.position.set(Utils.translate_dialog_X(960), Utils.translate_dialog_Y(753)), 
        this.darkMode.name = this.MONOCHROME_BUTTON, this.darkMode.anchor.set(.5), this.addChild(this.darkMode);
        var i = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(698), Fonts.RUBIKREGULAR35, this.game.translate("dark_mode").toUpperCase(), 35, null, null, {
            translationID: "dark_mode",
            isUpperCase: !0
        });
        i.tint = 31684, i.setMaxSize(400, 35), i.setAlignCenter(), i.setVerticalCenter(), 
        this.addChild(i), this.title = new BMFLabel(this.game, -350, Utils.translate_dialog_Y(237), Fonts.RUBIKREGULAR72, this.game.translate("themes").toUpperCase(), 72, null, null, {
            translationID: "themes",
            isUpperCase: !0
        }), this.title.tint = 31684, this.title.setMaxSize(570, 72), this.title.setVerticalandHorizontalCenter(), 
        this.title.setAlignLeft(), this.addChild(this.title), this.game.translation.addListener(function() {
            t.uniformButtons();
        }), this.uniformButtons();
    }, t.prototype.uniformButtons = function() {
        BMFLabel.UniformTextSizes([ this.btnOriginal.bmfLabel, this.btnSummer.bmfLabel, this.btnTextured.bmfLabel ]);
    }, t.prototype.show = function() {
        n.prototype.show.call(this), this.currentTheme = GameSettings.getInstance().applicationData.themeIndex, 
        this.refreshSelection(), this.refreshToggles();
    }, t.prototype.update = function() {
        n.prototype.update.call(this);
    }, t.prototype.refreshSelection = function() {
        0 === this.currentTheme ? (this.childDotOriginal.alpha = 0, this.childDotSummer.alpha = 1, 
        this.childDotTextured.alpha = 1) : 1 === this.currentTheme ? (this.childDotOriginal.alpha = 1, 
        this.childDotSummer.alpha = 0, this.childDotTextured.alpha = 1) : 2 === this.currentTheme && (this.childDotOriginal.alpha = 1, 
        this.childDotSummer.alpha = 1, this.childDotTextured.alpha = 0);
    }, t.prototype.onButtonClick = function(t) {
        n.prototype.onButtonClick.call(this, t), t.name === this.SELECT_BUTTON ? (ThemeController.setTheme(this.currentTheme, this.dialogParent, function() {}), 
        this.back_press(), gameanalytics.GameAnalytics.addDesignEvent("theme:select" + this.currentTheme)) : t.name === this.CLOSE_BUTTON ? this.back_press() : t.name === this.ORIGINAL_BUTTON ? (this.currentTheme = 0, 
        this.refreshSelection(), this.playSelection(this.dotOriginal, this.btnOriginal)) : t.name === this.SUMMER_BUTTON ? (this.currentTheme = 1, 
        this.refreshSelection(), this.playSelection(this.dotSummer, this.btnSummer)) : t.name === this.TEXTURED_BUTTON ? (this.currentTheme = 2, 
        this.refreshSelection(), this.playSelection(this.dotTextured, this.btnTextured)) : t.name === this.MONOCHROME_BUTTON && (GameSettings.getInstance().applicationData.darkTheme = !GameSettings.getInstance().applicationData.darkTheme, 
        ThemeController.refreshBackgroundIndex(this.dialogParent), GameSettings.getInstance().save(), 
        this.refreshToggles(), gameanalytics.GameAnalytics.addDesignEvent("theme:select:dark"));
    }, t.prototype.refreshToggles = function() {
        this.darkMode.setToggleState(GameSettings.getInstance().applicationData.darkTheme);
    }, t.prototype.back_press = function() {
        this.dialogParent instanceof GameSceneParent && Constants.IS_POKI && PokiSDK.gameplayStart(), 
        this.close();
    }, t.prototype.playSelection = function(t, e) {
        var i = this;
        t.scale.set(.25, .25), this.game.add.tween(t.scale).to({
            x: 1.4,
            y: 1.4
        }, 150, Phaser.Easing.Quadratic.Out, !0).onComplete.addOnce(function() {
            i.game.add.tween(t.scale).to({
                x: 1,
                y: 1
            }, 200, Phaser.Easing.Quadratic.Out, !0);
        });
        var n = this.game.add.image(e.x + t.x, e.y + t.y, Atlases.UI, "dot.png");
        n.anchor.set(.5), n.tint = t.tint, n.scale.set(1), this.addChild(n), this.game.add.tween(n).to({
            alpha: 0
        }, 500, Phaser.Easing.Quadratic.Out, !0, 0).onComplete.addOnce(function() {}), this.game.add.tween(n.scale).to({
            x: 3,
            y: 3
        }, 500, Phaser.Easing.Quadratic.Out, !0, 0).onComplete.addOnce(function() {});
    }, t.NAME = "themedialog", t;
}(PopUp), TutorialConfirm = function(n) {
    function t() {
        var t = null !== n && n.apply(this, arguments) || this;
        return t.YES_BUTTON = "yesbutton", t.NO_BUTTON = "nobutton", t;
    }
    return __extends(t, n), t.prototype.init = function() {
        var t = this;
        n.prototype.init.call(this), this.showInstallPrompt = !1, this.designWidth = 860, 
        this.designHeight = 860, this.dialogBackground = this.game.add.sprite(0, 0, Atlases.UI, "bgdialog.png"), 
        this.dialogBackground.anchor.set(.5, .5), this.addChild(this.dialogBackground);
        var e = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(237), Fonts.RUBIKREGULAR72, this.game.translate("start_tutorial").toUpperCase(), 72);
        e.setTranslation({
            translationID: "start_tutorial",
            isUpperCase: !0
        }), e.setMaxSize(690, 72), e.tint = 31684, e.setVerticalandHorizontalCenter(), this.addChild(e);
        var i = new BMFLabel(this.game, Utils.translate_dialog_X(960), Utils.translate_dialog_Y(320), Fonts.RUBIKREGULAR55, this.game.translate("start_tutorial_text").toUpperCase(), 55);
        i.setTranslation({
            translationID: "start_tutorial_text",
            isUpperCase: !0
        }), i.setMaxSize(690, 480), i.tint = 31684, i.align = "center", i.setAlignCenter(), 
        this.addChild(i), this.yesbutton = new ScaleButton(this.game, Utils.translate_dialog_X(764), Utils.translate_dialog_Y(862), Atlases.UI, "btngreen.png", this.butonButtonClick, this), 
        this.yesbutton.addBMFLabel(this.game.translate("yes").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.yesbutton.bmfLabel.setTranslation({
            translationID: "yes",
            isUpperCase: !0
        }), this.yesbutton.bmfLabel.setMaxSize(300, 35), this.yesbutton.bmfLabel.tint = 53416, 
        this.yesbutton.name = this.YES_BUTTON, this.registerKeyboardButton(Phaser.KeyCode.SPACEBAR, this.yesbutton), 
        this.nobutton = new ScaleButton(this.game, Utils.translate_dialog_X(1154), Utils.translate_dialog_Y(862), Atlases.UI, "btnblue.png", this.butonButtonClick, this), 
        this.nobutton.addBMFLabel(this.game.translate("no").toUpperCase(), Fonts.RUBIKREGULAR35, 35), 
        this.nobutton.bmfLabel.setTranslation({
            translationID: "no",
            isUpperCase: !0
        }), this.nobutton.bmfLabel.setMaxSize(300, 35), this.nobutton.bmfLabel.tint = 31684, 
        this.nobutton.name = this.NO_BUTTON, this.addChild(this.yesbutton), this.addChild(this.nobutton), 
        this.game.translation.addListener(function() {
            t.uniformButtons();
        }), this.uniformButtons();
    }, t.prototype.uniformButtons = function() {
        BMFLabel.UniformTextSizes([ this.yesbutton.bmfLabel, this.nobutton.bmfLabel ]);
    }, t.prototype.butonButtonClick = function(t) {
        n.prototype.onButtonClick.call(this, t), t.name === this.YES_BUTTON ? (GameSettings.getInstance().applicationData.tutorialAsked = !0, 
        GameSettings.getInstance().applicationData.tutorialInProgress = !0, GameSettings.getInstance().applicationData.tutorialPassed = !1, 
        GameSettings.getInstance().applicationData.tutorialIndex = 0, GameSettings.getInstance().save(), 
        this.close(), gameanalytics.GameAnalytics.addDesignEvent("tutorial:yes")) : t.name === this.NO_BUTTON && (GameSettings.getInstance().applicationData.tutorialAsked = !0, 
        GameSettings.getInstance().applicationData.tutorialInProgress = !1, GameSettings.getInstance().applicationData.tutorialPassed = !0, 
        GameSettings.getInstance().applicationData.tutorialIndex = 0, GameSettings.getInstance().save(), 
        gameanalytics.GameAnalytics.addDesignEvent("tutorial:no"), this.close());
    }, t.prototype.back_press = function() {
        GameSettings.getInstance().applicationData.tutorialAsked = !0, GameSettings.getInstance().applicationData.tutorialInProgress = !1, 
        GameSettings.getInstance().applicationData.tutorialPassed = !0, GameSettings.getInstance().applicationData.tutorialIndex = 0, 
        GameSettings.getInstance().save(), this.close();
    }, t.NAME = "tutorialconfirm", t;
}(PopUp), WatchAdDialog = function(e) {
    function t() {
        var t = null !== e && e.apply(this, arguments) || this;
        return t.WATCH_AD = "resetstatistics", t.NO_BUTTON = "mainmenu", t;
    }
    return __extends(t, e), t.prototype.init = function() {
        e.prototype.init.call(this);
    }, t.prototype.butonButtonClick = function(t) {
        e.prototype.onButtonClick.call(this, t), t.name === this.WATCH_AD && (AmazingGame.getInstance().amazingAdProvider.VideoController && AmazingGame.getInstance().amazingAdProvider.VideoController.isRewardAvaible() ? (AmazingGame.getInstance().amazingAdProvider.VideoController.show_reward_ad(function() {}.bind(this)), 
        this.close()) : AmazingGame.getInstance().amazingAdProvider.VideoController && AmazingGame.getInstance().amazingAdProvider.VideoController.isAdAvaible() && (AmazingGame.getInstance().amazingAdProvider.VideoController.show_ad(function() {}.bind(this)), 
        this.close())), t.name === this.NO_BUTTON && this.back_press();
    }, t.prototype.back_press = function() {
        this.close();
    }, t.NAME = "watchaddialog", t;
}(PopUp), GameHUD = function(n) {
    function t(t, e) {
        var i = n.call(this, t, t.world, e) || this;
        return i.GREEN_SCORE = Utils.RGBtoHEX(0, 201, 150), i.RED_SCORE = 16664689, i.BACK_BUTTON = "backbuton", 
        i.STATS_BUTTON = "statsbutton", i.HINT_BUTTON = "hintbutton", i.emaScore = 0, i.colors = [], 
        i.game = t, i.name = e, i.gameScene = AmazingGame.getInstance().getScene(GameScene.Name), 
        i.amazingGame = i.gameScene.game, i;
    }
    return __extends(t, n), t.prototype.init = function() {
        return this.bestScoreLabelLand = new BMFLabel(AmazingGame.getInstance(), 1700, 95, Fonts.RUBIKMEDIUM32, this.amazingGame.translate("BEST_SCORE").toUpperCase(), 32, 360, 40, {
            translationID: "BEST_SCORE",
            isUpperCase: !0
        }), this.bestScoreLabelLand.tint = 53159, this.bestScoreLabelLand.setAlignRight(), 
        this.bestScoreLabelLand.setVerticalCenter(), this.addChild(this.bestScoreLabelLand), 
        this.yourScoreLabelLand = new BMFLabel(AmazingGame.getInstance(), 1700, 195, Fonts.RUBIKMEDIUM32, this.amazingGame.translate("YOUR_SCORE").toUpperCase(), 32, 360, 40, {
            translationID: "YOUR_SCORE",
            isUpperCase: !0
        }), this.yourScoreLabelLand.tint = 16727911, this.yourScoreLabelLand.setAlignRight(), 
        this.yourScoreLabelLand.setVerticalCenter(), this.addChild(this.yourScoreLabelLand), 
        this.yourScoreLabelOverlay = new BMFLabel(AmazingGame.getInstance(), 1800, 95, Fonts.DIGITALDISPLAY62, "0", 62, 150, 62), 
        this.yourScoreLabelOverlay.tint = 16727911, this.yourScoreLabelOverlay.alpha = .15, 
        this.yourScoreLabelOverlay.setAlignRight(), this.yourScoreLabelOverlay.setVerticalCenter(), 
        this.addChild(this.yourScoreLabelOverlay), this.yourBestScoreLabelOverlay = new BMFLabel(AmazingGame.getInstance(), 1800, 195, Fonts.DIGITALDISPLAY62, "0", 62, 150, 62), 
        this.yourBestScoreLabelOverlay.tint = 53159, this.yourBestScoreLabelOverlay.alpha = .15, 
        this.yourBestScoreLabelOverlay.setAlignRight(), this.yourBestScoreLabelOverlay.setVerticalCenter(), 
        this.addChild(this.yourBestScoreLabelOverlay), this.bestScoreLabelValueLand = new BMFLabel(AmazingGame.getInstance(), 1800, 95, Fonts.DIGITALDISPLAY62, "", 62, 150, 62), 
        this.bestScoreLabelValueLand.tint = 53159, this.bestScoreLabelValueLand.setAlignRight(), 
        this.bestScoreLabelValueLand.setVerticalCenter(), this.addChild(this.bestScoreLabelValueLand), 
        this.yourScoreLabelValueLand = new BMFLabel(AmazingGame.getInstance(), 1800, 195, Fonts.DIGITALDISPLAY62, "", 62, 150, 62), 
        this.yourScoreLabelValueLand.tint = 16727911, this.yourScoreLabelValueLand.setAlignRight(), 
        this.yourScoreLabelValueLand.setVerticalCenter(), this.addChild(this.yourScoreLabelValueLand), 
        this.reset(), this;
    }, t.prototype.reset = function() {
        this.emaScore = 0, this.bestScoreLabelValueLand.setText("0"), this.yourScoreLabelValueLand.setText("0"), 
        GameSettings.getInstance().applicationData.statistics.bestScore && this.bestScoreLabelValueLand.setText(GameSettings.getInstance().applicationData.statistics.bestScore.toString());
    }, t.prototype.on_resize = function() {
        if (AmazingGame.getInstance().isLandscape) {
            this.toLocal(new Phaser.Point(750, 750), this.gameScene.gameLayer), this.toLocal(new Phaser.Point(1140, 1140), this.gameScene.gameLayer);
            this.bestScoreLabelLand.position.set(1670, SnapManager.snapTop(65)), this.yourScoreLabelLand.position.set(1670, SnapManager.snapTop(135)), 
            this.bestScoreLabelValueLand.position.set(1860, SnapManager.snapTop(65)), this.yourScoreLabelValueLand.position.set(1860, SnapManager.snapTop(135)), 
            this.yourBestScoreLabelOverlay.position.set(1860, SnapManager.snapTop(65)), this.yourScoreLabelOverlay.position.set(1860, SnapManager.snapTop(135));
        } else this.bestScoreLabelLand.position.set(SnapManager.snapRight(810), SnapManager.snapTop(65)), 
        this.yourScoreLabelLand.position.set(SnapManager.snapRight(810), SnapManager.snapTop(150)), 
        this.bestScoreLabelValueLand.position.set(SnapManager.snapRight(1020), SnapManager.snapTop(65)), 
        this.yourScoreLabelValueLand.position.set(SnapManager.snapRight(1020), SnapManager.snapTop(150)), 
        this.yourBestScoreLabelOverlay.position.set(SnapManager.snapRight(1020), SnapManager.snapTop(65)), 
        this.yourScoreLabelOverlay.position.set(SnapManager.snapRight(1020), SnapManager.snapTop(150));
    }, t.prototype.update = function() {
        BMFLabel.UniformTextSizes([ this.bestScoreLabelLand, this.yourScoreLabelLand ]), 
        Math.abs(GameSettings.getInstance().gameData.roundScore - this.emaScore) < 1 ? this.emaScore = GameSettings.getInstance().gameData.roundScore : this.emaScore += Math.ceil(.05 * (GameSettings.getInstance().gameData.roundScore - this.emaScore)), 
        this.yourScoreLabelValueLand.setText(this.emaScore.toString()), GameSettings.getInstance().applicationData.statistics.bestScore ? this.emaScore > GameSettings.getInstance().applicationData.statistics.bestScore && this.bestScoreLabelValueLand.setText(this.emaScore.toString()) : this.bestScoreLabelValueLand.setText(this.emaScore.toString()), 
        this.gameScene.tutorialController && (this.bestScoreLabelLand.visible = this.yourScoreLabelLand.visible = this.bestScoreLabelValueLand.visible = this.yourScoreLabelValueLand.visible = !this.gameScene.tutorialController.visible), 
        this.yourScoreLabelOverlay.setText("000000"), this.yourBestScoreLabelOverlay.setText("000000"), 
        this.yourBestScoreLabelOverlay.fontSize = this.bestScoreLabelValueLand.fontSize, 
        this.yourScoreLabelOverlay.fontSize = this.yourScoreLabelValueLand.fontSize;
    }, t.prototype.refresh = function() {}, t.prototype.refreshTheme = function() {
        this.on_resize(), GameTheme.IsDarkTheme();
    }, t.prototype.onButtonClick = function(t) {
        if (t.name === this.BACK_BUTTON) this.gameScene.doGameOver(); else if (t.name === this.STATS_BUTTON) ; else if (t.name === this.HINT_BUTTON) {
            var e = this.gameScene.game.amazingAdProvider.VideoController && 0 < this.gameScene.game.amazingAdProvider.VideoController.VideoAds.length && this.gameScene.game.amazingAdProvider.VideoController.isAdAvaible();
            e || gameanalytics.GameAnalytics.addDesignEvent("videoad:noad:" + this.name), e && (GlobalVars.IsMobile || Constants.IS_GAME_DISTRIBUTION) ? AmazingGame.getInstance().amazingAdProvider.VideoController.isRewardAvaible() ? (this.gameScene.game.amazingAdProvider.VideoController.show_reward_ad(function() {}.bind(this)), 
            this.gameScene.game.google.send_event("rewardad", "start"), gameanalytics.GameAnalytics.addDesignEvent("rewardad:start:" + this.name)) : (this.gameScene.game.amazingAdProvider.VideoController.show_ad(function() {}.bind(this)), 
            this.gameScene.game.google.send_event("videoad", "start"), gameanalytics.GameAnalytics.addDesignEvent("videoad:start:" + this.name)) : Constants.IS_POKI || this.gameScene.promoDialog.canShow && (this.gameScene.bannerLayoutController.reset(), 
            this.gameScene.open_popup("promodialog"));
        }
    }, t;
}(Phaser.Group), GameSceneParent = function(e) {
    function t() {
        var t = e.call(this) || this;
        return t.sessionGames = 0, t.shouldAskForReviev = !0, t.playedAds = !1, t;
    }
    return __extends(t, e), t.prototype.preload = function() {
        e.prototype.preload.call(this);
    }, t.prototype.create = function() {
        e.prototype.create.call(this), this.game.stage.smoothed = !0, this.game.renderer.renderSession.roundPixels = !0, 
        this.game.camera.roundPx = !0, this.background = this.game.add.sprite(960, 540, ThemeController.getBackgroundName(this)), 
        this.background.anchor.setTo(.5, .5), this.add_dialogs(), this.add_menu_slider_button(), 
        this.menu = new CustomMenu(this.game, "menu"), this.menu.initialize(), this.menu.position.x = -1600;
    }, t.prototype.new_game = function(t) {
        void 0 === t && (t = !1), null != this.menu && this.menu.isOpened && this.toogle_menu(this.menuButton), 
        t || (GameSettings.getInstance().gameData = new GameData(), GameSettings.getInstance().gameData.gameInProgress = !0, 
        GameSettings.getInstance().playedGames++), this.sessionGames++;
    }, t.prototype.add_dialogs = function() {
        var t = new PausePopUp(this.game, "pausedialog");
        this.add_popup(t), t.showfade = !1, this.promoDialog = new PromoPopUp(this.game, "promodialog"), 
        this.add_popup(this.promoDialog), this.add_popup(new ReviewDialog(this.game, ReviewDialog.NAME)), 
        this.add_popup(new GameOverPopUp(this.game, GameOverPopUp.NAME)), this.add_popup(new ThemeDialog(this.game, ThemeDialog.NAME)), 
        this.add_popup(new ConfirmNewGame(this.game, ConfirmNewGame.NAME)), this.add_popup(new TutorialConfirm(this.game, TutorialConfirm.NAME));
    }, t.prototype.add_menu_slider_button = function() {
        var e = this;
        this.menuButton = new ScaleButton(this.game, 80, 80, Atlases.UI2, "btnmenu.png", this.onButtonClick, this), 
        this.menuButton.anchor.set(.5, .5), this.menuButton.set_scale(1), this.add_ui_element(this.menuButton), 
        this.menuButton.onInputDown.add(function(t) {
            e.menu.isOpened && Constants.IS_POKI && PokiSDK.gameplayStart(), e.toogle_menu(t), 
            AudioManager.getInstance().play_button();
        }, this);
    }, t.prototype.check_startup_dialogs = function() {
        if (!DISABLE_ADS_PROMO_INSTALL_FOR_LICENSE) if (Constants.COMPILE_PLATFORM === Platform.WEB) IS_AMAZING && (this.game.amazingAdProvider.VideoController && this.game.amazingAdProvider.VideoController.isAdAvaible() ? this.game.amazingAdProvider.VideoController.show_ad(function() {}.bind(this)) : GameSettings.getInstance().playedGames % RemoteConfig.SHOW_PROMO_DIALOG_WEB == 0 && this.promoDialog.canShow() ? Constants.IS_POKI || this.open_popup("promodialog") : Constants.IS_GAME_DISTRIBUTION && this.game.amazingAdProvider.VideoController.show_ad(function() {}.bind(this))); else if (Constants.IS_MOBILE_COMPILE_VERSION) {
            var t = !1, e = GameSettings.getInstance().playedGames % RemoteConfig.SHOW_PROMO_DIALOG == 0 && this.get_dialog("promodialog").canShow(), i = GameSettings.getInstance().playedGames % RemoteConfig.ASK_REVIEW_PER_GAME_SESSION == 0 && this.shouldAskForReviev && !GameSettings.getInstance().gameReview;
            !(GameSettings.getInstance().playedGames % RemoteConfig.GAME_SCREEN_SHOW_VIDEO_ADS_EVERY == 0) || i || e ? GameSettings.getInstance().gameReview ? e && (t = !0) : Constants.IS_POKI || (i ? (this.open_popup("reviewdialog"), 
            !(this.shouldAskForReviev = !1)) : e && (t = !0)) : this.game.amazingAdProvider.VideoController && this.game.amazingAdProvider.VideoController.isAdAvaible() ? this.game.amazingAdProvider.VideoController.show_ad(function() {}) : Constants.IS_POKI || this.open_popup("promodialog"), 
            t && (Constants.IS_POKI || this.open_popup("promodialog"));
        }
    }, t.prototype.on_resize = function() {
        Constants.IS_MOBILE_COMPILE_VERSION && Constants.COMPILE_PLATFORM !== Platform.UWP && Math.min(1, this.game.ratio), 
        this.menuButton.position.x = SnapManager.snapLeft(115), this.menuButton.position.y = SnapManager.snapTop(106), 
        this.game.isLandscape, this.menu.on_resize(), this.game.refreshBackround(this.background, !1), 
        this.menu.on_resize(), e.prototype.on_resize.call(this);
    }, t.prototype.toogle_menu = function(t) {
        (void 0 === this.activeDialog || this.activeDialog instanceof PausePopUp) && (this.menu.isOpened ? (this.get_dialog("pausedialog").close(), 
        this.gameState = GameStateMachine.Play, this.menuButton.set_all_frames("btnmenu.png")) : (this.get_dialog("pausedialog").menuComponent = this.menu, 
        this.open_popup("pausedialog"), this.game.world.bringToTop(this.menuButton), this.gameState = GameStateMachine.Pause, 
        this.gameScene.bannerLayoutController.reset(), this.menuButton.set_all_frames("btnmenu_back.png"), 
        Constants.IS_POKI && PokiSDK.gameplayStop()), this.menu.toogle());
    }, t.prototype.update = function() {
        e.prototype.update.call(this, this.game), null == this.activeDialog && (this.game.input.activePointer.isDown ? (this.interact = !0, 
        this.check_inpt(this.game.input.activePointer.x, this.game.input.activePointer.y)) : this.game.input.activePointer.isUp && this.interact && (this.interact = !1)), 
        this.promoDialog && this.promoDialog.independent_Update();
    }, t.prototype.check_inpt = function(t, e) {
        this.menu.isOpened;
    }, t.prototype.add_score = function(t) {
        GameSettings.getInstance().playerScore += t, GameSettings.getInstance().save(), 
        this.refresh_ui();
    }, t.prototype.refresh_ui = function() {}, t.prototype.game_over = function() {
        GameSettings.getInstance().gameData.gameInProgress = !1;
    }, t.prototype.shutdown = function() {
        e.prototype.shutdown.call(this), this.background = null, this.oldbackground = null, 
        this.menuButton = null, this.menu.destroy(), this.menu = null, this.gameScene = null;
    }, t.Name = "gamescene", t.GOD_MODE = !1, t.MENU_BUTTON_SIZE = 74, t;
}(Component), Difficulty = function() {};

!function(t) {
    t[t.BeforePlay = 0] = "BeforePlay", t[t.Play = 1] = "Play", t[t.Pause = 2] = "Pause", 
    t[t.GameOver = 3] = "GameOver";
}(GameStateMachine || (GameStateMachine = {})), function(t) {
    t[t.StartCounting = 0] = "StartCounting", t[t.Counting = 1] = "Counting", t[t.StartPlay = 2] = "StartPlay";
}(StartState || (StartState = {})), function(t) {
    t[t.PrepareAnimation = 0] = "PrepareAnimation", t[t.Animation = 1] = "Animation", 
    t[t.EndAnimation = 2] = "EndAnimation", t[t.StartPlay = 3] = "StartPlay";
}(EndState || (EndState = {}));

var BallState, GameScene = function(o) {
    function t() {
        var t = o.call(this) || this;
        return t.GAME_OVER_ANIM_TIME = 1.5, t.boardPositionX = 1140, t.boardPositionY = 540, 
        t.boardPositionLeft = 0, t.boardPositionTop = 0, t.sessionGames = 0, t.countClickTime = !1, 
        t.clickTime = 0, t.canPlayStartAnimation = !1, t.debugSwitch = !0, t.endIndex = 0, 
        t.firstLetterTouched = !1, t.checkDialogs = !0, t.checkGameDistribution = !0, t.calculatedBoardTop = 0, 
        t.calculatedBoardBottom = 0, t.isPortraitLocked = !1, t;
    }
    return __extends(t, o), t.prototype.init = function() {
        o.prototype.init.call(this), (this.gameScene = this).gameLogic = new GameLogic(), 
        this.gameLogic.initGame();
    }, t.prototype.preload = function() {
        o.prototype.preload.call(this);
    }, t.prototype.create = function() {
        o.prototype.create.call(this), this.game.renderer.renderSession.roundPixels = !0, 
        this.game.stage.smoothed = !0, (this.menu.gameScene = this).game.input.onDown.add(this.doInputDown, this), 
        this.game.input.onUp.add(this.doInputUp, this), this.game.input.addMoveCallback(this.doInputMove, this), 
        this.createUI(), this.gameScene.game.input.enabled = !0, this.initialized || (this.bannerLayoutController = new BannerLayoutController(this)), 
        null != GameSettings.getInstance().gameData ? GameSettings.getInstance().gameData.gameInProgress ? this.new_game(!0) : this.new_game() : (GameSettings.getInstance().gameData = new GameData(), 
        this.new_game()), this.game.on_resize(), this.refreshTheme();
    }, t.prototype.createUI = function() {
        this.layers[0].ScaleOnResize = !0, this.add_ui_element(this.gameHud = new GameHUD(this, "hud").init()), 
        this.add_game_element(this.gameLayer = new Phaser.Group(this.game)), this.add_game_element(this.leftTop = this.game.add.image(0, 0, Atlases.GAME, "corner.png")), 
        this.add_game_element(this.rightTop = this.game.add.image(0, 0, Atlases.GAME, "corner.png")), 
        this.add_game_element(this.leftBottom = this.game.add.image(0, 0, Atlases.GAME, "corner.png")), 
        this.add_game_element(this.rightBottom = this.game.add.image(0, 0, Atlases.GAME, "corner.png")), 
        this.leftTop.anchor.set(1, 0), this.leftTop.scale.set(-1, 1), this.leftBottom.anchor.set(1, 0), 
        this.leftBottom.scale.set(-1, -1), this.rightBottom.anchor.set(1, 0), this.rightBottom.scale.set(1, -1), 
        this.rightTop.anchor.set(1, 0), this.leftTop.alpha = this.rightTop.alpha = this.leftBottom.alpha = this.rightBottom.alpha = .25, 
        this.leftTop.visible = this.rightTop.visible = this.leftBottom.visible = this.rightBottom.visible = !GameTheme.IsSummerTheme(), 
        this.add_ui_element(this.particleLayer = this.game.add.group()), this.gameLayer.addChild(this.summerBoard = new Phaser.Sprite(this.game, 0, 0, Atlases.GAME, "summerboard.png")), 
        this.gameLayer.addChild(this.selectionController = new SelectionController(this.game, this)), 
        this.gameLayer.addChild(this.prerenderEffectController = new PreRenderEffectController(this.game, this)), 
        this.gameLayer.addChild(this.ballsLayer = this.game.add.group()), this.gameLayer.addChild(this.postrenderEffectController = new PostRenderEffectController(this.game, this)), 
        this.gameLayer.addChild(this.effectController = new EffectController(this.game, this)), 
        this.add_game_element(this.gameScreenFrameController = new GameScreenFrameController(this.game, this)), 
        this.gameScreenFrameController.initialize(), this.particleController = new ParticleController(this), 
        this.particleController.initialize(), this.gameLayer.scale.set(.5625);
    }, t.prototype.new_game = function(t, e) {
        var i = this;
        if (void 0 === t && (t = !1), void 0 === e && (e = !1), o.prototype.new_game.call(this, t), 
        this.checkDialogs = !0, t ? this.gameLogic.load(GameSettings.getInstance().gameData) ? (this.checkDialogs = !1, 
        GameSettings.getInstance().gameData.startNewGameAfterInit && (this.FinishTutorial(), 
        this.gameLogic.endGame(GameSettings.getInstance().gameData.roundTime), GameSettings.getInstance().gameData = new GameData(), 
        GameSettings.getInstance().gameData.gameInProgress = !0, this.gameLogic.newGame(), 
        GameSettings.getInstance().playedGames++, this.checkDialogs = !0, gameanalytics.GameAnalytics.addDesignEvent("startgame", GameSettings.getInstance().playedGames)), 
        this.gameState = GameStateMachine.Play, this.canPlayStartAnimation = !1, this.checkDialogs = !0, 
        Constants.IS_POKI && (this.game.prepare_ad_show(), PokiSDK.commercialBreak().then(function() {
            i.game.stopAdShowing();
        }), PokiSDK.gameplayStart())) : (this.gameLogic.newGame(), this.gameState = GameStateMachine.BeforePlay, 
        this.canPlayStartAnimation = !0, this.checkDialogs = !0) : e || (this.gameLogic.newGame(), 
        this.gameState = GameStateMachine.BeforePlay, this.canPlayStartAnimation = !0, gameanalytics.GameAnalytics.addDesignEvent("startgame", GameSettings.getInstance().playedGames)), 
        this.initialized = !0, this.game.stage.disableVisibilityChange = !1, (GlobalVars.IsWebMobile || GlobalVars.IsMobile) && (this.canPlayStartAnimation || setTimeout(function(t) {
            this.game.on_resize();
        }.bind(this), 350)), this.boardController ? this.boardController.removeAllBalls() : this.boardController = new BoardController(this), 
        !this.ballPool) {
            this.ballPool = new ObjectPool(this.game, "balls");
            for (var n = 0; n < BOARD_WIDTH * BOARD_WIDTH * 2; n++) {
                var s = new BallView(this.boardController, "ball.png");
                this.ballPool.add_object_to_pool(s);
            }
        }
        this.boardController.initialize(BOARD_WIDTH, BOARD_HEIGHT), t && this.boardController.restoreBoardFromSaveState(), 
        this.gameHud.refresh(), this.gameHud.reset(), this.game.on_resize(), this.endTimer = 0, 
        this.checkGameDistribution = !0, GameSettings.getInstance().applicationData.tutorialAsked && GameSettings.getInstance().applicationData.tutorialInProgress && (this.createTutorial(), 
        this.tutorialController.RestoreTutorial());
    }, t.prototype.show = function() {
        o.prototype.show.call(this), AudioManager.getInstance().play_background();
    }, t.prototype.play_open_animation = function() {
        this.boardController.playInitAnimation();
    }, t.prototype.doInputDown = function(t) {
        this.gameState === GameStateMachine.Play && void 0 === this.activeDialog && this.boardController.processTouchDown(t.x, t.y);
    }, t.prototype.doInputMove = function(t) {
        this.gameState === GameStateMachine.Play && void 0 === this.activeDialog && this.boardController.processTouchMove(t.x, t.y);
    }, t.prototype.on_resume = function() {
        o.prototype.on_resume.call(this);
    }, t.prototype.doInputUp = function(t) {
        this.gameState === GameStateMachine.Play && void 0 === this.activeDialog && this.boardController.processTouchUp(t.x, t.y);
    }, t.prototype.onButtonClick = function(t) {
        o.prototype.onButtonClick.call(this, t);
    }, t.prototype.addBallToBoard = function() {
        var t = this.ballPool.create(0, 0, void 0);
        return this.ballsLayer.addChild(t), t;
    }, t.prototype.refreshBoardPosition = function() {
        var t = this.boardController.BALL_SIZE * this.gameLayer.scale.x;
        this.game.isLandscape ? (this.gameLayer.position.x = 960 - t / 2 * 6 + t / 2, this.gameLayer.position.y = 615 - t / 2 * 6 + t / 2) : (this.gameLayer.position.x = 540 - t / 2 * 6 + t / 2, 
        this.gameLayer.position.y = 960 - t / 2 * 6 + t / 2), this.summerBoard.position.x = -this.boardController.BALL_SIZE / 2, 
        this.summerBoard.position.y = -this.boardController.BALL_SIZE / 2;
    }, t.prototype.on_resize = function() {
        if (o.prototype.on_resize.call(this), this.initialized) {
            if (this.game.isLandscape) {
                this.boardPositionX = 1140, this.boardPositionY = 650, this.boardPositionLeft = 0, 
                this.boardPositionTop = 0, this.leftTop.position.set(SnapManager.snapLeft(0), SnapManager.snapTop(0)), 
                this.rightTop.position.set(SnapManager.snapRight(1920), SnapManager.snapTop(0)), 
                this.leftBottom.position.set(SnapManager.snapLeft(0), SnapManager.snapBottom(1080)), 
                this.rightBottom.position.set(SnapManager.snapRight(1920), SnapManager.snapBottom(1080));
                var t = 6 * this.boardController.BALL_SIZE, e = 150 * AmazingGame.getInstance().ratio;
                e < 230 * AmazingGame.getInstance().ratio && (e = 230 * AmazingGame.getInstance().ratio);
                var i = (this.game.height - e) / (t * AmazingGame.getInstance().ratio), n = 6 * this.boardController.BALL_SIZE;
                t * (s = this.game.width / (n * AmazingGame.getInstance().ratio)) * AmazingGame.getInstance().ratio < this.game.height - e ? this.gameLayer.scale.set(s) : this.gameLayer.scale.set(i);
                this.boardController.BALL_SIZE, this.gameLayer.scale.x;
            } else {
                this.leftTop.position.set(SnapManager.snapLeft(0), SnapManager.snapTop(0)), this.rightTop.position.set(SnapManager.snapRight(1080), SnapManager.snapTop(0)), 
                this.leftBottom.position.set(SnapManager.snapLeft(0), SnapManager.snapBottom(1920)), 
                this.rightBottom.position.set(SnapManager.snapRight(1080), SnapManager.snapBottom(1920)), 
                this.boardPositionX = 540, this.boardPositionY = 1780, this.boardPositionLeft = 0, 
                this.boardPositionTop = 0;
                var s;
                t = 6 * this.boardController.BALL_SIZE, i = (this.game.height - 420 * AmazingGame.getInstance().ratio) / (t * AmazingGame.getInstance().ratio), 
                n = 6 * this.boardController.BALL_SIZE;
                t * (s = (this.game.width - 30) / (n * AmazingGame.getInstance().ratio)) * AmazingGame.getInstance().ratio < this.game.height - 420 * AmazingGame.getInstance().ratio ? this.gameLayer.scale.set(s) : this.gameLayer.scale.set(i);
            }
            this.refreshBoardPosition(), this.summerBoard.scale.set(1 / .5625), this.boardController.on_resize(), 
            null != this.bannerLayoutController && this.bannerLayoutController.reset(), this.tutorialController && this.tutorialController.onResize(), 
            this.refreshBoardPosition(), this.gameHud.on_resize();
        }
        this.game.world.bringToTop(this.menuButton);
    }, t.prototype.getTopSpace = function() {
        var t = 0;
        return this.game.isLandscape ? (t = 300 * AmazingGame.getInstance().ratio) < 190 && (t = 190) : t = 210, 
        t;
    }, t.prototype.update = function() {
        var t = this;
        if (o.prototype.update.call(this), this.gameState === GameStateMachine.BeforePlay && this.enabled) void 0 === this.activeDialog && (DISABLE_ADS_PROMO_INSTALL_FOR_LICENSE || Constants.IS_POKI ? (this.canPlayStartAnimation && (this.play_open_animation(), 
        this.canPlayStartAnimation = !1), this.boardController.allBubblesAreIdle() && (this.gameState = GameStateMachine.Play, 
        Constants.IS_POKI && (this.game.prepare_ad_show(), PokiSDK.commercialBreak().then(function() {
            t.game.stopAdShowing();
        }), PokiSDK.gameplayStart()))) : this.checkDialogs ? (this.check_startup_dialogs(), 
        this.checkDialogs = !1) : this.game.amazingAdProvider.VideoController && this.game.amazingAdProvider.VideoController.isAdPlaying || this.menu.isShowed || (this.canPlayStartAnimation && (this.play_open_animation(), 
        this.canPlayStartAnimation = !1), this.boardController.allBubblesAreIdle() && (this.gameState = GameStateMachine.Play))); else if (this.gameState === GameStateMachine.Play) {
            if (GameSettings.getInstance().applicationData.tutorialAsked || this.activeDialog ? this.checkDialogs && (this.check_startup_dialogs(), 
            this.checkDialogs = !1) : (this.open_popup(TutorialConfirm.NAME), GameSettings.getInstance().applicationData.tutorialAsked = !0), 
            (Constants.IS_GAME_DISTRIBUTION || Constants.IS_GAME_MONETIZATION) && (0 < this.game.input.countActivePointers() || this.game.input.mousePointer.isDown && this.game.input.mousePointer.isMouse) && this.checkGameDistribution && (this.playedAds = !0, 
            this.checkGameDistribution = !1, this.game.amazingAdProvider.VideoController.show_ad(function() {}.bind(this))), 
            void 0 === this.activeDialog && !this.game.isGamePaused) {
                GameSettings.getInstance().gameData.roundTime += this.game.time.elapsedMS / 1e3;
            }
            this.activeDialog || (this.controlBoardState(), this.bannerLayoutController.update(), 
            this.gameHud.refresh());
        } else if (this.gameState === GameStateMachine.Pause) ; else if (this.gameState === GameStateMachine.GameOver) if (this.endState === EndState.PrepareAnimation) this.endTimer += this.game.time.elapsed / 100, 
        1 <= this.endTimer && (this.endState = EndState.Animation, this.endTimer = 0, AudioManager.getInstance().play_effect(Sounds.GAME_OVER, .7)); else if (this.endState === EndState.Animation) this.endTimer += this.game.time.elapsed / 100, 
        1 <= this.endTimer && (this.endState = EndState.EndAnimation, this.endTimer = 0); else if (this.endState === EndState.EndAnimation) {
            if (this.endTimer += this.game.time.elapsed / 1e3, this.endTimer >= this.GAME_OVER_ANIM_TIME) if (void 0 === this.activeDialog) GameSettings.getInstance().gameData.gameInProgress = !1, 
            this.get_dialog(GameOverPopUp.NAME).SetHighscores(), this.open_popup(GameOverPopUp.NAME), 
            this.bannerLayoutController.reset(), this.endState = EndState.StartPlay;
        }
    }, t.prototype.controlBoardState = function() {
        if (this.boardController.state === BoardState.Idle) {
            var t = !GameSettings.getInstance().applicationData.tutorialPassed && GameSettings.getInstance().applicationData.tutorialInProgress;
            this.tutorialController || this.createTutorial(), (t || 7 === this.tutorialController.tutorialState) && this.tutorialController.canRequestForNextStep && this.tutorialController.doNext();
        } else this.boardController.state === BoardState.Removing ? this.boardController.allBubblesAreIdle() && (this.boardController.canRemoveNextBonuses() || this.boardController.moveBalls()) : this.boardController.state === BoardState.Move && this.boardController.allBubblesAreIdle() && (this.gameLogic.isGameOver() ? this.doGameOver() : this.boardController.startIdle());
    }, t.prototype.refreshTheme = function() {
        this.ballsLayer.forEach(function(t) {
            t.refreshTheme();
        }), GameTheme.IsDarkTheme() ? (this.summerBoard.visible = !1, this.background.tint = Utils.RGBtoHEX(0, 0, 0), 
        this.leftBottom.visible = this.leftTop.visible = this.rightTop.visible = this.rightBottom.visible = !0) : (this.summerBoard.visible = !1, 
        this.background.tint = Utils.RGBtoHEX(255, 255, 255), this.leftBottom.visible = this.leftTop.visible = this.rightTop.visible = this.rightBottom.visible = !0, 
        GameTheme.IsSummerTheme() && (this.summerBoard.visible = !0, this.leftBottom.visible = this.leftTop.visible = this.rightTop.visible = this.rightBottom.visible = !1)), 
        this.gameHud.refreshTheme();
    }, t.prototype.refresh_background = function() {
        var t = ThemeController.getBackgroundName(this);
        this.background.key != t && this.background.loadTexture(t, 0), this.game.refreshBackround(this.background, !1), 
        this.game.refreshBackround(this.oldbackground, !1), this.refreshTheme();
    }, t.prototype.swap_background = function() {
        this.oldbackground = this.game.add.sprite(960, 540, this.background.key), this.oldbackground.anchor.setTo(.5, .5), 
        this.oldbackground.width = this.game.width, this.oldbackground.height = this.game.height;
        var t = this.game.world.getChildIndex(this.background);
        this.game.world.setChildIndex(this.oldbackground, t + 1), this.refresh_background(), 
        this.background.alpha = 0, this.game.add.tween(this.oldbackground).to({
            alpha: 0
        }, 2 * Phaser.Timer.SECOND, Phaser.Easing.Cubic.Out, !0), this.game.add.tween(this.background).to({
            alpha: 1
        }, 2 * Phaser.Timer.SECOND, Phaser.Easing.Cubic.Out, !0);
    }, t.prototype.showScore = function(t, e, i, n, s) {
        var o = this;
        void 0 === s && (s = !1);
        var a = this.boardController.gameScene.particleLayer.toLocal(new Phaser.Point(e, i), this.boardController.gameScene.gameLayer), r = new BMFLabel(this.game, a.x, a.y, Fonts.DIGITALDISPLAY62OUTLINEWHITE, t.toString(), 62);
        r.scale.set(0, 0), r.setVerticalandHorizontalCenter(), this.add_ui_element(r);
        var h = new BMFLabel(this.game, 4, 0, Fonts.DIGITALDISPLAY62, t.toString(), 62);
        if (h.tint = n, 16777215 === h.tint) {
            var l = Utils.randomInt(0, GameTheme.GetCurretnBallsTheme().length);
            h.tint = GameTheme.GetCurretnBallsTheme()[l];
        }
        h.setVerticalandHorizontalCenter(), r.addChild(h);
        this.game.ratio;
        this.game.isLandscape;
        this.game.add.tween(r).to({
            alpha: 1
        }, 100, Phaser.Easing.Linear.None, !0), this.game.add.tween(r.scale).to({
            x: 1.3,
            y: 1.3
        }, 200, Phaser.Easing.Linear.None, !0);
        var c = this.game.add.tween(r.position).to({
            y: a.y - 100
        }, 500, Phaser.Easing.Cubic.In, !0), u = this.game.add.tween(r.scale).to({
            x: 1.25,
            y: 1.25
        }, 100, Phaser.Easing.Linear.None, !1), d = this.game.add.tween(r.scale).to({
            x: 1.3,
            y: 1.3
        }, 100, Phaser.Easing.Linear.None, !1), p = this.game.add.tween(r).to({
            alpha: 0
        }, 200, Phaser.Easing.Linear.None, !1);
        c.chain(u), u.chain(d), d.chain(p), p.onComplete.addOnce(function() {
            o.layers[1].removeChild(r);
        });
    }, t.prototype.showInfo = function(t) {
        var e = this, i = new Phaser.Point(960, 540);
        this.game.isLandscape || (i = new Phaser.Point(540, 960));
        var n = new BMFLabel(this.game, i.x, i.y, Fonts.RUBIKMEDIUM72, t, 72);
        n.setVerticalandHorizontalCenter(), this.add_game_element(n);
        var s = new BMFLabel(this.game, 4, 0, Fonts.RUBIKMEDIUM72, t, 72);
        s.tint = 16755882, s.setVerticalandHorizontalCenter(), n.addChild(s);
        this.game.add.tween(n).to({
            alpha: 1
        }, 100, Phaser.Easing.Linear.None, !0), this.game.add.tween(n.position).to({
            y: -100
        }, 1250, Phaser.Easing.Cubic.In, !0);
        this.game.add.tween(n).to({
            alpha: 0
        }, 200, Phaser.Easing.Linear.None, !0, 1050).onComplete.addOnce(function() {
            e.layers[1].removeChild(n);
        });
    }, t.prototype.doGameOver = function() {
        this.endIndex = 0, this.endTimer = 0, this.gameState = GameStateMachine.GameOver, 
        this.endState = EndState.PrepareAnimation, this.gameLogic.endGame(GameSettings.getInstance().gameData.roundTime), 
        this.boardController.gameOver();
        var t = new WordsearchRank();
        t.userName = GameSettings.getInstance().playerName, t.score = GameSettings.getInstance().gameData.roundScore, 
        this.game.amazingRank.post_score_object(t, null, function(t) {}), gameanalytics.GameAnalytics.addDesignEvent("endgame", GameSettings.getInstance().gameData.roundScore), 
        Constants.IS_POKI && PokiSDK.gameplayStop();
    }, t.prototype.getBoardScale = function() {
        return this.game.isLandscape, 1;
    }, t.prototype.on_keyboard_clicked = function(t) {
        if (o.prototype.on_keyboard_clicked.call(this, t), void 0 === this.gameScene.activeDialog) ;
    }, t.prototype.back_press = function() {
        TutorialHelper.TutorialOpened ? TutorialHelper.hide() : null != this.activeDialog ? this.menu.isOpened ? this.toogle_menu(null) : o.prototype.back_press.call(this) : (this.menu.isOpened || Constants.IS_MOBILE_COMPILE_VERSION, 
        this.toogle_menu(null));
    }, t.prototype.game_over = function() {
        o.prototype.game_over.call(this);
    }, t.prototype.get_game_data = function() {
        return null != this.gameLogic && this.gameLogic.save(GameSettings.getInstance().gameData), 
        GameSettings.getInstance().gameData;
    }, t.prototype.set_game_Data = function(t) {}, t.prototype.open_popup = function(t) {
        o.prototype.open_popup.call(this, t), Utils.switch_input([ this.gameHud ], !1);
    }, t.prototype.close_popup = function() {
        o.prototype.close_popup.call(this), Utils.switch_input([ this.gameHud ], !0);
    }, t.prototype.createTutorial = function() {
        this.tutorialController || (this.tutorialController = new TutorialController(this), 
        this.tutorialController.initialize(), this.add_ui_element(this.tutorialController), 
        this.tutorialController.onResize(), this.tutorialController.visible = !1);
    }, t.prototype.FinishTutorial = function() {
        GameSettings.getInstance().applicationData.tutorialPassed || (GameSettings.getInstance().applicationData.tutorialAsked = !0, 
        GameSettings.getInstance().applicationData.tutorialInProgress = !1, GameSettings.getInstance().applicationData.tutorialPassed = !0, 
        GameSettings.getInstance().applicationData.tutorialIndex = 0), this.tutorialController && (this.tutorialController.finishTutorial(), 
        this.tutorialController.visible = !1);
    }, t.prototype.render = function() {
        o.prototype.render.call(this, this.game);
    }, t.prototype.shutdown = function() {
        o.prototype.shutdown.call(this), GameSettings.getInstance().save(), this.gameHud.destroy(), 
        this.particleLayer.destroy(!0), this.particleLayer = null, this.particleController = null, 
        this.gameHud = null, this.boardController = void 0, this.ballPool.destroy(), this.ballPool = void 0, 
        this.tutorialController.destroy(!0), this.tutorialController = null, this.background = null;
    }, t.VIDEO_ADD_MIN_TIME = 25e3, t.Name = "gamescene", t.GOD_MODE = !1, t.LETTER_VIEW_SIZE_X = 89, 
    t.LETTER_VIEW_SIZE_Y = 89, t;
}(GameSceneParent), MainMenu = function(e) {
    function i() {
        return null !== e && e.apply(this, arguments) || this;
    }
    return __extends(i, e), i.prototype.preload = function() {}, i.prototype.create = function() {
        var t = this;
        e.prototype.create.call(this), this.game.renderer.renderSession.roundPixels = !0, 
        this.game.stage.smoothed = !0, this.game.camera.roundPx = !0, this.background = this.game.add.sprite(800, 480, "bg_1"), 
        this.background.anchor.setTo(.5, .5), this.add_ui_element(this.leftTop = this.game.add.image(0, 0, Atlases.GAME, "corner.png")), 
        this.add_ui_element(this.rightTop = this.game.add.image(0, 0, Atlases.GAME, "corner.png")), 
        this.add_ui_element(this.leftBottom = this.game.add.image(0, 0, Atlases.GAME, "corner.png")), 
        this.add_ui_element(this.rightBottom = this.game.add.image(0, 0, Atlases.GAME, "corner.png")), 
        this.leftTop.anchor.set(1, 0), this.leftTop.scale.set(-1, 1), this.leftBottom.anchor.set(1, 0), 
        this.leftBottom.scale.set(-1, -1), this.rightBottom.anchor.set(1, 0), this.rightBottom.scale.set(1, -1), 
        this.rightTop.anchor.set(1, 0), this.logo = this.game.add.sprite(960, 220, Atlases.MENU_SHEET, "logo.png"), 
        this.logo.anchor.setTo(.5, .5), this.add_ui_element(this.logo), this.hedgehog = this.game.add.sprite(960, 1018, Atlases.MENU_SHEET, "hedgehog.png"), 
        this.hedgehog.anchor.setTo(.5, .5), this.add_ui_element(this.hedgehog), this.btnPlay = new ScaleButton(this.game, 960, 545, Atlases.MENU_SHEET, "btnplay.png", this.onButtonClick, this), 
        this.btnPlay.key = i.PLAY_BUTTON, this.btnPlay.addBMFLabel(this.game.translate("new_game").toUpperCase(), Fonts.RUBIKREGULAR40, 40, -75, 0, Utils.RGBtoHEX(0, 201, 150)), 
        this.btnPlay.bmfLabel.setTranslation({
            translationID: "new_game",
            isUpperCase: !0
        }), this.btnPlay.bmfLabel.setAlignLeft(), this.btnPlay.bmfLabel.setMaxSize(250, 40), 
        this.btnPlay.anchor.set(.5), this.registerKeyboardButton(Phaser.KeyCode.SPACEBAR, this.btnPlay), 
        this.add_ui_element(this.btnPlay), this.btnContinue = new ScaleButton(this.game, 960, 704, Atlases.MENU_SHEET, "btncontinue.png", this.onButtonClick, this), 
        this.btnContinue.key = i.CONTINUE_BUTTON, this.btnContinue.addBMFLabel(this.game.translate("continue").toUpperCase(), Fonts.RUBIKREGULAR40, 40, -75, 0, Utils.RGBtoHEX(19, 103, 187)), 
        this.btnContinue.bmfLabel.setTranslation({
            translationID: "continue",
            isUpperCase: !0
        }), this.btnContinue.bmfLabel.setAlignLeft(), this.btnContinue.bmfLabel.setMaxSize(250, 40), 
        this.btnContinue.bmfLabelDisableTint = 602973, this.btnContinue.anchor.set(.5), 
        this.add_ui_element(this.btnContinue), this.btnStats = new ScaleButton(this.game, 140, 940, Atlases.MENU_SHEET, "btnstats.png", this.onButtonClick, this), 
        this.btnStats.key = i.STATS_BUTTON, this.btnStats.anchor.set(.5), this.add_ui_element(this.btnStats), 
        this.btnSettings = new ScaleButton(this.game, 320, 940, Atlases.MENU_SHEET, "btnsettings.png", this.onButtonClick, this), 
        this.btnSettings.key = i.SETTINGS_BUTTON, this.btnSettings.anchor.set(.5), this.add_ui_element(this.btnSettings), 
        IS_4BALANCE || (this.btnHighscore = new ScaleButton(this.game, 1600, 940, Atlases.MENU_SHEET, "btnrank.png", this.onButtonClick, this), 
        this.btnHighscore.key = i.RANK_BUTTON, this.btnHighscore.anchor.set(.5), this.add_ui_element(this.btnHighscore)), 
        this.btnThemes = new ScaleButton(this.game, 1780, 940, Atlases.MENU_SHEET, "btntheme.png", this.onButtonClick, this), 
        this.btnThemes.key = i.THEME_BUTTON, this.btnThemes.anchor.set(.5), this.add_ui_element(this.btnThemes), 
        DISABLE_ADS_PROMO_INSTALL_FOR_LICENSE || Constants.IS_POKI || (this.btnFB = new ScaleButton(this.game, 1780, 80, Atlases.MENU_SHEET, "btnfb.png", this.onButtonClick, this), 
        this.btnFB.key = i.FB_BUTTON, this.btnFB.anchor.set(.5), this.add_ui_element(this.btnFB), 
        this.btnTW = new ScaleButton(this.game, 1780, 80, Atlases.MENU_SHEET, "btntw.png", this.onButtonClick, this), 
        this.btnTW.key = i.TW_BUTTON, this.btnTW.anchor.set(.5), this.add_ui_element(this.btnTW)), 
        this.add_popup(new ThemeDialog(this.game, ThemeDialog.NAME)), this.add_popup(new StatisticPopUp(this.game, StatisticPopUp.NAME)), 
        this.add_popup(new ConfirmResetStatistic(this.game, ConfirmResetStatistic.NAME)), 
        this.add_popup(new SettingsPopUp(this.game, SettingsPopUp.NAME)), this.add_popup(new ScorePopUp(this.game, ScorePopUp.NAME)), 
        this.add_popup(new ConfirmNewGame(this.game, ConfirmNewGame.NAME)), this.on_resize(), 
        this.game.translation.addListener(function() {
            t.uniformButtons();
        }), this.uniformButtons();
    }, i.prototype.uniformButtons = function() {
        BMFLabel.UniformTextSizes([ this.btnPlay.bmfLabel, this.btnContinue.bmfLabel ]);
    }, i.prototype.show = function() {
        var t = this;
        e.prototype.show.call(this), null != GameSettings.getInstance().gameData && GameSettings.getInstance().gameData.gameInProgress ? this.btnContinue.enable() : this.btnContinue.disable(), 
        AudioManager.getInstance().play_background(), this.game.amazingAdProvider.VideoController && this.game.amazingAdProvider.VideoController.isAdAvaible() && this.game.time.events.add(1500, function() {
            t.game.amazingAdProvider.VideoController.show_ad(function() {}.bind(t));
        });
    }, i.prototype.enable = function(t) {
        e.prototype.enable.call(this, t), this.enabled && (!this.amazingBtn && RemoteConfig.SHOW_AMAZING_BUTTON && this.add_ui_element(this.amazingBtn = new AmazingAddButton(this.game, 96, 96)), 
        this.amazingBtn && this.amazingBtn.load(), this.tryShowAd());
    }, i.prototype.update = function() {}, i.prototype.refreshTheme = function() {}, 
    i.prototype.render = function() {
        Constants.IS_FONT_DEBUG && (this.debugLayer || (this.debugLayer = DebugScene.init(this.game), 
        this.stage.add(this.debugLayer)), this.debugLayer.renderScene(this));
    }, i.prototype.on_resize = function() {
        e.prototype.on_resize.call(this), this.game.refreshBackround(this.background), this.game.isLandscape ? (this.leftTop.position.set(SnapManager.snapLeft(0), SnapManager.snapTop(0)), 
        this.rightTop.position.set(SnapManager.snapRight(1920), SnapManager.snapTop(0)), 
        this.leftBottom.position.set(SnapManager.snapLeft(0), SnapManager.snapBottom(1080)), 
        this.rightBottom.position.set(SnapManager.snapRight(1920), SnapManager.snapBottom(1080)), 
        this.leftTop.scale.set(-1, 1), this.rightTop.scale.set(1, 1), this.leftBottom.scale.set(-1, -1), 
        this.rightBottom.scale.set(1, -1), this.logo.position.set(960, 258), this.logo.scale.set(1), 
        this.hedgehog.position.set(960, 958), this.hedgehog.scale.set(1), this.btnPlay.position.set(720, 528), 
        this.btnPlay.set_scale(1), this.btnContinue.position.set(1190, 528), this.btnContinue.set_scale(1), 
        this.btnStats.position.set(1072, 675), this.btnStats.set_scale(1), this.btnSettings.position.set(836, 675), 
        this.btnSettings.set_scale(1), this.btnThemes.position.set(1306, 675), this.btnThemes.set_scale(1), 
        this.btnHighscore && (this.btnHighscore.position.set(602, 675), this.btnHighscore.set_scale(1)), 
        this.btnFB && (this.btnFB.position.set(602, 986), this.btnFB.set_scale(1), this.btnTW.position.set(1306, 986), 
        this.btnTW.set_scale(1)), IS_4BALANCE && (this.btnSettings.x -= 100, this.btnStats.x -= 100, 
        this.btnThemes.x -= 100), this.amazingBtn && this.amazingBtn.position.set(SnapManager.snapLeft(80), SnapManager.snapTop(100))) : (this.leftTop.position.set(SnapManager.snapLeft(0), SnapManager.snapTop(0)), 
        this.rightTop.position.set(SnapManager.snapRight(1080), SnapManager.snapTop(0)), 
        this.leftBottom.position.set(SnapManager.snapLeft(0), SnapManager.snapBottom(1920)), 
        this.rightBottom.position.set(SnapManager.snapRight(1080), SnapManager.snapBottom(1920)), 
        this.leftTop.scale.set(-.828, .828), this.rightTop.scale.set(.828, .828), this.leftBottom.scale.set(-.828, -.828), 
        this.rightBottom.scale.set(.828, -.828), this.logo.scale.set(1), this.logo.position.set(540, 394), 
        this.hedgehog.position.set(540, SnapManager.snapBottom(1690)), this.btnPlay.position.set(540, 700), 
        this.btnPlay.set_scale(1.3), this.btnContinue.position.set(540, 925), this.btnContinue.set_scale(1.3), 
        this.btnHighscore && (this.btnHighscore.position.set(390, 1150), this.btnHighscore.set_scale(1.256)), 
        this.btnSettings.position.set(690, 1150), this.btnSettings.set_scale(1.256), this.btnStats.position.set(390, 1375), 
        this.btnStats.set_scale(1.3), this.btnThemes.position.set(690, 1375), this.btnThemes.set_scale(1.3), 
        this.btnFB && (this.btnFB.position.set(336, SnapManager.snapBottom(1690)), this.btnFB.set_scale(1.375), 
        this.btnTW.position.set(743, SnapManager.snapBottom(1690)), this.btnTW.set_scale(1.375)), 
        IS_4BALANCE && (this.btnStats.y = this.btnSettings.y, this.btnThemes.x -= 140), 
        this.amazingBtn && this.amazingBtn.position.set(SnapManager.snapLeft(80), SnapManager.snapTop(260))), 
        this.enabled && this.tryShowAd();
    }, i.prototype.refresh_background = function() {
        this.game.refreshBackround(this.background), this.game.refreshBackround(this.oldbackground);
    }, i.prototype.swap_background = function() {
        this.oldbackground = this.game.add.sprite(960, 540, this.background.key), this.oldbackground.anchor.setTo(.5, .5), 
        this.oldbackground.width = this.game.width, this.oldbackground.height = this.game.height;
        var t = this.game.world.getChildIndex(this.background);
        this.game.world.setChildIndex(this.oldbackground, t + 1), this.refresh_background(), 
        this.background.alpha = 0, this.game.add.tween(this.oldbackground).to({
            alpha: 0
        }, 2 * Phaser.Timer.SECOND, Phaser.Easing.Cubic.Out, !0), this.game.add.tween(this.background).to({
            alpha: 1
        }, 2 * Phaser.Timer.SECOND, Phaser.Easing.Cubic.Out, !0);
    }, i.prototype.onButtonClick = function(t) {
        e.prototype.onButtonClick.call(this, t), t.key === i.THEME_BUTTON ? this.open_popup(ThemeDialog.NAME) : t.key === i.STATS_BUTTON ? this.open_popup(StatisticPopUp.NAME) : t.key === i.SETTINGS_BUTTON ? this.open_popup(SettingsPopUp.NAME) : t.key === i.FB_BUTTON ? this.game.PlatformProvider.open_link(Constants.FACEBOOK_LINK) : t.key === i.TW_BUTTON ? this.game.PlatformProvider.open_link(Constants.TWITTER_LINK) : t.key === i.PLAY_BUTTON ? null != GameSettings.getInstance().gameData && GameSettings.getInstance().gameData.gameInProgress ? this.open_popup(ConfirmNewGame.NAME) : (GameSettings.getInstance().gameData = void 0, 
        this.game.runScene(GameScene.Name, !0)) : t.key === i.CONTINUE_BUTTON ? this.game.runScene(GameScene.Name, !0) : t.key === i.REVIEW ? Constants.IS_MOBILE_COMPILE_VERSION && !GameSettings.getInstance().gameReview ? this.game.PlatformProvider.review_game() : this.game.PlatformProvider.open_more_games() : t.key === i.RANK_BUTTON && this.open_popup(ScorePopUp.NAME);
    }, i.prototype.back_press = function() {
        void 0 === this.activeDialog ? Constants.IS_MOBILE_COMPILE_VERSION : e.prototype.back_press.call(this);
    }, i.prototype.tryShowAd = function() {
        if (!this.activeDialog && !TutorialHelper.TutorialOpened && (UIAdsManager.getInstance().removeAd(), 
        RemoteConfig.PLAY_BANNER_ADS)) {
            var t = this.leftTop.worldPosition.y + this.leftTop.height / 2, e = this.btnPlay.worldPosition.x - this.btnPlay.getBounds().width / 2, i = this.leftBottom.worldPosition.y - this.leftBottom.getBounds().height / 2 - t, n = [];
            if (this.game.isLandscape) {
                var s = new AdDetail(0, t, e, i);
                n.push(new Pair(s, [ RECT_BANNER, FLAG_BANNER ]));
            } else {
                var o = this.game.width, a = this.logo.worldPosition.y - this.logo.getBounds().height / 2, r = new AdDetail(0, 0, o, a);
                n.push(new Pair(r, [ BILLBOARD, HUGE_BANNER, MEDIUM_BANNER, SMALL_BANNER ]));
            }
            UIAdsManager.getInstance().tryShowAd(n);
        }
    }, i.prototype.shutdown = function() {
        e.prototype.shutdown.call(this), this.background = null, this.oldbackground = null, 
        this.btnPlay = null, this.btnContinue = null, this.btnStats = null, this.btnSettings = null, 
        this.btnHighscore = null, this.btnThemes = null, this.btnFB = null, this.btnTW = null, 
        this.logo = null, this.hedgehog = null, this.leftTop = null, this.leftBottom = null, 
        this.rightTop = null, this.rightBottom = null, this.debugLayer && (this.debugLayer.removeAll(), 
        this.stage.removeChild(this.debugLayer), this.debugLayer.destroy(), this.debugLayer = null);
    }, i.Name = "mainmenu", i.PLAY_BUTTON = "playbutton", i.RANK_BUTTON = "rankbutton", 
    i.CONTINUE_BUTTON = "continuebutton", i.THEME_BUTTON = "theme", i.STATS_BUTTON = "stats", 
    i.FB_BUTTON = "fb", i.TW_BUTTON = "tw", i.SETTINGS_BUTTON = "settings", i.REVIEW = "review", 
    i;
}(Component), Preloader = function(n) {
    function o() {
        return null !== n && n.apply(this, arguments) || this;
    }
    return __extends(o, n), o.prototype.init = function() {
        n.prototype.init.call(this), this.game.stage.smoothed = !0, this.game.stage.setBackgroundColor(GlobalVars.AccentColor), 
        this.game.stage.disableVisibilityChange = !0, this.game.plugins.add(PhaserNineSlice.NineSlicePlugin);
    }, o.prototype.preload = function() {
        var i = this;
        Constants.IS_POKI && PokiSDK.gameLoadingStart(), this.set_preload_assets(), this.game.on_resize(), 
        this.load_game(), Images.list.forEach(function(t) {
            i.load_image(t, "assets/" + t + ".png");
        }), Atlases.list.forEach(function(t) {
            i.game.load.atlas(t, "assets/atlases/" + t + ".png?v=" + Constants.APP_VERSION, "assets/atlases/" + t + ".json?v=" + Constants.APP_VERSION, Phaser.Loader.TEXTURE_ATLAS_JSON_HASH);
        }), SpriteSheets.list.forEach(function(t) {
            i.game.load.spritesheet(t.Name, "assets/anim/" + t.Name + ".png?v=" + Constants.APP_VERSION, t.Width, t.Height, t.FrameCount);
        }), this.game.plugins.add(AmazingTranslation.AmazingTranslation), IS_4BALANCE ? this.game.translation.initialize("kr", [ "kr-KR" ]) : this.game.translation.initialize("en", o.TRANSLATIONS);
        var n = Object.keys([]);
        Fonts.list.forEach(function(t) {
            var e = t;
            -1 != n.indexOf(e) ? i.game.load.bitmapFont(t, "assets/fonts/" + i.game.translation.languageCode + "/" + t + ".png?v=" + Constants.APP_VERSION, "assets/fonts/" + i.game.translation.languageCode + "/" + t + ".xml?v=" + Constants.APP_VERSION) : i.game.load.bitmapFont(t, "assets/fonts/" + t + ".png?v=" + Constants.APP_VERSION, "assets/fonts/" + t + ".xml?v=" + Constants.APP_VERSION);
        }), Sounds.list.forEach(function(t) {
            i.game.device.iOS ? i.game.load.audio(t, "assets/" + t + ".m4a?v=" + Constants.APP_VERSION) : Constants.COMPILE_PLATFORM === Platform.UWP ? i.game.load.audio(t, [ "assets/" + t + ".mp3?v=" + Constants.APP_VERSION, "assets/" + t + ".mp3?v=" + Constants.APP_VERSION ]) : i.game.load.audio(t, [ "assets/" + t + ".ogg?v=" + Constants.APP_VERSION, "assets/" + t + ".mp3?v=" + Constants.APP_VERSION ]);
        }), this.load_image("bg_1", "assets/theme/bg_1.png"), this.load_image("bg_2", "assets/theme/bg_2.png"), 
        this.loadTranslations(), this.createDynamicContent(), this.game.load.onFileComplete.add(this.fileComplete, this), 
        GlobalVars.TransitionColor = "#F4F4F4";
    }, o.prototype.set_preload_assets = function() {
        this.preloadBG = this.game.add.image(960, 540, Images.PRELOAD_BG), this.preloadBG.anchor.setTo(.5, .5), 
        this.game.refreshBackround(this.preloadBG), this.logo = this.game.add.sprite(Constants.WIDTH / 2, Constants.HEIGHT / 2 - 75, Images.LOGO), 
        this.logo.smoothed = !0, Utils.center_objects([ this.logo ]), this.add_ui_element(this.logo), 
        this.loadingText = this.game.add.text(Constants.WIDTH / 2, Constants.HEIGHT / 2 + 400 + 56, "Loading... 0%", {
            font: 112 * this.game.ratio + "px" + Fonts.HELVETICA,
            fill: "#ffffff",
            align: "center"
        }), this.loadingText.scale.set(1 / this.game.ratio), this.loadingText.align = "center", 
        this.loadingText.smoothed = !0, this.loadingText.anchor.set(.5), Utils.make_font_fit(this.loadingText, 812, 50);
        var t = Constants.WIDTH / 2 - 406, e = Constants.HEIGHT / 2 + 400;
        this.preloadback = new Phaser.Sprite(this.game, t + 11, e + 11, SpriteUtils.create_rectangle(this.game, 640, 5, 3651292)), 
        this.add_ui_element(this.preloadback), this.preloadTexture = new Phaser.Sprite(this.game, t + 11, e + 11, SpriteUtils.create_rectangle(this.game, 640, 5, 16777215)), 
        this.add_ui_element(this.preloadTexture), this.game.load.setPreloadSprite(this.preloadTexture), 
        this.add_ui_element(this.loadingText);
    }, o.prototype.createDynamicContent = function() {
        var t = 380, e = 380, i = 44, n = 44;
        2 <= (1 < devicePixelRatio ? 2 : 1) && 800 <= window.innerWidth * devicePixelRatio && (t = 720, 
        e = 760, n = i = 88);
        var s = Utils.RGBtoHEX(64, 64, 64), o = Utils.RGBtoHEX(34, 34, 34), a = SpriteUtils.create_rectangle(this.game, t, i, s), r = SpriteUtils.create_rectangle(this.game, e, n, o);
        this.game.cache.addRenderTexture("menu_button", a), this.game.cache.addRenderTexture("title_gfx", r);
    }, o.prototype.load_game = function() {
        GameSettings.getInstance().load();
    }, o.prototype.fadeInLogo = function() {
        this.logo.alpha = 0, this.add.tween(this.logo).to({
            alpha: 1
        }, PopUp.TRANSITION_TIME, "Linear", !0).delay(.25);
    }, o.prototype.load_image = function(t, e) {
        this.game.load.image(t, e + "?v=" + Constants.APP_VERSION);
    }, o.prototype.load_text = function(t, e) {
        this.game.load.text(t, e + "?v=" + Constants.APP_VERSION);
    }, o.prototype.load_sprite_sheet = function(t, e, i, n, s) {
        this.game.load.spritesheet(t, e + "?v=" + Constants.APP_VERSION, i, n, s);
    }, o.prototype.load_assets_sheet = function(t, e, i) {
        this.game.load.atlasJSONHash(t, e + "?v=" + Constants.APP_VERSION, i + "?v=" + Constants.APP_VERSION);
    }, o.prototype.loadTranslations = function() {
        var e, t;
        try {
            for (var i = __values(o.TRANSLATIONS), n = i.next(); !n.done; n = i.next()) {
                var s = n.value;
                this.game.load.json(s, "assets/localize/" + s + ".json?v=" + Constants.APP_VERSION);
            }
        } catch (t) {
            e = {
                error: t
            };
        } finally {
            try {
                n && !n.done && (t = i.return) && t.call(i);
            } finally {
                if (e) throw e.error;
            }
        }
    }, o.prototype.fileComplete = function(t, e, i, n, s) {
        var o = Math.round(n / s * 100);
        Strings.AMAZING_START_PHRASES[0];
        1 < o && LoadingHelper.isShowed && LoadingHelper.hide(), o < 20 ? Strings.AMAZING_START_PHRASES[1] : o < 40 ? Strings.AMAZING_START_PHRASES[2] : o < 60 ? Strings.AMAZING_START_PHRASES[3] : o < 80 ? Strings.AMAZING_START_PHRASES[4] : Strings.AMAZING_START_PHRASES[5], 
        this.loadingText.text = o + "%";
    }, o.prototype.on_resize = function() {
        if (n.prototype.on_resize.call(this), null != this.logo) {
            SnapManager.snapToCenter(0, 0, this.game.ratio);
            var t = 540, e = 960;
            this.game.isLandscape && (t = 960, e = 540), this.logo.position.set(t, e);
            var i = e + 200;
            this.preloadback.position.set(t - this.preloadback.width / 2, i), this.preloadTexture.position.set(t - this.preloadback.width / 2, i), 
            this.game.refreshBackround(this.preloadBG), this.loadingText.fontSize = 28 * this.game.ratio + "px", 
            this.loadingText.scale.set(1 / this.game.ratio), this.loadingText.position.set(t, this.preloadTexture.centerY + 40 / this.game.ratio);
        }
    }, o.prototype.create = function() {
        if (AudioManager.getInstance().initialize(this.game, Sounds.list), this.game.plugins.add(GoogleAnalytics.GoogleAnalytics), 
        this.game.plugins.add(AmazingAd.AmazingAd), this.game.plugins.add(AmazingAdProvider.AmazingAdProvider), 
        this.game.plugins.add(AmazingRank.AmazingRank), this.game.plugins.add(Phaser.ParticleStorm), 
        this.game.google.initialize(), this.game.google.send_event("send", "pageview", {
            page: "/Boot"
        }), IS_4BALANCE ? this.game.translation.initialize("kr", [ "kr-KR" ]) : this.game.translation.initialize("en", o.TRANSLATIONS), 
        Constants.USE_ADS_FRAMEWORK && (this.game.amazingAd.initialize("https://ad.amazinghedgehog.com"), 
        this.game.amazingAdProvider.initialize()), this.game.amazingRank.initialize("https://rank.amazinghedgehog.com"), 
        DISABLE_ADS_PROMO_INSTALL_FOR_LICENSE || (this.game.InitInstallPrompt(), this.game.InitPromoPopUp()), 
        0 === GameSettings.getInstance().gameSession) {
            var t = new WordsearchRank();
            t.userName = GameSettings.getInstance().playerName, t.score = 0, this.game.amazingRank.post_score_object(t, null, function(t) {});
        }
        var e = !0;
        Constants.COMPILE_PLATFORM === Platform.IOS && (e = !0), Constants.IS_POKI && PokiSDK.gameLoadingFinished(), 
        GameSettings.getInstance().applicationData.runOnGameScreen ? this.game.runScene(GameScene.Name, e) : this.game.runScene(MainMenu.Name, e);
    }, o.Name = "preloader", o.TRANSLATIONS = [ "en-US", "pl-PL", "pt-PT", "fr-FR", "de-DE", "es-ES", "it-IT", "kr-KR" ], 
    o;
}(Component);

!function(t) {
    t[t.Idle = 0] = "Idle", t[t.Spawn = 1] = "Spawn", t[t.MoveDown = 2] = "MoveDown", 
    t[t.Removing = 3] = "Removing", t[t.RemovingAsPowerUp = 4] = "RemovingAsPowerUp", 
    t[t.Dead = 5] = "Dead", t[t.GameOverEffect = 6] = "GameOverEffect";
}(BallState || (BallState = {}));

var BallView = function(n) {
    function s(t, e) {
        var i = n.call(this, AmazingGame.getInstance(), 0, 0, Atlases.GAME, e) || this;
        return i.stateTime = 0, i.stateDelay = 0, i.targetY = 0, i.bounceScale = 0, i.scaleMultiplier = 10, 
        i.bombDangerDuration = 0, i.boardController = t, i.bombInfo = new Phaser.Image(i.game, 0, 3, Atlases.GAME, "bomb_info.png"), 
        i.bombInfo.anchor.set(.5), i.addChild(i.bombInfo), i.bombText = new BMFLabel(i.game, 0, 2, Fonts.DIGITALDISPLAY72, "0", 74), 
        i.bombText.setVerticalandHorizontalCenter(), i.bombText.anchor.set(.5), i.addChild(i.bombText), 
        i.bombText.visible = !1, i.bombInfo.visible = !1, i;
    }
    return __extends(s, n), s.prototype.init = function(t, e, i) {
        this.loadTexture(Atlases.GAME), this.frameName = "ball.png", this.bubble = i, this.tint = GameTheme.GetCurretnBallsTint(i.value), 
        this.bombInfo.visible = !1, this.bombText.visible = !1, this.anchor.set(.5), 2 === GameSettings.getInstance().applicationData.themeIndex && (this.frameName = GameTheme.GetOverlayNameForBall(this.bubble.value - 1) + "_1.png", 
        this.tint = 16777215), CountersHelper.contains(this.bubble.id) && this.changeToBomb(), 
        this.position.set(t, e), this.smoothed = !0, this.setState(BallState.Idle), this.scale.set(1), 
        this.bubble.powerup === POWERUP_HORIZONTAL_LINE ? this.changeToHorizontalPowerUp(!1) : this.bubble.powerup === POWERUP_VERTICAL_LINE ? this.changeToVerticalPowerUp(!1) : this.bubble.powerup === POWERUP_REMOVE_COLOR ? this.changeToBombPowerUp(!1) : this.isWildcard() && this.changeToWildcardPowerUp(!1), 
        this.alpha = 0, this.inputEnabled = !1;
    }, s.prototype.initEffect = function(t) {
        this.bounceScale = .23, this.setState(BallState.Spawn), this.scale.set(t), this.bombText.visible;
    }, s.prototype.update = function() {
        n.prototype.update.call(this), this.bombInfo.visible && CountersHelper.getCurrentCounter(this.bubble.id) <= 3 && (this.bombDangerDuration += .6, 
        this.x += 2 * Math.sin(this.bombDangerDuration));
    }, s.prototype.enterEffectMoveFromTop = function() {
        var t = this, e = 250 * (BOARD_HEIGHT - this.bubble.position.y), i = this.position.y;
        this.position.y = -300, this.alpha = 0, this.moveTo(this.position.x, i, e, s.FALLING_TIME), 
        this.game.time.events.add(e, function() {
            t.alpha = 1;
        }, this), this.game.add.tween(this.scale).to({
            x: -1,
            y: 1
        }, 175, Phaser.Easing.Cubic.Out, !0, e + 100).onComplete.addOnce(function() {
            t.game.add.tween(t.scale).to({
                x: 1,
                y: 1
            }, 375, Phaser.Easing.Cubic.Out, !0);
        });
    }, s.prototype.moveFromTopWithoutDelay = function() {
        var t = this.position.y;
        this.position.y = 0, this.moveTo(this.position.x, t, 0, s.FALLING_TIME / 2), this.visible = !0, 
        this.alpha = 0, this.game.add.tween(this).to({
            alpha: 1
        }, 150, Phaser.Easing.Quadratic.In, !0);
    }, s.prototype.selectEffect = function(t) {
        var e = this;
        this.game.add.tween(this.scale).to({
            x: 1.4,
            y: 1.4
        }, 150, Phaser.Easing.Quadratic.Out, !0).onComplete.addOnce(function() {
            e.game.add.tween(e.scale).to({
                x: 1,
                y: 1
            }, 200, Phaser.Easing.Quadratic.Out, !0);
        }), this.isBomb() ? (this.boardController.gameScene.postrenderEffectController.playSelection(this), 
        t && WILD_CARD_THRESHOLD <= t && this.boardController.gameScene.postrenderEffectController.playWildcardSelection(this)) : (this.isWildcard() ? (this.boardController.gameScene.game.time.events.add(1, function() {
            e.boardController.gameScene.prerenderEffectController.playSelection(e, 500, 1);
        }), this.boardController.gameScene.game.time.events.add(100, function() {
            e.boardController.gameScene.prerenderEffectController.playSelection(e, 600, 2);
        }), this.boardController.gameScene.game.time.events.add(200, function() {
            e.boardController.gameScene.prerenderEffectController.playSelection(e, 700, 3);
        }), this.boardController.gameScene.game.time.events.add(300, function() {
            e.boardController.gameScene.prerenderEffectController.playSelection(e, 800, 4);
        })) : (this.boardController.gameScene.game.time.events.add(1, function() {
            e.boardController.gameScene.prerenderEffectController.playSelection(e, 600);
        }), this.boardController.gameScene.game.time.events.add(200, function() {
            e.boardController.gameScene.prerenderEffectController.playSelection(e, 1e3);
        })), this.boardController.gameScene.postrenderEffectController.playSelection(this), 
        t && WILD_CARD_THRESHOLD <= t && (this.boardController.gameScene.postrenderEffectController.playWildcardSelection(this), 
        AudioManager.getInstance().play_effect(Sounds.WILDCARD_TAP, .45)));
    }, s.prototype.hoverEffect = function() {
        var t = this;
        this.game.add.tween(this.scale).to({
            x: 1.1,
            y: 1.1
        }, 75, Phaser.Easing.Quadratic.In, !0).onComplete.addOnce(function() {
            t.game.add.tween(t.scale).to({
                x: 1,
                y: 1
            }, 75, Phaser.Easing.Quadratic.Out, !0);
        });
    }, s.prototype.invalidTouchEffect = function() {
        var t = this;
        0 === this.angle && this.game.add.tween(this).to({
            angle: 30
        }, 120, Phaser.Easing.Quartic.In, !0, 0).onComplete.addOnce(function() {
            t.game.add.tween(t).to({
                angle: 0
            }, 120, Phaser.Easing.Quartic.Out, !0, 0).onComplete.addOnce(function() {}, t);
        }, this);
    }, s.prototype.hintEfect = function() {
        var t = this;
        0 === this.angle && this.game.add.tween(this).to({
            angle: 30
        }, 240, Phaser.Easing.Quartic.In, !0, 0).onComplete.addOnce(function() {
            t.game.add.tween(t).to({
                angle: -30
            }, 240, Phaser.Easing.Quartic.Out, !0, 0).onComplete.addOnce(function() {
                t.game.add.tween(t).to({
                    angle: 0
                }, 240, Phaser.Easing.Quartic.Out, !0, 0).onComplete.addOnce(function() {}, t);
            }, t);
        }, this);
    }, s.prototype.removeEffect = function(t, e, i) {
        var n = this;
        void 0 === e && (e = !1), void 0 === i && (i = !1), this.state !== BallState.RemovingAsPowerUp && (this.setState(BallState.Removing), 
        this.game.time.events.add(t, function() {
            if (i ? n.changeToWildcardPowerUp(!0) : n.explode(), n.isWildcard() || i) {
                var t = n.boardController.gameScene.particleLayer.toLocal(n.position, n.boardController.gameScene.gameLayer);
                n.boardController.gameScene.particleController.playExplodeWildcardEffect(t.x, t.y, n.tint);
            } else t = n.boardController.gameScene.particleLayer.toLocal(n.position, n.boardController.gameScene.gameLayer);
        }), i ? (this.game.add.tween(this).to({
            alpha: 0
        }, 375, Phaser.Easing.Cubic.In, !0, 200).onComplete.addOnce(function() {
            n.remove();
        }), this.game.add.tween(this.scale).to({
            x: 2,
            y: 2
        }, 575, Phaser.Easing.Cubic.Out, !0, t)) : this.game.add.tween(this.scale).to({
            x: -.7,
            y: .7
        }, 175, Phaser.Easing.Cubic.Out, !0, t + 250).onComplete.addOnce(function() {
            n.game.add.tween(n.scale).to({
                x: 1,
                y: 1
            }, 375, Phaser.Easing.Cubic.Out, !0).onComplete.addOnce(function() {
                n.remove();
            }, n), n.game.add.tween(n).to({
                alpha: 0
            }, 375, Phaser.Easing.Cubic.In, !0);
        }, this));
    }, s.prototype.gameOverEffect = function(t) {
        var e = this;
        this.setState(BallState.Removing), this.game.time.events.add(t, function() {
            e.game.add.tween(e).to({
                alpha: 0
            }, 1e3, Phaser.Easing.Quartic.InOut, !0, 0).onComplete.addOnce(function() {
                e.remove();
            }, e);
        }, this);
    }, s.prototype.isWildcard = function() {
        return this.bubble.value === BUBBLE_WILD_CARD;
    }, s.prototype.remove = function() {
        this.boardController.gameScene.ballPool.add_object_to_pool(this);
    }, s.prototype.moveTo = function(t, e, i, n) {
        var s = this;
        void 0 === i && (i = 0), void 0 === n && (n = 0), this.setState(BallState.MoveDown), 
        this.game.add.tween(this.position).to({
            x: t,
            y: e
        }, n, Phaser.Easing.Bounce.Out, !0, i).onComplete.addOnce(function() {
            s.setState(BallState.Idle);
        }, this);
    }, s.prototype.moveToWithoutBounce = function(t, e, i, n) {
        var s = this;
        void 0 === i && (i = 0), void 0 === n && (n = 0), this.setState(BallState.MoveDown), 
        this.game.add.tween(this.position).to({
            x: t,
            y: e
        }, n, Phaser.Easing.Quintic.In, !0, i).onComplete.addOnce(function() {
            s.setState(BallState.Idle);
        }, this);
    }, s.prototype.moveToPowerUp = function(t, e, i, n) {
        var s = this;
        void 0 === i && (i = 0), void 0 === n && (n = 0), this.setState(BallState.RemovingAsPowerUp), 
        this.game.add.tween(this.scale).to({
            x: 0,
            y: 0
        }, n, Phaser.Easing.Cubic.Out, !0, i).onComplete.addOnce(function() {}, this), this.game.add.tween(this.position).to({
            x: t,
            y: e
        }, n, Phaser.Easing.Cubic.Out, !0, i).onComplete.addOnce(function() {
            s.remove();
        }, this);
    }, s.prototype.isIdle = function() {
        return this.state === BallState.Idle;
    }, s.prototype.setState = function(t) {
        this.stateTime = 0, this.state = t;
    }, s.prototype.isPowerUp = function() {
        return 0 != this.bubble.powerup;
    }, s.prototype.prepareFirePowerUp = function() {
        this.setState(BallState.RemovingAsPowerUp);
    }, s.prototype.fireBombEffect = function(t) {
        var e = this;
        this.prepareFirePowerUp(), this.game.add.tween(this.scale).to({
            x: 2.5,
            y: 2.5
        }, 375, Phaser.Easing.Cubic.Out, !0).onComplete.addOnce(function() {
            e.boardController.gameScene.prerenderEffectController.fireBombEffect(e, t);
        }, this), this.game.time.events.add(750, function() {
            e.remove();
        }, this);
    }, s.prototype.fireCounterBomb = function() {
        var t = this;
        this.prepareFirePowerUp();
        var e = this.boardController.gameScene.particleLayer.toLocal(this.position, this.boardController.gameScene.gameLayer);
        this.boardController.gameScene.particleController.playExplodeEffect(e.x, e.y, s.GetTintForBall(this)), 
        this.game.tweens.removeFrom(this.scale), this.game.add.tween(this.scale).to({
            x: 0,
            y: 0
        }, 550, Phaser.Easing.Cubic.Out, !0).onComplete.addOnce(function() {
            t.remove();
        }, this);
    }, s.prototype.changeToHorizontalPowerUp = function(t) {
        var e = this;
        this.frameName = "horizontal.png", 2 === GameSettings.getInstance().applicationData.themeIndex && (this.frameName = GameTheme.GetOverlayNameForBall(this.bubble.value - 1) + "_3.png", 
        this.tint = 16777215), t && (this.boardController.gameScene.prerenderEffectController.changeToPowerUpCircle(this, 15), 
        this.game.add.tween(this.scale).to({
            x: 3.5,
            y: 1.5
        }, 375, Phaser.Easing.Cubic.Out, !0).onComplete.addOnce(function() {
            e.boardController.gameScene.effectController.playHorizontalLineEffect(e), e.game.add.tween(e).to({
                alpha: 0
            }, 375, Phaser.Easing.Cubic.Out, !0).onComplete.addOnce(function() {
                e.remove();
            }, e);
        }, this), this.bringToTop());
    }, s.prototype.changeToVerticalPowerUp = function(t) {
        var e = this;
        this.frameName = "vertical.png", 2 === GameSettings.getInstance().applicationData.themeIndex && (this.frameName = GameTheme.GetOverlayNameForBall(this.bubble.value - 1) + "_2.png", 
        this.tint = 16777215), t && (this.boardController.gameScene.prerenderEffectController.changeToPowerUpCircle(this, 15), 
        this.game.add.tween(this.scale).to({
            x: 1.5,
            y: 3.5
        }, 375, Phaser.Easing.Cubic.Out, !0).onComplete.addOnce(function() {
            e.boardController.gameScene.effectController.playVerticalLineEffect(e), e.game.add.tween(e).to({
                alpha: 0
            }, 375, Phaser.Easing.Cubic.Out, !0).onComplete.addOnce(function() {
                e.remove();
            }, e);
        }, this), this.bringToTop());
    }, s.prototype.changeToWildcardPowerUp = function(t) {
        this.frameName = "wildcard.png", this.tint = Utils.RGBtoHEX(255, 255, 255), this.bombText.visible = !1, 
        this.bombInfo.visible = !1, this.anchor.set(.5, .5), t && this.game.add.tween(this).to({
            angle: 360
        }, 750, Phaser.Easing.Linear.None, !0, 0).onComplete.addOnce(function() {});
    }, s.prototype.changeToBombPowerUp = function(t) {
        var e = this;
        this.frameName = "color.png", 2 === GameSettings.getInstance().applicationData.themeIndex && (this.frameName = GameTheme.GetOverlayNameForBall(this.bubble.value - 1) + "_5.png", 
        this.tint = 16777215), t && (this.boardController.gameScene.prerenderEffectController.changeToPowerUp(this, 500), 
        this.explode(), this.game.add.tween(this.scale).to({
            x: -.7,
            y: .7
        }, 150, Phaser.Easing.Cubic.Out, !0).onComplete.addOnce(function() {
            e.game.add.tween(e.scale).to({
                x: 1.5,
                y: 1.5
            }, 400, Phaser.Easing.Cubic.Out, !0).onComplete.addOnce(function() {}, e), e.game.add.tween(e).to({
                alpha: 0
            }, 400, Phaser.Easing.Cubic.In, !0);
        }, this));
    }, s.prototype.explode = function() {
        var t = this, e = GameTheme.GetCurretnBallsTint(this.boardController.gameScene.gameLogic.grid[this.bubble.position.x][this.bubble.position.y].value);
        this.boardController.gameScene.postrenderEffectController.playRingAnim(this, 0, e);
        var i = this.boardController.gameScene.particleLayer.toLocal(this.position, this.boardController.gameScene.gameLayer);
        this.game.time.events.add(50, function() {
            t.boardController.gameScene.particleController.playStarsEffect(i.x, i.y, s.GetTintForBall(t));
        }, this);
    }, s.prototype.changeToBomb = function() {
        this.frameName = "bomb.png", this.bombText.text = CountersHelper.getCurrentCounter(this.bubble.id).toString(), 
        this.bombText.position.x = 2, this.bombText.text.startsWith("1") && (this.bombText.position.x = -10), 
        this.bombText.tint = s.GetTintForBall(this), this.bombText.visible = !0, this.bombInfo.visible = !0, 
        this.bombInfo.tint = Utils.RGBtoHEX(255, 255, 255), this.anchor.set(.5, .625), 2 === GameSettings.getInstance().applicationData.themeIndex && (this.frameName = GameTheme.GetOverlayNameForBall(this.bubble.value - 1) + "_4.png", 
        this.tint = 16777215), GameTheme.IsDarkTheme() ? this.bombInfo.tint = 0 : this.bombInfo.tint = 16777215;
    }, s.prototype.isBomb = function() {
        return this.bombInfo.visible;
    }, s.prototype.refreshBomb = function() {
        this.bombText.visible && (this.bombText.position.x = 0, this.bombText.text = CountersHelper.getCurrentCounter(this.bubble.id).toString(), 
        this.bombText.text.startsWith("1") && (this.bombText.position.x = -10));
    }, s.prototype.bombGameOverEffect = function() {
        Utils.tweenTint(this.game, this, this.tint, Phaser.Color.hexToColor("#53616C").color, 300);
    }, s.prototype.fireGameOverEffect = function(e) {
        for (var n = this, s = this, t = function(t) {
            var i = e[t];
            o.game.time.events.add(50 * t, function(t) {
                t.bombGameOverEffect(), t.boardController.gameScene.prerenderEffectController.fireGameOverEffect(s, [ t ]);
                var e = n.boardController.gameScene.particleLayer.toLocal(i.position, n.boardController.gameScene.gameLayer);
                n.boardController.gameScene.particleController.playExplodeEffect(e.x, e.y, 5464428);
            }, o, i);
        }, o = this, i = 0; i < e.length; i++) t(i);
    }, s.prototype.clearTweens = function() {
        this.game.tweens.removeFrom(this.position);
    }, s.prototype.refreshTheme = function() {
        this.tint = GameTheme.GetCurretnBallsTint(this.bubble.value), this.isWildcard() && (this.tint = Utils.RGBtoHEX(255, 255, 255)), 
        2 == GameSettings.getInstance().applicationData.themeIndex ? (this.frameName = GameTheme.GetOverlayNameForBall(this.bubble.value - 1) + "_1.png", 
        this.tint = 16777215, this.isBomb() && (this.frameName = GameTheme.GetOverlayNameForBall(this.bubble.value - 1) + "_4.png", 
        this.bombText.tint = s.GetTintForBall(this))) : (this.frameName = "ball.png", this.isBomb() && (this.frameName = "bomb.png"), 
        this.tint = s.GetTintForBall(this), this.bombText.tint = s.GetTintForBall(this)), 
        this.isWildcard() && (this.frameName = "wildcard.png", this.tint = 16777215), GameTheme.IsDarkTheme() ? this.bombInfo.tint = 0 : this.bombInfo.tint = 16777215;
    }, s.prototype.refreshForTutorial = function() {
        this.isWildcard() || (this.tint = GameTheme.GetCurretnBallsTint(this.bubble.value)), 
        CountersHelper.contains(this.bubble.id) && this.changeToBomb();
    }, s.GetTintForBall = function(t) {
        return GameTheme.GetCurretnBallsTint(t.bubble.value);
    }, s.FALLING_TIME = 1025, s;
}(Phaser.Image), Line = function(a) {
    function e(t, e, i, n, s) {
        var o = a.call(this, t, e, i, n, s) || this;
        return o.pFrame = o.game.cache.getFrameData(n).getFrameByName(s), o;
    }
    return __extends(e, a), e.prototype.redraw = function(t, e, i, n, s, o) {
        this.x1 = t, this.y1 = e, this.x2 = i, this.y2 = n, this.thicknes = s;
        var a = i - t, r = n - e, h = Phaser.Point.normalize(new Phaser.Point(a, r)), l = Math.sqrt(a * a + r * r);
        this.x = t + h.x * l / 2, this.y = e + h.y * l / 2, this.scale.set(l / this.pFrame.width, s), 
        this.rotation = Math.atan2(r, a), this.tint = o, this.anchor.set(.5, .5);
    }, e.prototype.clone = function() {
        var t = new e(this.game, this.x, this.y, this.key, this.frameName);
        return t.redraw(this.x1, this.y1, this.x2, this.y2, this.thicknes, this.tint), t.scale.set(this.scale.x), 
        t;
    }, e.prototype.playBombEffect = function() {
        this.game.add.tween(this.scale).to({
            x: 0,
            y: 0
        }, 500, Phaser.Easing.Cubic.Out, !0), this.game.add.tween(this).to({
            alpha: 0
        }, 500, Phaser.Easing.Cubic.Out, !0);
    }, e.prototype.playBlinkAndScaleDown = function() {
        var e = 0, i = 10, n = this;
        !function t() {
            e++;
            if (e < i) return n.visible = !n.visible, void n.game.time.events.add(50, function() {
                t();
            });
        }();
    }, e;
}(Phaser.Image);